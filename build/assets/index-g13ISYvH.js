const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/InlineImageComponent-zYRbgtOS.js","assets/vendor-DFfV0FQp.js"])))=>i.map(i=>d[i]);
var Bg=Object.defineProperty;var Fg=(t,s,n)=>s in t?Bg(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var Wt=(t,s,n)=>Fg(t,typeof s!="symbol"?s+"":s,n);import{X as ro,l as xm,M as hm,t as fm,R as C,j as e,r as b,c as zg,i as ls,g as I,u as Le,a as _r,m as gi,b as Ae,C as Pg,d as Ec,e as Et,f as gm,L as ue,P as Bt,D as Rg,h as Hg,k as Wg,n as bi,q as bm,o as ym,p as yi,s as vm,v as Vg,w as vi,x as ne,y as Zt,z as ao,A as Ug,O as qg,B as wm,E as jm,U as cr,S as Cm,F as Nm,G as km,H as Gg,I as Jg,J as Xg,K as Zg,N as As,Q as _a,T as dr,V as Ml,W as $m,Y as oo,Z as Yg,_ as Qg,$ as Sm,a0 as Kg,a1 as e0,a2 as t0,a3 as _m,a4 as Yt,a5 as He,a6 as We,a7 as Ke,a8 as kn,a9 as Im,aa as Lm,ab as s0,ac as Al,ad as Tl,ae as ur,af as wi,ag as n0,ah as r0,ai as a0,aj as pt,ak as Em,al as ut,am as o0,an as Ol,ao as ji,ap as $n,aq as lo,ar as l0,as as Mc,at as i0,au as c0,av as Ac,aw as d0,ax as cs,ay as Ir,az as ct,aA as io,aB as Mm,aC as Am,aD as Ia,aE as Tm,aF as u0,aG as Om,aH as m0,aI as p0,aJ as x0,aK as ha,aL as h0,aM as f0,aN as g0,aO as Ts,aP as Dm,aQ as Bm,aR as Fm,aS as fs,aT as b0,aU as zm,aV as Pm,aW as Rm,aX as Hm,aY as Is,aZ as Wm,a_ as Vm,a$ as Um,b0 as y0,b1 as v0,b2 as w0,b3 as Tc,b4 as Os,b5 as j0,b6 as is,b7 as co,b8 as ar,b9 as C0,ba as N0,bb as Ds,bc as k0,bd as Ut,be as $0,bf as S0,bg as _0,bh as qm,bi as Dl,bj as Oc,bk as I0,bl as L0,bm as E0,bn as M0,bo as A0,bp as Jo,bq as Gm,br as T0,bs as Dc,bt as Jm,bu as O0,bv as Xm,bw as D0,bx as B0,by as F0,bz as z0,bA as P0,bB as R0,bC as H0,bD as W0,bE as V0,bF as Bc,bG as U0,bH as Yr,bI as q0,bJ as G0,bK as J0,bL as X0,bM as Z0,bN as Y0,bO as Q0,bP as K0,bQ as eb,bR as Zm,bS as tb,bT as sb,bU as nb,bV as rb,bW as Fc,bX as ab,bY as zc,bZ as ob,b_ as lb,b$ as ib,c0 as cb,c1 as db,c2 as ub,c3 as mb,c4 as pb,c5 as xb,c6 as hb,c7 as fb,c8 as gb,c9 as bb,ca as yb,cb as vb,cc as wb,cd as Ze,ce as pe,cf as jb,cg as Cb,ch as Qe,ci as Gt,cj as bt,ck as Ge,cl as Ci,cm as Nb,cn as uo,co as Be,cp as tn,cq as Rt,cr as Oe,cs as Je,ct as mo,cu as Ni,cv as kb,cw as $b,cx as Te,cy as Sb,cz as _b,cA as Ib,cB as Pc,cC as Ym,cD as Lb,cE as Tt,cF as Eb,cG as Mb,cH as Ab,cI as Tb,cJ as Ob,cK as Db,cL as Bb,cM as Fb,cN as zb,cO as Pb,cP as Qm,cQ as rs,cR as st,cS as bs,cT as ki,cU as Km,cV as ep,cW as tp,cX as sp,cY as Rb,cZ as Hb,c_ as Wb,c$ as $i,d0 as Vb,d1 as Ub,d2 as La,d3 as np,d4 as qb,d5 as Gb,d6 as Jb,d7 as Si,d8 as Xb,d9 as Zb,da as Yb,db as Rc,dc as Qb,dd as Hc,de as Kb,df as rp,dg as ap,dh as op,di as lp,dj as ip,dk as cp,dl as sn,dm as e1,dn as t1,dp as Sn,dq as dp,dr as _i,ds as s1,dt as ye,du as up,dv as n1,dw as r1,dx as a1,dy as po,dz as o1,dA as gn,dB as K,dC as _n,dD as jt,dE as l1,dF as Qr,dG as Wc,dH as i1,dI as c1,dJ as d1}from"./vendor-DFfV0FQp.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();function u1(t,s,n){let r,a,l,i,c,d=!1,u=!1;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT);s=Number(s)||0;function m(N){let S=r,w=a;return r=a=void 0,l=t.apply(w,S),l}function p(N){return i=setTimeout(f,s),d?m():l}function x(N){let S=N-c;return s-S}function h(N){let S=N-c;return c===void 0||S>=s||S<0||u}function f(){const N=Date.now();if(h(N))return g();i=setTimeout(f,x(N))}function g(N){return i=void 0,r?m():(r=a=void 0,l)}function y(){i!==void 0&&clearTimeout(i),r=c=a=i=void 0}function v(){return i===void 0?l:g()}function j(){let N=Date.now(),S=h(N);return r=arguments,a=this,c=N,S&&i===void 0?p():(i===void 0&&(i=setTimeout(f,s)),l)}return j.cancel=y,j.flush=v,j}function m1(){return new ro}function p1(){return new ro}var Vc=Object.prototype.hasOwnProperty,Uc=function(){};function Bl(){}Bl.create=function(t){var s=new Bl;return s.subscribe=function(n,r,a){var l,i;return typeof n=="function"?l={onNext:n,onError:r||Uc,onCompleted:a||Uc}:l=n,i=t(l),typeof i=="function"?{dispose:i}:i},s};function Xo(t,s,n){return Bl.create(function(a){var l={method:t||"GET",crossDomain:!1,async:!0,headers:{},responseType:"json"},i,c,d,u,m;for(m in s)Vc.call(s,m)&&(l[m]=s[m]);!l.crossDomain&&!l.headers["X-Requested-With"]&&(l.headers["X-Requested-With"]="XMLHttpRequest"),n.onBeforeRequest!=null&&n.onBeforeRequest(l);try{i=l.crossDomain?p1():m1()}catch(p){a.onError(p)}try{l.user?i.open(l.method,l.url,l.async,l.user,l.password):i.open(l.method,l.url,l.async),i.timeout=l.timeout,i.withCredentials=l.withCredentials!==!1,d=l.headers;for(u in d)Vc.call(d,u)&&i.setRequestHeader(u,d[u]);if(l.responseType)try{i.responseType=l.responseType}catch(p){if(l.responseType!=="json")throw p}i.onreadystatechange=function(x){i.readyState===4&&(c||(c=!0,x1(a,i,x)))},i.ontimeout=function(x){c||(c=!0,h1(a,i,"timeout error",x))},i.send(l.data)}catch(p){a.onError(p)}return function(){!c&&i.readyState!==4&&(c=!0,i.abort())}})}function pn(t,s,n){n||(n=new Error(s)),t.onError(n)}function x1(t,s,n){var r,a;if(s&&t){a=s.responseType,r="response"in s?s.response:s.responseText;var l=s.status===1223?204:s.status;if(l>=200&&l<=399){try{a!=="json"&&(r=JSON.parse(r||"")),typeof r=="string"&&(r=JSON.parse(r||""))}catch(i){pn(t,"invalid json",i)}t.onNext(r),t.onCompleted();return}else return l===401||l===403||l===407||l===410||l===408||l===504?pn(t,r):pn(t,r||"Response code "+l)}}function h1(t,s,n,r){pn(t,n,r)}function f1(t,s,n){var r=[],a,l={url:t},i=t.indexOf("?")!==-1,c=i?"&":"?";return typeof n=="string"?r.push(n):(a=Object.keys(n),a.forEach(function(d){var u=typeof n[d]=="object"?JSON.stringify(n[d]):n[d];r.push(d+"="+encodeURIComponent(u))})),s==="GET"?l.url+=c+r.join("&"):l.data=r.join("&"),l}function xn(t,s){var n;for(n in s)t[n]=s[n];return t}function Hs(t,s){if(this._jsongUrl=t,typeof s=="number"){var n={timeout:s};s=n}this._config=xn({timeout:15e3,headers:{}},s||{})}Hs.prototype={constructor:Hs,buildQueryObject:f1,get:function(s){var n="GET",r=this.buildQueryObject(this._jsongUrl,n,{paths:s,method:"get"}),a=xn(r,this._config),l=this;return Xo(n,a,l)},set:function(s){var n="POST",r,a;!this._config.headers||!this._config.headers["Content-Type"]||!this._config.headers["Content-Type"].match(/application\/json/)?(a=this.buildQueryObject(this._jsongUrl,n,{jsonGraph:s,method:"set"}),r=xn(a,this._config),r.headers["Content-Type"]="application/x-www-form-urlencoded"):r=xn({url:this._jsongUrl,data:JSON.stringify({jsonGraph:JSON.stringify(s),method:"set"})},this._config);var l=this;return Xo(n,r,l)},call:function(s,n,r,a){n=n||[],r=r||[],a=a||[];var l="POST",i,c=[],d;!this._config.headers||!this._config.headers["Content-Type"]||!this._config.headers["Content-Type"].match(/application\/json/)?(c.push("method=call"),c.push("callPath="+encodeURIComponent(JSON.stringify(s))),c.push("arguments="+encodeURIComponent(JSON.stringify(n))),c.push("pathSuffixes="+encodeURIComponent(JSON.stringify(r))),c.push("paths="+encodeURIComponent(JSON.stringify(a))),d=this.buildQueryObject(this._jsongUrl,l,c.join("&")),i=xn(d,this._config),i.headers["Content-Type"]="application/x-www-form-urlencoded"):i=xn({url:this._jsongUrl,data:JSON.stringify({method:"call",callPath:JSON.stringify(s),arguments:JSON.stringify(n),pathSuffixes:JSON.stringify(r),paths:JSON.stringify(a)})},this._config);var u=this;return Xo(l,i,u)}};Hs.XMLHttpSource=Hs;Hs.default=Hs;Promise.map=function(t,s,n={}){let r=n.concurrency||1/0,a=0;const l=[],i=[],c=t[Symbol.iterator]();for(;r-- >0;){const u=d();if(u)i.push(u);else break}return Promise.all(i).then(()=>l);function d(){const u=c.next();if(u.done)return null;const m=a++,p=s(u.value,m);return Promise.resolve(p).then(x=>(l[m]=x,d()))}};let g1=class extends Hs{onBeforeRequest(s){if(window&&window.localStorage){const n=window.localStorage.getItem("userToken");n&&(s.headers.Authorization=n)}}};function b1(){return{}}const y1=()=>{},v1=(t,s,n={})=>{const{placeholder:r="replace_me",chunkSize:a=100}=n,l=[];for(let i=0;i<t.length;i+=a)l.push(s.map(c=>c===r?t.slice(i,i+a):c));return l.length?l:[s]},w1=(t,s={})=>{const{falcor:n,onProgress:r=y1,concurrency:a=5,...l}=s,i=fm(r,50);let c=0,d=0,u=t.reduce((m,[p,x])=>{const h=v1(p,x,l);return d+=h.length,m.push(...h),m},[]);return Promise.map(u,m=>n.get(m).then(()=>{i(++c,d)}),{concurrency:a})},mp=t=>t.reduce((s,n)=>(Array.isArray(n)?s[0].push(n):s[1]=n,s),[[],{}]),j1=(...t)=>{const[s,n]=mp(t),{index:r=null,placeholder:a="replace_me",...l}=n,i=s.reduce((c,d)=>{let u=[],m=!1;const p=d.map((x,h)=>Array.isArray(x)&&x.length&&!m&&(r===null||r===h)?(m=!0,u=x,a):x);return c.push([u,p]),c},[]);return w1(i,{...l,placeholder:a})};let C1=class extends hm{constructor(...s){super(...s),this.listeners=[],this.onChange=this.onChange.bind(this),this.listen=this.listen.bind(this),this.unlisten=this.unlisten.bind(this)}onChange(){this.listeners.forEach(s=>s())}listen(s){this.listeners.includes(s)||this.listeners.push(s)}unlisten(s){this.listeners=this.listeners.filter(n=>n!==s)}},N1=class extends xm.Model{constructor(...s){super(...s),this.onChange=this.onChange.bind(this),this.remove=this.remove.bind(this),this.chunk=this.chunk.bind(this)}onChange(s,n){this._root.listen(s,n)}remove(s){this._root.unlisten(s)}get(...s){return super.get(...s).then(n=>n)}chunk(...s){const[n,r]=mp(s);return j1(...n,{falcor:this,...r})}};const pp=t=>new N1({_root:new C1,source:new g1(t+"/graph",{crossDomain:!0,withCredentials:!1,timeout:12e4}),errorSelector:(s,n)=>(console.log("errorSelector",s,n),n),cache:b1()});pp("https://graph.availabs.org");const Ii=C.createContext(),k1=()=>C.useContext(Ii);Ii.Consumer;const $1=({falcor:t,children:s})=>{const[n,r]=C.useState({}),a=C.useMemo(()=>u1(()=>{const i=t.getCache();r(i)},250),[t]);C.useEffect(()=>(t.onChange(a),()=>{t.remove(a)}),[t,a]);const l=C.useMemo(()=>({falcor:t,falcorCache:n}),[t,n]);return e.jsx(Ii.Provider,{value:l,children:s})},xp=(t,s)=>{const[n,...r]=t.split(new RegExp("(?<!^)(?=[A-Z])"));return!s.$compositions||!s.$compositions[n]?s[n]||"":s.$compositions[n].reduce((a,l)=>{let i=l.$default||"";for(const c of r)c in l&&(i=l[c]);return a.push(i),a},[]).filter(Boolean).join(" ")},S1=t=>{const s=JSON.parse(JSON.stringify(t));for(const n in s){if(n==="$compositions")continue;const r=s[n].split(/\s+/),a=/^[@](.+)$/;s[n]=r.map(l=>{const i=a.exec(l);if(i){const[,c]=i;return s[c]}return l}).join(" ")}if(s.$compositions){const{$defaults:n=[],...r}=s.$compositions;for(const a in r)s.$compositions[a].forEach(l=>{for(let i in l){const c=/^[@](.+)$/;l[i]=l[i].split(/\s+/).map(m=>{const p=c.exec(m);if(p){const[,x]=p;return s[x]}return m}).join(" ");const d=/^\$(.+)$/,u=d.exec(l[i]);if(u){const[,m]=u;m in s&&(l[i]=s[m],n.push(m))}}});n.forEach(a=>{s[a]=xp(a,s)})}return s},hp={get:(t,s,n)=>(s in t||(t[s]=xp(s,t)),t[s])},xo=t=>new Proxy(t,hp),_1=t=>new Proxy(S1(t),hp),I1=[{$default:"rounded inline-flex items-center justify-center @transition disabled:cursor-not-allowed disabled:bg-transparent disabled:opacity-50 focus:outline-none border",Text:"inline-flex items-center justify-center @transition disabled:cursor-not-allowed disabled:opacity-50 focus:outline-none border"},{$default:"text-gray-400 disabled:text-gray-300",Primary:"text-blue-400 disabled:text-blue-300",Success:"text-green-400 disabled:text-green-300",Danger:"text-red-400 disabled:text-red-300",Info:"text-teal-400 disabled:text-teal-300"},{$default:"border-gray-400",Primary:"border-blue-400",Success:"border-green-400",Danger:"border-red-400",Info:"border-teal-400",Text:"border-none"},{$default:"hover:bg-gray-400 hover:text-white",Primary:"hover:bg-blue-400 hover:text-white",Success:"hover:bg-green-400 hover:text-white",Danger:"hover:bg-red-400 hover:text-white",Info:"hover:bg-teal-400 hover:text-white",Text:""},{$default:"px-4 py-1 @textBase",Large:"px-6 py-2 @textLarge",Small:"px-2 py-0 @textSmall"},{Block:"w-full"}],L1=[{$default:"w-full block rounded cursor-pointer disabled:cursor-not-allowed @transition @text @placeholder @inputBg @inputBorder"},{$default:"@paddingBase @textBase",Large:"@paddingLarge @textLarge",Small:"@paddingSmall @textSmall"}],E1=[{$default:"border-transparent font-medium focus:outline-none @transition"},{Top:"h-16 flex flex-1 items-center px-4 text-base leading-5",Side:"h-12 mb-1 flex pl-3 pr-4 py-2 border-l-4 text-base"},{$default:"@menuBg @menuBgHover @menuText @menuTextHover",Active:"@menuBgActive @menuBgActiveHover @menuTextActive @menuTextActiveHover"}],M1=[{$default:"@transition inline-flex px-2 hover:font-bold disabled:font-normal disabled:cursor-not-allowed disabled:opacity-50 focus:outline-none"},{$default:"$textbutton",Info:"text-teal-400 hover:text-teal-500 disabled:text-teal-400"},{$default:"text-base",Large:"text-lg",Small:"text-sm"},{$default:"font-normal cursor-pointer",Active:"font-bold cursor-default"}],A1=[{$default:"@transition rounded"},{$default:"p-2 bg-opacity-50",Item:"py-1 px-3 bg-gray-300 mb-2"},{$default:"bg-opacity-50",Dragging:"bg-opacity-75"},{$default:"bg-gray-400",Success:"bg-green-400"}],T1={$defaults:["input","navitemTop","navitemTopActive","navitemSide","navitemSideActive"],button:I1,input:L1,navitem:E1,textbutton:M1,list:A1},O1={bg:"custom-bg",ySpace:"py-4",contentPadding:"py-4",menuBg:"custom-bg",contentWidth:"",text:"text-blue-800",sidebarW:"64",sidebarBorder:"",menuIcon:"mr-3 h-5 w-5",navitemTop:"mr-4 inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out",navitemTopActive:"mr-4 inline-flex items-center px-1 pt-1 border-b-2 border-indigo-500 text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-700 transition duration-150 ease-in-out",navitemSide:"mb-1 group flex pl-3 pr-4 py-2 border-l-4 border-transparent text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out",navitemSideActive:"mb-1 group flex pl-3 pr-4 py-2 border-l-4 border-indigo-500 text-sm font-medium text-indigo-700 bg-indigo-50 focus:outline-none focus:text-indigo-800 focus:bg-indigo-100 focus:border-indigo-700 transition duration-150 ease-in-out",headerBg:"custom-bg",headerShadow:"",contentBg:"",accent1:"bg-gray-200",accent2:"bg-gray-300",accent3:"bg-gray-400",accent4:"bg-gray-500",lighter:"bg-gray-50",button:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm leading-5 font-medium rounded-md text-gray-700 bg-white hover:text-gray-500 focus:outline-none focus:shadow-outline-blue focus:border-blue-300 active:text-gray-800 active:bg-gray-50 transition duration-150 ease-in-out",buttonPrimary:"inline-flex items-center px-4 py-2 border border-transparent text-sm leading-5 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 focus:outline-none focus:shadow-outline-indigo focus:border-indigo-700 active:bg-indigo-700 transition duration-150 ease-in-out",textbutton:"text-sm text-blue-500 hover:text-blue-300 px-2",input:"block",tableRow:"bg-white border-b border-blue-100 hover:bg-blue-50",tableRowStriped:"bg-white even:bg-gray-50",tableCell:"px-6 py-4 whitespace-no-wrap text-sm leading-5 text-gray-600",tableCellCondensed:"px-3 py-2 whitespace-no-wrap text-sm leading-5 text-gray-600",tableHeader:"px-6 pt-2 pb-1	border-b border-gray-400 bg-gray-200 text-left font-medium text-gray-700 uppercase first:rounded-tl-md last:rounded-tr-md"};xo(O1);const D1={bg:"bg-gray-300",menuBg:"bg-gray-800",sidebarW:"56",sidebarBorder:"",shadow:"",ySpace:"py-5",contentPadding:"py-5",text:"text-gray-300",contentWidth:"max-w-7xl mx-auto",menuIcon:"mr-3 h-4 w-4",navitemTop:"ml-3 my-3 px-3 py-1 inline-flex items-center rounded-md text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-700 focus:outline-none focus:text-white focus:bg-gray-700",navitemTopActive:"ml-3 my-3 px-3 py-1 inline-flex items-center rounded-md text-sm font-medium text-white bg-gray-900 focus:outline-none focus:text-white focus:bg-gray-700",navitemSide:"mt-1 group flex items-center px-2 py-2 text-sm leading-5 font-medium text-gray-300 rounded-md hover:text-white hover:bg-gray-700 focus:outline-none focus:text-white focus:bg-gray-700 transition ease-in-out duration-150",navitemSideActive:"group flex items-center px-2 py-2 text-sm leading-5 font-medium text-white rounded-md bg-gray-900 focus:outline-none focus:bg-gray-700 transition ease-in-out duration-150",headerBg:"bg-gray-800",headerShadow:"shadow",contentBg:"bg-gray-100",accent1:"bg-gray-600",accent2:"bg-gray-500",accent3:"bg-gray-400",lighter:"bg-gray-700",button:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm leading-5 font-medium rounded-md text-gray-700 bg-white hover:text-gray-500 focus:outline-none focus:shadow-outline-blue focus:border-blue-300 active:text-gray-800 active:bg-gray-50 transition duration-150 ease-in-out",buttonPrimary:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm leading-5 font-medium rounded-md text-gray-700 bg-white hover:text-gray-500 focus:outline-none focus:shadow-outline-blue focus:border-blue-300 active:text-gray-800 active:bg-gray-50 transition duration-150 ease-in-out",textbutton:"text-sm text-blue-500 hover:text-blue-300 px-2",tableRow:"bg-white border-b border-gray-200",tableRowStriped:"bg-white even:bg-gray-50"};xo(D1);const B1={bg:"bg-gray-200",menuBg:"bg-indigo-800",sidebarW:"56",sidebarBorder:"",shadow:"shadow",ySpace:"py-5",contentPadding:"py-5",text:"text-gray-300",contentWidth:"max-w-7xl mx-auto",menuIcon:"mr-3 h-4 w-4",navitemTop:"ml-3 my-3 px-3 py-1 inline-flex items-center rounded-md text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-700 focus:outline-none focus:text-white focus:bg-gray-700",navitemTopActive:"ml-3 my-3 px-3 py-1 inline-flex items-center rounded-md text-sm font-medium text-white bg-gray-900 focus:outline-none focus:text-white focus:bg-gray-700",navitemSide:"mt-1 group flex items-center px-2 py-2 text-sm leading-5 font-medium text-gray-300 rounded-md hover:text-white hover:bg-gray-700 focus:outline-none focus:text-white focus:bg-gray-700 transition ease-in-out duration-150",navitemSideActive:"group flex items-center px-2 py-2 text-sm leading-5 font-medium text-white rounded-md bg-gray-900 focus:outline-none focus:bg-gray-700 transition ease-in-out duration-150",headerBg:"bg-gray-800",headerShadow:"shadow",contentBg:"bg-gray-100",accent1:"bg-gray-200",accent2:"bg-gray-300",accent3:"bg-gray-400",light:"bg-gray-50",button:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm leading-5 font-medium rounded-md text-gray-700 bg-white hover:text-gray-500 focus:outline-none focus:shadow-outline-blue focus:border-blue-300 active:text-gray-800 active:bg-gray-50 transition duration-150 ease-in-out",buttonPrimary:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm leading-5 font-medium rounded-md text-gray-700 bg-white hover:text-gray-500 focus:outline-none focus:shadow-outline-blue focus:border-blue-300 active:text-gray-800 active:bg-gray-50 transition duration-150 ease-in-out",tableRow:"bg-white border-b border-gray-200",tableRowStriped:"bg-white even:bg-gray-50"};xo(B1);const F1={shadow:"shadow",ySpace:"py-4",contentPadding:"py-4",sidebarBorder:"",text:"text-gray-800",textContrast:"text-white",border:"border-gray-400",textInfo:"text-teal-400",bgInfo:"bg-teal-400",borderInfo:"border-teal-400",textSuccess:"text-green-400",bgSuccess:"bg-green-400",borderSuccess:"border-green-400",textPrimary:"text-blue-400",bgPrimary:"bg-blue-400",borderPrimary:"border-blue-400",textDanger:"text-red-400",bgDanger:"bg-red-400",borderDanger:"border-red-400",textWarning:"text-yellow-400",bgWarning:"bg-yellow-400",borderWarning:"border-yellow-400",textLight:"text-gray-400",placeholder:"placeholder-gray-400",borderLight:"border-gray-400",bgLight:"bg-gray-400",menuIcon:"mr-3 h-6 w-6",topMenuBorder:"border-b border-gray-200",headerShadow:"",navitemTop:"mr-4 inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out",navitemTopActive:"mr-4 inline-flex items-center px-1 pt-1 border-b-2 border-indigo-500 text-sm font-medium leading-5 text-gray-900 bg-indigo-100 focus:outline-none hover:bg-indigo-200 focus:border-indigo-700 transition duration-150 ease-in-out",navitemSide:"mb-1 group flex pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-300 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out",navitemSideActive:"mb-1 group flex pl-3 pr-4 py-2 border-l-4 border-indigo-500 text-base font-medium text-indigo-600 bg-indigo-100 focus:outline-none hover:text-indigo-800 focus:text-indigo-800 hover:bg-indigo-200 focus:bg-indigo-200 focus:border-indigo-700 transition duration-150 ease-in-out",bg:"bg-gray-100",mobileButton:"md:hidden bg-white inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-300",menuBg:"bg-gray-200",menuBgHover:"hover:bg-gray-300",menuBgActive:"bg-teal-200",menuBgActiveHover:"hover:bg-teal-300",menuText:"text-gray-500",menuTextHover:"hover:text-gray-700",menuTextActive:"text-teal-500",menuTextActiveHover:"hover:text-teal-700",topnavWrapper:"w-full bg-gray-100",topnavContent:"flex w-full ",topnavMenu:"hidden md:flex flex-1 h-full overflow-x-auto overflow-y-hidden scrollbar-sm",sidenavWrapper:"bg-gray-100 w-56 border-r border-gray-200 h-screen pt-16 z-50",headerBg:"bg-gray-200",headerBgHover:"hover:bg-gray-400",inputBg:"bg-white disabled:bg-gray-200 cursor-pointer focus:outline-none",inputBorder:"rounded border border-transparent hover:border-gray-300 focus:border-gray-600 disabled:border-gray-200",inputBgDisabled:"bg-gray-200 cursor-not-allowed focus:outline-none",inputBorderDisabled:"rounded border border-gray-200 hover:border-gray-200",inputBgFocus:"bg-white cursor-pointer focus:outline-none",inputBorderFocus:"rounded border border-transparent hover:border-gray-600 focus:border-gray-600 border-gray-600",textBase:"text-base",textSmall:"text-sm",textLarge:"text-lg",paddingBase:"py-1 px-2",paddingSmall:"py-0 px-1",paddingLarge:"py-2 px-4",contentBg:"bg-white",contentWidth:"max-w-7xl mx-auto",accent1:"bg-gray-200",accent2:"bg-gray-300",accent3:"bg-gray-400",accent4:"bg-gray-500",highlight1:"bg-teal-200",highlight2:"bg-teal-300",highlight3:"bg-teal-400",highlight4:"bg-teal-500",sidebarW:"56",transition:"transition ease-in-out duration-150",button:`
		inline-flex items-center
		px-4 py-2 border border-gray-300
		text-sm leading-5 font-medium
		rounded-md text-gray-700 bg-white
		hover:text-gray-500
		focus:outline-none focus:shadow-outline-blue focus:border-blue-300
		active:text-gray-800 active:bg-gray-50 transition duration-150 ease-in-out
		disabled:cursor-not-allowed`,buttonPrimary:"inline-flex items-center px-4 py-2 border border-transparent text-sm leading-5 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 focus:outline-none focus:shadow-outline-indigo focus:border-indigo-700 active:bg-indigo-700 transition duration-150 ease-in-out disabled:cursor-not-allowed",tableRow:"bg-gray-100 hover:bg-gray-200 transition ease-in-out duration-150",tableRowStriped:"bg-gray-100 even:bg-gray-200 hover:bg-gray-300 transition ease-in-out duration-150",tableCell:"px-4 py-1 whitespace-no-wrap",tableHeader:"px-4 py-2 pb-1 border-b-2 border-gray-300 bg-gray-200 text-left font-medium text-gray-700 uppercase first:rounded-tl-md last:rounded-tr-md"},z1=xo(F1),P1={text:"text-gray-800",textContrast:"text-white",border:"border-gray-400",ySpace:"",textInfo:"text-teal-400",bgInfo:"bg-teal-400",borderInfo:"border-teal-400",textSuccess:"text-green-400",bgSuccess:"bg-green-400",borderSuccess:"border-green-400",textPrimary:"text-blue-400",bgPrimary:"bg-blue-400",borderPrimary:"border-blue-400",textDanger:"text-red-400",bgDanger:"bg-red-400",borderDanger:"border-red-400",textWarning:"text-yellow-400",bgWarning:"bg-yellow-400",borderWarning:"border-yellow-400",textLight:"text-gray-400",placeholder:"placeholder-gray-400",menuIcon:"mr-3 h-6 w-6",topMenuBorder:"border-b border-gray-200",headerShadow:"",bg:"bg-gray-100",menuBg:"bg-gray-200",menuBgHover:"hover:bg-gray-300",menuBgActive:"bg-teal-200",menuBgActiveHover:"hover:bg-teal-300",menuText:"text-gray-500",menuTextHover:"hover:text-gray-700",menuTextActive:"text-teal-500",menuTextActiveHover:"hover:text-teal-700",menuOpenIcon:"fas fa-bars",menuCloseIcon:"fas fa-times",topnavWrapper:"w-full bg-gray-200 h-16",topnavContent:"flex w-full max-w-7xl mx-auto h-full",topnavMenu:"hidden md:flex flex-1 h-full overflow-x-auto overflow-y-hidden scrollbar-sm",sidenavWrapper:"bg-gray-200 w-56 border-r border-gray-200 h-screen pt-16 z-50",topmenuRightNavContainer:"h-full",mobileButton:"md:hidden bg-white inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-300",sidebarBg:"bg-gray-200",sidebarBorder:"",sidebarW:"56",headerBg:"bg-gray-200",headerBgHover:"hover:bg-gray-400",inputBg:"bg-white disabled:bg-gray-200 cursor-pointer focus:outline-none",inputBorder:"rounded border border-transparent hover:border-gray-300 focus:border-gray-600 disabled:border-gray-200",inputBgDisabled:"bg-gray-200 cursor-not-allowed focus:outline-none",inputBorderDisabled:"rounded border border-gray-200 hover:border-gray-200",inputBgFocus:"bg-white cursor-pointer focus:outline-none",inputBorderFocus:"rounded border border-transparent hover:border-gray-600 focus:border-gray-600 border-gray-600",booleanInputSlider:"bg-gray-300",textBase:"text-base",textSmall:"text-sm",textLarge:"text-lg",paddingBase:"py-1 px-2",paddingSmall:"py-0 px-1",paddingLarge:"py-2 px-4",accent1:"bg-gray-200",accent2:"bg-gray-300",accent3:"bg-gray-400",accent4:"bg-gray-500",highlight1:"bg-teal-200",highlight2:"bg-teal-300",highlight3:"bg-teal-400",highlight4:"bg-teal-500",contentBg:"bg-white",contentWidth:"w-full max-w-7xl mx-auto",contentPadding:"py-4",transition:"transition ease-in-out duration-150",tableInfoBar:"bg-white",tableRow:"bg-white hover:bg-gray-200 @transition",tableRowStriped:"bg-white even:bg-gray-100 hover:bg-gray-200 @transition",tableCell:"px-4 py-1 whitespace-no-wrap",tableHeader:"px-4 py-2 pb-1 border-b-2 border-gray-300 bg-gray-200 text-left font-medium text-gray-700 uppercase first:rounded-tl-md last:rounded-tr-md",$compositions:T1};_1(P1);const ho=C.createContext(z1),De=()=>b.useContext(ho),Lr=t=>zg((n,r)=>({user:n.user}),null)(t);Lr(({title:t,LeftComponent:s=null,children:n,RightComponent:r=null,shadowed:a=!1,user:l,userMenu:i=!1,className:c="",customTheme:d={},toggle:u=()=>{},open:m})=>{const p={...De(),...d},{TopUserMenu:x}=go(),h=t||s,f=n||r,g=p.topNavHeight;return e.jsxs("div",{className:`w-full relative flex items-center justify-end ${p.headerBg} ${c} h-${g}`,style:a?{boxShadow:"0px 6px 3px -3px rgba(0, 0, 0, 0.25)"}:null,children:[e.jsx("div",{className:`inset-0 z-0 text-3xl font-bold flex-1 items-center h-${g} flex-grow`,children:typeof h=="function"?C.createElement(h):h}),e.jsxs("div",{className:"flex flex-0 items-center relative z-10 pr-8 w-48 flex-shrink",children:[e.jsx("div",{className:"hidden xl:block",children:f}),!l||!i?null:e.jsx("div",{className:"ml-8",children:e.jsx(x,{})}),e.jsx("button",{className:`block xl:hidden fas ${m?"fa-times":"fa-bars"} float-right ${p.textContrast}`,onClick:u})]})]})});const or={};for(const t in ls.schemeGroups)ls.schemeGroups[t].forEach(s=>{const n=ls[s];for(const r in n)r in or||(or[r]=[]),or[r].push({type:`${t[0].toUpperCase()}${t.slice(1)}`,name:s,category:"Colorbrewer",colors:n[r]})});const fp=(t,s,n=!1)=>{let r=I(or,[t],[]).reduce((a,l)=>l.name===s?l.colors:a,[]).slice();return n&&r.reverse(),r},gp=({colors:t,size:s=3})=>e.jsx("div",{className:"flex",children:t.map((n,r)=>e.jsx("div",{style:{backgroundColor:n,transition:"background-color 0.5s"},className:`flex-1 h-${s}`},r))}),bp=({...t})=>Object.keys(t).reduce((s,n)=>(t[n]&&s.push(n.split("").map((r,a)=>a===0?r.toUpperCase():r).join("")),s),[]).join(""),R1=(...t)=>C.useCallback(s=>{[...t].forEach(n=>{n&&(typeof n=="function"?n(s):n.current=s)})},[t]),yp=t=>{const[s,n]=b.useState(null);return b.useEffect(()=>{const r=a=>{s.contains(a.target)||typeof t=="function"&&t(a)};return s&&document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[s,t]),[n,s]};function Fl(){for(var t={}.hasOwnProperty,s=[],n=0;n<arguments.length;n++){var r=arguments[n];if(r){var a=typeof r;if(a==="string"||a==="number")s.push(r);else if(Array.isArray(r)){if(r.length){var l=Fl.apply(null,r);l&&s.push(l)}}else if(a==="object"){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){s.push(r.toString());continue}for(var i in r)t.call(r,i)&&r[i]&&s.push(i)}}}return s.join(" ")}const qc=({icon:t,className:s})=>e.jsx("div",{className:`${s} flex justify-center items-center`,children:e.jsx("span",{className:t})}),fo=({i:t=0,children:s,icon:n,to:r,onClick:a,className:l=null,type:i="side",active:c=!1,subMenus:d=[],themeOptions:u,subMenuActivate:m="onClick",subMenuOpen:p=!1})=>{const x=De()[i==="side"?"sidenav":"topnav"](u),h=Le(),f=C.useMemo(()=>Array.isArray(r)?r:[r],[r]),g=C.useMemo(()=>{const M=d.reduce((_,L)=>(Array.isArray(L.path)?_.push(...L.path):L.path&&_.push(L.path),_),[]);return[...f,...M]},[f,d]),y=!!_r({path:`${g[0]}/*`||"",end:!0}),v=i==="side"?x.navitemSide:x.navitemTop,j=i==="side"?x.navitemSideActive:x.navitemTopActive,N=y||c,S=N?j:v,[w,k]=C.useState(p||y),[$,E]=C.useState(!1);return b.useEffect(()=>{k(y)},[y,w,r]),e.jsx("div",{className:i==="side"?x.subMenuParentWrapper:null,onMouseOutCapture:()=>m==="onHover"&&k(!1)||m!=="onHover"&&E(!1)&&k(!1),onMouseMove:()=>m==="onHover"&&k(!0)||m!=="onHover"&&E(!0)&&k(!0),children:e.jsx("div",{className:`${l||S}`,onClick:M=>{if(M.stopPropagation(),a)return a(f[0]);f[0]&&h(f[0])},children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex-1 flex",children:[n?e.jsx(qc,{icon:n,className:i==="side"?N?x.menuIconSideActive:x.menuIconSide:N?x.menuIconTopActive:x.menuIconTop}):null,e.jsx("div",{className:x.navItemContent,children:s})]}),e.jsx("div",{onClick:()=>{m==="onClick"&&k(!w)},children:d.length?e.jsx(qc,{icon:w?x.indicatorIconOpen:x.indicatorIcon}):null}),d.length?e.jsx(H1,{i:t,showSubMenu:w,subMenuActivate:m,active:y,hovering:$,subMenus:d,type:i,themeOptions:u,className:l}):""]})})})},H1=({i:t,showSubMenu:s,subMenus:n,type:r,hovering:a,subMenuActivate:l,active:i,themeOptions:c})=>{const d=De()[r==="side"?"sidenav":"topnav"](c),u=!i&&l!=="onHover"&&a;return(!s||!n.length)&&!u?null:e.jsx("div",{className:r==="side"?d.subMenuWrapper:u&&t===0?d.subMenuWrapperInactiveFlyout:u&&t>0?d.subMenuWrapperInactiveFlyoutBelow:d.subMenuWrapperTop,children:e.jsx("div",{className:`
							${u&&d.subMenuWrapperInactiveFlyoutDirection}
							${!u&&d.subMenuWrapperChild}
					flex ${r==="side"||u?"flex-col":"flex-row"}
				`,children:n.map((m,p)=>e.jsx(fo,{i:p+1,to:m.path,icon:m.icon,type:r,className:m.className,onClick:m.onClick,themeOptions:c,subMenus:m.subMenus,children:m.name},p))})})},W1=t=>{const[s,n]=C.useState(null);return C.useEffect(()=>{const r=a=>{s.contains(a.target)||typeof t=="function"&&t(a)};return s&&document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[s,t]),[n,s]},Li=({control:t,children:s,className:n,openType:r="hover"})=>{const[a,l]=C.useState(!1),i=C.useCallback(()=>l(!1),[]),[c]=W1(i);return e.jsxs("div",{ref:c,className:`h-full relative cursor-pointer ${n}`,onMouseEnter:d=>{r==="hover"&&l(!0)},onMouseLeave:d=>l(!1),onClick:d=>{l(!a)},children:[t,a?e.jsx("div",{className:`shadow fixed w-full max-w-[200px] rounded-b-lg ${a?"block":"hidden"} z-10`,children:s}):""]})},vp=({color:t})=>e.jsxs("svg",{width:"100",height:"100",children:[e.jsx("path",{fill:t,d:`M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3
		c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z`,children:e.jsx("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})}),e.jsx("path",{fill:t,d:`M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7
		c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z`,children:e.jsx("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1s",from:"0 50 50",to:"-360 50 50",repeatCount:"indefinite"})}),e.jsx("path",{fill:t,d:`M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5
		L82,35.7z`,children:e.jsx("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1.5s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})})]}),V1=({width:t="100vw",height:s="100vh",color:n="#005bcc"})=>e.jsx("div",{style:{width:t,height:s,display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(vp,{color:n})}),wp=({scale:t=1,color:s="#005bcc"})=>{const n=100*t;return e.jsx("div",{style:{position:"relative",width:`${n}px`,height:`${n}px`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{style:{display:"flex",transform:`scale(${t}, ${t})`,width:"100px",height:"100px"},children:e.jsx(vp,{color:s})})})},U1=(t={})=>{const{color:s="white",size:n="base",width:r="block"}=t;let a={white:`
            border border-gray-300  text-gray-700 bg-white hover:text-gray-500
            focus:outline-none focus:shadow-outline-blue focus:border-blue-300
            active:text-gray-800 active:bg-gray-50 transition duration-150 ease-in-out
            disabled:cursor-not-allowed
        `,cancel:`
            text-red-700 bg-white hover:text-red-500
            focus:outline-none focus:shadow-outline-blue focus:border-blue-300
            active:text-red-800 active:bg-gray-50 transition duration-150 ease-in-out
            disabled:cursor-not-allowed
        `,transparent:`
            border border-gray-300  text-gray-700 bg-white hover:text-gray-500
            focus:outline-none focus:shadow-outline-blue focus:border-blue-300
            active:text-gray-800 active:bg-gray-50 hover:bg-gray-100 hover:text-gray-900
            transition duration-150 ease-in-out
            disabled:cursor-not-allowed
        `,primary:`
            border border-transparent shadow
            text-sm leading-4 text-white bg-blue-600 hover:bg-blue-700
            focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,danger:`
          border border-red-300 text-white bg-red-500 
          focus:outline-none focus:shadow-outline-blue focus:border-blue-300
          active:bg-red-600 hover:bg-red-700 transition duration-150 ease-in-out
          disabled:cursor-not-allowed
        `},l={base:"px-4 py-4 leading-5 font-medium",xs:"text-xs px-1 py-0.5 leading-5 font-thin rounded-sm",sm:"text-sm px-2 py-2 leading-5 font-medium rounded-md",lg:"text-lg px-6 py-6 leading-5 font-medium rounded-md",xl:"text-2xl px-12 py-8 leading-5 font-medium rounded-lg"},i={block:"",full:"w-full"};return{button:`
          ${a[s]} ${l[n]} ${i[r]}
        `,vars:{color:a,size:l,width:i}}},q1=({onClick:t,children:s,confirmMessage:n,type:r,...a})=>{const[l,i]=C.useState(!1),c=C.useRef(null),d=C.useCallback(m=>{m.preventDefault(),i(!0),c.current=setTimeout(i,5e3,!1)},[c]),u=C.useCallback(m=>{i(!1),t&&t(m)},[t]);return C.useEffect(()=>()=>clearTimeout(c.current),[c]),e.jsx("button",{onClick:l?r==="submit"?null:u:d,...a,type:l?r:"button",children:e.jsxs("div",{className:"relative w-full",children:[l?e.jsx("div",{className:"absolute top-0 left-0 right-0 bottom-0 flex items-center overflow-hidden",children:e.jsx("div",{children:n})}):null,e.jsx("div",{style:{color:l?"transparent":null},children:s})]})})},$e=({children:t,type:s="button",className:n="",showConfirm:r=!1,confirmMessage:a="click to confirm",themeOptions:l={},...i})=>{const c=U1(l);return r?e.jsx(q1,{type:s,...i,confirmMessage:a,className:`${c.button} ${n}`,children:t}):e.jsx("button",{type:s,...i,className:`${c.button} ${n}`,children:t})},Bs=t=>t==null||t===!1||typeof t=="string"&&!t.length?!1:Array.isArray(t)?t.reduce((s,n)=>s||Bs(n),!1):typeof t=="number"&&isNaN(t)?!1:typeof t=="object"?Object.values(t).reduce((s,n)=>s||Bs(n),!1):!0,Ns=C.forwardRef(({large:t,small:s,className:n=null,onChange:r,value:a,showClear:l=!1,placeholder:i="type a value...",themeOptions:c={color:"white",size:"small",width:"block"},...d},u)=>{const m=De().input(c).input,p=C.useCallback(x=>{x.stopPropagation(),r(x.target.value,x)},[r]);return l?e.jsxs(e.Fragment,{children:[e.jsx("input",{...d,ref:u,onChange:p,value:Bs(a)?a:"",className:`${n||m} `,placeholder:i}),Bs(a)?e.jsx("div",{className:`absolute right-0 ${s?"mr-1":"mr-2"} top-0 bottom-0 flex items-center`,children:e.jsx("div",{className:`
                ${m.menuBgActive} ${m.menuBgActiveHover} ${m.textContrast}
                p-1 flex justify-center items-center rounded cursor-pointer
              `,onClick:()=>r(""),children:e.jsxs("svg",{width:"8",height:"8",children:[e.jsx("line",{x2:"8",y2:"8",style:{stroke:"currentColor",strokeWidth:2}}),e.jsx("line",{y1:"8",x2:"8",style:{stroke:"currentColor",strokeWidth:2}})]})})}):null]}):e.jsx("input",{...d,ref:u,onChange:p,value:Bs(a)?a:"",className:`${n||m} `,placeholder:i})});C.forwardRef(({large:t,small:s,className:n="",children:r,onChange:a,value:l,...i},c)=>{const d=De(),u=d[`input${bp({large:t,small:s})}`];return e.jsx("textarea",{...i,onChange:m=>a(m.target.value),value:l||"",className:`${u()} ${n}`,ref:c,rows:6,children:r})});C.forwardRef(({children:t,hasFocus:s,large:n,small:r,disabled:a=!1,customTheme:l,className:i="",...c},d)=>{const u={...De(),...l};return e.jsx("div",{...c,ref:d,className:`
        w-full flex flex-row flex-wrap
        ${a?`${u.inputBgDisabled} ${u.inputBorderDisabled}`:s?`${u.inputBgFocus} ${u.inputBorderFocus}`:`${u.inputBg} ${u.inputBorder}`}
        ${n?"pt-1 pb-2 px-4":r?"pb-1 px-1":"pb-1 px-2"}
        ${n?u.textLarge:r?u.textSmall:u.textBase}
        ${i}
      `,children:t})});const Gc=({isPlaceholder:t,children:s,remove:n,edit:r,disabled:a=!1,themeOptions:l})=>{const i=De().select(l);return e.jsxs("div",{className:`
        ${t?i.textLight:`${a?i.accent2:n||r?i.menuBgActive:""}
            mr-1 pl-2 ${!a&&(n||r)?"pr-1":"pr-4"}
          `}
        ${i.itemText}
         flex items-center max-w-full
      `,children:[e.jsx("span",{className:i.valueItem,children:s}),t||a||!r?null:e.jsx("div",{className:`
            ${i.menuBgActive} ${i.menuBgActiveHover} ${i.textContrast}
            ml-2 p-1 flex justify-center items-center rounded cursor-pointer
          `,onClick:r,children:e.jsxs("svg",{width:"8",height:"8",children:[e.jsx("line",{x1:"0",y1:"6",x2:"4",y2:"2",style:{stroke:"currentColor",strokeWidth:2}}),e.jsx("line",{x1:"4",y1:"2",x2:"8",y2:"6",style:{stroke:"currentColor",strokeWidth:2}})]})}),t||a||!n?null:e.jsx("div",{className:`
            ${i.menuBgActive} ${i.menuBgActiveHover} ${i.textContrast}
            ${r?"ml-1":"ml-2"} p-1 flex justify-center items-center rounded cursor-pointer
          `,onClick:n,children:e.jsxs("svg",{width:"8",height:"8",children:[e.jsx("line",{x2:"8",y2:"8",style:{stroke:"currentColor",strokeWidth:2}}),e.jsx("line",{y1:"8",x2:"8",style:{stroke:"currentColor",strokeWidth:2}})]})})]})},G1=C.forwardRef(({children:t,searchable:s,opened:n,direction:r,themeOptions:a={}},l)=>{const i=De().select(a);return e.jsx("div",{className:`
      absolute left-0 z-40 overflow-hidden min-w-full
      ${n?"block":"hidden"}
    `,style:r==="down"?{top:"100%"}:{bottom:"100%"},ref:l,children:e.jsx("div",{className:`${i.menuWrapper}`,children:t})})}),Zo=t=>t,zl=t=>{const{multi:s=!1,searchable:n=!1,domain:r=[],options:a=[],value:l=null,placeholder:i="Select a value...",accessor:c=Zo,listAccessor:d=null,autoFocus:u=!1,disabled:m=!1,removable:p=!1,themeOptions:x={},onChange:h=Zo,valueAccessor:f=Zo,className:g=""}=t,y=De().select(x),v=C.useRef(),j=C.useRef(),N=C.useRef(),S=C.useRef([]),[w,k]=b.useState(!1),[$,E]=b.useState("down"),[,M]=b.useState(!1),[_,L]=b.useState(""),D=q=>{q.stopPropagation(),k(!0),M(!0)},A=q=>{w&&j&&j.current.focus(),k(!1)},T=()=>{j&&j.focus()};b.useEffect(()=>{u&&T()},[u]),b.useEffect(()=>{const q=Y=>{w&&j&&j.current.focus(),k(!1)},Q=Y=>{v&&v.current&&v.current.contains(Y.target)||q()};if(document.addEventListener("mousedown",Q),N&&N.current&&w&&$==="down"){const Y=N.current.getBoundingClientRect();Y.top+Y.height>window.innerHeight&&E("up")}return()=>{document.removeEventListener("mousedown",Q)}},[$,w]);const O=()=>{let q=[];return Bs(l)?(Array.isArray(l)?q=l:q=[l],z().filter(Q=>q.reduce((Y,H)=>Y||Ae(f(Q),H),!1))):[]},B=(q,Q)=>{q.stopPropagation(),A(),Q=f(Q),s?Bs(l)?l.reduce((Y,H)=>Y&&!Ae(H,Q),!0)&&h([...l,Q]):h([Q]):h(Q)},F=(q,Q)=>{q.stopPropagation(),Q=f(Q),h(s?l.filter(Y=>!Ae(Y,Q)):null)},z=()=>a.length?a:r;let P=b.useCallback(q=>{switch(q.key){case"Space":case"Enter":case"ArrowDown":q.preventDefault(),w||k(!0),S[0]&&S[0].current&&S[0].current.focus();break;case"ArrowUp":q.preventDefault(),w||k(!0),S[0]&&S[0].current&&S[0].current.focus();break;case"Escape":q.preventDefault(),q.stopPropagation(),w&&k(!1);break}},[w]);const U=O(),R=z();let W=R.filter(q=>U.includes(q));const V=d||c,X=_?gi(R,_,{keys:[V]}):R;return e.jsxs("div",{ref:v,onMouseLeave:q=>A(),children:[e.jsx("div",{className:"cursor-pointer",children:e.jsxs("div",{id:t.id,ref:j,onBlur:q=>M(!1),onFocus:q=>M(!0),onKeyDown:P,disabled:m,tabIndex:m?-1:0,onClick:D,className:`${y.select} ${g}`,children:[e.jsx("div",{className:"w-11/12 overflow-x-hidden",children:U.length?U.map((q,Q,Y)=>e.jsx(Gc,{disabled:m,themeOptions:x,remove:p?H=>F(H,q):null,children:c(q,Y)},Q)):e.jsx(Gc,{isPlaceholder:!0,themeOptions:x,children:i},"placeholder")}),e.jsx("div",{className:`${y.selectIcon}`})]})}),e.jsx("div",{className:"relative",children:m||!w?null:e.jsxs(G1,{opened:w,direction:$,searchable:n,ref:N,themeOptions:x,children:[n?e.jsx("div",{className:"p-2 pt-1 w-full",children:e.jsx(Ns,{type:"text",autoFocus:!0,placeholder:"search...",className:"w-full",value:_,onChange:q=>L(q)})}):null,X.length?e.jsx("div",{className:"scrollbar overflow-y-auto",style:{maxHeight:"15rem"},children:X.map((q,Q)=>e.jsx("div",{ref:Y=>S.current.push(Y),onClick:W.includes(q)?Y=>Y.stopPropagation():Y=>B(Y,q),className:`${W.includes(q)?`${y.menuItemActive}`:`${y.menuItem}`}`,children:I(q,"OptionComponent")?e.jsx(q.OptionComponent,{option:q}):V(q)},`${c(q)}-${Q}`))}):e.jsx("div",{className:"p-1 text-center",children:"No Selections"})]})})]})};C.forwardRef(({large:t,small:s,className:n="",labels:r=["False","True"],value:a,onChange:l,disabled:i=!1,autoFocus:c=!1,...d},u)=>{const[m,p]=C.useState(!1),[x,h]=C.useState(null);C.useEffect(()=>{x&&c&&x.focus()},[c,x]);const f=De();return e.jsx("div",{...d,onClick:i?null:g=>l(!a),onFocus:g=>p(!i),onBlur:g=>p(!1),className:`
        ${t?`${f.paddingLarge} ${f.textLarge}`:s?`${f.paddingSmall} ${f.textSmall}`:`${f.paddingBase} ${f.textBase}`}
        ${i?`${f.inputBgDisabled} ${f.inputBorderDisabled}`:m?`${f.inputBgFocus} ${f.inputBorderFocus}`:`${f.inputBg} ${f.inputBorder}`}
        ${n}
      `,ref:R1(u,h),tabIndex:i?"-1":"0",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-0",children:e.jsx(J1,{value:a})}),e.jsx("div",{className:"flex-1 ml-4",children:r[+!!a]})]})})});const J1=({value:t})=>{const s=De();return e.jsx("div",{className:"px-1 h-full flex justify-center items-center",children:e.jsxs("div",{className:"relative h-3",children:[e.jsxs("div",{className:"relative w-10 h-3 rounded-lg overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 w-20 h-full ${s.accent4}`,style:{left:t?"100%":"0",transition:"left 0.25s"}}),e.jsx("div",{className:`absolute top-0 w-20 h-full ${s.bgInfo}`,style:{right:t?"0":"100%",transition:"right 0.25s"}})]}),e.jsx("div",{className:`absolute h-4 w-4 rounded-lg ${s.booleanInputSlider||s.accent2}`,style:{top:"50%",left:t?"calc(100% - 0.625rem)":"-0.125rem",transform:"translateY(-50%)",transition:"left 0.25s"}})]})})};let X1=-1;const Jc=()=>`input-id-${++X1}`,Z1=C.memo(({small:t=!1,large:s=!1})=>{const n=De();return e.jsx("div",{className:`
        ${t?"h-3 mt-1 w-1":s?"h-9 mt-3 w-3":"h-6 mt-2 w-2"}
        rounded pointer-events-none ${n.accent3}
      `,style:{transform:"translate(-50%, -50%)"}})}),Y1=({showPreview:t=!0,showInputs:s=!0,showLabels:n=!0,showHex:r=!0,showRgb:a=!0,small:l=!1,large:i=!1,disabled:c=!1,autoFocus:d=!1,...u})=>{const[m,p]=C.useState(),x=C.useRef(Jc()),h=C.useRef(Jc());C.useEffect(()=>{m&&d&&m.focus()},[m,d]);const f=De(),g=f[`input${bp({large:i,small:l})}`];return e.jsx("div",{tabIndex:c?-1:0,ref:p,className:`
        ${g} w-full h-full
      `,children:e.jsxs("div",{className:`
          grid
          ${l?"gap-y-1 py-1":i?"gap-y-4 py-2":"gap-y-2 py-1"}
        `,style:{gridTemplateRows:`auto auto${s?" auto":""}`},children:[e.jsxs("div",{className:`
            grid grid-cols-12
            ${l?"gap-x-1":i?"gap-x-4":"gap-x-2"}
          `,style:{height:i?"20rem":l?"10rem":"15rem"},children:[e.jsx("div",{className:`
              relative h-full cursor-pointer
              ${t?"col-span-9":"col-span-12"}
            `,children:e.jsx(Ec.Saturation,{...u,style:{pointer:{pointerEvents:"none"}}})}),t?e.jsx("div",{className:"col-span-3 h-full rounded",style:{backgroundColor:u.hex}}):null]}),e.jsx("div",{className:`
            rounded cursor-pointer relative
            ${l?"h-2":i?"h-6":"h-4"}
          `,children:e.jsx(Ec.Hue,{...u,direction:"horizontal",pointer:()=>e.jsx(Z1,{small:l,large:i})})}),s?e.jsxs("div",{className:`
              grid grid-cols-${!!r+!!a}
              ${l?"gap-x-1":i?"gap-x-4":"gap-x-2"}
            `,children:[r?e.jsx("div",{className:n?`${f.accent1} rounded
                  ${n?l?"px-1 pt-1 pb-0":i?"px-4 pt-4 pb-3":"px-2 pt-2 pb-1":""}
                `:null,children:e.jsx(ey,{id:x.current,...u,value:u.hex,small:l,large:i,showLabels:n})}):null,a?e.jsx("div",{className:n?`${f.accent1} rounded
                  ${n?l?"px-1 pt-1 pb-0":i?"px-4 pt-4 pb-3":"px-2 pt-2 pb-1":""}
                `:null,children:e.jsx(ny,{id:h.current,...u,value:u.rgb,small:l,large:i,showLabels:n})}):null]}):null]})})};Pg(Y1);const Q1=t=>({value:t.toUpperCase(),blurValue:t.toUpperCase()}),K1=(t,s)=>{const{type:n,...r}=s;switch(n){case"update-state":return{...t,...r};default:return t}},fa=C.forwardRef(({id:t,label:s,showLabels:n,...r},a)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Ns,{id:t,ref:a,...r}),n?e.jsx("label",{htmlFor:t,className:`
            font-bold
            ${r.small?"text-sm":r.large?"text-lg":"text-base"}
          `,children:s}):null]})),ey=({id:t,value:s,onChange:n,small:r=!1,large:a=!1,showLabels:l=!0})=>{const[i,c]=C.useReducer(K1,s,Q1),d=C.useRef(null),u=C.useRef(null),m=C.useRef(null);C.useEffect(()=>{s!==i.value&&(m.current!==s||u.current!==i.value)&&(d.current===document.activeElement?c({type:"update-state",blurValue:s.toUpperCase()}):c({type:"update-state",value:s.toUpperCase(),blurValue:!i.blurValue&&s.toUpperCase()})),u.current=i.value,m.current=s},[s,i]);const p=C.useCallback(h=>{c({type:"update-state",value:h}),n(h)},[n]),x=C.useCallback(h=>{i.blurValue&&c({type:"update-state",value:i.blurValue,blurValue:null})},[i]);return e.jsx(fa,{type:"text",id:t,small:r,large:a,ref:d,onChange:p,value:i.value,onBlur:x,showLabels:l,label:"Hex"})},ty=t=>({value:t,blurValue:t}),sy=(t,s)=>{const{type:n,...r}=s;switch(n){case"update-state":return{...t,...r};case"update-value":return{...t,value:{...t.value,...r}};default:return t}},ny=({id:t,value:s,onChange:n,small:r=!1,large:a=!1,showLabels:l=!0})=>{const[i,c]=C.useReducer(sy,s,ty),d=C.useRef(null),u=C.useRef(null),m=C.useRef(null),p=C.useRef(null),x=C.useRef(null);C.useEffect(()=>{!Ae(s,i.value)&&(!Ae(x.current,s)||!Ae(p.current,i.value))&&([d.current,u.current,m.current].includes(document.activeElement)?c({type:"update-state",blurValue:s}):c({type:"update-state",value:s,blurValue:!i.blurValue&&s})),p.current=i.value,x.current=s},[s,i]);const h=C.useCallback((g,y)=>{const v=y.target.name;c({type:"update-value",[v]:g}),n({...s,[v]:g})},[s,n]),f=C.useCallback(g=>{i.blurValue&&c({type:"update-state",value:i.blurValue,blurValue:null})},[i]);return e.jsxs("div",{className:`
      grid grid-cols-3
      ${r?"gap-x-1":a?"gap-x-4":"gap-x-2"}
    `,children:[e.jsx(fa,{type:"number",id:`r-${t}`,name:"r",small:r,large:a,min:0,max:255,ref:d,onChange:h,value:i.value.r,onBlur:f,showLabels:l,label:"Red"}),e.jsx(fa,{type:"number",id:`g-${t}`,name:"g",small:r,large:a,min:0,max:255,ref:u,onChange:h,value:i.value.g,onBlur:f,showLabels:l,label:"Green"}),e.jsx(fa,{type:"number",id:`b-${t}`,name:"b",small:r,large:a,min:0,max:255,ref:m,onChange:h,value:i.value.b,onBlur:f,showLabels:l,label:"Blue"})]})},jp=(t={color:"white",size:"compact"})=>{const{color:s="white",size:n="compact"}=t;let r={white:"bg-white hover:bg-blue-50",gray:"bg-gray-100 hover:bg-gray-200",transparent:"gray-100",total:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold"},a={small:"px-4 py-1 text-xs",compact:"px-4 py-1 text-sm",full:"px-10 py-5"};return{tableHeader:`${a[n]} pb-1 h-8 border border-b-4 border-gray-200 bg-slate-50 text-left font-semibold text-gray-700 uppercase first:rounded-tl-md last:rounded-tr-md`,tableInfoBar:"bg-white",tableRow:`${r[s]} transition ease-in-out duration-150 hover:bg-blue-100`,totalRow:`${r.total} transition ease-in-out duration-150`,tableOpenOutRow:"flex flex-col",tableRowStriped:"bg-white odd:bg-blue-50 hover:bg-blue-100 bg-opacity-25 transition ease-in-out duration-150",tableCell:`${a[n]} break-words border border-gray-200 pl-1 align-top font-light text-sm`,inputSmall:"w-24",sortIconDown:"fas fa-sort-amount-down text-tigGray-300 opacity-75",sortIconUp:"fas fa-sort-amount-up text-tigGray-300 opacity-75",sortIconIdeal:"fa fa-sort-alt text-tigGray-300 opacity-25",infoIcon:"fas fa-info text-sm text-blue-300 hover:text-blue-500",vars:{color:r,size:a}}},ry=({column:t})=>{var i;const{filterValue:s="",setFilter:n,filterPlaceholder:r="Search...",filterClassName:a=""}=t,l=typeof De=="function"&&((i=De())!=null&&i.table)?De().table():jp();return e.jsx("div",{className:"w-3/4",children:e.jsx("input",{className:`${l.inputSmall} ${a}`,value:s,onChange:c=>n(c.target.value),onClick:c=>c.stopPropagation(),placeholder:r})})},ay=({column:{filterValue:t,setFilter:s,preFilteredRows:n,id:r,filterMeta:a,filterDomain:l,onFilterChange:i,customValue:c,filterThemeOptions:d,filterClassName:u,filterMulti:m,filterRemovable:p=!0}})=>{const x=C.useMemo(()=>{const f=new Set;return a||(n.forEach(g=>{f.add(g.values[r])}),[...f.values()])},[a,r,n]).filter(f=>f),h=n.length;return e.jsx("div",{className:"",children:e.jsx(zl,{domain:l||x,value:t||c||[],onChange:f=>{s(f||void 0),i(f||void 0)},placeHolder:`Search ${h} records...`,removable:p,multi:m,themeOptions:d,className:`${u}`})})};function oy(t,s,n){return gi(t,n,{keys:[r=>r.values[s]]})}function ly(t,s,n){return t.filter(r=>{const a=r.values[s];return a!==void 0&&Array.isArray(n)&&n.length?n.includes(a):a!==void 0&&n.length?a===n:!0})}const iy=(t,s)=>{let n=t-2,r=t+2;n<0&&(r+=-n,n=0),r>s&&(n-=r-s,r=s);const a=[];for(let l=Math.max(0,n);l<=Math.min(s,r);++l)a.push(l);return a},cy=({values:t,theme:s})=>e.jsx("div",{className:"flex flex-col divide-y",children:t.map(({key:n,value:r},a)=>e.jsxs("div",{className:"flex-1 p-2",children:[n?e.jsxs("div",{className:"font-semibold",children:[n,":"]}):null,e.jsx("span",{className:!0,children:r})]},n||`key-${a}`))}),dy=({fetchData:t,manualPagination:s,theme:n,pageValue:r,pageCount:a,pageSize:l,pageIndex:i,statePageSize:c,totalRecords:d,rows:u,canNextPage:m,onPageSelect:p,onPrevPage:x,onNextPage:h,previousPage:f,gotoPage:g,nextPage:y})=>a<=1?null:e.jsxs("div",{className:`flex items-center flex-wrap ${n.textInfo}`,children:[e.jsxs("div",{className:"flex-0",children:["Page ",r+1," of ",a,e.jsx("br",{}),"Rows ",r*l+1," -",!t&&!s?Math.min(u.length,i*c+c):Math.min(d,r*l+l)," of ",!t&&!s?u.length:d]}),e.jsxs("div",{className:"flex-1 flex justify-end items-center",children:[e.jsx($e,{disabled:r===0,themeOptions:{size:"sm"},onClick:v=>!t&&!s?g(0):p(0),children:"<<"}),e.jsx($e,{disabled:r===0,themeOptions:{size:"sm"},onClick:v=>!t&&!s?f():x(),children:"<"}),iy(r,a-1).map(v=>{const j=v===r;return e.jsx($e,{themeOptions:{size:"sm",color:j?"primary":"white"},onClick:j?null:N=>!t&&!s?g(v):p(v),children:v+1},v)}),e.jsx($e,{disabled:!t&&!s?!m:r===a-1,themeOptions:{size:"sm"},onClick:v=>!t&&!s?y(0):h(v),children:">"}),e.jsx($e,{disabled:r===a-1,themeOptions:{size:"sm"},onClick:v=>!t&&!s?g(a-1):p(a-1),children:">>"})]})]}),Xc=({row:t,expand:s,visibleColumns:n,ExpandRow:r,theme:a})=>!t.isExpanded||!s.length?null:e.jsx("tr",{className:a.tableRow,children:e.jsx("td",{colSpan:n.length,className:a.tableCell,children:e.jsx(r,{values:s})})}),Zc=({ii:t,cell:s,row:n,columns:r,expand:a,expanded:l,toggleRowExpanded:i,theme:c})=>{const{key:d,...u}=s.getCellProps({style:{minWidth:s.column.minWidth,maxWidth:s.column.maxWidth,width:s.column.width}});return e.jsx("td",{...u,className:`text-${I(r.find(m=>m.Header===s.column.Header),"align")||"center"} ${c.tableCell}`,children:t>0||n.subRows.length===0&&a.length===0?s.render("Cell"):e.jsxs("div",{className:"flex items-center ",children:[e.jsx("div",{onClick:m=>{m.stopPropagation(),m.preventDefault(),Object.keys(l).filter(p=>p!==n.id).forEach(i),n.toggleRowExpanded(!n.isExpanded)},className:`
                          flex item-center justify-center
                          rounded cursor-pointer py-1 px-2
                        h-full hover:text-blue-500
                           ${c.transition}
                        `,children:n.isExpanded?e.jsx("i",{className:"fal fa-chevron-down"}):e.jsx("i",{className:"fal fa-chevron-right"})}),e.jsx("div",{className:"flex-1",children:s.render("Cell")})]})},d??t)},Yc=[],Dn=({columns:t=Yc,data:s=Yc,sortBy:n,sortOrder:r="",initialPageSize:a=10,manualPagination:l,fetchData:i,onPageChange:c,numRecords:d,manualCurrentPage:u,pageSize:m=5,onRowClick:p,onRowEnter:x,onRowLeave:h,ExpandRow:f=cy,disableFilters:g=!1,disableSortBy:y=!1,csvDownload:v=!1,onCsvDownload:j,themeOptions:N={},...S})=>{var re;const[w,k]=C.useState(s||[]),[$,E]=C.useState(d||0),[M,_]=b.useState(u||0),[L,D]=b.useState(0),[A,T]=b.useState(!1),O=typeof De=="function"&&((re=De())!=null&&re.table)?De().table(N):jp(N),B=C.useMemo(()=>({fuzzyText:oy,dropdown:ly}),[]),F=C.useMemo(()=>({dropdown:ay,text:ry}),[]),z=C.useMemo(()=>({Filter:!1}),[]),{getTableProps:P,getTableBodyProps:U,headerGroups:R,page:W,rows:V,preFilteredRows:X,prepareRow:q,canPreviousPage:Q,canNextPage:Y,gotoPage:H,previousPage:J,nextPage:G,pageCount:se,visibleColumns:le,toggleRowExpanded:ce,setPageSize:je,state:{pageSize:Ce,pageIndex:oe,expanded:ve}}=Et.useTable({columns:t,data:w,manualPagination:!!l||!!i,...(!!i||!!l)&&{pageCount:Math.ceil($/m)},defaultColumn:z,filterTypes:B,disableFilters:g,disableSortBy:y,initialState:{pageSize:+m||+a,...n&&{sortBy:[{id:n,desc:r.toLowerCase()==="desc"}]}}},Et.useFilters,Et.useGlobalFilter,Et.useSortBy,Et.useExpanded,Et.usePagination);C.useEffect(()=>{m!==null&&m!==Ce&&je(+m)},[m,Ce,je]),C.useEffect(()=>{i&&(async()=>{T(!0);const{data:xe,length:ke}=await i({currentPage:M,pageSize:m});return{data:xe,length:ke}})().then(xe=>{k((xe==null?void 0:xe.data)||[]),E((xe==null?void 0:xe.length)||0),T(!1)})},[i,m,M]),C.useEffect(()=>{i||k(s)},[s,se,i]),C.useEffect(()=>{!i&&$!==d&&E(d)},[d]),C.useEffect(()=>{D(i||l?M:oe)},[oe,M]);const ae=b.useCallback(()=>{_(ee=>ee+1),c(M+1)},[]),de=b.useCallback(()=>{_(ee=>ee-1),c(M-1)},[]),te=b.useCallback(ee=>{M!==ee&&_(ee),c(ee)},[M]);return!(t.length&&w.length)||!X.length?null:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"overflow-auto scrollbar-sm",children:[A&&e.jsx("div",{className:"z-10 absolute float-center text-center align-middle items-center w-full",style:{backgroundColor:"rgba(255,255,255,0.38)",width:"100%"},children:e.jsx(V1,{width:"100%",height:"100%"})}),v?e.jsx("div",{className:"w-full text-right",children:e.jsxs(gm,{data:w,headers:t.map(ee=>({label:ee.Header,key:ee.accessor})),filename:"data.csv",className:O.downloadWrapper,children:[e.jsx("i",{className:O.downloadIcon||"fa fa-download"})," ",e.jsx("label",{children:"csv"})]})}):null,e.jsxs("table",{...P(),className:"w-full",children:[e.jsx("thead",{children:R.map(ee=>{const{key:xe,...ke}=ee.getHeaderGroupProps();return e.jsx("tr",{...ke,children:ee.headers.map(he=>{const{key:we,...be}=he.getHeaderProps({...he.getSortByToggleProps(),style:{minWidth:he.minWidth,width:he.width,maxWidth:he.maxWidth}});return e.jsx("th",{...be,className:O.tableHeader,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex-1 pr-1",children:he.render("Header")}),e.jsxs(e.Fragment,{children:[he.info&&e.jsx("i",{className:`${O.infoIcon}`,title:he.info}),he.canSort?he.isSorted?he.isSortedDesc?e.jsx("i",{className:`ml-2 pt-1 ${O.sortIconDown}`}):e.jsx("i",{className:`ml-2 pt-1 ${O.sortIconUp}`}):e.jsx("i",{className:`ml-2 pt-1 ${O.sortIconIdeal}`}):null]})]}),e.jsx("div",{children:he.canFilter?e.jsx("div",{children:he.render(F[he.filter]||"Filter")}):null})]})},we)})},xe)})}),e.jsxs("tbody",{...U(),children:[W.filter(ee=>!ee.original.totalRow).map(ee=>{const{onClick:xe,expand:ke=[]}=ee.original;q(ee);const{key:he,...we}=ee.getRowProps();return e.jsxs(C.Fragment,{children:[e.jsx("tr",{...we,onMouseEnter:typeof x=="function"?be=>x(be,ee):null,onMouseLeave:typeof h=="function"?be=>h(be,ee):null,className:`
                                        ${S.striped?O.tableRowStriped:O.tableRow}
                                        ${xe||p?"cursor-pointer":""}
                                    `,onClick:be=>{typeof p=="function"&&p(be,ee),typeof xe=="function"&&xe(be,ee)},children:ee.cells.map((be,Me)=>e.jsx(Zc,{ii:Me,cell:be,row:ee,columns:t,expand:ke,expanded:ve,toggleRowExpanded:ce,theme:O},Me))}),e.jsx(Xc,{row:ee,expand:ke,visibleColumns:le,ExpandRow:f,theme:O})]},he)}),V.filter(ee=>ee.original.totalRow).map(ee=>{const{onClick:xe,expand:ke=[]}=ee.original;q(ee);const{key:he,...we}=ee.getRowProps();return e.jsxs(C.Fragment,{children:[e.jsx("tr",{...we,onMouseEnter:typeof x=="function"?be=>x(be,ee):null,onMouseLeave:typeof h=="function"?be=>h(be,ee):null,className:`
                                        ${O.totalRow}
                                        ${xe||p?"cursor-pointer":""}
                                    `,onClick:be=>{typeof p=="function"&&p(be,ee),typeof xe=="function"&&xe(be,ee)},children:ee.cells.map((be,Me)=>e.jsx(Zc,{ii:Me,cell:be,row:ee,columns:t,expand:ke,expanded:ve,toggleRowExpanded:ce,theme:O},Me))}),e.jsx(Xc,{row:ee,expand:ke,visibleColumns:le,ExpandRow:f,theme:O})]},he)})]})]})]}),e.jsx("div",{className:"w-full p-2",children:e.jsx(dy,{fetchData:i,manualPagination:l,theme:O,pageValue:L,pageCount:se,pageSize:m,pageIndex:oe,statePageSize:Ce,totalRecords:$,rows:V,canNextPage:Y,onPageSelect:te,onPrevPage:de,onNextPage:ae,previousPage:J,gotoPage:H,nextPage:G,onPageChange:c})})]})},Cp=({open:t,toggle:s,menuItems:n=[],rightMenu:r=null,themeOptions:a={}})=>{let l=De().topnav(a);return e.jsxs("div",{className:`${t?"md:hidden":"hidden"} ${l.topnavMobileContainer}`,id:"mobile-menu",children:[e.jsx("div",{className:"",children:n.map((i,c)=>e.jsx(fo,{type:"top",to:i.path,icon:i.icon,themeOptions:a,subMenus:I(i,"subMenus",[]),children:i.name},c))}),e.jsx("div",{className:"",children:r})]})},uy=({open:t,toggle:s,menuItems:n=[],rightMenu:r=null,leftMenu:a=null,subMenuActivate:l,themeOptions:i={}})=>{let c=De().topnav(i);return e.jsx("div",{className:`${c.topnavWrapper}`,children:e.jsxs("div",{className:`${c.topnavContent} justify-between`,children:[e.jsx("div",{children:a}),e.jsx("div",{className:`${c.topnavMenu}`,children:n.map((d,u)=>e.jsx(fo,{type:"top",to:d.path,icon:d.icon,subMenuActivate:l,themeOptions:i,subMenus:I(d,"subMenus",[]),children:d.name},u))}),e.jsxs("div",{className:"flex items-center justify-center h-full",children:[e.jsx("div",{className:`${c.topmenuRightNavContainer}`,children:r}),e.jsxs("button",{type:"button",className:`${c.mobileButton}`,onClick:()=>s(!t),children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("div",{className:"flex justify-center items-center text-2xl",children:e.jsx("span",{className:t?c.menuCloseIcon:c.menuOpenIcon})})]})]})]})})},Ei=({...t})=>{const[s,n]=b.useState(!1);return e.jsxs("nav",{children:[e.jsx(uy,{open:s,toggle:n,...t}),e.jsx(Cp,{open:s,...t})]})},Np=({i:t,item:s,themeOptions:n,subMenuActivate:r})=>e.jsx(fo,{to:s.path,icon:s.icon,className:s.className,onClick:s.onClick,themeOptions:n,subMenuActivate:r,subMenus:I(s,"subMenus",[]),children:s.name},t),my=({open:t,toggle:s,logo:n=null,topMenu:r,menuItems:a=[],bottomMenu:l,themeOptions:i={},subMenuActivate:c,subMenuStyle:d,...u})=>{let m=De().sidenav(i);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden",onClick:()=>s(!t),children:e.jsx("span",{className:t?m.menuIconOpen:m.menuIconClosed})}),e.jsxs("div",{style:{display:t?"block":"none"},className:"md:hidden",children:[e.jsx("div",{className:"fixed inset-0 z-20 transition-opacity ease-linear duration-300",children:e.jsx("div",{className:"absolute inset-0 opacity-75"})}),e.jsx("div",{className:`fixed inset-0 flex z-40 ${m.contentBgAccent}`,children:e.jsxs("div",{className:`flex-1 flex flex-col max-w-xs w-full transform ease-in-out duration-300 ${m.contentBg}`,children:[e.jsx("div",{className:"absolute top-0 right-0 -mr-14 p-1",children:e.jsx("button",{onClick:()=>s(!t),className:"flex items-center justify-center h-12 w-12 rounded-full focus:outline-none focus:bg-gray-600 os-icon os-icon-x"})}),e.jsxs("div",{className:"flex-1 h-0 pt-2 pb-4 overflow-y-auto overflow-x-hidden",children:[e.jsx("div",{className:"px-6 pt-4 pb-8 logo-text gray-900",children:e.jsx(ue,{to:"/",className:`flex-shrink-0 flex items-center ${m.text}`,children:n})}),e.jsx("div",{children:r}),e.jsx("nav",{className:"flex-1",children:a.map((p,x)=>e.jsx("div",{className:p.sectionClass,children:Np({i:x,themeOptions:i,subMenuActivate:c})},x))}),e.jsx("div",{children:l})]})]})})]})]})},py=({menuItems:t=[],logo:s=null,topMenu:n,bottomMenu:r,toggle:a,open:l,mobile:i,themeOptions:c={},subMenuActivate:d,subMenuStyle:u,...m})=>{let p=De().sidenav(c);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`${p.sidenavWrapper}`,children:[n,e.jsx("nav",{className:`${p.itemsWrapper}`,children:t.map((x,h)=>Np({i:h,item:x,themeOptions:c,subMenuActivate:d}))}),r]}),i==="side"?"":e.jsx("div",{className:`${p.topnavWrapper} md:hidden`,children:e.jsxs("div",{className:`${p.topnavContent} justify-between`,children:[e.jsx("div",{children:n}),e.jsxs("div",{className:"flex items-center justify-center h-full",children:[e.jsx("div",{className:`${p.topmenuRightNavContainer}`,children:r}),e.jsxs("button",{type:"button",className:p.mobileButton,onClick:()=>a(!l),children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("div",{className:"flex justify-center items-center text-2xl",children:e.jsx("span",{className:l?p.menuCloseIcon:p.menuOpenIcon})})]})]})]})})]})},xy=t=>{const[s,n]=b.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(py,{...t,open:s,toggle:n}),t.mobile==="side"?e.jsx(my,{open:s,toggle:n,...t}):e.jsx(Cp,{open:s,...t,themeOptions:{}})]})},hy=(t,s=100)=>{let n,r;return()=>{const a=+new Date;!!n&&a<n+s?(clearTimeout(r),r=setTimeout(()=>{n=a,t()},s)):(n=a,t())}};function fy(t,s){return t.length===s.length&&t.every((n,r)=>n===s[r])}class eT extends C.Component{static get propTypes(){return{items:Bt.arrayOf(Bt.string).isRequired,currentClassName:Bt.string.isRequired,scrolledPastClassName:Bt.string,style:Bt.object,componentTag:Bt.oneOfType([Bt.string,Bt.elementType]),offset:Bt.number,rootEl:Bt.string,onUpdate:Bt.func}}static get defaultProps(){return{items:[],currentClassName:"",style:{},componentTag:"ul",offset:1e3,onUpdate(){}}}constructor(s){super(s),this.state={targetItems:[],inViewState:[],isScrolledPast:[]},this._handleSpy=this._handleSpy.bind(this)}_initSpyTarget(s){return s.map(r=>document.getElementById(r))}_fillArray(s,n){let r=[];for(let a=0,l=s.length;a<l;a++)r[a]=n;return r}_isScrolled(){return this._getScrollDimension().scrollTop>0}_getScrollDimension(){const s=document,{rootEl:n}=this.props,r=n?s.querySelector(n).scrollTop:s.documentElement.scrollTop||s.body.parentNode.scrollTop||s.body.scrollTop,a=n?s.querySelector(n).scrollHeight:s.documentElement.scrollHeight||s.body.parentNode.scrollHeight||s.body.scrollHeight;return{scrollTop:r,scrollHeight:a}}_getElemsViewState(s){let n=[],r=[],a=[];const l=s||this.state.targetItems;let i=!1;for(let c=0,d=l.length;c<d;c++){let u=l[c],m=i?!1:this._isInView(u);m?(i=!0,n.push(u)):r.push(u);const p=c===d-1,x=this._isScrolled();this._isAtBottom()&&this._isInView(u)&&!m&&p&&x&&(r.pop(),r.push(...n),n=[u],a=this._fillArray(a,!1),m=!0),a.push(m)}return{inView:n,outView:r,viewStatusList:a,scrolledPast:this.props.scrolledPastClassName&&this._getScrolledPast(a)}}_isInView(s){if(!s)return!1;const{rootEl:n,offset:r}=this.props;let a;n&&(a=document.querySelector(n).getBoundingClientRect());const l=s.getBoundingClientRect(),i=n?a.height:window.innerHeight,{scrollTop:c}=this._getScrollDimension(),d=c+i,u=n?l.top+c-a.top+r:l.top+c+r,m=u+s.offsetHeight;return u<d&&m>c}_isAtBottom(){const{rootEl:s}=this.props,{scrollTop:n,scrollHeight:r}=this._getScrollDimension(),a=s?document.querySelector(s).getBoundingClientRect().height:window.innerHeight;return n+a>=r}_getScrolledPast(s){if(!s.some(a=>a))return s;let n=!1;return s.map(a=>a&&!n?(n=!0,!1):!n)}_spy(s){const n=this._getElemsViewState(s),r=this.state.inViewState;this.setState({inViewState:n.viewStatusList,isScrolledPast:n.scrolledPast},()=>{this._update(r)})}_update(s){fy(this.state.inViewState,s)||this.props.onUpdate(this.state.targetItems[this.state.inViewState.indexOf(!0)])}_handleSpy(){hy(this._spy(),100)}_initFromProps(){const s=this._initSpyTarget(this.props.items);this.setState({targetItems:s}),this._spy(s)}offEvent(){(this.props.rootEl?document.querySelector(this.props.rootEl):window).removeEventListener("scroll",this._handleSpy)}onEvent(){(this.props.rootEl?document.querySelector(this.props.rootEl):window).addEventListener("scroll",this._handleSpy)}componentDidMount(){this._initFromProps(),this.onEvent()}componentWillUnmount(){this.offEvent()}UNSAFE_componentWillReceiveProps(){this._initFromProps()}render(){const s=this.props.componentTag,{children:n,className:r,scrolledPastClassName:a,style:l}=this.props;let i=0;const c=C.Children.map(n,(u,m)=>{if(!u)return null;const p=u.type,x=a&&this.state.isScrolledPast[m],h=Fl({[`${u.props.className}`]:u.props.className,[`${this.props.currentClassName}`]:this.state.inViewState[m],[`${this.props.scrolledPastClassName}`]:x});return b.createElement(p,{...u.props,className:h,key:i++},u.props.children)}),d=Fl({[`${r}`]:r});return e.jsx(s,{className:d,style:l,children:c})}}const kp=({children:t,open:s,themeOptions:n})=>{const r=De().modal(n);return e.jsxs("div",{style:{display:s?"flex":"none"},className:`${r.modalContainer} `,children:[e.jsx("div",{className:`${r.modalOverlay}`}),e.jsx("div",{className:`${r.modal}`,children:t})]})},gy=({open:t=!1,className:s="",style:n={},...r})=>{const a=De();return e.jsx("div",{...r,className:`
        flex items-center rounded cursor-pointer ${a.textInfo}
        ${t?a.borderInfo:"border-transparent"}
        hover:${a.borderInfo} ${a.transition}
        flex items-center justify-center ${s}
      `,style:{width:"2.5rem",height:"2.5rem",borderRadius:"1.25rem",fontSize:"1.15rem",borderWidth:"3px",...n},children:e.jsx("span",{className:"fas fa-user"})})},by=Lr(({user:t})=>{const[s,n]=C.useState(!1),r=C.useCallback(u=>{n(m=>!m)},[]),a=C.useCallback(()=>n(!1),[]),[l]=yp(a),i=De(),{UserMenuItems:c,TopUserMenuControl:d}=go();return t?t.authed?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx(d,{open:s,onClick:r}),s?e.jsx("div",{className:`
              ${i.menuBg} ${i.menuText}
              p-2 right-0 absolute
            `,style:{top:"100%",minWidth:"8rem"},children:e.jsx(c,{toggle:r})}):null]}):e.jsx(ue,{to:"/auth/login",children:e.jsx(d,{})}):null}),yy=({open:t=!1,label:s="",className:n="",style:r=null,...a})=>{const l=De();return e.jsxs("div",{...a,className:`
        w-full py-1 pl-4 transition cursor-pointer
        ${l.menuBgHover} ${l.menuTextHover} ${n}
      `,style:r,children:[e.jsx("span",{className:"fas fa-user mr-2"}),s]})},vy=Lr(({user:t})=>{const[s,n]=C.useState(!1),r=C.useCallback(()=>{n(u=>!u)},[]),a=C.useCallback(()=>n(!1),[]),[l]=yp(a),i=De(),{SideUserMenuControl:c,UserMenuItems:d}=go();return t?e.jsx("div",{className:"pb-6",children:t.authed?e.jsxs("div",{className:"relative",ref:l,children:[e.jsx(c,{label:"User Menu",open:s,onClick:r}),s?e.jsx("div",{className:`
                  ${i.menuBg} ${i.menuText} mt-1 p-2 left-0 absolute
                `,style:{bottom:"100%",minWidth:"8rem"},children:e.jsx(d,{toggle:r})}):null]}):e.jsx(ue,{to:"/auth/login",children:e.jsx(c,{label:"Login"})})}):null}),wy=Lr(({user:t={},toggle:s})=>{const{UserMenuSeparator:n,UserMenuItem:r}=go();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-1 border-b-2",children:t.email}),e.jsx(r,{to:"/auth/profile",toggle:s,children:"Profile"}),I(t,"authLevel",-1)<5?null:e.jsx(r,{to:"/auth/project-management",toggle:s,children:"Project Management"}),e.jsx(n,{}),e.jsx(r,{to:"/auth/logout",toggle:s,children:"Logout"})]})}),jy=({to:t="#",toggle:s,children:n})=>{const r=De();return e.jsx("div",{onClick:s,children:e.jsx(ue,{to:t,children:e.jsx("div",{className:`
          rounded cursor-pointer px-2 whitespace-nowrap
          ${r.menuBg} ${r.menuBgHover}
          ${r.menuText} ${r.menuTextHover}
        `,children:n})})})},Cy=()=>e.jsx("div",{className:"border my-1"});let Ny=-1;const ky=()=>`list-${++Ny}`,$y=({children:t,...s})=>{const[n,r]=C.useState(!1);return C.useEffect(()=>{const a=requestAnimationFrame(()=>r(!0));return()=>{cancelAnimationFrame(a),r(!1)}},[]),n?e.jsx(Hg,{...s,children:t}):null},Sy=({id:t,index:s,children:n})=>e.jsx(Wg,{draggableId:`draggable-${t}`,index:s,children:r=>e.jsx("div",{ref:r.innerRef,...r.draggableProps,...r.dragHandleProps,style:{...r.draggableProps.style,left:"auto !important",top:"auto !important"},children:n})}),Qt=({onDrop:t,children:s,offset:n={x:0,y:0},className:r=""})=>{const a=C.useCallback(i=>{if(!i.destination)return;const c=i.source.index,d=i.destination.index;c!==d&&t(c,d)},[t]),l=De();return C.Children.toArray(s).length?e.jsx(Rg,{onDragEnd:a,children:e.jsx($y,{droppableId:ky(),className:"box-content",children:(i,c)=>e.jsxs("div",{ref:i.innerRef,...i.droppableProps,className:`flex flex-col
                  ${c.isDraggingOver?l.listDragging:l.list}
                  ${r}
                `,children:[C.Children.toArray(s).map((d,u)=>e.jsx(Sy,{id:d.key,index:u,children:d},d.key)),i.placeholder]})})}):null};Qt.defaultProps={items:[],idAccessor:t=>t.id,indexAccessor:t=>t.index,onDrop:(t,s)=>{}};C.createContext({});C.forwardRef(({open:t,transitioning:s,width:n,padding:r,children:a,heightFull:l=!0},i)=>{const c=De(),d=l?"h-full":"";return e.jsx("div",{className:`${d} w-full`,ref:i,style:{overflow:t&&!s?"visible":"hidden"},children:e.jsxs("div",{className:`${d} scrollbar-sm overflow-y-auto`,style:{width:`${n-r*2}px`},children:[e.jsx("div",{className:`
          absolute top-0 right-0 bottom-0 left-0 pointer-events-none z-10
          ${t?"opacity-0":"opacity-100"} ${c.sidebarBg}
        `,style:{transition:"opacity 500ms"}}),a]})})});Object.keys(or).sort((t,s)=>+t-+s);const _y=({type:t,domain:s,range:n,format:r,...a})=>{const l=C.useMemo(()=>Iy(t,s,n),[t,s,n]),i=C.useMemo(()=>Ey(r),[r]);return e.jsx("div",{children:t==="linear"?e.jsx(My,{scale:l,format:i,...a}):t==="ordinal"?e.jsx(Ty,{scale:l,format:i,...a}):t==="quantize"||t==="quantile"||t==="threshold"?e.jsx(Oy,{scale:l,format:i,...a}):t==="custom"?e.jsx(Ay,{format:i,...a}):e.jsxs("div",{children:['Unknown scale type "',t,'."']})})},Iy=(t,s,n)=>{switch(t){case"linear":return Vg().domain(s).range(n);case"ordinal":return vm().domain(s).range(n);case"quantize":return ym().domain(yi(s)).range(n);case"quantile":return bm().domain(s).range(n);case"threshold":return bi().domain(s).range(n);default:return null}},Ly=t=>t,Ey=t=>t?typeof t=="string"?vi(t):t:Ly,My=({scale:t,format:s,size:n,ticks:r=5})=>{const a=t.ticks(r);return e.jsxs("div",{children:[e.jsx(gp,{size:n,colors:a.map(l=>t(l))}),e.jsx("div",{className:"text-sm flex",children:a.map(l=>e.jsx("div",{className:"col-span-1 text-right pr-1 flex-1",children:s(l)},l))})]})},Ay=({format:t,height:s=3,customLegendScale:n})=>{const r=Object.keys(n);return e.jsx("div",{className:"flex",children:r.filter(a=>n[a].type!=="none").reduce((a,l,i)=>(i%s===0&&a.push([]),a[a.length-1].push(l),a),[]).map((a,l)=>e.jsx("div",{className:`${l>0?"ml-6":""} flex-1`,children:a.map(i=>{const c=n[i].color||null;return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-6 w-6 rounded mr-1 mb-1",children:e.jsx("img",{src:n[i].url})}),e.jsx("div",{className:"h-6 w-6 rounded mr-1 mb-1",style:{backgroundColor:c,border:"1px solid black"}}),e.jsx("div",{children:t(i)})]},i)})},l))})},Ty=({scale:t,format:s,height:n=3,direction:r="vertical",customLegendScale:a})=>{const l=t.range();return e.jsx("div",{children:r==="horizontal"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex",children:l.map(i=>e.jsx("div",{className:"flex-1  h-3 mx-2 rounded",style:{backgroundColor:i}},i))}),e.jsx("div",{className:"flex",children:t.domain().map(i=>e.jsx("div",{className:"flex-1 text-center",children:s(i)},i))})]}):e.jsx("div",{className:"flex",children:t.domain().reduce((i,c,d)=>(d%n===0&&i.push([]),i[i.length-1].push(c),i),[]).map((i,c)=>e.jsx("div",{className:`${c>0?"ml-6":""} flex-1`,children:i.map(d=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-6 w-6 rounded mr-1 mb-1",style:{backgroundColor:t(d)}}),e.jsx("div",{children:s(d)})]},d))},c))})})},Oy=({scale:t,format:s,size:n})=>{const r=t.range();return e.jsxs("div",{children:[e.jsx(gp,{size:n,colors:r}),e.jsx("div",{className:"text-sm flex",children:r.map(a=>e.jsx("div",{className:"flex-1 text-right pr-1",children:s(t.invertExtent(a)[1])},a))})]})},Dy={TopUserMenu:by,TopUserMenuControl:gy,SideUserMenu:vy,SideUserMenuControl:yy,UserMenuItem:jy,UserMenuSeparator:Cy,UserMenuItems:wy},By=C.createContext(Dy),go=()=>C.useContext(By);C.memo(({color:t,position:s="fixed",className:n="",scale:r=1})=>e.jsx("div",{className:`
    ${s} left-0 top-0 right-0 bottom-0
    flex justify-center items-center z-50 bg-black opacity-50
    ${n}
  `,children:e.jsx(wp,{scale:r,color:t})}));function Fy(){return new ro}function zy(){return new ro}var Qc=Object.prototype.hasOwnProperty,Kc=function(){};function Pl(){}Pl.create=function(t){var s=new Pl;return s.subscribe=function(n,r,a){var l,i;return typeof n=="function"?l={onNext:n,onError:r||Kc,onCompleted:a||Kc}:l=n,i=t(l),typeof i=="function"?{dispose:i}:i},s};function Yo(t,s,n){return Pl.create(function(a){var l={method:t||"GET",crossDomain:!1,async:!0,headers:{},responseType:"json"},i,c,d,u,m;for(m in s)Qc.call(s,m)&&(l[m]=s[m]);!l.crossDomain&&!l.headers["X-Requested-With"]&&(l.headers["X-Requested-With"]="XMLHttpRequest"),n.onBeforeRequest!=null&&n.onBeforeRequest(l);try{i=l.crossDomain?zy():Fy()}catch(p){a.onError(p)}try{l.user?i.open(l.method,l.url,l.async,l.user,l.password):i.open(l.method,l.url,l.async),i.timeout=l.timeout,i.withCredentials=l.withCredentials!==!1,d=l.headers;for(u in d)Qc.call(d,u)&&i.setRequestHeader(u,d[u]);if(l.responseType)try{i.responseType=l.responseType}catch(p){if(l.responseType!=="json")throw p}i.onreadystatechange=function(x){i.readyState===4&&(c||(c=!0,Py(a,i,x)))},i.ontimeout=function(x){c||(c=!0,Ry(a,i,"timeout error",x))},i.send(l.data)}catch(p){a.onError(p)}return function(){!c&&i.readyState!==4&&(c=!0,i.abort())}})}function hn(t,s,n){n||(n=new Error(s)),t.onError(n)}function Py(t,s,n){var r,a;if(s&&t){a=s.responseType,r="response"in s?s.response:s.responseText;var l=s.status===1223?204:s.status;if(l>=200&&l<=399){try{a!=="json"&&(r=JSON.parse(r||"")),typeof r=="string"&&(r=JSON.parse(r||""))}catch(i){hn(t,"invalid json",i)}t.onNext(r),t.onCompleted();return}else return l===401||l===403||l===407||l===410||l===408||l===504?hn(t,r):hn(t,r||"Response code "+l)}}function Ry(t,s,n,r){hn(t,n,r)}function Hy(t,s,n){var r=[],a,l={url:t},i=t.indexOf("?")!==-1,c=i?"&":"?";return typeof n=="string"?r.push(n):(a=Object.keys(n),a.forEach(function(d){var u=typeof n[d]=="object"?JSON.stringify(n[d]):n[d];r.push(d+"="+encodeURIComponent(u))})),s==="GET"?l.url+=c+r.join("&"):l.data=r.join("&"),l}function fn(t,s){var n;for(n in s)t[n]=s[n];return t}function Ws(t,s){if(this._jsongUrl=t,typeof s=="number"){var n={timeout:s};s=n}this._config=fn({timeout:15e3,headers:{}},s||{})}Ws.prototype={constructor:Ws,buildQueryObject:Hy,get:function(s){var n="GET",r=this.buildQueryObject(this._jsongUrl,n,{paths:s,method:"get"}),a=fn(r,this._config),l=this;return Yo(n,a,l)},set:function(s){var n="POST",r,a;!this._config.headers||!this._config.headers["Content-Type"]||!this._config.headers["Content-Type"].match(/application\/json/)?(a=this.buildQueryObject(this._jsongUrl,n,{jsonGraph:s,method:"set"}),r=fn(a,this._config),r.headers["Content-Type"]="application/x-www-form-urlencoded"):r=fn({url:this._jsongUrl,data:JSON.stringify({jsonGraph:JSON.stringify(s),method:"set"})},this._config);var l=this;return Yo(n,r,l)},call:function(s,n,r,a){n=n||[],r=r||[],a=a||[];var l="POST",i,c=[],d;!this._config.headers||!this._config.headers["Content-Type"]||!this._config.headers["Content-Type"].match(/application\/json/)?(c.push("method=call"),c.push("callPath="+encodeURIComponent(JSON.stringify(s))),c.push("arguments="+encodeURIComponent(JSON.stringify(n))),c.push("pathSuffixes="+encodeURIComponent(JSON.stringify(r))),c.push("paths="+encodeURIComponent(JSON.stringify(a))),d=this.buildQueryObject(this._jsongUrl,l,c.join("&")),i=fn(d,this._config),i.headers["Content-Type"]="application/x-www-form-urlencoded"):i=fn({url:this._jsongUrl,data:JSON.stringify({method:"call",callPath:JSON.stringify(s),arguments:JSON.stringify(n),pathSuffixes:JSON.stringify(r),paths:JSON.stringify(a)})},this._config);var u=this;return Yo(l,i,u)}};Ws.XMLHttpSource=Ws;Ws.default=Ws;Promise.map=function(t,s,n={}){let r=n.concurrency||1/0,a=0;const l=[],i=[],c=t[Symbol.iterator]();for(;r-- >0;){const u=d();if(u)i.push(u);else break}return Promise.all(i).then(()=>l);function d(){const u=c.next();if(u.done)return null;const m=a++,p=s(u.value,m);return Promise.resolve(p).then(x=>(l[m]=x,d()))}};class Wy extends Ws{onBeforeRequest(s){if(window&&window.localStorage){const n=window.localStorage.getItem("userToken");n&&(s.headers.Authorization=n)}}}function Vy(){return{}}const Uy=()=>{},qy=(t,s,n={})=>{const{placeholder:r="replace_me",chunkSize:a=100}=n,l=[];for(let i=0;i<t.length;i+=a)l.push(s.map(c=>c===r?t.slice(i,i+a):c));return l.length?l:[s]},Gy=(t,s={})=>{const{falcor:n,onProgress:r=Uy,concurrency:a=5,...l}=s,i=fm(r,50);let c=0,d=0,u=t.reduce((m,[p,x])=>{const h=qy(p,x,l);return d+=h.length,m.push(...h),m},[]);return Promise.map(u,m=>n.get(m).then(()=>{i(++c,d)}),{concurrency:a})},$p=t=>t.reduce((s,n)=>(Array.isArray(n)?s[0].push(n):s[1]=n,s),[[],{}]),Jy=(...t)=>{const[s,n]=$p(t),{index:r=null,placeholder:a="replace_me",...l}=n,i=s.reduce((c,d)=>{let u=[],m=!1;const p=d.map((x,h)=>Array.isArray(x)&&x.length&&!m&&(r===null||r===h)?(m=!0,u=x,a):x);return c.push([u,p]),c},[]);return Gy(i,{...l,placeholder:a})};class Xy extends hm{constructor(...s){super(...s),this.listeners=[],this.onChange=this.onChange.bind(this),this.listen=this.listen.bind(this),this.unlisten=this.unlisten.bind(this)}onChange(){this.listeners.forEach(s=>s())}listen(s){this.listeners.includes(s)||this.listeners.push(s)}unlisten(s){this.listeners=this.listeners.filter(n=>n!==s)}}class Zy extends xm.Model{constructor(...s){super(...s),this.onChange=this.onChange.bind(this),this.remove=this.remove.bind(this),this.chunk=this.chunk.bind(this)}onChange(s,n){this._root.listen(s,n)}remove(s){this._root.unlisten(s)}get(...s){return super.get(...s).then(n=>n)}call(...s){return super.call(...s).then(n=>n)}chunk(...s){const[n,r]=$p(s);return Jy(...n,{falcor:this,...r})}}const Yy=t=>new Zy({_root:new Xy,source:new Wy(t+"/graph",{crossDomain:!0,withCredentials:!1,timeout:12e4}),errorSelector:(s,n)=>(console.log("errorSelector",s,n),n),cache:Vy()});Yy("https://graph.availabs.org");const Qy=C.createContext();Qy.Consumer;const Ky=()=>{const t="neutral",s="white",n="blue";return{graphColors:["#1e40af","#93c5fd","#1d4ed8","#bfdbfe"],graphCategorical:["#fde72f","#95d840","#55a488","#2f708e","#453781","#472354"],sidebarBg:`bg-${t}-100`,sidenav:(r={})=>{let{color:a="white",size:l="compact",subMenuStyle:i="inline",responsive:c="top"}=r,d={top:"hidden md:block",side:"hidden md:block",none:""},u={white:{contentBg:`bg-${s} border-r`,sideItemActive:"",contentBgAccent:"bg-slate-100",accentColor:`${n}-600`,accentBg:"",borderColor:"border-slate-200",textColor:`text-${t}-600`,textColorAccent:"text-slate-800",highlightColor:"text-blue-800"},transparent:{contentBg:"",contentBgAccent:"bg-neutral-100",accentColor:`${n}-600`,accentBg:`hover:bg-${n}-400`,borderColor:`border-${t}-100`,textColor:`text-${t}-600`,textColorAccent:"text-slate-800",highlightColor:`text-${t}-800`},dark:{contentBg:"bg-neutral-800",contentBgAccent:"bg-neutral-900",accentColor:"white",accentBg:"",borderColor:"border-neutral-700",textColor:"text-slate-300",textColorAccent:"text-slate-100",highlightColor:"text-slate-100",sideItem:"text-slate-300 hover:text-white",sideItemActive:"text-slate-300 hover:text-white"},bright:{contentBg:`bg-${n}-700`,accentColor:`${n}-400`,accentBg:`hover:bg-${n}-400`,borderColor:`border-${n}-600`,textColor:`text-${s}`,highlightColor:`text-${s}-500`}},m={none:{wrapper:"w-0 overflow-hidden",sideItem:"flex mx-2 pr-4 py-2 text-base ",topItem:"flex items-center text-sm px-4 border-r h-12",icon:"mr-3 text-lg"},compact:{fixed:"ml-0 md:ml-36",wrapper:"w-36",itemWrapper:"pt-5 ",sideItem:"group flex px-3 py-1.5 text-[14px] mx-2 hover:translate-x-1 duration-300 ease-in-out",sideItemActive:"group flex px-3 py-1.5 text-[14px]  mx-2 hover:translate-x-1 duration-300 ease-in-out",topItem:"flex items-center text-sm px-4 border-r h-12",icon:"  w-6 mr-2  ",iconActive:"  w-6 mr-2  ",sideItemContent:"text-slate-300 group-hover:text-white"},full:{fixed:"",wrapper:"w-full",sideItem:"group flex px-3 py-2 text-[14px] font-light hover:bg-blue-50  mx-2 border-r-4 border-white",sideItemActive:"group flex px-3 py-2 text-[14px] font-light hover:bg-blue-50 mx-2 border-r-4  border-white",topItem:"flex pr-4 py-2  font-",icon:"group w-6 mr-2 text-blue-500  ",iconActive:"group w-6 mr-2 text-blue-500",sideItemContent:"group-hover:translate-x-1.5 transition-transform duration-300 ease-in-out"},mini:{fixed:"ml-0 md:ml-20",wrapper:"w-20 overflow-x-hidden",sideItem:"text-white hover:bg-blue-100 hover:text-blue-100",sideItemActive:"text-blue-500 bg-blue-500  ",topItem:"flex px-4 items-center text-sm font-light ",icon:"w-20 h-10 text-xl text-blue-500",iconActive:"w-20 h-10 text-xl text-white",sideItemContent:"w-0"},micro:{fixed:"ml-0 md:ml-14",wrapper:"w-14 overflow-x-hidden",itemWrapper:"p-1",sideItem:"flex text-base font-base ",topItem:"flex mx-6 pr-4 py-2 text-sm font-light",icon:"w-12 text-2xl hover:bg-neutral-900 px-1 py-3 my-2 rounded-lg mr-4 hover:text-blue-500",iconActive:"w-12 text-2xl text-blue-500 hover:bg-neutral-900 px-1 py-3 my-2 rounded-lg mr-4 ",sideItemContent:"hidden"}};m[l]||(l="none");let p={inline:{indicatorIcon:"fa fa-angle-right pt-2.5",indicatorIconOpen:"fal fa-angle-down pt-2.5",subMenuWrapper:"pl-2 w-full",subMenuParentWrapper:"flex flex-col w-full"},flyout:{indicatorIcon:"fal fa-angle-down",indicatorIconOpen:"fa fa-angle-right",subMenuWrapper:`absolute ml-${m[l].width-8}`,subMenuParentWrapper:"flex flex-row",subMenuWrapperTop:"absolute top-full"}};return{fixed:`md:${m[l].fixed}`,logoWrapper:`${m[l].wrapper} ${u[a].contentBgAccent} ${u[a].textColorAccent}`,sidenavWrapper:`${d[c]} ${u[a].contentBg} ${m[l].wrapper} h-full z-20`,menuIconSide:`${m[l].icon} group-hover:${u[a].highlightColor} text-slate-300 group-hover:text-white`,menuIconSideActive:`${m[l].iconActive} group-hover:${u[a].highlightColor} text-slate-100 group-hover:text-white`,itemsWrapper:`${u[a].borderColor} ${m[l].itemWrapper}  `,navItemContent:`${m[l].sideItemContent} text-slate-300`,navitemSide:`
            group  flex flex-col

            ${m[l].sideItem} ${u[a].sideItem}
            focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
            transition-all cursor-pointer
         `,navitemSideActive:`
            group  flex flex-col
             ${m[l].sideItemActive} ${u[a].sideItemActive} 
            
            focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
            transition-all cursor-pointer

          `,...p[i],vars:{colors:u,sizes:m,mobile:d}}},topnav:({color:r="white",size:a="compact"})=>{let l={white:{contentBg:"bg-slate-100",accentColor:`${n}-500`,accentBg:`hover:bg-${n}-500`,borderColor:`border-${t}-100`,textColor:`text-${t}-500`,highlightColor:`text-${s}`},bright:{contentBg:`bg-${n}-700`,accentColor:`${n}-400`,accentBg:`hover:bg-${n}-400`,borderColor:`border-${n}-600`,textColor:`text-${s}`,highlightColor:`text-${s}`}},i={compact:{menu:"hidden md:flex flex-1 justify-end",sideItem:"flex mx-6 pr-4 py-2 text-sm font-light hover:pl-4",topItem:`flex items-center text-sm px-4 border-r h-12 ${l[r].textColor} ${l[r].borderColor}
            ${l[r].accentBg} hover:${l[r].highlightColor}`,activeItem:`flex items-center text-sm px-4 border-r h-12 ${l[r].textColor} ${l[r].borderColor}
            ${l[r].accentBg} hover:${l[r].highlightColor}`,icon:"mr-3 text-lg",responsive:"md:hidden"},inline:{menu:"flex flex-1",sideItem:"flex mx-4 pr-4 py-4 text-base font-base border-b hover:pl-4",topItem:`flex px-4 py-2 mx-2 font-medium text-gray-400 border-b-2 ${l[r].textColor} ${l[r].borderColor}
          hover:border-gray-300 hover:text-gray-700 border-gray-100 `,activeItem:`flex px-4 py-2 mx-2 font-medium text-blue-600 border-b-2 ${l[r].textColor} ${l[r].borderColor} border-blue-600 `,icon:"mr-4 text-2xl",responsive:"hidden"}};return{topnavWrapper:`w-full ${l[r].contentBg} border-b border-gray-200`,topnavContent:"flex w-full h-full",topnavMenu:`${i[a].menu} h-full overflow-x-auto overflow-y-hidden scrollbar-sm`,menuIconTop:`text-${l[r].accentColor} ${i[a].icon} group-hover:${l[r].highlightColor}`,menuOpenIcon:"fa fa-bars",menuCloseIcon:'fa fa-xmark fa-fw"',navitemTop:`
            group font-sans
            ${i[a].topItem}
            focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
            transition cursor-pointer
        `,topmenuRightNavContainer:"hidden md:block h-full",navitemTopActive:` group font-sans
            ${i[a].activeItem}
            focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
            transition cursor-pointer
          `,mobileButton:`${i[a].responsive} ${l[r].contentBg} inline-flex items-center justify-center p-2  text-gray-400 hover:bg-gray-100 `,vars:{colors:l,sizes:i}}},select:(r={})=>{const{color:a="white"}=r;let l={white:"white",transparent:"gray-100 border border-gray-200 shadow-sm"};return{menuWrapper:`bg-${l[a]} my-1`,menuItemActive:`px-4 py-2 cursor-not-allowed bg-${n}-200 border-1 focus:border-${n}-300`,menuItem:`px-4 py-2 cursor-pointer hover:bg-blue-100 border-1 border-${l[a]} focus:border-blue-300`,select:`bg-${l[a]} w-full flex flex-row flex-wrap justify-between px-4 py-2 cursor-pointer focus:border-blue-300`,selectIcon:"fal fa-angle-down text-gray-400 pt-2"}},table:(r={color:"white",size:"compact"})=>{const{color:a="white",size:l="compact"}=r;let i={white:"bg-white hover:bg-blue-50",gray:"bg-gray-100 hover:bg-gray-200",transparent:"gray-100"},c={small:"px-4 py-1 text-xs",compact:"px-4 py-1 text-sm",full:"px-10 py-5"};return{tableHeader:`${c[l]} pb-1 h-8 border border-b-4 border-gray-200 bg-white text-left font-medium text-gray-700 uppercase first:rounded-tl-md last:rounded-tr-md`,tableInfoBar:"bg-white",tableRow:`${i[a]} transition ease-in-out duration-150 hover:bg-blue-100`,tableRowStriped:"bg-white odd:bg-tigGray-25 hover:bg-tigGray-100 bg-opacity-25 transition ease-in-out duration-150",tableCell:`${c[l]} break-words border border-gray-200 pl-1 align-top font-light text-sm`,inputSmall:"w-24",sortIconDown:"fas fa-sort-amount-down text-tigGray-300 opacity-75",sortIconUp:"fas fa-sort-amount-up text-tigGray-300 opacity-75",sortIconIdeal:"fa fa-sort-alt text-tigGray-300 opacity-25",vars:{color:i,size:c}}},tabpanel:(r={})=>{const{tabLocation:a="top"}=r;let l={top:{tabpanelWrapper:"flex-col",tabWrapper:"flex-row",tab:"border-b-2"},left:{tabpanelWrapper:"flex-row",tabWrapper:"flex-col",tab:"border-r-2"}};return{tabpanelWrapper:`flex ${l[a].tabpanelWrapper} w-full h-full`,tabWrapper:`flex ${l[a].tabWrapper}`,tab:"px-4 py-2 hover:text-gray-800 cursor-pointer   text-center text-gray-500",tabActive:`px-4 py-2 text-${n}-500 ${l[a].tab} border-blue-500 text-center`,icon:"",tabName:"",contentWrapper:"bg-white flex-1 h-full",vars:{tabLocation:l}}},button:(r={})=>{const{color:a="white",size:l="base",width:i="block"}=r;let c={white:`
                    border border-gray-300  text-gray-700 bg-white hover:text-gray-500
                    focus:outline-none focus:shadow-outline-blue focus:border-blue-300
                    active:text-gray-800 active:bg-gray-50 transition duration-150 ease-in-out
                    disabled:cursor-not-allowed
                `,cancel:`
                    border border-red-300  text-red-700 bg-white hover:text-red-500
                    focus:outline-none focus:shadow-outline-blue focus:border-blue-300
                    active:text-red-800 active:bg-gray-50 transition duration-150 ease-in-out
                    disabled:cursor-not-allowed
                `,transparent:`
                    border border-gray-300  text-gray-700 bg-white hover:text-gray-500
                    focus:outline-none focus:shadow-outline-blue focus:border-blue-300
                    active:text-gray-800 active:bg-gray-50 transition duration-150 ease-in-out
                    disabled:cursor-not-allowed
                `,primary:`
                    border border-transparent shadow
                    leading-4 rounded-sm text-white bg-blue-600 hover:bg-blue-700
                    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,danger:""},d={base:"px-4 py-4 leading-5 font-medium",sm:"text-sm px-2 py-2 leading-5 font-medium",lg:"text-lg px-6 py-6 leading-5 font-medium",xl:"text-2xl px-12 py-8 leading-5 font-medium"},u={block:"",full:"w-full"};return{button:`
                  ${c[a]} ${d[l]} ${u[i]}
                `,vars:{color:c,size:d,width:u}}},input:(r={})=>{const{color:a="white",size:l="small",width:i="block"}=r;let c={white:"bg-white focus:outline-none",gray:"bg-gray-100"},d={base:"px-4 py-4 font-medium",small:"text-sm px-2 py-2 font-medium text-xs",large:"text-lg px-6 py-6 font-medium text-xl"},u={block:"",full:"w-full"};return{input:`
                 ${c[a]} ${d[l]} ${u[i]}
                `,vars:{color:c,size:d,width:u}}},modal:(r={})=>{const{size:a="base",overlay:l="default"}=r;let i={default:"fixed  inset-0 bg-gray-500 opacity-75",none:""},c={base:"sm:max-w-2xl",small:"w-64",large:"sm:max-w-5xl",xlarge:"sm:max-w-8xl"};return{modalContainer:`${l==="default"?"":"pointer-events-none"} fixed bottom-0 inset-x-0 px-4 pb-4 inset-0 flex items-center justify-center z-50`,modalOverlay:i[l],modal:`${c[a]} w-full  pointer-events-auto bg-white rounded-lg overflow-hidden shadow-xl transform transition-all`,vars:{size:c,overlay:i}}},shadow:"shadow",ySpace:"py-4",text:"text-gray-800",textContrast:"text-white",border:"broder-gray-400",textInfo:"text-blue-400",bgInfo:"bg-blue-400",borderInfo:"border-blue-400",textSuccess:"text-blue-400",bgSuccess:"bg-blue-400",borderSuccess:"border-blue-400",textDanger:"text-red-400",bgDanger:"bg-red-400",borderDanger:"border-red-400",textWarning:"text-yellow-400",bgWarning:"bg-yellow-400",borderWarning:"border-yellow-400",textLight:"text-gray-400",placeholder:"placeholder-gray-400",topMenuBorder:"border-b border-gray-200",topMenuScroll:"",headerShadow:"",navText:"text-gray-100",navMenu:"h-full relative",navMenuOpen:"bg-darkblue-500 text-white shadow-lg w-56 rounded-t-lg",navMenuBg:"bg-darkblue-500 bb-rounded-10 shadow-lg text-white rounded-b-lg",navMenuItem:"hover:font-medium cursor-pointer px-2 py-1 text-lg font-semibold",bg:"bg-gray-50",menuBg:"bg-white z-50",menuBgHover:"",menuBgActive:"bg-blue-200",menuBgActiveHover:"hover:bg-blue-300",menuText:"text-gray-100",menuTextHover:"hover:text-gray-700",menuTextActive:"text-blue-500",menuTextActiveHover:"hover:text-blue-700",headerBg:"bg-gray-200",headerBgHover:"hover:bg-gray-400",inputBg:"bg-white disabled:bg-gray-200 cursor-pointer focus:outline-none",inputBorder:"rounded border-0 border-transparent hover:border-gray-300 focus:border-gray-600 disabled:border-gray-200",inputBgDisabled:"bg-gray-200 cursor-not-allowed focus:outline-none",inputBorderDisabled:"rounded border-2 border-gray-200 hover:border-gray-200",inputBgFocus:"bg-white cursor-pointer focus:outline-none",inputBorderFocus:"rounded border-2 border-transparent hover:border-gray-600 focus:border-gray-600 border-gray-600",textBase:"text-base",textSmall:"text-sm",textLarge:"text-lg",paddingBase:"py-1 px-2",paddingSmall:"py-0 px-1",paddingLarge:"py-2 px-4",contentBg:"bg-white",accent1:"bg-blue-100",accent2:"bg-gray-300",accent3:"bg-gray-400",accent4:"bg-gray-500",highlight1:"bg-blue-200",highlight2:"bg-blue-300",highlight3:"bg-blue-400",highlight4:"bg-blue-500",width:"",transition:"transition ease-in-out duration-150",tableRow:"bg-gray-100 hover:bg-gray-200 transition ease-in-out duration-150",tableRowStriped:"bg-gray-100 even:bg-gray-200 hover:bg-gray-300 transition ease-in-out duration-150",tableCell:"px-4 py-1 whitespace-no-wrap",tableHeader:"px-4 py-2 pb-1 border-b-2 border-gray-300 bg-gray-200 text-left font-medium text-gray-700 uppercase first:rounded-tl-md last:rounded-tr-md"}},ev=Ky();function tv(){return{landing:{wrapper:"p-4 border-2 border-blue-300"},table:{table:"min-w-full divide-y divide-gray-300",thead:"",th:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900",tbody:"divide-y divide-gray-200 ",td:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},text:{input:"px-2 py-1 w-full text-sm font-light border rounded-md focus:border-blue-300 bg-white focus:outline-none transition ease-in",view:"text-sm font-light truncate bg-red-500"},textarea:{input:"px-2 py-1 w-full text-sm font-light border rounded-md focus:border-blue-300 focus:outline-none transition ease-in",viewWrapper:"whitespace-normal text-sm font-light"},select:{input:"px-2 py-1 w-full text-sm font-light border rounded-md focus:border-blue-300 bg-white hover:bg-blue-100 transition ease-in",error:"p-1 text-xs text-red-700 font-bold"},multiselect:{view:"w-full h-full",mainWrapper:"w-full h-full",inputWrapper:"flex px-2 py-1 w-full text-sm font-light border focus:border-blue-300 rounded-md bg-white hover:bg-blue-100 transition ease-in",input:"w-full px-2 py-1 border rounded-lg focus:outline-none",tokenWrapper:"w-fit flex m-0.5 px-2 py-1 mx-1 bg-[#C5D7E0] text-[#37576B] hover:bg-[#E0EBF0] rounded-md transition ease-in",removeIcon:"fa fa-xmark px-1 text-xs text-red-500 hover:text-red-600 self-center cursor-pointer transition ease-in",menuWrapper:"absolute p-2 bg-white w-full max-h-[150px] overflow-auto scrollbar-sm shadow-lg z-10 rounded-lg",menuItem:"px-2 py-1 text-sm hover:bg-blue-300 hover:cursor-pointer transition ease-in rounded-md",smartMenuWrapper:"w-full h-full flex flex-wrap",smartMenuItem:"w-fit px-1 py-0.5 m-1 bg-blue-100 hover:bg-blue-300 hover:cursor-pointer transition ease-in border rounded-lg text-xs",error:"p-1 text-xs text-red-700 font-bold"},radio:{wrapper:"p-1 flex",input:"self-center p-1",label:"text-sm font-light p-1 self-center",error:"text-xs text-red-700 font-bold"},card:{wrapper:"p-4",rowHeader:"w-full flex flex-row justify-between",infoIcon:"p-2 fad fa-info text-blue-300 hover:text-blue-400",row:"flex py-1 flex-col p-2 mt-3",rowLabel:"w-full text-sm font-light mb-2 capitalize",rowContent:"flex-1",btnWrapper:"w-full flex justify-end",continueBtn:"p-2 m-1 bg-blue-300 hover:bg-blue-500 disabled:bg-blue-300 text-white rounded-md transition ease-in",backBtn:"p-2 m-1 bg-blue-300 hover:bg-blue-500 disabled:bg-blue-300 text-white rounded-md transition ease-in",submitBtn:"p-2 m-1 bg-blue-300 hover:bg-blue-500 text-white rounded-md transition ease-in"},form:{tabpanelWrapper:"flex",tabWrapper:"flex p-3 w-full",tabActive:"w-full p-1 border-b-2 flex flex-col text-center border-blue-300 transition ease-in",tab:"group w-full p-1 border-b-2 flex flex-col text-center hover:bg-blue-300 transition ease-in",icon:"",tabTitle:"text-xs font-bold text-blue-500 group-hover:text-white",tabSubtitle:"text-sm font-light text-blue-500 group-hover:text-white",contentWrapper:"flex",sectionsWrapper:"columns-2 gap-2",sections:"w-full h-fit shadow-md mb-4 border",card:{wrapper:"divide-y-2",row:"flex py-1 flex-row hover:bg-blue-50 space-between p-2",rowLabel:"w-1/4 text-xs text-gray-600 font-medium mb-2 capitalize",rowContent:"pl-2 w-3/4 text-sm"}}}}const Sp=tv(),sv=C.createContext(Sp),et=()=>b.useContext(sv),nv=({value:t="",onChange:s,className:n,placeholder:r,...a})=>{var d;const[l,i]=b.useState(t),c=et();return b.useEffect(()=>i(t),[t]),e.jsx("input",{...a,className:n||((d=c==null?void 0:c.text)==null?void 0:d.input)||"w-full border p-2",value:l,placeholder:r,onChange:u=>{i(u.target.value),s(u.target.value)}})},rv=({value:t,className:s,...n})=>{var a;if(!t)return!1;const r=et();return e.jsx("div",{className:s||((a=r==null?void 0:r.text)==null?void 0:a.view),children:typeof t=="object"?JSON.stringify(t):t})},Qo={EditComp:nv,ViewComp:rv},av=({value:t,onChange:s,className:n,placeholder:r,...a})=>{var d;const[l,i]=b.useState(t),c=et();return e.jsx("textarea",{className:n||((d=c==null?void 0:c.textarea)==null?void 0:d.input)||"w-full border p-2",value:l,placeholder:r,onChange:u=>{i(u.target.value),s(u.target.value)}})},ov=({value:t})=>{const s=et();return t?e.jsx("div",{className:ne(s,"textarea.viewWrapper",""),children:typeof t=="object"?JSON.stringify(t):t}):!1},lv={EditComp:av,ViewComp:ov},iv=({value:t,onChange:s,placeHolder:n="Please Select"})=>{var a;const r=et();return e.jsxs("select",{className:(a=r==null?void 0:r.boolean)==null?void 0:a.select,value:t,onChange:l=>s(l.target.value),children:[e.jsx("option",{value:void 0,children:n}),e.jsx("option",{value:!0,children:"True"}),e.jsx("option",{value:!1,children:"False"})]})},cv=({value:t})=>t?e.jsx("div",{children:t}):!1,dv={EditComp:iv,ViewComp:cv},Er=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",uv=b.createContext({}),mv=()=>b.useContext(uv);function pv({onClose:t,children:s,title:n,closeOnClickOutside:r}){const a=b.useRef(null);return b.useEffect(()=>{a.current!==null&&a.current.focus()},[]),b.useEffect(()=>{let l=null;const i=u=>{u.keyCode===27&&t()},c=u=>{const m=u.target;a.current!==null&&!a.current.contains(m)&&r&&t()},d=a.current;return d!==null&&(l=d.parentElement,l!==null&&l.addEventListener("click",c)),window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i),l!==null&&(l==null||l.removeEventListener("click",c))}},[r,t]),e.jsx("div",{className:"z-20 flex justify-center items-center fixed flex-col top-0 bottom-0 left-0 right-0 bg-[rgba(40,_40,_40,_0.6)] flex-grow-[0px] flex-shrink-[1px]",role:"dialog",children:e.jsxs("div",{className:"p-[20px] min-h-[100px] min-w-[300px] flex flex-grow-[0px] bg-[#fff] flex-col relative [box-shadow:0_0_20px_0_#444] rounded-[10px]",tabIndex:-1,ref:a,children:[e.jsx("h2",{className:"text-[#444] m-0 pb-[10px] border-b-[1px_solid_#ccc]",children:n}),e.jsx("button",{className:"border-[0px] absolute right-[20px] rounded-[20px] justify-center items-center flex w-[30px] h-[30px] text-center cursor-pointer bg-[#eee] hover:bg-[#ddd]","aria-label":"Close modal",type:"button",onClick:t,children:"X"}),e.jsx("div",{className:"pt-[20px]",children:s})]})})}function xv({onClose:t,children:s,title:n,closeOnClickOutside:r=!1}){return Zt.createPortal(e.jsx(pv,{onClose:t,title:n,closeOnClickOutside:r,children:s}),document.body)}function Mr(){const[t,s]=b.useState(null),n=b.useCallback(()=>{s(null)},[]),r=b.useMemo(()=>{if(t===null)return null;const{title:l,content:i,closeOnClickOutside:c}=t;return e.jsx(xv,{onClose:n,title:l,closeOnClickOutside:c,children:i})},[t,n]),a=b.useCallback((l,i,c=!1)=>{s({closeOnClickOutside:c,content:i(n),title:l})},[n]);return[r,a]}function hv(...t){return t.filter(Boolean).join(" ")}function Vs({"data-test-id":t,children:s,className:n,onClick:r,disabled:a,small:l,title:i}){return e.jsx("button",{disabled:a,className:hv("pt-[10px] pb-[10px] pl-[15px] pr-[15px] border-[0px] bg-[#eee] rounded-[5px] cursor-pointer text-[14px] hover:bg-[#ddd]",a&&"cursor-not-allowed hover:bg-[#eee]",l&&"pt-[5px] pb-[5px] pl-[10px] pr-[10px] text-[13px]",n),onClick:r,title:i,"aria-label":i,...t&&{"data-test-id":t},children:s})}const fv="modulepreload",gv=function(t){return"/"+t},ed={},_p=function(s,n,r){let a=Promise.resolve();if(n&&n.length>0){let i=function(u){return Promise.all(u.map(m=>Promise.resolve(m).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=i(n.map(u=>{if(u=gv(u),u in ed)return;ed[u]=!0;const m=u.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const x=document.createElement("link");if(x.rel=m?"stylesheet":fv,m||(x.as="script"),x.crossOrigin="",x.href=u,d&&x.setAttribute("nonce",d),document.head.appendChild(x),m)return new Promise((h,f)=>{x.addEventListener("load",h),x.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return a.then(i=>{for(const c of i||[])c.status==="rejected"&&l(c.reason);return s().catch(l)})},bv=b.lazy(()=>_p(()=>import("./InlineImageComponent-zYRbgtOS.js"),__vite__mapDeps([0,1])));function yv(t){if(t instanceof HTMLImageElement){const{alt:s,src:n,width:r,height:a}=t;return{node:bo({altText:s,height:a,src:n,width:r})}}return null}class nn extends ao{static getType(){return"image"}static clone(s){return new nn(s.__src,s.__altText,s.__position,s.__width,s.__height,s.__showCaption,s.__caption,s.__key)}static importJSON(s){const{altText:n,height:r,width:a,caption:l,src:i,showCaption:c,position:d="full"}=s,u=bo({altText:n,height:r,position:d,showCaption:c,src:i,width:a}),m=u.__caption,p=m.parseEditorState(l.editorState);return p.isEmpty()||m.setEditorState(p),u}static importDOM(){return{img:s=>({conversion:yv,priority:0})}}constructor(s,n,r,a,l,i,c,d){super(d),this.__src=s,this.__altText=n,this.__width=a||"inherit",this.__height=l||"inherit",this.__showCaption=i||!1,this.__caption=c||Ug(),this.__position=r}exportDOM(){const s=document.createElement("img");return s.setAttribute("src",this.__src),s.setAttribute("alt",this.__altText),s.setAttribute("width",this.__width.toString()),s.setAttribute("height",this.__height.toString()),{element:s}}exportJSON(){return{altText:this.getAltText(),caption:this.__caption.toJSON(),height:this.__height==="inherit"?0:this.__height,position:this.__position,showCaption:this.__showCaption,src:this.getSrc(),type:"image",version:1,width:this.__width==="inherit"?0:this.__width}}getSrc(){return this.__src}getAltText(){return this.__altText}setAltText(s){const n=this.getWritable();n.__altText=s}setWidthAndHeight(s,n){const r=this.getWritable();r.__width=s,r.__height=n}getShowCaption(){return this.__showCaption}setShowCaption(s){const n=this.getWritable();n.__showCaption=s}getPosition(){return this.__position}setPosition(s){const n=this.getWritable();n.__position=s}update(s){const n=this.getWritable(),{altText:r,showCaption:a,position:l}=s;r!==void 0&&(n.__altText=r),a!==void 0&&(n.__showCaption=a),l!==void 0&&(n.__position=l)}createDOM(s){const n=document.createElement("span"),r=`${s.theme.inlineImage} position-${this.__position}`;return r!==void 0&&(n.className=r),n.style.lineHeight="0",n.style.display="inline-block",n.style.verticalAlign="bottom",n}updateDOM(s,n,r){const a=this.__position;if(a!==s.__position){const l=`${r.theme.inlineImage} position-${a}`;l!==void 0&&(n.className=l)}return!1}decorate(){return e.jsx(b.Suspense,{fallback:null,children:e.jsx(bv,{src:this.__src,altText:this.__altText,width:this.__width,height:this.__height,nodeKey:this.getKey(),showCaption:this.__showCaption,caption:this.__caption,position:this.__position})})}}function bo({altText:t,position:s,height:n,src:r,width:a,showCaption:l,caption:i,key:c}){return qg(new nn(r,t,s,a,n,l,i,c))}function Ip(t){return t instanceof nn}const vv="https://platform.twitter.com/widgets.js";function wv(t){const s=t.getAttribute("data-lexical-tweet-id");return s?{node:Mi(s)}:null}let td=!0;function jv({className:t,format:s,loadingComponent:n,nodeKey:r,onError:a,onLoad:l,tweetID:i}){const c=b.useRef(null),d=b.useRef(""),[u,m]=b.useState(!1),p=b.useCallback(async()=>{try{await window.twttr.widgets.createTweet(i,c.current),m(!1),td=!1,l&&l()}catch(x){a&&a(String(x))}},[a,l,i]);return b.useEffect(()=>{var x;if(i!==d.current){if(m(!0),td){const h=document.createElement("script");h.src=vv,h.async=!0,(x=document.body)==null||x.appendChild(h),h.onload=p,a&&(h.onerror=a)}else p();d&&(d.current=i)}},[p,a,i]),e.jsxs(jm,{className:t,format:s,nodeKey:r,children:[u?n:null,e.jsx("div",{style:{display:"inline-block",width:"550px"},ref:c})]})}class Ar extends wm{static getType(){return"tweet"}static clone(s){return new Ar(s.__id,s.__format,s.__key)}static importJSON(s){const n=Mi(s.id);return n.setFormat(s.format),n}exportJSON(){return{...super.exportJSON(),id:this.getId(),type:"tweet",version:1}}static importDOM(){return{div:s=>s.hasAttribute("data-lexical-tweet-id")?{conversion:wv,priority:2}:null}}exportDOM(){const s=document.createElement("div");s.setAttribute("data-lexical-tweet-id",this.__id);const n=document.createTextNode(this.getTextContent());return s.append(n),{element:s}}constructor(s,n,r){super(n,r),this.__id=s}getId(){return this.__id}getTextContent(s,n){return`https://twitter.com/i/web/status/${this.__id}`}decorate(s,n){const r=n.theme.embedBlock||{},a={base:r.base||"",focus:r.focus||""};return e.jsx(jv,{className:a,format:this.__format,loadingComponent:"Loading...",nodeKey:this.getKey(),tweetID:this.__id})}isInline(){return!1}}function Mi(t){return new Ar(t)}function Cv(t){return t instanceof Ar}const Nv={dependencies:[km],export:t=>e0(t)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(t,s,n,r)=>{const a=Kg();r||t.getNextSibling()!=null?t.replace(a):t.insertBefore(a),a.selectNext()},type:"element"},kv={dependencies:[nn],export:t=>Ip(t)?`![${t.getAltText()}](${t.getSrc()})`:null,importRegExp:/!(?:\[([^[]*)\])(?:\(([^(]+)\))/,regExp:/!(?:\[([^[]*)\])(?:\(([^(]+)\))$/,replace:(t,s)=>{const[,n,r]=s,a=bo({altText:n,src:r});t.replace(a)},trigger:")",type:"text-match"},$v={dependencies:[Ar],export:t=>Cv(t)?`<tweet id="${t.getId()}" />`:null,regExp:/<tweet id="([^"]+?)"\s?\/>\s?$/,replace:(t,s,n)=>{const[,r]=n,a=Mi(r);t.replace(a)},type:"element"},Lp=/^(?:\|)(.+)(?:\|)\s?$/,Sv=/^(\| ?:?-*:? ?)+\|\s?$/,_v={dependencies:[cr,Cm,Nm],export:t=>{if(!As(t))return null;const s=[];for(const n of t.getChildren()){const r=[];if(!_a(n))continue;let a=!1;for(const l of n.getChildren())dr(l)&&(r.push(Sm(Ea,l).replace(/\n/g,"\\n")),l.__headerState===Ml.ROW&&(a=!0));s.push(`| ${r.join(" | ")} |`),a&&s.push(`| ${r.map(l=>"---").join(" | ")} |`)}return s.join(`
`)},regExp:Lp,replace:(t,s,n)=>{if(Sv.test(n[0])){const u=t.getPreviousSibling();if(!u||!As(u))return;const m=u.getChildren(),p=m[m.length-1];if(!p||!_a(p))return;p.getChildren().forEach(x=>{dr(x)&&x.toggleHeaderStyle(Ml.ROW)}),t.remove();return}const r=sd(n[0]);if(r==null)return;const a=[r];let l=t.getPreviousSibling(),i=r.length;for(;l&&!(!$m(l)||l.getChildrenSize()!==1);){const u=l.getFirstChild();if(!oo(u))break;const m=sd(u.getTextContent());if(m==null)break;i=Math.max(i,m.length),a.unshift(m);const p=l.getPreviousSibling();l.remove(),l=p}const c=Yg();for(const u of a){const m=Qg();c.append(m);for(let p=0;p<i;p++)m.append(p<u.length?u[p]:Ep(""))}const d=t.getPreviousSibling();As(d)&&Iv(d)===i?(d.append(...c.getChildren()),t.remove()):t.replace(c),c.selectEnd()},type:"element"};function Iv(t){const s=t.getFirstChild();return _a(s)?s.getChildrenSize():0}const Ep=t=>{t=t.replace(/\\n/g,`
`);const s=t0(Ml.NO_STATUS);return _m(t,Ea,s),s},sd=t=>{const s=t.match(Lp);return!s||!s[1]?null:s[1].split("|").map(n=>Ep(n))},Ea=[_v,Nv,kv,$v,Gg,...Jg,...Xg,...Zg],nd=()=>{let t=document.getElementById("report-container");return t===null&&(t=document.createElement("div"),t.id="report-container",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.fontSize="32px",t.style.transform="translate(-50%, -50px)",t.style.padding="20px",t.style.background="rgba(240, 240, 240, 0.4)",t.style.borderRadius="20px",document.body&&document.body.appendChild(t)),t};function Lv(){const t=b.useRef(null),s=b.useCallback(()=>{t!==null&&clearTimeout(t.current),document.body&&document.body.removeChild(nd())},[]);return b.useEffect(()=>s,[s]),b.useCallback(n=>{console.log(n);const r=nd();return clearTimeout(t.current),r.innerHTML=n,t.current=setTimeout(s,1e3),t.current},[s])}const Mp=Yt(),Ev={"\n":({selection:t})=>{t.insertParagraph()},redo:({editor:t})=>{t.dispatchCommand(Lm,void 0)},undo:({editor:t})=>{t.dispatchCommand(Im,void 0)}},Ap="SpeechRecognition"in window||"webkitSpeechRecognition"in window;function Mv(){const[t]=He(),[s,n]=b.useState(!1),r=window.SpeechRecognition||window.webkitSpeechRecognition,a=b.useRef(null),l=Lv();return b.useEffect(()=>(s&&a.current===null&&(a.current=new r,a.current.continuous=!0,a.current.interimResults=!0,a.current.addEventListener("result",i=>{const c=i.results.item(i.resultIndex),{transcript:d}=c.item(0);l(d),c.isFinal&&t.update(()=>{const u=We();if(Ke(u)){const m=Ev[d.toLowerCase().trim()];m?m({editor:t,selection:u}):d.match(/\s*\n\s*/)?u.insertParagraph():u.insertText(d)}})})),a.current&&(s?a.current.start():a.current.stop()),()=>{a.current!==null&&a.current.stop()}),[r,t,s,l]),b.useEffect(()=>t.registerCommand(Mp,i=>(n(i),!0),kn),[t]),null}const Av=Ap?Mv:()=>null,Z={editorScroller:"min-h-[150px] border-0 flex relative outline-0 z-0bh resize-y",viewScroller:"border-0 flex relative outline-0 z-0 resize-none",editorContainer:"relative block rounded-[10px] min-h-[50px]",editorShell:"font-['Proxima_Nova'] font-[400] text-[1rem] text-slate-700 leading-[22.4px]",card:"overflow-hidden p-[12px] shadow-[0px_0px_6px_0px_rgba(0,0,0,0.02),0px_2px_4px_0px_rgba(0,0,0,0.08)]",paragraph:"-ml-8 pl-8 relative",contentEditable:"border-none relative [tab-size:1] outline-none outline-0",quote:"m-0 mb-2 font-['Oswald'] text-[30px] leading-[36px] text-[#2D3E4C] border-l-4 border-[#37576B] pl-4 pb-[12px]",heading:{h1:"font-semibold text-3xl scroll-mt-36 font-display",h2:"font-medium text-xl scroll-mt-36 font-display",h3:"font-medium text-lg scroll-mt-36 font-display",h4:"font-medium scroll-mt-36 font-display",h5:"scroll-mt-36 font-display",h6:"scroll-mt-36 font-display"},text:{bold:"font-[700]",code:"bg-gray-200 px-1 py-0.5 font-mono text-[94%]",italic:"italic",strikethrough:"line-through",subscript:"align-sub text-[0.8em]",superscript:"align-super text-[0.8em]",underline:"underline",underlineStrikethrough:"underline line-through"},blockCursor:"block pointer-events-none absolute content-['']  after:absolute after:-top-[2px] after:w-[20px] after:border-t-[1px_solid_black]",characterLimit:"inline !bg-[#ffbbbb]",layoutContainer:"grid gap-[10px]",layoutItem:"border border-dashed border-slate-300 rounded-lg px-2 py-4 min-w-0 max-w-full",code:"bg-[rgb(240,_242,_245)] font-[Menlo,_Consolas,_Monaco,_monospace] block pl-[52px] pr-[8px] py-[8px] leading-[1.53] text-[13px] m-0 mt-[8px] mb-[8px] [tab-size:2] relative after:content-[attr(data-gutter)] after:absolute after:bg-[#eee] after:left-[0] after:top-[0] after:border-r-[1px_solid_#ccc] after:p-[8px] after:text-[#777] after:whitespace-pre-wrap after:text-right after:min-w-[25px]",codeHighlight:{atrule:"text-[#07a]",attr:"text-[#07a]",boolean:"text-[#905]",builtin:"text-[#690]",cdata:"text-[slategray]",char:"text-[#690]",class:"text-[#dd4a68]","class-name":"text-[#dd4a68]",comment:"text-[slategray]",constant:"text-[#905]",deleted:"text-[#905]",doctype:"text-[slategray]",entity:"text-[#9a6e3a]",function:"text-[#dd4a68]",important:"text-[#e90]",inserted:"text-[#690]",keyword:"text-[#07a]",namespace:"text-[#e90]",number:"text-[#905]",operator:"text-[#9a6e3a]",prolog:"text-[slategray]",property:"text-[#905]",punctuation:"text-[#999]",regex:"text-[#e90]",selector:"text-[#690]",string:"text-[#690]",symbol:"text-[#905]",tag:"text-[#905]",url:"text-[#9a6e3a]",variable:"text-[#e90]"},embedBlock:{base:"select-none",focus:"outline-[2px_solid_rgb(60,_132,_244)]"},hashtag:"bg-[rgba(88,_144,_255,_0.15)] border-b-[1px_solid_rgba(88,_144,_255,_0.3)]",image:"editor-image",indent:"PlaygroundEditorTheme__indent",inlineImage:"inline-editor-image",link:"text-[rgb(33,111,219)] no-underline inline-block hover:underline hover:cursor-pointer",list:{listitem:"mx-[32px]",listitemChecked:"PlaygroundEditorTheme__listItemChecked",listitemUnchecked:"PlaygroundEditorTheme__listItemUnchecked",nested:{listitem:"list-none before:hidden after:hidden"},olDepth:["list-inside list-decimal m-0 p-0 ","m-0 p-0 list-inside list-alpha","m-0 p-0 list-inside list-lower-alpha","m-0 p-0 list-inside list-upper-roman","m-0 p-0 list-inside list-lower-roman"],ul:"m-0 p-0 list-inside list-disc"},token:{comment:"text-slate-500",punctuation:"text-gray-400",property:"text-[#905]",selector:"text-[#690]",operator:"text-[#9a6e3a]",attr:"text-[#07a]",variable:"text-[#e90]",function:"text-[#dd4a68]"},ltr:"text-left",mark:{base:"bg-[rgba(255, 212, 0, 0.14)] border-b-2 border-[rgba(255, 212, 0, 0.3)] pb-0.5",selected:"bg-[rgba(255, 212, 0, 0.5)] border-b-2 border-[rgba(255, 212, 0, 1)]"},markOverlap:{base:"bg-[rgba(255,212,0,0.3)] border-b-2 border-b-[rgba(255,212,0,0.7)]",selected:"bg-[rgba(255,212,0,0.7)] border-b-2 border-b-[rgba(255,212,0,0.7)]"},rtl:"text-right",table:"border-collapse border-spacing-0 max-w-full overflow-y-scroll table-fixed w-[calc(100%-25px)] my-7",tableAddColumns:"relative top-0 w-[20px] bg-gray-200 h-full right-0 animate-[table-controls_0.2s_ease] border-0 cursor-pointer hover:bg-[#c9dbf0] after:content-[''] after:absolute after:top-0 after:left-0 after:w-full after:h-full after:bg-[url(/images/icons/plus.svg)] after:bg-center after:bg-no-repeat after:bg-contain after:opacity-40",tableAddRows:"absolute bottom-[-25px] w-[calc(100%-25px)] bg-gray-200 h-[20px] left-0 animate-[table-controls_0.2s_ease] border-0 cursor-pointer hover:bg-[#c9dbf0] after:content-[''] after:absolute after:top-0 after:left-0 after:w-full after:h-full after:bg-[url(/images/icons/plus.svg)] after:bg-center after:bg-no-repeat after:bg-contain after:opacity-40",tableCell:"border border-gray-400 min-w-[75px] align-top text-left px-2 py-[6px] relative cursor-default outline-none",tableCellActionButton:"bg-gray-200 block border-0 rounded-full w-5 h-5 text-gray-900 cursor-pointer hover:bg-gray-300",tableCellActionButtonContainer:"block absolute right-1 top-1.5 z-40 w-5 h-5",tableCellEditing:"shadow-[0_0_5px_rgba(0,0,0,0.4)] rounded-[3px]",tableCellHeader:"bg-[#f2f3f5] text-left",tableCellPrimarySelected:"border-2 border-[rgb(60,132,244)] absolute h-[calc(100%-2px)] w-[calc(100%-2px)] left-[-1px] top-[-1px] z-2",tableCellResizer:"absolute right-[-4px] h-full w-[8px] cursor-ew-resize z-10 top-0",tableCellSelected:"bg-[#c9dbf0]",tableCellSortedIndicator:"block opacity-50 absolute bottom-0 left-0 w-full h-[4px] bg-[#999]",tableResizeRuler:"block absolute w-[1px] bg-[rgb(60,132,244)] h-full top-0",tableSelected:"outline outline-2 outline-[rgb(60,132,244)]",charLimit:"inline bg-[#ffbbbb] !important",editorEditTreeView:"rounded-none",editorViewContainer:"relative block rounded-[10px]",editorViewTreeView:"rounded-none",editorPlanText:"rounded-t-[10px]",testRecorderOutput:"my-5 mx-auto w-full",treeViewOutput:"block bg-gray-900 text-white p-0 text-xs my-[1px] mx-auto mb-[10px] relative overflow-hidden rounded-lg",editorDevButton:{base:"relative block w-10 h-10 text-xs rounded-[20px] border-none cursor-pointer outline-none shadow-[0px_1px_10px_rgba(0,0,0,0.3)] bg-gray-700 hover:bg-gray-600 after:content-[''] after:absolute after:top-[10px] after:right-[10px] after:bottom-[10px] after:left-[10px] after:block after:bg-contain after:filter invert",active:"bg-red-600"},testRecorderToolbar:"flex",testRecorderButton:{base:"relative block w-8 h-8 text-xs p-[6px] rounded-md border-none cursor-pointer outline-none shadow-md bg-gray-800 transition-shadow duration-75 ease-out after:content-[''] after:absolute after:top-2 after:right-2 after:bottom-2 after:left-2 after:block after:bg-contain after:filter-invert",active:"shadow-lg"},componentPickerMenu:"w-[200px]",mentionsMenu:"w-[250px]",autoEmbedMenu:"w-[150px]",emojiMenu:"w-[200px]",icon:{plus:"bg-[url(/images/icons/plus.svg)]",caretRight:"bg-[url(/images/icons/caret-right-fill.svg)]",columns:"bg-[url(/images/icons/3-columns.svg)]",dropdownMore:"bg-[url(/images/icons/dropdown-more.svg)]",fontColor:"bg-[url(/images/icons/font-color.svg)]",fontFamily:"bg-[url(/images/icons/font-family.svg)]",bgColor:"bg-[url(/images/icons/bg-color.svg)]",table:"bg-[#6c757d] bg-[url(/images/icons/table.svg)]  mask-[url(/images/icons/table.svg)] mask-no-repeat mask-size-contain",paragraph:"bg-[url(/images/icons/text-paragraph.svg)]",h1:"bg-[url(/images/icons/type-h1.svg)]",h2:"bg-[url(/images/icons/type-h2.svg)]",h3:"bg-[url(/images/icons/type-h3.svg)]",h4:"bg-[url(/images/icons/type-h4.svg)]",h5:"bg-[url(/images/icons/type-h5.svg)]",h6:"bg-[url(/images/icons/type-h6.svg)]",bulletList:"bg-[url(/images/icons/list-ul.svg)]",bullet:"bg-[url(/images/icons/list-ul.svg)]",checkList:"bg-[url(/images/icons/square-check.svg)]",check:"bg-[url(/images/icons/square-check.svg)]",numberedList:"bg-[url(/images/icons/list-ol.svg)]",number:"bg-[url(/images/icons/list-ol.svg)]",quote:"bg-[url(/images/icons/chat-square-quote.svg)]",code:"bg-[url(/images/icons/code.svg)]",strikethrough:"bg-[url(/images/icons/type-strikethrough.svg)]",subscript:"bg-[url(/images/icons/type-subscript.svg)]",superscript:"bg-[url(/images/icons/type-superscript.svg)]",palette:"bg-[url(/images/icons/palette.svg)]",bucket:"bg-[url(/images/icons/paint-bucket.svg)]",bold:"bg-[url(/images/icons/type-bold.svg)]",italic:"bg-[url(/images/icons/type-italic.svg)]",clear:"bg-[url(/images/icons/trash.svg)]",underline:"bg-[url(/images/icons/type-underline.svg)]",link:"bg-[url(/images/icons/link.svg)]",horizontalRule:"bg-[url(/images/icons/horizontal-rule.svg)]",centerAlign:"bg-[url(/images/icons/text-center.svg)]",rightAlign:"bg-[url(/images/icons/text-right.svg)]",justifyAlign:"bg-[url(/images/icons/justify.svg)]",indent:"bg-[url(/images/icons/indent.svg)]",markdown:"bg-[url(/images/icons/markdown.svg)]",outdent:"bg-[url(/images/icons/outdent.svg)]",undo:"bg-[url(/images/icons/arrow-counterclockwise.svg)]",redo:"bg-[url(/images/icons/arrow-clockwise.svg)]",sticky:"bg-[url(/images/icons/sticky.svg)]",mic:"bg-[url(/images/icons/mic.svg)]",import:"bg-[url(/images/icons/upload.svg)]",export:"bg-[url(/images/icons/download.svg)]",diagram2:"bg-[url(/images/icons/diagram-2.svg)]",user:"bg-[url(/images/icons/user.svg)]",equation:"bg-[url(/images/icons/plus-slash-minus.svg)]",gif:"bg-[url(/images/icons/filetype-gif.svg)]",copy:"bg-[url(/images/icons/copy.svg)]",success:"bg-[url(/images/icons/success.svg)]",prettier:"bg-[url(/images/icons/prettier.svg)]",prettierError:"bg-[url(/images/icons/prettier-error.svg)]",image:"bg-[url(/images/icons/file-image.svg)]",close:"bg-[url(/images/icons/close.svg)]",figma:"bg-[url(/images/icons/figma.svg)]",poll:"bg-[url(/images/icons/card-checklist.svg)]",tweet:"bg-[url(/images/icons/tweet.svg)]",youtube:"bg-[url(/images/icons/youtube.svg)]",leftAlign:"bg-[url(/images/icons/text-left.svg)]"},iconChevronDown:"bg-transparent bg-contain inline-block h-[8px] w-[8px] bg-[url(/images/icons/chevron-down.svg)]",switch:{base:"block text-gray-700 my-[5px] bg-gray-200 bg-opacity-70 py-[5px] px-[10px] rounded-lg",richTextSwitch:"absolute right-0",characterCountSwitch:"absolute right-[130px]",label:"mr-1 line-height-[24px] w-[100px] text-[14px] inline-block align-middle",button:"bg-[rgb(206,208,212)] h-[24px] box-border rounded-[12px] w-[44px] inline-block align-middle relative outline-none cursor-pointer transition-colors duration-[100ms] border-[2px] border-transparent focus-visible:border-blue-500",buttonSpan:"absolute top-0 left-0 block w-[20px] h-[20px] rounded-[12px] bg-white transition-transform duration-[200ms]",buttonChecked:"bg-[rgb(24,119,242)]",buttonCheckedSpan:"translate-x-[20px]"},linkEditor:{base:"flex absolute top-0 left-0 z-10 max-w-[400px] w-full opacity-0 bg-white shadow-lg rounded-b-lg transition-opacity duration-500 will-change-transform",button:{active:"bg-[rgb(223,232,250)]",base:"w-[20px] h-[20px] inline-block p-[6px] rounded-lg cursor-pointer mx-[2px]",hovered:"w-[20px] h-[20px] inline-block bg-gray-200",i:"bg-contain inline-block h-[20px] w-[20px] align-middle"},linkInput:{base:"block w-[calc(100%-75px)] box-border m-3 p-2 rounded-[15px] bg-[#eee] text-[15px] text-[rgb(5,5,5)] border-0 outline-0 relative font-inherit",a:"text-[rgb(33,111,219)] underline whitespace-nowrap overflow-hidden mr-[30px] overflow-ellipsis hover:underline"},linkView:{base:"block w-[calc(100%-24px)] m-2 p-2 rounded-[15px] text-[15px] text-[rgb(5,5,5)] border-0 outline-0 relative font-inherit",a:"block break-words w-[calc(100%-33px)]"},div:{linkEdit:"bg-[url(/images/icons/pencil-fill.svg)] bg-[length:16px] bg-center bg-no-repeat w-[35px] align-middle absolute right-[30px] top-0 bottom-0 cursor-pointer",linkTrash:"bg-[url(/images/icons/trash.svg)] bg-[length:16px] bg-center bg-no-repeat w-[35px] align-middle absolute right-0 top-0 bottom-0 cursor-pointer",linkCancel:"bg-[url(/images/icons/close.svg)] bg-[length:16px] bg-center bg-no-repeat w-[35px] align-middle absolute right-0 top-0 bottom-0 cursor-pointer mr-[28px]",linkConfirm:"bg-[url(/images/icons/success-alt.svg)] bg-[length:16px] bg-center bg-no-repeat w-[35px] align-middle absolute right-0 top-0 bottom-0 cursor-pointer mr-[2px]"},fontSizeWrapper:"flex mx-[4px]",fontFamilyWrapper:"flex mx-[4px]",select:"p-[6px] border-0 bg-[rgba(0,0,0,0.075)] rounded-[4px]",buttonHovered:"w-5 h-5 inline-block bg-gray-200",icon:"bg-contain inline-block h-5 w-5 align-middle"},mention:{focus:"shadow-[0_0_0_2px_rgb(180,213,255)] outline-none"},blockControls:{base:"absolute right-2 top-4 w-8 h-8 box-border shadow-md z-10 rounded-lg border border-gray-300 overflow-hidden",button:{base:"border border-white bg-white block transition-colors duration-100 ease-in cursor-pointer outline-none rounded-lg p-1 hover:bg-gray-200",focusVisible:"focus-visible:border-blue-500"},span:{base:"block w-[18px] h-[18px] m-[2px] bg-contain",paragraph:"bg-[url(/images/icons/text-paragraph.svg)]",h1:"bg-[url(/images/icons/type-h1.svg)]",h2:"bg-[url(/images/icons/type-h2.svg)]",quote:"bg-[url(/images/icons/chat-square-quote.svg)]",ul:"bg-[url(/images/icons/list-ul.svg)]",ol:"bg-[url(/images/icons/list-ol.svg)]",code:"bg-[url(/images/icons/code.svg)]"}},charactersLimit:{base:"text-gray-400 text-xs text-right block absolute left-3 bottom-1",exceeded:"text-red-500"},dropdown:{base:"z-10 block fixed shadow-lg rounded-[8px] min-h-[40px] bg-white",item:{base:"m-0 mx-2 p-2 text-[#050505] cursor-pointer leading-4 text-[15px] flex items-center flex-row flex-shrink-0 justify-between bg-white rounded-lg border-0 max-w-[250px] min-w-[100px] hover:bg-gray-200",fontSizeItem:"min-w-unset",fontSizeText:"min-w-unset",active:"flex w-5 h-5 bg-contain",firstChild:"mt-2",lastChild:"mb-2",text:"flex leading-5 flex-grow min-w-[150px]",icon:"flex w-5 h-5 select-none mr-3 leading-4 bg-contain bg-center bg-no-repeat"},divider:"w-auto bg-gray-200 my-1 h-[1px] mx-2"},switchbase:"block text-gray-700 my-1 bg-[rgba(238,_238,_238,_0.7)] p-1 px-[10px] rounded-lg",switchlabel:"mr-1 leading-6 w-[100px] text-sm inline-block align-middle",switchbutton:"bg-gray-300 h-[24px] box-border rounded-full w-[44px] inline-block align-middle relative outline-none cursor-pointer transition-colors duration-100 border-2 border-transparent",switchbuttonFocus:"focus-visible:border-blue-500",switchbuttonSpan:"absolute top-0 left-0 block w-[20px] h-[20px] rounded-full bg-white transition-transform duration-200",switchbuttonChecked:"bg-blue-600",switchbuttonCheckedSpan:"translate-x-[20px]",editor:{base:"flex-auto relative resize-y z-negative",image:{base:"inline-block relative cursor-default select-none",img:{base:"max-w-full cursor-default",focused:"outline outline-2 outline-blue-600",draggable:{base:"cursor-grab",active:"cursor-grabbing"}},captionContainer:"block absolute bottom-1 left-0 right-0 p-0 m-0 border-t border-white bg-opacity-90 bg-white min-w-[100px] text-black overflow-hidden",captionButton:"block absolute bottom-5 left-0 right-0 w-[30%] mx-auto p-2 border border-white/30 rounded bg-black bg-opacity-50 min-w-[100px] text-white cursor-pointer select-none hover:bg-blue-500",resizer:{base:"block w-[7px] h-[7px] absolute bg-blue-600 border border-white",n:"z-[10] top-[-6px] left-[48%] cursor-n-resize",ne:"z-[10] top-[-6px] right-[-6px] cursor-ne-resize",e:"z-[10] bottom-[48%] right-[-6px] cursor-e-resize",se:"z-[10] bottom-[-2px] right-[-6px] cursor-se-resize",s:"z-[10] bottom-[-2px] left-[48%] cursor-s-resize",sw:"z-[10] bottom-[-2px] left-[-6px] cursor-sw-resize",w:"z-[10] bottom-[48%] left-[-6px] cursor-w-resize",nw:"z-[10] top-[-6px] left-[-6px] cursor-nw-resize"}},inlineImage:{base:"inline-block relative z-10 cursor-default select-none",img:{base:"cursor-default",focused:"outline outline-2 outline-blue-600",draggable:{base:"cursor-grab",active:"cursor-grabbing"}},captionContainer:"block bg-gray-200 min-w-full text-black overflow-hidden",editButton:{base:"block absolute top-3 right-3 py-[6px] px-[8px] border border-white/30 rounded-md bg-black/50 min-w-[60px] text-white cursor-pointer select-none hover:bg-blue-500",hide:"hidden"},position:{full:"my-4",left:"float-left w-fit mx-1 mb-0",right:"float-right w-fit mb-0 mx-1"},resizer:{base:"block w-[7px] h-[7px] absolute bg-blue-600 border border-white",n:"top-[-6px] left-[48%] cursor-n-resize",ne:"top-[-6px] right-[-6px] cursor-ne-resize",e:"bottom-[48%] right-[-6px] cursor-e-resize",se:"bottom-[-2px] right-[-6px] cursor-se-resize",s:"bottom-[-2px] left-[48%] cursor-s-resize",sw:"bottom-[-2px] left-[-6px] cursor-sw-resize",w:"bottom-[48%] left-[-6px] cursor-w-resize",nw:"top-[-6px] left-[-6px] cursor-nw-resize"}}},keyword:"text-[#f1765e] font-bold",tableDisableCell:{disableSelection:{base:"",selectedSpan:"bg-transparent",selectedBr:"bg-transparent"}},cellActionButtonContainer:"absolute top-0 left-0 will-change-transform",cellActionButton:"bg-none flex justify-center items-center border-0 relative rounded-[15px] text-[#222] inline-block cursor-pointer",actionButton:{base:"bg-[#eee] border-0 px-3 py-2 relative ml-[5px] rounded-[15px] text-[#222] inline-block cursor-pointer hover:bg-[#ddd] hover:text-black",disabled:"g-gray-200 cursor-not-allowed opacity-60"},typeaheadPopover:{base:"bg-white shadow-[0_5px_10px_rgba(0,0,0,0.3)] rounded-[8px] mt-[25px]",ul:{base:"p-0 list-none m-0 rounded-[8px] max-h-[200px] overflow-y-scroll scrollbar-none",li:{base:"m-0 min-w-[180px] text-[14px] outline-none cursor-pointer rounded-[8px] hover:bg-gray-200",selected:"bg-gray-200",item:"p-[8px] text-[#050505] cursor-pointer leading-[16px] text-[15px] flex items-center shrink-0 rounded-[8px] border-0",active:"flex w-[20px] h-[20px] bg-contain",firstChild:"rounded-t-[8px]",lastChild:"rounded-b-[8px]",hover:"bg-gray-200",text:"flex items-center leading-[20px] grow min-w-[150px]",icon:"flex w-[20px] h-[20px] select-none mr-[8px] leading-[16px] bg-contain bg-no-repeat bg-center"}},li:"m-0 mx-2 p-2 text-[#050505] cursor-pointer leading-4 text-[15px] flex items-center flex-row flex-shrink-0 bg-white rounded-lg border-0"},debugTimetravelPanel:{base:"overflow-hidden p-0 pb-2.5 m-auto flex",slider:"p-0 flex-[8]",button:"p-0 border-0 bg-none flex-[1] text-white text-xs hover:underline"},debugTimetravelButton:"absolute top-2.5 right-3 border-0 p-0 text-xs text-white bg-transparent hover:underline",debugTreetypeButton:"absolute top-2.5 right-[85px] border-0 p-0 text-xs text-white bg-transparent hover:underline",connecting:"absolute top-2.5 left-2.5 text-[15px] text-gray-400 overflow-hidden text-ellipsis whitespace-nowrap pointer-events-none",toolbar:{base:"flex flex-wrap h-fit overflow-hidden mb[1px] p-1 rounded-tl-lg rounded-tr-lg sticky top-0 z-20 items-center",toolbarItem:{base:"border-0 flex bg-none rounded-lg p-2 cursor-pointer align-middle flex-shrink-0 items-center justify-between hover:bg-gray-200",disabled:{base:"cursor-not-allowed",icon:"opacity-20",text:"opacity-20",iconFormat:"opacity-60",chevronDown:"opacity-20"},spaced:"mr-2",iconFormat:"flex h-[18px] w-[18px] opacity-60 custom-vertical-align",active:{base:"bg-[rgba(223,232,250,0.3)]",i:"opacity-100"},fontFamilyText:"block max-w-[10rem]",text:"flex leading-[20px] custom-vertical-align text-[14px] text-gray-500 truncate overflow-hidden h-[20px] text-left pr-[10px]",icon:"flex w-5 h-5 select-none mr-2 leading-4 bg-contain"},codeLanguage:"w-[150px]",chevronDownIcon:"mt-1 w-4 h-4 flex select-none",chevronDownIconInside:"w-4 h-4 flex ml-6 mt-2.5 mr-2 pointer-events-none",divider:"w-[1px] bg-[#eee] mx-[4px] h-[35px]"},stickyNoteContainer:{base:"absolute z-9 w-[120px] inline-block",dragging:"transition-none"},stickyNote:{base:"relative block cursor-move text-left w-[120px] m-6 p-[20px] border border-[#e8e8e8] font-[Reenie_Beanie] text-[24px] rounded-br-[60px]",contentEditable:"min-h-[20px] border-0 resize-none cursor-text text-[24px] caret-black block relative tab-[1] outline-none p-[10px] select-text whitespace-pre-wrap break-words",placeholder:"text-[24px] text-gray-500 overflow-hidden absolute truncate top-[30px] left-[20px] w-[120px] select-none whitespace-nowrap inline-block pointer-events-none",after:"absolute z-[-1] right-0 bottom-[20px] w-[120px] h-[25px] bg-black/20 shadow-[2px_15px_5px_rgba(0,0,0,0.4)] transform -scale-x-100",yellow:"border-t border-[#fdfd86] bg-gradient-to-br from-[#ffff88] to-[#ffffc6]",pink:"border-t border-[#e7d1e4] bg-gradient-to-br from-[#f7cbe8] to-[#e7bfe1]",div:"cursor-text",delete:"absolute top-[8px] right-[10px] text-[10px] border-0 bg-none cursor-pointer opacity-50 hover:font-bold hover:opacity-100",color:"absolute top-[8px] right-[25px] border-0 bg-none opacity-50 hover:opacity-100",colorIcon:"block w-[12px] h-[12px] bg-contain"},excalidrawButton:{base:"border-0 p-0 m-0 bg-transparent",selected:"outline outline-2 outline-[rgb(60,132,244)] user-select-none"},hr:{base:"p-[2px] border-none my-4 cursor-pointer relative",after:"absolute left-0 right-0 h-[2px] bg-[#ccc] leading-[2px]",selected:"outline-[2px] outline-solid outline-[#3c84f4] select-none"},spacer:"tracking[-2px]",editorEquation:{base:"cursor-default select-none",focused:"outline-2 outline-solid outline-[#3c84f4]"},buttonItemIcon:"opacity-60",dropdownItemActive:"bg-[#dfe8fa4d]",dropdownItemActiveIcon:"opacity-100",tableNodeContentEditable:"min-h-[20px] border-0 resize-none cursor-text block relative tab-size-1 outline-0 p-0 select-text text-[15px] whitespace-pre-wrap break-words z-3",nestable:{base:"relative",list:"p-0 list-none",listDirectChild:"p-0",item:"m-0",itemFirstChild:"mt-0",itemList:"mt-0",isDragging:{list:"pointer-events-none",allElements:"opacity-0",before:"absolute inset-0 rounded-md"},itemIcon:"mr-1 cursor-pointer",dragLayer:"fixed top-0 left-0 z-[100] pointer-events-none",dragLayerList:"absolute top-0 left-0 p-0",icon:{base:"relative inline-block w-5 h-5 bg-transparent bg-center bg-no-repeat",before:"hidden"},iconPlusGray:'w-5 h-5 bg-[url("./icon-plus-gray.svg")]',iconMinusGray:'w-5 h-5 bg-[url("./icon-minus-gray.svg")]'},draggableBlockMenu:{base:"rounded-md p-0.5 cursor-grab opacity-0 absolute -left-8 top-0 will-change-transform hover:bg-gray-200",icon:"w-4 h-4 opacity-30 bg-[url(/images/icons/draggable-block-menu.svg)]",active:"cursor-grabbing"},draggableBlockTargetLine:{base:"pointer-events-none bg-blue-500 h-1 absolute left-0 top-0 opacity-0 will-change-transform"},floatingTextFormatPopup:{base:"flex bg-white p-1 align-middle absolute top-0 left-0 z-10 opacity-0 shadow-md rounded-lg transition-opacity duration-500 h-11 will-change-transform",popupItem:{base:"border-0 flex bg-transparent rounded-lg p-2 cursor-pointer align-middle",disabled:"cursor-not-allowed",spaced:"mr-[2px]",icon:"bg-contain inline-block h-[18px] w-[18px] mt-[2px] flex opacity-60",disabledIcon:"opacity-20",active:"bg-[rgba(223,232,250,0.3)]",activeIcon:"opacity-100",hover:"hover:bg-gray-200"},select:{base:"border-0 flex bg-transparent rounded-lg p-2 w-18 text-sm text-gray-500 truncate appearance-none",codeLanguage:"capitalize w-32"},text:"flex items-center text-[14px] text-gray-500 leading-[20px] w-[70px] h-[20px] overflow-hidden text-left truncate",icon:"flex w-5 h-5 select-none mr-2 leading-4 bg-contain",chevronDown:"mt-0.75 w-4 h-4 flex select-none",chevronInside:"w-4 h-4 flex ml-[-6.25rem] mt-[11px] mr-[10px] pointer-events-none",divider:"w-px bg-gray-200 mx-1",insertComment:"hidden md:block"},collapsible:{container:"bg-[#fcfcfc] border border-gray-200 rounded-lg mb-2",containerOpen:"bg-transparent border-none",title:"scroll-mt-24 cursor-pointer p-1.25 pl-5 relative font-bold list-none outline-none",titleBefore:"absolute left-1.75 top-1/2 transform -translate-y-1/2 border border-solid border-transparent border-l-black border-t-[4px] border-b-[4px] border-l-[6px] border-r-[6px]",titleBeforeClosed:"border-[0.25rem_0.375rem_0.25rem_0.375rem]",titleBeforeOpen:"border-[0.375rem_0.25rem_0_0.25rem] border-t-black bg-transparent",content:"p-0 pl-5 pb-[5px]",collapsedContent:"hidden select-none"},tableOfContents:{container:"fixed top-52 right-[-35px] p-[10px] w-[250px] flex flex-row justify-start z-10 h-[300px] text-[#65676b]",headings:"list-none mt-0 ml-[10px] p-0 overflow-scroll w-[200px] h-[220px] overflow-x-hidden overflow-y-auto scrollbar-hide",heading1:"text-black font-bold cursor-pointer",heading2:"ml-[10px]",heading3:"ml-5",normalHeading:"cursor-pointer leading-5 text-base",selectedHeading:"text-[#3578e5] relative",selectedHeadingWrapper:"relative",selectedHeadingBefore:"absolute inline-block left-[-30px] top-1 z-10 h-1 w-1 bg-[#3578e5] border-4 border-white rounded-full",normalHeadingWrapper:"ml-8 relative"},imageNode:{contentEditable:"min-h-[20px] border-0 resize-none cursor-text caret-[#050505] block relative tab-[1] outline-0 p-[10px] select-text text-[12px] w-[calc(100%-20px)] whitespace-pre-wrap break-words",placeholder:"text-[12px] text-gray-500 overflow-hidden absolute text-ellipsis top-[10px] left-[10px] select-none whitespace-nowrap inline-block pointer-events-none"},imageControlWrapperResizing:"touch-none",actions:{base:"absolute text-right m-[10px] bottom-0 right-0",treeView:"rounded-bl-none rounded-br-none",i:{base:"bg-contain inline-block h-[15px] w-[15px] align-[-0.25em]",indent:"bg-[url(/images/icons/indent.svg)]",outdent:"bg-[url(/images/icons/outdent.svg)]",lock:"bg-[url(/images/icons/lock-fill.svg)]",unlock:"bg-[url(/images/icons/lock.svg)]",image:"bg-[url(/images/icons/file-image.svg)]",table:"bg-[url(/images/icons/table.svg)]",leftAlign:"bg-[url(/images/icons/text-left.svg)]",centerAlign:"bg-[url(/images/icons/text-center.svg)]",rightAlign:"bg-[url(/images/icons/text-right.svg)]",justifyAlign:"bg-[url(/images/icons/justify.svg)]",disconnect:"bg-[url(/images/icons/plug.svg)]",connect:"bg-[url(/images/icons/plug-fill.svg)]"}}};async function Tv(t){const s=JSON.stringify(t.getEditorState());try{await fetch("http://localhost:1235/setEditorState",{body:s,headers:{Accept:"application/json","Content-type":"application/json"},method:"POST"})}catch{}}async function Ov(t){const s=JSON.stringify(t.getEditorState());let n=null;try{n=await fetch("http://localhost:1235/validateEditorState",{body:s,headers:{Accept:"application/json","Content-type":"application/json"},method:"POST"})}catch{}if(n!==null&&n.status===403)throw new Error("Editor state validation failed! Server did not accept changes.")}function Dv({isRichText:t}){const[s]=He(),[n,r]=b.useState(()=>s.isEditable()),[a,l]=b.useState(!1),[i,c]=b.useState(!1),[d,u]=b.useState(!0),[m,p]=Mr(),{isCollabActive:x}=s0();b.useEffect(()=>s.registerUpdateListener(({dirtyElements:f,prevEditorState:g,tags:y})=>{!n&&f.size>0&&!y.has("historic")&&!y.has("collaboration")&&Ov(s),s.getEditorState().read(()=>{const j=Al().getChildren();if(j.length>1)u(!1);else if($m(j[0])){const N=j[0].getChildren();u(N.length===0)}else u(!1)})}),[s,n]);const h=b.useCallback(()=>{s.update(()=>{const f=Al(),g=f.getFirstChild();if(Tl(g)&&g.getLanguage()==="markdown")_m(g.getTextContent(),Ea);else{const y=Sm(Ea);f.clear().append(ur("markdown").append(wi(y)))}f.selectEnd()})},[s]);return e.jsxs("div",{className:`${Z.actions.base}`||"actions",children:[Ap&&e.jsx("button",{onClick:()=>{s.dispatchCommand(Mp,!a),l(!a)},className:`${Z.actionButton} action-button-mic `+(a?"active":""),title:"Speech To Text","aria-label":`${a?"Enable":"Disable"} speech to text`,children:e.jsx("i",{className:"mic"})}),e.jsx("button",{className:`${Z.actionButton.base} import`,onClick:()=>n0(s),title:"Import","aria-label":"Import editor state from JSON",children:e.jsx("i",{className:Z.icon.import||"import"})}),e.jsx("button",{className:`${Z.actionButton.base} export`,onClick:()=>r0(s,{fileName:`Playground ${new Date().toISOString()}`,source:"Playground"}),title:"Export","aria-label":"Export editor state to JSON",children:e.jsx("i",{className:Z.icon.export||"export"})}),e.jsx("button",{className:`${Z.actionButton.base} clear`,disabled:d,onClick:()=>{p("Clear editor",f=>e.jsx(Bv,{editor:s,onClose:f}))},title:"Clear","aria-label":"Clear editor contents",children:e.jsx("i",{className:Z.icon.clear||"clear"})}),e.jsx("button",{className:`${Z.actionButton.base} ${n?"lock":"unlock"}`,onClick:()=>{n&&Tv(s),s.setEditable(!s.isEditable())},title:"Read-Only Mode","aria-label":`${n?"Lock":"Unlock"} read-only mode`,children:e.jsx("i",{className:n?"lock":"unlock"})}),e.jsx("button",{className:`${Z.actionButton.base}`,onClick:h,title:"Convert From Markdown","aria-label":"Convert from markdown",children:e.jsx("i",{className:Z.icon.markdown})}),m]})}function Bv({editor:t,onClose:s}){return e.jsxs(e.Fragment,{children:["Are you sure you want to clear the editor?",e.jsxs("div",{className:"Modal__content",children:[e.jsx(Vs,{onClick:()=>{t.dispatchCommand(a0,void 0),t.focus(),s()},children:"Clear"})," ",e.jsx(Vs,{onClick:()=>{t.focus(),s()},children:"Cancel"})]})]})}const Fv=b.createContext([t=>()=>t,t=>t]),Tp=()=>{const[t,s]=b.useContext(Fv),[n,r]=b.useState(null);return b.useEffect(()=>t(a=>{r(a)}),[t]),[n,s]};class Tr extends ao{static clone(s){return new Tr(s.__key)}static getType(){return"autocomplete"}static importJSON(s){return Op(s.uuid)}exportJSON(){return{...super.exportJSON(),type:"autocomplete",uuid:this.__uuid,version:1}}constructor(s,n){super(n),this.__uuid=s}updateDOM(){return!1}createDOM(){return document.createElement("span")}decorate(){return this.__uuid!==Rl?null:e.jsx(zv,{})}}function Op(t){return new Tr(t)}function zv(){const[t]=Tp(),s=window.navigator.userAgentData,n=s!==void 0?s.mobile:window.innerWidth<=800&&window.innerHeight<=600;return e.jsxs("span",{style:{color:"#ccc"},spellCheck:"false",children:[t," ",n?"(SWIPE )":"(TAB)"]})}const Ma=new WeakMap;function rd(t){const s=t.changedTouches[0];return s===void 0?null:[s.clientX,s.clientY]}function Pv(t,s){let n=Ma.get(t);if(n===void 0){const r=new Set,a=i=>{n!==void 0&&(n.start=rd(i))},l=i=>{if(n===void 0)return;const c=n.start;if(c===null)return;const d=rd(i);for(const u of r)d!==null&&u([d[0]-c[0],d[1]-c[1]],i)};t.addEventListener("touchstart",a),t.addEventListener("touchend",l),n={handleTouchend:l,handleTouchstart:a,listeners:r,start:null},Ma.set(t,n)}return n.listeners.add(s),()=>Rv(t,s)}function Rv(t,s){const n=Ma.get(t);if(n===void 0)return;const r=n.listeners;r.delete(s),r.size===0&&(Ma.delete(t),t.removeEventListener("touchstart",n.handleTouchstart),t.removeEventListener("touchend",n.handleTouchend))}function Hv(t,s){return Pv(t,(n,r)=>{const[a,l]=n;a>0&&a>Math.abs(l)&&s(a,r)})}const Rl=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5);function ad(t){if(!Ke(t)||!t.isCollapsed())return[!1,""];const s=t.getNodes()[0],n=t.anchor;if(!oo(s)||!s.isSimpleText()||!Ol(n))return[!1,""];const r=[],a=s.getTextContent();let l=s.getTextContentSize(),i;for(;l--&&l>=0&&(i=a[l])!==" ";)r.push(i);return r.length===0?[!1,""]:[!0,r.reverse().join("")]}function Wv(){return b.useCallback(t=>{const s=new Uv;console.time("query");const n=s.query(t);return console.timeEnd("query"),n},[])}function Vv(){const[t]=He(),[,s]=Tp(),n=Wv();return b.useEffect(()=>{let r=null,a=null,l=null,i=null;function c(){const y=r!==null?$n(r):null;y!==null&&y.isAttached()&&(y.remove(),r=null),i!==null&&(i.dismiss(),i=null),a=null,l=null,s(null)}function d(y,v){i!==y||v===null||t.update(()=>{const j=We(),[N,S]=ad(j);if(!N||S!==a||!Ke(j))return;const w=j.clone(),k=Op(Rl);r=k.getKey(),j.insertNodes([k]),ji(w),l=v,s(v)},{tag:"history-merge"})}function u(y){const v=y.getKey();y.__uuid===Rl&&v!==r&&c()}function m(){t.update(()=>{const y=We(),[v,j]=ad(y);if(!v){c();return}j!==a&&(c(),i=n(j),i.promise.then(N=>{i!==null&&d(i,N)}).catch(N=>{console.error(N)}),a=j)})}function p(){if(l===null||r===null)return!1;const y=$n(r);if(y===null)return!1;const v=wi(l);return y.replace(v),v.selectNext(),c(),!0}function x(y){return p()?(y.preventDefault(),!0):!1}function h(y,v){t.update(()=>{p()&&v.preventDefault()})}function f(){t.update(()=>{c()})}const g=t.getRootElement();return pt(t.registerNodeTransform(Tr,u),t.registerUpdateListener(m),t.registerCommand(o0,x,ut),t.registerCommand(Em,x,ut),...g!==null?[Hv(g,h)]:[],f)},[t,n,s]),null}class Uv{constructor(){this.DATABASE=qv,this.LATENCY=200,this.query=s=>{let n=!1;const r=()=>{n=!0},a=new Promise((l,i)=>{setTimeout(()=>{if(n)return i("Dismissed");const c=s.length;if(s===""||c<4)return l(null);const d=s.charCodeAt(0),u=d>=65&&d<=90,m=u?String.fromCharCode(d+32)+s.substring(1):s,p=this.DATABASE.find(f=>f.startsWith(m)??null);if(p===void 0)return l(null);const h=(u?String.fromCharCode(p.charCodeAt(0)-32)+p.substring(1):p).substring(c);return l(h===""?null:h)},this.LATENCY)});return{dismiss:r,promise:a}}}}const qv=["information","available","copyright","university","management","international","development","education","community","technology","following","resources","including","directory","government","department","description","insurance","different","categories","conditions","accessories","september","questions","application","financial","equipment","performance","experience","important","activities","additional","something","professional","committee","washington","california","reference","companies","computers","president","australia","discussion","entertainment","agreement","marketing","association","collection","solutions","electronics","technical","microsoft","conference","environment","statement","downloads","applications","requirements","individual","subscribe","everything","production","commercial","advertising","treatment","newsletter","knowledge","currently","construction","registered","protection","engineering","published","corporate","customers","materials","countries","standards","political","advertise","environmental","availability","employment","commission","administration","institute","sponsored","electronic","condition","effective","organization","selection","corporation","executive","necessary","according","particular","facilities","opportunities","appropriate","statistics","investment","christmas","registration","furniture","wednesday","structure","distribution","industrial","potential","responsible","communications","associated","foundation","documents","communication","independent","operating","developed","telephone","population","navigation","operations","therefore","christian","understand","publications","worldwide","connection","publisher","introduction","properties","accommodation","excellent","opportunity","assessment","especially","interface","operation","restaurants","beautiful","locations","significant","technologies","manufacturer","providing","authority","considered","programme","enterprise","educational","employees","alternative","processing","responsibility","resolution","publication","relations","photography","components","assistance","completed","organizations","otherwise","transportation","disclaimer","membership","recommended","background","character","maintenance","functions","trademarks","phentermine","submitted","television","interested","throughout","established","programming","regarding","instructions","increased","understanding","beginning","associates","instruments","businesses","specified","restaurant","procedures","relationship","traditional","sometimes","themselves","transport","interesting","evaluation","implementation","galleries","references","presented","literature","respective","definition","secretary","networking","australian","magazines","francisco","individuals","guidelines","installation","described","attention","difference","regulations","certificate","directions","documentation","automotive","successful","communities","situation","publishing","emergency","developing","determine","temperature","announcements","historical","ringtones","difficult","scientific","satellite","particularly","functional","monitoring","architecture","recommend","dictionary","accounting","manufacturing","professor","generally","continued","techniques","permission","generation","component","guarantee","processes","interests","paperback","classifieds","supported","competition","providers","characters","thousands","apartments","generated","administrative","practices","reporting","essential","affiliate","immediately","designated","integrated","configuration","comprehensive","universal","presentation","languages","compliance","improvement","pennsylvania","challenge","acceptance","strategies","affiliates","multimedia","certified","computing","interactive","procedure","leadership","religious","breakfast","developer","approximately","recommendations","comparison","automatically","minnesota","adventure","institutions","assistant","advertisement","headlines","yesterday","determined","wholesale","extension","statements","completely","electrical","applicable","manufacturers","classical","dedicated","direction","basketball","wisconsin","personnel","identified","professionals","advantage","newsletters","estimated","anonymous","miscellaneous","integration","interview","framework","installed","massachusetts","associate","frequently","discussions","laboratory","destination","intelligence","specifications","tripadvisor","residential","decisions","industries","partnership","editorial","expression","provisions","principles","suggestions","replacement","strategic","economics","compatible","apartment","netherlands","consulting","recreation","participants","favorites","translation","estimates","protected","philadelphia","officials","contained","legislation","parameters","relationships","tennessee","representative","frequency","introduced","departments","residents","displayed","performed","administrator","addresses","permanent","agriculture","constitutes","portfolio","practical","delivered","collectibles","infrastructure","exclusive","originally","utilities","philosophy","regulation","reduction","nutrition","recording","secondary","wonderful","announced","prevention","mentioned","automatic","healthcare","maintained","increasing","connected","directors","participation","containing","combination","amendment","guaranteed","libraries","distributed","singapore","enterprises","convention","principal","certification","previously","buildings","household","batteries","positions","subscription","contemporary","panasonic","permalink","signature","provision","certainly","newspaper","liability","trademark","trackback","americans","promotion","conversion","reasonable","broadband","influence","importance","webmaster","prescription","specifically","represent","conservation","louisiana","javascript","marketplace","evolution","certificates","objectives","suggested","concerned","structures","encyclopedia","continuing","interracial","competitive","suppliers","preparation","receiving","accordance","discussed","elizabeth","reservations","playstation","instruction","annotation","differences","establish","expressed","paragraph","mathematics","compensation","conducted","percentage","mississippi","requested","connecticut","personals","immediate","agricultural","supporting","collections","participate","specialist","experienced","investigation","institution","searching","proceedings","transmission","characteristics","experiences","extremely","verzeichnis","contracts","concerning","developers","equivalent","chemistry","neighborhood","variables","continues","curriculum","psychology","responses","circumstances","identification","appliances","elementary","unlimited","printable","enforcement","hardcover","celebrity","chocolate","hampshire","bluetooth","controlled","requirement","authorities","representatives","pregnancy","biography","attractions","transactions","authorized","retirement","financing","efficiency","efficient","commitment","specialty","interviews","qualified","discovery","classified","confidence","lifestyle","consistent","clearance","connections","inventory","converter","organisation","objective","indicated","securities","volunteer","democratic","switzerland","parameter","processor","dimensions","contribute","challenges","recognition","submission","encourage","regulatory","inspection","consumers","territory","transaction","manchester","contributions","continuous","resulting","cambridge","initiative","execution","disability","increases","contractor","examination","indicates","committed","extensive","affordable","candidate","databases","outstanding","perspective","messenger","tournament","consideration","discounts","catalogue","publishers","caribbean","reservation","remaining","depending","expansion","purchased","performing","collected","absolutely","featuring","implement","scheduled","calculator","significantly","temporary","sufficient","awareness","vancouver","contribution","measurement","constitution","packaging","consultation","northwest","classroom","democracy","wallpaper","merchandise","resistance","baltimore","candidates","charlotte","biological","transition","preferences","instrument","classification","physician","hollywood","wikipedia","spiritual","photographs","relatively","satisfaction","represents","pittsburgh","preferred","intellectual","comfortable","interaction","listening","effectively","experimental","revolution","consolidation","landscape","dependent","mechanical","consultants","applicant","cooperation","acquisition","implemented","directories","recognized","notification","licensing","textbooks","diversity","cleveland","investments","accessibility","sensitive","templates","completion","universities","technique","contractors","subscriptions","calculate","alexander","broadcast","converted","anniversary","improvements","specification","accessible","accessory","typically","representation","arrangements","conferences","uniprotkb","consumption","birmingham","afternoon","consultant","controller","ownership","committees","legislative","researchers","unsubscribe","molecular","residence","attorneys","operators","sustainable","philippines","statistical","innovation","employers","definitions","elections","stainless","newspapers","hospitals","exception","successfully","indonesia","primarily","capabilities","recommendation","recruitment","organized","improving","expensive","organisations","explained","programmes","expertise","mechanism","jewellery","eventually","agreements","considering","innovative","conclusion","disorders","collaboration","detection","formation","engineers","proposals","moderator","tutorials","settlement","collectables","fantastic","governments","purchasing","appointed","operational","corresponding","descriptions","determination","animation","productions","telecommunications","instructor","approaches","highlights","designers","melbourne","scientists","blackjack","argentina","possibility","commissioner","dangerous","reliability","unfortunately","respectively","volunteers","attachment","appointment","workshops","hurricane","represented","mortgages","responsibilities","carefully","productivity","investors","underground","diagnosis","principle","vacations","calculated","appearance","incorporated","notebooks","algorithm","valentine","involving","investing","christopher","admission","terrorism","parliament","situations","allocated","corrections","structural","municipal","describes","disabilities","substance","prohibited","addressed","simulation","initiatives","concentration","interpretation","bankruptcy","optimization","substances","discovered","restrictions","participating","exhibition","composition","nationwide","definitely","existence","commentary","limousines","developments","immigration","destinations","necessarily","attribute","apparently","surrounding","mountains","popularity","postposted","coordinator","obviously","fundamental","substantial","progressive","championship","sacramento","impossible","depression","testimonials","memorabilia","cartridge","explanation","cincinnati","subsection","electricity","permitted","workplace","confirmed","wallpapers","infection","eligibility","involvement","placement","observations","vbulletin","subsequent","motorcycle","disclosure","establishment","presentations","undergraduate","occupation","donations","associations","citysearch","radiation","seriously","elsewhere","pollution","conservative","guestbook","effectiveness","demonstrate","atmosphere","experiment","purchases","federation","assignment","chemicals","everybody","nashville","counseling","acceptable","satisfied","measurements","milwaukee","medication","warehouse","shareware","violation","configure","stability","southwest","institutional","expectations","independence","metabolism","personally","excellence","somewhere","attributes","recognize","screening","thumbnail","forgotten","intelligent","edinburgh","obligation","regardless","restricted","republican","merchants","attendance","arguments","amsterdam","adventures","announcement","appreciate","regularly","mechanisms","customize","tradition","indicators","emissions","physicians","complaint","experiments","afghanistan","scholarship","governance","supplements","camcorder","implementing","ourselves","conversation","capability","producing","precision","contributed","reproduction","ingredients","franchise","complaints","promotions","rehabilitation","maintaining","environments","reception","correctly","consequences","geography","appearing","integrity","discrimination","processed","implications","functionality","intermediate","emotional","platforms","overnight","geographic","preliminary","districts","introduce","promotional","chevrolet","specialists","generator","suspension","correction","authentication","communicate","supplement","showtimes","promoting","machinery","bandwidth","probability","dimension","schedules","admissions","quarterly","illustrated","continental","alternate","achievement","limitations","automated","passenger","convenient","orientation","childhood","flexibility","jurisdiction","displaying","encouraged","cartridges","declaration","automation","advantages","preparing","recipient","extensions","athletics","southeast","alternatives","determining","personalized","conditioning","partnerships","destruction","increasingly","migration","basically","conventional","applicants","occupational","adjustment","treatments","camcorders","difficulty","collective","coalition","enrollment","producers","collector","interfaces","advertisers","representing","observation","restoration","convenience","returning","opposition","container","defendant","confirmation","supervisor","peripherals","bestsellers","departure","minneapolis","interactions","intervention","attraction","modification","customized","understood","assurance","happening","amendments","metropolitan","compilation","verification","attractive","recordings","jefferson","gardening","obligations","orchestra","polyphonic","outsourcing","adjustable","allocation","discipline","demonstrated","identifying","alphabetical","dispatched","installing","voluntary","photographer","messaging","constructed","additions","requiring","engagement","refinance","calendars","arrangement","conclusions","bibliography","compatibility","furthermore","cooperative","measuring","jacksonville","headquarters","transfers","transformation","attachments","administrators","personality","facilitate","subscriber","priorities","bookstore","parenting","incredible","commonwealth","pharmaceutical","manhattan","workforce","organizational","portuguese","everywhere","discharge","halloween","hazardous","methodology","housewares","reputation","resistant","democrats","recycling","qualifications","slideshow","variation","transferred","photograph","distributor","underlying","wrestling","photoshop","gathering","projection","mathematical","specialized","diagnostic","indianapolis","corporations","criticism","automobile","confidential","statutory","accommodations","northeast","downloaded","paintings","injection","yorkshire","populations","protective","initially","indicator","eliminate","sunglasses","preference","threshold","venezuela","exploration","sequences","astronomy","translate","announces","compression","establishing","constitutional","perfectly","instantly","litigation","submissions","broadcasting","horizontal","terrorist","informational","ecommerce","suffering","prospective","ultimately","artificial","spectacular","coordination","connector","affiliated","activation","naturally","subscribers","mitsubishi","underwear","potentially","constraints","inclusive","dimensional","considerable","selecting","processors","pantyhose","difficulties","complexity","constantly","barcelona","presidential","documentary","territories","palestinian","legislature","hospitality","procurement","theoretical","exercises","surveillance","protocols","highlight","substitute","inclusion","hopefully","brilliant","evaluated","assignments","termination","households","authentic","montgomery","architectural","louisville","macintosh","movements","amenities","virtually","authorization","projector","comparative","psychological","surprised","genealogy","expenditure","liverpool","connectivity","algorithms","similarly","collaborative","excluding","commander","suggestion","spotlight","investigate","connecting","logistics","proportion","significance","symposium","essentials","protecting","transmitted","screenshots","intensive","switching","correspondence","supervision","expenditures","separation","testimony","celebrities","mandatory","boundaries","syndication","celebration","filtering","luxembourg","offensive","deployment","colleagues","separated","directive","governing","retailers","occasionally","attending","recruiting","instructional","traveling","permissions","biotechnology","prescribed","catherine","reproduced","calculation","consolidated","occasions","equations","exceptional","respondents","considerations","queensland","musicians","composite","unavailable","essentially","designing","assessments","brunswick","sensitivity","preservation","streaming","intensity","technological","syndicate","antivirus","addressing","discounted","bangladesh","constitute","concluded","desperate","demonstration","governmental","manufactured","graduation","variations","addiction","springfield","synthesis","undefined","unemployment","enhancement","newcastle","performances","societies","brazilian","identical","petroleum","norwegian","retention","exchanges","soundtrack","wondering","profession","separately","physiology","collecting","participant","scholarships","recreational","dominican","friendship","expanding","provincial","investigations","medications","rochester","advertiser","encryption","downloadable","sophisticated","possession","laboratories","vegetables","thumbnails","stockings","respondent","destroyed","manufacture","wordpress","vulnerability","accountability","celebrate","accredited","appliance","compressed","scheduling","perspectives","mortality","christians","therapeutic","impressive","accordingly","architect","challenging","microwave","accidents","relocation","contributors","violations","temperatures","competitions","discretion","cosmetics","repository","concentrations","christianity","negotiations","realistic","generating","christina","congressional","photographic","modifications","millennium","achieving","fisheries","exceptions","reactions","macromedia","companion","divisions","additionally","fellowship","victorian","copyrights","lithuania","mastercard","chronicles","obtaining","distribute","decorative","enlargement","campaigns","conjunction","instances","indigenous","validation","corruption","incentives","cholesterol","differential","scientist","starsmerchant","arthritis","nevertheless","practitioners","transcript","inflation","compounds","contracting","structured","reasonably","graduates","recommends","controlling","distributors","arlington","particles","extraordinary","indicating","coordinate","exclusively","limitation","widescreen","illustration","construct","inquiries","inspiration","affecting","downloading","aggregate","forecasts","complicated","shopzilla","decorating","expressions","shakespeare","connectors","conflicts","travelers","offerings","incorrect","furnishings","guatemala","perception","renaissance","pathology","ordinance","photographers","infections","configured","festivals","possibilities","contributing","analytical","circulation","assumption","jerusalem","transexuales","invention","technician","executives","enquiries","cognitive","exploring","registrar","supporters","withdrawal","predicted","saskatchewan","cancellation","ministers","veterinary","prostores","relevance","incentive","butterfly","mechanics","numerical","reflection","accompanied","invitation","princeton","spirituality","meanwhile","proprietary","childrens","thumbzilla","porcelain","pichunter","translated","columnists","consensus","delivering","journalism","intention","undertaken","statewide","semiconductor","illustrations","happiness","substantially","identifier","calculations","conducting","accomplished","calculators","impression","correlation","fragrance","neighbors","transparent","charleston","champions","selections","projectors","inappropriate","comparing","vocational","pharmacies","introducing","appreciated","albuquerque","distinguished","projected","assumptions","shareholders","developmental","regulated","anticipated","completing","comparable","confusion","copyrighted","warranties","documented","paperbacks","keyboards","vulnerable","reflected","respiratory","notifications","transexual","mainstream","evaluating","subcommittee","maternity","journalists","foundations","volleyball","liabilities","decreased","tolerance","creativity","describing","lightning","quotations","inspector","bookmarks","behavioral","riverside","bathrooms","abilities","initiated","nonprofit","lancaster","suspended","containers","attitudes","simultaneously","integrate","sociology","screenshot","exhibitions","confident","retrieved","officially","consortium","recipients","delicious","traditions","periodically","hungarian","referring","transform","educators","vegetable","humanities","independently","alignment","henderson","britannica","competitors","visibility","consciousness","encounter","resolutions","accessing","attempted","witnesses","administered","strengthen","frederick","aggressive","advertisements","sublimedirectory","disturbed","determines","sculpture","motivation","pharmacology","passengers","quantities","petersburg","consistently","powerpoint","obituaries","punishment","appreciation","subsequently","providence","restriction","incorporate","backgrounds","treasurer","lightweight","transcription","complications","scripting","remembered","synthetic","testament","specifics","partially","wilderness","generations","tournaments","sponsorship","headphones","proceeding","volkswagen","uncertainty","breakdown","reconstruction","subsidiary","strengths","encouraging","furnished","terrorists","comparisons","beneficial","distributions","viewpicture","threatened","republicans","discusses","responded","abstracts","prediction","pharmaceuticals","thesaurus","individually","battlefield","literally","ecological","appraisal","consisting","submitting","citations","geographical","mozambique","disclaimers","championships","sheffield","finishing","wellington","prospects","bulgarian","aboriginal","remarkable","preventing","productive","boulevard","compliant","penalties","imagination","refurbished","activated","conferencing","armstrong","politicians","trackbacks","accommodate","christine","accepting","precipitation","isolation","sustained","approximate","programmer","greetings","inherited","incomplete","chronicle","legitimate","biographies","investigator","plaintiff","prisoners","mediterranean","nightlife","architects","entrepreneur","freelance","excessive","screensaver","valuation","unexpected","cigarette","characteristic","metallica","consequently","appointments","narrative","academics","quantitative","screensavers","subdivision","distinction","livestock","exemption","sustainability","formatting","nutritional","nicaragua","affiliation","relatives","satisfactory","revolutionary","bracelets","telephony","breathing","thickness","adjustments","graphical","discussing","aerospace","meaningful","maintains","shortcuts","voyeurweb","extending","specifies","accreditation","blackberry","meditation","microphone","macedonia","combining","instrumental","organizing","moderators","kazakhstan","standings","partition","invisible","translations","commodity","kilometers","thanksgiving","guarantees","indication","congratulations","cigarettes","controllers","consultancy","conventions","coordinates","responding","physically","stakeholders","hydrocodone","consecutive","attempting","representations","competing","peninsula","accurately","considers","ministries","vacancies","parliamentary","acknowledge","thoroughly","nottingham","identifies","questionnaire","qualification","modelling","miniature","interstate","consequence","systematic","perceived","madagascar","presenting","troubleshooting","uzbekistan","centuries","magnitude","richardson","fragrances","vocabulary","earthquake","fundraising","geological","assessing","introduces","webmasters","computational","acdbentity","participated","handhelds","answering","impressed","conspiracy","organizer","combinations","preceding","cumulative","amplifier","arbitrary","prominent","lexington","contacted","recorders","occasional","innovations","postcards","reviewing","explicitly","transsexual","citizenship","informative","girlfriend","bloomberg","hierarchy","influenced","abandoned","complement","mauritius","checklist","requesting","lauderdale","scenarios","extraction","elevation","utilization","beverages","calibration","efficiently","entertaining","prerequisite","hypothesis","medicines","regression","enhancements","renewable","intersection","passwords","consistency","collectors","azerbaijan","astrology","occurring","supplemental","travelling","induction","precisely","spreading","provinces","widespread","incidence","incidents","enhancing","interference","palestine","listprice","atmospheric","knowledgestorm","referenced","publicity","proposition","allowance","designation","duplicate","criterion","civilization","vietnamese","tremendous","corrected","encountered","internationally","surrounded","creatures","commented","accomplish","vegetarian","newfoundland","investigated","ambassador","stephanie","contacting","vegetation","findarticles","specially","infectious","continuity","phenomenon","conscious","referrals","differently","integrating","revisions","reasoning","charitable","annotated","convinced","burlington","replacing","researcher","watershed","occupations","acknowledged","equilibrium","characterized","privilege","qualifying","estimation","pediatric","techrepublic","institutes","brochures","traveller","appropriations","suspected","benchmark","beginners","instructors","highlighted","stationery","unauthorized","competent","contributor","demonstrates","gradually","desirable","journalist","afterwards","religions","explosion","signatures","disciplines","daughters","conversations","simplified","motherboard","bibliographic","champagne","deviation","superintendent","housewives","influences","inspections","irrigation","hydraulic","robertson","penetration","conviction","omissions","retrieval","qualities","prototype","importantly","apparatus","explaining","nomination","empirical","dependence","sexuality","polyester","commitments","suggesting","remainder","privileges","televisions","specializing","commodities","motorcycles","concentrate","reproductive","molecules","refrigerator","intervals","sentences","exclusion","workstation","holocaust","receivers","disposition","navigator","investigators","marijuana","cathedral","fairfield","fascinating","landscapes","lafayette","computation","cardiovascular","salvation","predictions","accompanying","selective","arbitration","configuring","editorials","sacrifice","removable","convergence","gibraltar","anthropology","malpractice","reporters","necessity","rendering","hepatitis","nationally","waterproof","specialties","humanitarian","invitations","functioning","economies","alexandria","bacterial","undertake","continuously","achievements","convertible","secretariat","paragraphs","adolescent","nominations","cancelled","introductory","reservoir","occurrence","worcester","demographic","disciplinary","respected","portraits","interpreted","evaluations","elimination","hypothetical","immigrants","complimentary","helicopter","performer","commissions","powerseller","graduated","surprising","unnecessary","dramatically","yugoslavia","characterization","likelihood","fundamentals","contamination","endangered","compromise","expiration","namespace","peripheral","negotiation","opponents","nominated","confidentiality","electoral","changelog","alternatively","greensboro","controversial","recovered","upgrading","frontpage","demanding","defensive","forbidden","programmers","monitored","installations","deutschland","practitioner","motivated","smithsonian","examining","revelation","delegation","dictionaries","greenhouse","transparency","currencies","survivors","positioning","descending","temporarily","frequencies","reflections","municipality","detective","experiencing","fireplace","endorsement","psychiatry","persistent","summaries","looksmart","magnificent","colleague","adaptation","paintball","enclosure","supervisors","westminster","distances","absorption","treasures","transcripts","disappointed","continually","communist","collectible","entrepreneurs","creations","acquisitions","biodiversity","excitement","presently","mysterious","librarian","subsidiaries","stockholm","indonesian","therapist","promising","relaxation","thereafter","commissioners","forwarding","nightmare","reductions","southampton","organisms","telescope","portsmouth","advancement","harassment","generators","generates","replication","inexpensive","receptors","interventions","huntington","internship","aluminium","snowboard","beastality","evanescence","coordinated","shipments","antarctica","chancellor","controversy","legendary","beautifully","antibodies","examinations","immunology","departmental","terminology","gentleman","reproduce","convicted","roommates","threatening","spokesman","activists","frankfurt","encourages","assembled","restructuring","terminals","simulations","sufficiently","conditional","crossword","conceptual","liechtenstein","translator","automobiles","continent","longitude","challenged","telecharger","insertion","instrumentation","constraint","groundwater","strengthening","insulation","infringement","subjective","swaziland","varieties","mediawiki","configurations"];function yo({"data-test-id":t,children:s}){return e.jsx("div",{className:"flex flex-row mt-[20px]","data-test-id":t,children:s})}function Gv({className:t,format:s,nodeKey:n,videoID:r}){return e.jsx(jm,{className:t,format:s,nodeKey:n,children:e.jsx("iframe",{width:"560",height:"315",src:`https://www.youtube-nocookie.com/embed/${r}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"YouTube video"})})}function Jv(t){const s=t.getAttribute("data-lexical-youtube");return s?{node:Ai(s)}:null}class Or extends wm{static getType(){return"youtube"}static clone(s){return new Or(s.__id,s.__format,s.__key)}static importJSON(s){const n=Ai(s.videoID);return n.setFormat(s.format),n}exportJSON(){return{...super.exportJSON(),type:"youtube",version:1,videoID:this.__id}}constructor(s,n,r){super(n,r),this.__id=s}exportDOM(){const s=document.createElement("iframe");return s.setAttribute("data-lexical-youtube",this.__id),s.setAttribute("width","560"),s.setAttribute("height","315"),s.setAttribute("src",`https://www.youtube-nocookie.com/embed/${this.__id}`),s.setAttribute("frameborder","0"),s.setAttribute("allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"),s.setAttribute("allowfullscreen","true"),s.setAttribute("title","YouTube video"),{element:s}}static importDOM(){return{iframe:s=>s.hasAttribute("data-lexical-youtube")?{conversion:Jv,priority:1}:null}}updateDOM(){return!1}getId(){return this.__id}getTextContent(s,n){return`https://www.youtube.com/watch?v=${this.__id}`}decorate(s,n){const r=n.theme.embedBlock||{},a={base:r.base||"",focus:r.focus||""};return e.jsx(Gv,{className:a,format:this.__format,nodeKey:this.getKey(),videoID:this.__id})}isInline(){return!1}}function Ai(t){return new Or(t)}const Dp=Yt();function Xv(){const[t]=He();return b.useEffect(()=>{if(!t.hasNodes([Or]))throw new Error("YouTubePlugin: YouTubeNode not registered on editor");return t.registerCommand(Dp,s=>{const n=Ai(s);return lo(n),!0},kn)},[t]),null}const Zv={contentName:"Youtube Video",exampleUrl:"https://www.youtube.com/watch?v=jNQXAC9IVRw",icon:e.jsx("i",{className:`${Z.typeaheadPopover.ul.li.icon} ${Z.icon.youtube}`}),insertNode:(t,s)=>{t.dispatchCommand(Dp,s.id)},keywords:["youtube","video"],parseUrl:async t=>{const s=/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/.exec(t),n=s&&(s==null?void 0:s[2].length)===11?s[2]:null;return n!=null?{id:n,url:t}:null},type:"youtube-video"},Bp=[Zv];function Yv({index:t,isSelected:s,onClick:n,onMouseEnter:r,option:a}){let l=`${Z.typeaheadPopover.ul.li.item}`;return s&&(l+=`${Z.typeaheadPopover.ul.li.selected}`),e.jsx("li",{tabIndex:-1,className:`${Z.typeaheadPopover.ul.li.base} ${l}`,ref:a.setRefElement,role:"option","aria-selected":s,id:"typeahead-item-"+t,onMouseEnter:r,onClick:n,children:e.jsx("span",{className:Z.typeaheadPopover.ul.li.text,children:a.title})},a.key)}function Qv({options:t,selectedItemIndex:s,onOptionClick:n,onOptionMouseEnter:r}){return e.jsx("div",{className:`${Z.typeaheadPopover.base}`,children:e.jsx("ul",{children:t.map((a,l)=>e.jsx(Yv,{index:l,isSelected:s===l,onClick:()=>n(a,l),onMouseEnter:()=>r(l),option:a},a.key))})})}const Kv=(t,s)=>{let n;return r=>{window.clearTimeout(n),n=window.setTimeout(()=>{t(r)},s)}};function e2({embedConfig:t,onClose:s}){const[n,r]=b.useState(""),[a]=He(),[l,i]=b.useState(null),c=b.useMemo(()=>Kv(u=>{const m=i0.exec(u);t!=null&&u!=null&&m!=null?Promise.resolve(t.parseUrl(u)).then(p=>{i(p)}):l!=null&&i(null)},200),[t,l]),d=()=>{l!=null&&(t.insertNode(a,l),s())};return e.jsxs("div",{style:{width:"600px"},children:[e.jsx("div",{className:"Input__wrapper",children:e.jsx("input",{type:"text",className:"Input__input",placeholder:t.exampleUrl,value:n,"data-test-id":`${t.type}-embed-modal-url`,onChange:u=>{const{value:m}=u.target;r(m),c(m)}})}),e.jsx(yo,{children:e.jsx(Vs,{disabled:!l,onClick:d,"data-test-id":`${t.type}-embed-modal-submit-btn`,children:"Embed"})})]})}function t2(){const[t,s]=Mr(),n=a=>{s(`Embed ${a.contentName}`,l=>e.jsx(e2,{embedConfig:a,onClose:l}))},r=(a,l,i)=>[new Mc("Dismiss",{onSelect:i}),new Mc(`Embed ${a.contentName}`,{onSelect:l})];return e.jsxs(e.Fragment,{children:[t,e.jsx(l0,{embedConfigs:Bp,onOpenEmbedModalForConfig:n,getMenuOptions:r,menuRenderFn:(a,{selectedIndex:l,options:i,selectOptionAndCleanUp:c,setHighlightedIndex:d})=>a.current?Zt.createPortal(e.jsx("div",{className:`${Z.typeaheadPopover.base} ${Z.autoEmbedMenu}`,style:{marginLeft:a.current.style.width,width:200},children:e.jsx(Qv,{options:i,selectedItemIndex:l,onOptionClick:(u,m)=>{d(m),c(u)},onOptionMouseEnter:u=>{d(u)}})}),a.current):null})]})}const s2=/((https?:\/\/(www\.)?)|(www\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/,n2=/(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/,r2=[Ac(s2,t=>t.startsWith("http")?t:`https://${t}`),Ac(n2,t=>`mailto:${t}`)];function a2(){return e.jsx(c0,{matchers:r2})}function o2(){const[t]=He();return b.useEffect(()=>d0(t),[t]),null}function l2(t){const s=t.open!==void 0?t.open:!0;return{node:Ti(s)}}class Us extends cs{constructor(s,n){super(n),this.__open=s}static getType(){return"collapsible-container"}static clone(s){return new Us(s.__open,s.__key)}createDOM(s,n){const r="300px",a=document.createElement("div");return a.classList.add("Collapsible__container"),a.classList.add("flex","flex-col","gap-4","bg-[#F3F8F9]","p-[12px]","pt-[16px]","rounded-lg","mb-2"),a.open=this.__open,a.style.maxHeight=this.__open?"none":r,a.addEventListener("toggle",()=>{n.update(()=>{const l=this.getOpen();a.style.maxHeight=l?"none":r,a.style.overflow=l?"visible":"hidden"})}),a}updateDOM(s,n){return s.__open!==this.__open&&(n.open=!0,n.style.maxHeight=this.__open?"none":"195px",this.getChildren().forEach(r=>r.markDirty())),!1}static importDOM(){return{details:s=>({conversion:l2,priority:1})}}static importJSON(s){return Ti(s.open)}exportDOM(){const s=document.createElement("details");return s.setAttribute("open",this.__open.toString()),{element:s}}exportJSON(){return{...super.exportJSON(),open:this.__open,type:"collapsible-container",version:1}}setOpen(s){const n=this.getWritable();n.__open=s}getOpen(){return this.__open}toggleOpen(){this.setOpen(!this.getOpen())}toggleCollapsed(){this.getWritable().__collapsed=!this.__collapsed}}function Ti(t){return new Us(t)}function Fs(t){return t instanceof Us}function i2(t){return{node:Oi()}}class qs extends cs{static getType(){return"collapsible-content"}static clone(s){return new qs(s.__key)}createDOM(s,n){const r=document.createElement("div");r.classList.add("Collapsible__content","text-[14px]","leading-[19.6px]","overflow-hidden","transition-all","duration-300","ease-in-out");const a=this.getParent();return Fs(a)&&requestAnimationFrame(()=>{this.applyStyles(r,a.getOpen())}),r}updateDOM(s,n){const r=this.getParent();return Fs(r)&&(requestAnimationFrame(()=>{this.applyStyles(n,r.getOpen())}),this.markDirty()),!1}applyStyles(s,n){s.style.maxHeight=n?"none":"64px",s.style.overflow=n?"auto":"hidden",n?(s.classList.remove("bg-gradient-to-b","from-[#2D3E4C]","to-[#F3F8F9]","bg-clip-text","text-transparent"),s.classList.add("text-[#37576B]"),s.style.background="",s.style.webkitMaskImage="",s.style.maskImage=""):(s.classList.remove("text-[#37576B]"),s.classList.add("text-[#2D3E4C]"),s.style.background="",s.style.webkitMaskImage="linear-gradient(to bottom, rgba(0,0,0,1), rgba(0,0,0,0.2))",s.style.maskImage="linear-gradient(to bottom, rgba(0,0,0,1), rgba(0,0,0,0.2))")}static importDOM(){return{div:s=>s.hasAttribute("data-lexical-collapsible-content")?{conversion:i2,priority:2}:null}}exportDOM(){const s=document.createElement("div");return s.setAttribute("data-lexical-collapsible-content","true"),{element:s}}static importJSON(s){return Oi()}isShadowRoot(){return!0}exportJSON(){return{...super.exportJSON(),type:"collapsible-content",version:1}}}function Oi(){return new qs}function Fp(t){return t instanceof qs}function c2(t){return{node:Di()}}class Dr extends cs{static getType(){return"collapsible-title"}static clone(s){return new Dr(s.__key)}createDOM(s,n){const r=document.createElement("div");r.classList.add("Collapsible__title","flex","flex-row","w-full","font-[Oswald]","font-medium","text-[12px]","text-[#2D3E4C]","uppercase","pb-[12px]","border-b","border-[#C5D7E0]","flex","items-center","gap-2");const a=document.createElementNS("http://www.w3.org/2000/svg","svg");return a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("viewBox","0 0 24 24"),a.setAttribute("width","24"),a.setAttribute("height","24"),a.setAttribute("fill","none"),a.innerHTML=`
     <path d="M22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12Z" stroke="currentColor" stroke-width="1.5" />
          <path d="M12.2422 17V12C12.2422 11.5286 12.2422 11.2929 12.0957 11.1464C11.9493 11 11.7136 11 11.2422 11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
          <path d="M11.992 8H12.001" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
    `,a.classList.add("inline-block","align-middle"),r.appendChild(a),r.addEventListener("click",l=>{l.preventDefault()}),r}updateDOM(s,n){return!1}static importDOM(){return{summary:s=>({conversion:c2,priority:1})}}static importJSON(s){return Di()}exportDOM(){return{element:document.createElement("summary")}}exportJSON(){return{...super.exportJSON(),type:"collapsible-title",version:1}}collapseAtStart(s){return this.getParentOrThrow().insertBefore(this),!0}insertNewAfter(s,n=!0){const r=this.getParentOrThrow();if(!Fs(r))throw new Error("CollapsibleTitleNode expects to be child of CollapsibleContainerNode");if(r.getOpen()){const a=this.getNextSibling();if(!Fp(a))throw new Error("CollapsibleTitleNode expects to have CollapsibleContentNode sibling");const l=a.getFirstChild();if(Ir(l))return l;{const i=ct();return a.append(i),i}}else{const a=ct();return r.insertAfter(a,n),a}}}function Di(){return new Dr}function d2(t){return{node:Aa()}}class Bn extends cs{static getType(){return"collapsible-button"}static clone(s){return new Bn(s.__key)}createDOM(s,n){const r=document.createElement("button");r.classList.add("collapsible-toggle","w-fit","h-fit","cursor-pointer","bg-[#C5D7E0]","text-[#37576B]","font-semibold","leading-[14.62px]","rounded-full","text-sm","text-center","pt-[9px]","pb-[7px]","px-[12px]");const a=this.getParentOrThrow();return Fs(a)&&(r.textContent=a.getOpen()?"SHOW LESS":"SHOW MORE"),r.addEventListener("click",()=>{n.update(()=>{const l=this.getParentOrThrow();Fs(l)&&l.toggleOpen()}),r.textContent=r.textContent==="SHOW LESS"?"SHOW MORE":"SHOW LESS"}),r}updateDOM(s,n){return!1}static importDOM(){return{button:s=>({conversion:d2,priority:1})}}static importJSON(s){return Aa()}exportDOM(){const s=document.createElement("button");return s.textContent="Toggle Expand",{element:s}}exportJSON(){return{...super.exportJSON(),type:"collapsible-button",version:1}}collapseAtStart(s){return this.getParentOrThrow().insertBefore(this),!0}insertNewAfter(s,n=!0){const r=this.getParentOrThrow();if(!Fs(r))throw new Error("CollapsibleButtonNode expects to be child of CollapsibleContainerNode");if(r.getOpen()){const a=this.getNextSibling();if(!Fp(a))throw new Error("CollapsibleButtonNode expects to have CollapsibleContentNode sibling");const l=a.getFirstChild();if(Ir(l))return l;{const i=ct();return a.append(i),i}}else{const a=ct();return r.insertAfter(a,n),a}}}function Aa(){return new Bn}function u2(t){return t instanceof Bn}const Bi=Yt(),m2=Yt();function p2({editable:t}){const[s]=He();return b.useEffect(()=>{if(!s.hasNodes([Us,Dr,qs,Bn]))throw new Error("CollapsiblePlugin: Required collapsible nodes not registered on editor");return pt(s.registerNodeTransform(Us,n=>{n.getChildren().some(u2)||n.append(Aa())}),s.registerCommand(Bi,()=>(s.update(()=>{const n=Di(),r=Oi().append(ct()),a=Aa(),l=Ti(!0).append(n,r,a);lo(l),n.select()}),!0),ut),s.registerCommand(m2,n=>(s.update(()=>{const r=s.getNodeByKey(n);Fs(r)&&r.toggleCollapsed()}),!0),ut))},[s]),b.useEffect(()=>pt(s.registerNodeTransform(qs,n=>{const r=s.getElementByKey(n.getKey());if(!r)return;const a=r.querySelector(".collapsible-toggle");a&&r.appendChild(a)})),[t]),null}function x2(t){const s=t.open!==void 0?t.open:!0;return{node:Fi(s)}}class Fn extends cs{constructor(s,n){super(n),this.__open=s}static getType(){return"collapsible-no-preview-container"}static clone(s){return new Fn(s.__open,s.__key)}createDOM(s,n){const r="50px",a=document.createElement("div");return a.classList.add("Collapsible__container"),a.classList.add("flex","flex-col","gap-4","bg-[#F3F8F9]","p-[12px]","pt-[16px]","rounded-lg","mb-2"),a.open=this.__open,a.style.maxHeight=this.__open?"none":r,a.addEventListener("toggle",()=>{n.update(()=>{const l=this.getOpen();a.style.maxHeight=l?"none":r,a.style.overflow=l?"visible":"hidden"})}),a}updateDOM(s,n){return s.__open!==this.__open&&(n.open=!0,n.style.maxHeight=this.__open?"none":"50px",this.getChildren().forEach(r=>r.markDirty())),!1}static importDOM(){return{details:s=>({conversion:x2,priority:1})}}static importJSON(s){return Fi(s.open)}exportDOM(){const s=document.createElement("details");return s.setAttribute("open",this.__open.toString()),{element:s}}exportJSON(){return{...super.exportJSON(),open:this.__open,type:"collapsible-no-preview-container",version:1}}setOpen(s){const n=this.getWritable();n.__open=s}getOpen(){return this.__open}toggleOpen(){this.setOpen(!this.getOpen())}toggleCollapsed(){this.getWritable().__collapsed=!this.__collapsed}}function Fi(t){return new Fn(t)}function mr(t){return t instanceof Fn}function h2(t){return{node:zi()}}class Gs extends cs{static getType(){return"collapsible-no-preview-content"}static clone(s){return new Gs(s.__key)}createDOM(s,n){const r=document.createElement("div");r.classList.add("Collapsible__content","text-[14px]","leading-[19.6px]","overflow-hidden","transition-all","duration-300","ease-in-out");const a=this.getParent();return mr(a)&&requestAnimationFrame(()=>{this.applyStyles(r,a.getOpen())}),r}updateDOM(s,n){const r=this.getParent();return mr(r)&&(requestAnimationFrame(()=>{this.applyStyles(n,r.getOpen())}),this.markDirty()),!1}applyStyles(s,n){s.style.maxHeight=n?"none":"64px",s.style.overflow=n?"auto":"hidden",n?(s.classList.remove("bg-gradient-to-b","from-[#2D3E4C]","to-[#F3F8F9]","bg-clip-text","text-transparent"),s.classList.add("text-[#37576B]"),s.style.background="",s.style.webkitMaskImage="",s.style.maskImage=""):(s.classList.remove("text-[#37576B]"),s.classList.add("text-[#2D3E4C]"),s.style.background="",s.style.webkitMaskImage="linear-gradient(to bottom, rgba(0,0,0,1), rgba(0,0,0,0.2))",s.style.maskImage="linear-gradient(to bottom, rgba(0,0,0,1), rgba(0,0,0,0.2))")}static importDOM(){return{div:s=>s.hasAttribute("data-lexical-collapsible-content")?{conversion:h2,priority:2}:null}}exportDOM(){const s=document.createElement("div");return s.setAttribute("data-lexical-collapsible-content","true"),{element:s}}static importJSON(s){return zi()}isShadowRoot(){return!0}exportJSON(){return{...super.exportJSON(),type:"collapsible-no-preview-content",version:1}}}function zi(){return new Gs}function f2(t){return t instanceof Gs}function g2(t){return{node:Pi()}}class Br extends cs{static getType(){return"collapsible-no-preview-title"}static clone(s){return new Br(s.__key)}createDOM(s,n){const a=this.getParentOrThrow().getOpen(),l=document.createElement("div");l.classList.add("Collapsible__title","flex","flex-row","w-full","font-[Oswald]","font-medium","text-[12px]","text-[#2D3E4C]","uppercase","pb-[12px]","flex","items-center","gap-2"),a?l.classList.add("border-b","border-[#C5D7E0]"):l.classList.remove("border-b","border-[#C5D7E0]");const i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("viewBox","0 0 24 24"),i.setAttribute("width","24"),i.setAttribute("height","24"),i.setAttribute("fill","none"),i.innerHTML=`
     <path d="M22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12Z" stroke="currentColor" stroke-width="1.5" />
          <path d="M12.2422 17V12C12.2422 11.5286 12.2422 11.2929 12.0957 11.1464C11.9493 11 11.7136 11 11.2422 11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
          <path d="M11.992 8H12.001" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
    `,i.classList.add("inline-block","align-middle"),i.addEventListener("click",()=>{console.log("icon clicked"),n.update(()=>{const c=this.getParentOrThrow();c.toggleOpen(),mr(c)&&(c.getOpen()?l.classList.remove("border-b","border-[#C5D7E0]"):l.classList.add("border-b","border-[#C5D7E0]"),c.toggleOpen())})}),l.appendChild(i),l.addEventListener("click",c=>{c.preventDefault()}),l}updateDOM(s,n){return s.__open!==this.__open&&(n.open=!0,n.style.maxHeight=this.__open?"none":"50px",this.getChildren().forEach(r=>r.markDirty())),!1}static importDOM(){return{summary:s=>({conversion:g2,priority:1})}}static importJSON(s){return Pi()}exportDOM(){return{element:document.createElement("summary")}}exportJSON(){return{...super.exportJSON(),type:"collapsible-no-preview-title",version:1}}collapseAtStart(s){return this.getParentOrThrow().insertBefore(this),!0}insertNewAfter(s,n=!0){const r=this.getParentOrThrow();if(!mr(r))throw new Error("CollapsibleTitleNode expects to be child of CollapsibleContainerNode");if(r.getOpen()){const a=this.getNextSibling();if(!f2(a))throw new Error("CollapsibleTitleNode expects to have CollapsibleContentNode sibling");const l=a.getFirstChild();if(Ir(l))return l;{const i=ct();return a.append(i),i}}else{const a=ct();return r.insertAfter(a,n),a}}}function Pi(){return new Br}const zp=Yt(),b2=Yt();function y2({editable:t}){const[s]=He();return b.useEffect(()=>{if(!s.hasNodes([Fn,Br,Gs]))throw new Error("CollapsiblePlugin: Required collapsible nodes not registered on editor");return pt(s.registerCommand(zp,()=>(s.update(()=>{const n=Pi(),r=zi().append(ct()),a=Fi(!0).append(n,r);lo(a),n.select()}),!0),ut),s.registerCommand(b2,n=>(s.update(()=>{const r=s.getNodeByKey(n);mr(r)&&r.toggleCollapsed()}),!0),ut))},[s]),b.useEffect(()=>pt(s.registerNodeTransform(Gs,n=>{const r=s.getElementByKey(n.getKey());if(!r)return;const a=r.querySelector(".collapsible-toggle");a&&r.appendChild(a)})),[t]),null}const Kr={primary:"w-fit h-fit cursor-pointer uppercase bg-[#EAAD43] hover:bg-[#F1CA87] text-[#37576B] font-[700] leading-[14.62px] rounded-full text-[12px] text-center py-[16px] px-[24px]",secondary:"w-fit h-fit cursor-pointer uppercase border boder-[#E0EBF0] bg-white hover:bg-[#E0EBF0] text-[#37576B] font-[700] leading-[14.62px] rounded-full text-[12px] text-center py-[16px] px-[24px]",primarySmall:"w-fit h-fit cursor-pointer uppercase bg-[#EAAD43] hover:bg-[#F1CA87] text-[#37576B] font-[700] leading-[14.62px] rounded-full text-[12px] text-center pt-[9px] pb-[7px] px-[12px]",secondarySmall:"w-fit h-fit cursor-pointer uppercase border bg-[#E0EBF0] hover:bg-[#C5D7E0] text-[#37576B] font-[700] leading-[14.62px] rounded-full text-[12px] text-center pt-[9px] pb-[7px] px-[12px]",whiteSmall:"w-fit h-fit cursor-pointer uppercase border boder-[#E0EBF0] bg-white hover:bg-[#E0EBF0] text-[#37576B] font-[700] leading-[14.62px] rounded-full text-[12px] text-center pt-[9px] pb-[7px] px-[12px]"};function v2({nodeKey:t,linkText:s,path:n,style:r}){const a=io(),[l]=He(),[i,c]=Mr();return e.jsxs(e.Fragment,{children:[a?e.jsx("span",{className:`${Kr[r]||Kr.primary}`,onClick:d=>{d.preventDefault(),c("Insert Button",u=>e.jsx(Hp,{activeEditor:l,onClose:u,initialValues:{linkText:s,path:n,style:r,nodeKey:t}}))},children:s||"submit"}):e.jsx(ue,{className:`${Kr[r]||Kr.primary}`,to:n,children:s||"submit"}),i]})}function w2(t){const s=t.innerText,n=t.getAttribute("href"),r=t.style;return s?{node:vo({linkText:s,path:n,style:r})}:null}class zn extends ao{static getType(){return"button"}static clone(s){return new zn(s.__linkText,s.__path,s.__style,s.__key)}static importJSON(s){return vo({linkText:s.linkText,path:s.path,style:s.style})}exportJSON(){return{...super.exportJSON(),type:"button",version:1,linkText:this.__linkText,path:this.__path,style:this.__style}}constructor(s,n,r,a){super(a),this.__linkText=s,this.__path=n,this.__style=r}createDOM(s){const n=document.createElement("span");return n.setAttribute("data-lexical-button","true"),n}exportDOM(){const s=document.createElement("a");return s.setAttribute("href",this.__path),s.setAttribute("data-lexical-button","true"),s.className=this.__style,s.innerText=this.__linkText,{element:s}}static importDOM(){return{a:s=>s.hasAttribute("data-lexical-button")?{conversion:w2,priority:2}:null}}updateDOM(){return!1}getId(){return this.__id}decorate(s,n){return e.jsx(v2,{format:this.__format,nodeKey:this.getKey(),linkText:this.__linkText,path:this.__path,style:this.__style})}isInline(){return!0}}function vo(t){const{linkText:s,path:n,style:r}=t;return new zn(s,n,r)}function j2(t){return t instanceof zn}function Pp({children:t,label:s,className:n,...r}){return e.jsxs("div",{className:"Input__wrapper",children:[e.jsx("label",{style:{marginTop:"-1em"},className:"Input__label",children:s}),e.jsx("select",{...r,className:n||"min-w-[160px] max-w-[290px] border-[1px] border-[solid] border-[#393939] rounded-[0.25em] px-[0.5em] py-[0.25em] text-[1rem] cursor-pointer leading-[1.4] bg-[linear-gradient(to_bottom,_#ffffff_0%,_#e5e5e5_100%)]",children:t})]})}const Ko={};function In({label:t,value:s,onChange:n,placeholder:r="","data-test-id":a,type:l="text"}){return e.jsxs("div",{className:`${Ko.Input__wrapper}`,children:[e.jsx("label",{className:`${Ko.Input__label}`,children:t}),e.jsx("input",{type:l,value:s,className:`${Ko.Input__input}`,placeholder:r,onChange:i=>n(i.target.value),"data-test-id":a})]})}const Rp=Yt();function Hp({activeEditor:t,onClose:s,initialValues:n}){const r=b.useRef(!1),[a,l]=b.useState((n==null?void 0:n.linkText)||"submit"),[i,c]=b.useState((n==null?void 0:n.path)||"#"),[d,u]=b.useState((n==null?void 0:n.style)||"primary");b.useEffect(()=>{r.current=!1;const x=h=>{r.current=h.altKey};return document.addEventListener("keydown",x),()=>{document.removeEventListener("keydown",x)}},[t]);const m=()=>{const x={linkText:a,path:i,style:d};t.update(()=>{if(n!=null&&n.nodeKey){const h=vo({linkText:a,path:i,style:d}),f=$n(n.nodeKey);j2(f)&&f.replace(h)}else t.dispatchCommand(Rp,x)}),s()},p=b.useMemo(()=>(a==null?void 0:a.length)===0||(i==null?void 0:i.length)===0,[a,i]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:"1em"},children:e.jsx(In,{label:"Button Text",placeholder:"",onChange:x=>{l(x)},value:a,"data-test-id":"image-modal-alt-text-input"})}),e.jsx("div",{style:{marginBottom:"1em"},children:e.jsx(In,{label:"URL",placeholder:"LinkPath",onChange:c,value:i,"data-test-id":"image-modal-alt-text-input"})}),e.jsxs(Pp,{style:{marginBottom:"1em",width:"290px"},label:"Position",name:"position",id:"position-select",onChange:x=>u(x.target.value),children:[e.jsx("option",{value:"primary",children:"Primary"}),e.jsx("option",{value:"secondary",children:"Secondary"}),e.jsx("option",{value:"primarySmall",children:"Primary Small"}),e.jsx("option",{value:"secondarySmall",children:"Secondary Small"}),e.jsx("option",{value:"whiteSmall",children:"White Small"})]}),e.jsx(yo,{children:e.jsx(Vs,{"data-test-id":"create-button-node",disabled:p,onClick:()=>m(),children:"Confirm"})})]})}function C2(){const[t]=He();return b.useEffect(()=>{if(!t.hasNodes([zn]))throw new Error("ButtonPlugin: ImageNode not registered on editor");return pt(t.registerCommand(Rp,s=>{const n=vo(s);return Mm([n]),!0},kn))},[t]),null}const el={};function N2({accept:t,label:s,onChange:n,"data-test-id":r}){return e.jsxs("div",{className:`${el.Input__wrapper}`,children:[e.jsx("label",{className:`${el.Input__label}`,children:s}),e.jsx("input",{type:"file",accept:t,className:`${el.Input__input}`,onChange:a=>n(a.target.files),"data-test-id":r})]})}const k2=t=>Er?(t||window).getSelection():null,wo=Yt();function Wp({activeEditor:t,onClose:s}){const n=b.useRef(!1),[r,a]=b.useState(""),[l,i]=b.useState(""),[c,d]=b.useState(!1),[u,m]=b.useState("left"),p=r==="",x=y=>{d(y.target.checked)},h=y=>{m(y.target.value)},f=y=>{const v=new FileReader;v.onload=function(){return typeof v.result=="string"&&a(v.result),""},y!==null&&v.readAsDataURL(y[0])};b.useEffect(()=>{n.current=!1;const y=v=>{n.current=v.altKey};return document.addEventListener("keydown",y),()=>{document.removeEventListener("keydown",y)}},[t]);const g=()=>{const y={altText:l,position:u,showCaption:c,src:r};t.dispatchCommand(wo,y),s()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:"1em"},children:e.jsx(N2,{label:"Image Upload",onChange:f,accept:"image/*","data-test-id":"image-modal-file-upload"})}),e.jsx("div",{style:{marginBottom:"1em"},children:e.jsx(In,{label:"Alt Text",placeholder:"Descriptive alternative text",onChange:i,value:l,"data-test-id":"image-modal-alt-text-input"})}),e.jsxs(Pp,{style:{marginBottom:"1em",width:"290px"},label:"Position",name:"position",id:"position-select",onChange:h,children:[e.jsx("option",{value:"left",children:"Left"}),e.jsx("option",{value:"right",children:"Right"}),e.jsx("option",{value:"full",children:"Full Width"})]}),e.jsxs("div",{className:"Input__wrapper",children:[e.jsx("input",{id:"caption",type:"checkbox",checked:c,onChange:x}),e.jsx("label",{htmlFor:"caption",children:"Show Caption"})]}),e.jsx(yo,{children:e.jsx(Vs,{"data-test-id":"image-modal-file-upload-btn",disabled:p,onClick:()=>g(),children:"Confirm"})})]})}function $2(){const[t]=He();return b.useEffect(()=>{if(!t.hasNodes([nn]))throw new Error("ImagesPlugin: ImageNode not registered on editor");return pt(t.registerCommand(wo,s=>{const n=bo(s);return Mm([n]),Om(n.getParentOrThrow())&&m0(n,ct).selectEnd(),!0},kn),t.registerCommand(u0,s=>_2(s),Ia),t.registerCommand(Tm,s=>I2(s),ut),t.registerCommand(Am,s=>L2(s,t),Ia))},[t]),null}const S2="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",Vp=document.createElement("img");Vp.src=S2;function _2(t){const s=Ri();if(!s)return!1;const n=t.dataTransfer;return n?(n.setData("text/plain","_"),n.setDragImage(Vp,0,0),n.setData("application/x-lexical-drag",JSON.stringify({data:{altText:s.__altText,caption:s.__caption,height:s.__height,key:s.getKey(),showCaption:s.__showCaption,src:s.__src,width:s.__width},type:"image"})),!0):!1}function I2(t){return Ri()?(Up(t)||t.preventDefault(),!0):!1}function L2(t,s){const n=Ri();if(!n)return!1;const r=E2(t);if(!r)return!1;if(t.preventDefault(),Up(t)){const a=M2(t);n.remove();const l=p0();a!=null&&l.applyDOMRange(a),ji(l),s.dispatchCommand(wo,r)}return!0}function Ri(){const t=We();if(!x0(t))return null;const n=t.getNodes()[0];return Ip(n)?n:null}function E2(t){var a;const s=(a=t.dataTransfer)==null?void 0:a.getData("application/x-lexical-drag");if(!s)return null;const{type:n,data:r}=JSON.parse(s);return n!=="image"?null:r}function Up(t){const s=t.target;return!!(s&&s instanceof HTMLElement&&!s.closest("code, span.editor-image")&&s.parentElement&&s.parentElement.closest("div.ContentEditable__root"))}function M2(t){let s;const n=t.target,r=n==null?null:n.nodeType===9?n.defaultView:n.ownerDocument.defaultView,a=k2(r);if(document.caretRangeFromPoint)s=document.caretRangeFromPoint(t.clientX,t.clientY);else if(t.rangeParent&&a!==null)a.collapse(t.rangeParent,t.rangeOffset||0),s=a.getRangeAt(0);else throw Error("Cannot get the selection when dragging");return s}const qp=b.createContext(null),od=4;function Re({children:t,className:s,onClick:n,title:r}){const a=b.useRef(null),l=b.useContext(qp);if(l===null)throw new Error("DropDownItem must be used within a DropDown");const{registerItem:i}=l;return b.useEffect(()=>{a&&a.current&&i(a)},[a,i]),e.jsx("button",{className:s,onClick:n,ref:a,title:r,type:"button",children:t})}function A2({children:t,dropDownRef:s,onClose:n}){const[r,a]=b.useState(),[l,i]=b.useState(),c=b.useCallback(m=>{a(p=>p?[...p,m]:[m])},[a]),d=m=>{if(!r)return;const p=m.key;["Escape","ArrowUp","ArrowDown","Tab"].includes(p)&&m.preventDefault(),p==="Escape"||p==="Tab"?n():p==="ArrowUp"?i(x=>{if(!x)return r[0];const h=r.indexOf(x)-1;return r[h===-1?r.length-1:h]}):p==="ArrowDown"&&i(x=>x?r[r.indexOf(x)+1]:r[0])},u=b.useMemo(()=>({registerItem:c}),[c]);return b.useEffect(()=>{r&&!l&&i(r[0]),l&&l.current&&l.current.focus()},[r,l]),e.jsx(qp.Provider,{value:u,children:e.jsx("div",{className:`${Z.dropdown.base} z-30`,ref:s,onKeyDown:d,children:t})})}function gs({disabled:t=!1,buttonLabel:s,buttonAriaLabel:n,buttonClassName:r,buttonIconClassName:a,children:l,stopCloseOnClickSelf:i}){const c=b.useRef(null),d=b.useRef(null),[u,m]=b.useState(!1),p=()=>{m(!1),d&&d.current&&d.current.focus()};return b.useEffect(()=>{const x=d.current,h=c.current;if(u&&x!==null&&h!==null){const{top:f,left:g}=x.getBoundingClientRect();h.style.top=`${f+x.offsetHeight+od}px`,h.style.left=`${Math.min(g,window.innerWidth-h.offsetWidth-20)}px`}},[c,d,u]),b.useEffect(()=>{const x=d.current;if(x!==null&&u){const h=f=>{const g=f.target;i&&c.current&&c.current.contains(g)||x.contains(g)||m(!1)};return document.addEventListener("click",h),()=>{document.removeEventListener("click",h)}}},[c,d,u,i]),b.useEffect(()=>{const x=()=>{if(u){const h=d.current,f=c.current;if(h!==null&&f!==null){const{top:g}=h.getBoundingClientRect(),y=g+h.offsetHeight+od;y!==f.getBoundingClientRect().top&&(f.style.top=`${y}px`)}}};return document.addEventListener("scroll",x),()=>{document.removeEventListener("scroll",x)}},[d,c,u]),e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",disabled:t,"aria-label":n||s,className:r,onClick:()=>m(!u),ref:d,children:[a&&e.jsx("span",{className:a}),s&&e.jsx("span",{className:`${Z.toolbar.toolbarItem.text} display-none`,children:s}),e.jsx("i",{className:`${Z.iconChevronDown}`})]}),u&&Zt.createPortal(e.jsx(A2,{dropDownRef:c,onClose:p,children:l}),document.body)]})}function T2(t){const n=window.getComputedStyle(t).getPropertyValue("grid-template-columns");return n?{node:Hi(n)}:null}class Js extends cs{constructor(s,n){super(n),this.__templateColumns=s}static getType(){return"layout-container"}static clone(s){return new Js(s.__templateColumns,s.__key)}createDOM(s){const n=document.createElement("div");return ha(n,this.__templateColumns),typeof s.theme.layoutContainer=="string"&&ha(n,s.theme.layoutContainer),n}exportDOM(){const s=document.createElement("div");return s.style.gridTemplateColumns=this.__templateColumns,s.setAttribute("data-lexical-layout-container","true"),{element:s}}updateDOM(s,n){return s.__templateColumns!==this.__templateColumns&&(removeClassNamesFromElement(n,s.__templateColumns),ha(n,this.__templateColumns)),!1}static importDOM(){return{div:s=>s.hasAttribute("data-lexical-layout-container")?{conversion:T2,priority:2}:null}}static importJSON(s){return Hi().updateFromJSON(s)}updateFromJSON(s){return super.updateFromJSON(s).setTemplateColumns(s.templateColumns)}isShadowRoot(){return!0}canBeEmpty(){return!1}exportJSON(){return{...super.exportJSON(),templateColumns:this.__templateColumns}}getTemplateColumns(){return this.getLatest().__templateColumns}setTemplateColumns(s){const n=this.getWritable();return n.__templateColumns=s,n}}function Hi(t=""){return new Js(t)}function ea(t){return t instanceof Js}function O2(){return{node:Ta()}}class Xs extends cs{static getType(){return"layout-item"}static clone(s){return new Xs(s.__key)}createDOM(s,n){const r=document.createElement("div");return r.setAttribute("data-lexical-layout-item","true"),typeof s.theme.layoutItem=="string"&&ha(r,`${s.theme.layoutItem} ${(n==null?void 0:n._editable)&&s.theme.layoutItemEditable}`),r}updateDOM(){return!1}static importDOM(){return{div:s=>s.hasAttribute("data-lexical-layout-item")?{conversion:O2,priority:2}:null}}static importJSON(s){return Ta().updateFromJSON(s)}isShadowRoot(){return!0}}function Ta(t){return new Xs(t)}function ld(t){return t instanceof Xs}const Gp=Yt(),D2=Yt();function B2(){const[t]=He();return b.useEffect(()=>{if(!t.hasNodes([Js,Xs]))throw new Error("LayoutPlugin: LayoutContainerNode, or LayoutItemNode not registered on editor");const s=a=>{var i,c;const l=We();if(Ke(l)&&l.isCollapsed()&&l.anchor.offset===0){const d=Ts(l.anchor.getNode(),ea);if(ea(d)){const u=d.getParent(),m=u&&(a?u.getFirstChild():u==null?void 0:u.getLastChild()),p=a?(i=d.getFirstDescendant())==null?void 0:i.getKey():(c=d.getLastDescendant())==null?void 0:c.getKey();u!==null&&m===d&&l.anchor.key===p&&(a?d.insertBefore(ct()):d.insertAfter(ct()))}}return!1},n=a=>{a.isEmpty()&&a.append(ct())},r=a=>{const l=a.getParent();if(!ea(l)){const i=a.getChildren();for(const c of i)a.insertBefore(c);return a.remove(),!0}return!1};return pt(t.registerCommand(g0,()=>s(!1),ut),t.registerCommand(Em,()=>s(!1),ut),t.registerCommand(f0,()=>s(!0),ut),t.registerCommand(h0,()=>s(!0),ut),t.registerCommand(Gp,a=>(t.update(()=>{const l=Hi(a),i=tl(a);for(let c=0;c<i;c++)l.append(Ta().append(ct()));lo(l),l.selectStart()}),!0),kn),t.registerCommand(D2,({template:a,nodeKey:l})=>(t.update(()=>{const i=$n(l);if(!ea(i))return;const c=tl(a),d=tl(i.getTemplateColumns());if(c>d)for(let u=d;u<c;u++)i.append(Ta().append(ct()));else if(c<d)for(let u=d-1;u>=c;u--){const m=i.getChildAtIndex(u);ld(m)&&m.remove()}i.setTemplateColumns(a)}),!0),kn),t.registerNodeTransform(Xs,a=>{r(a)||n(a)}),t.registerNodeTransform(Js,a=>{const l=a.getChildren();if(!l.every(ld)){for(const i of l)a.insertBefore(i);a.remove()}}))},[t]),null}function tl(t){var s,n;return((n=(s=ga.filter(r=>r.value===t))==null?void 0:s[0])==null?void 0:n.count)||2}const ga=[{label:"2 columns (equal width)",value:"grid-cols-1 md:grid-cols-2",count:2},{label:"2 columns (25% - 75%)",value:"grid-cols-1 md:grid-cols-[1fr_3fr]",count:2},{label:"3 columns (equal width)",value:"grid-cols-1 md:grid-cols-3",count:3},{label:"3 columns (25% - 50% - 25%)",value:"grid-cols-1 md:grid-cols-[1fr_2fr_1fr]",count:3},{label:"4 columns (equal width)",value:"grid-cols-1 md:grid-cols-2 lg:grid-cols-4",count:4}];function F2({activeEditor:t,onClose:s}){var i;const[n,r]=b.useState(ga[0].value),a=(i=ga.find(c=>c.value===n))==null?void 0:i.label,l=()=>{t.dispatchCommand(Gp,n),s()};return e.jsxs(e.Fragment,{children:[e.jsx(gs,{buttonClassName:`${Z.toolbar.toolbarItem.base} block-controls`,buttonLabel:a,children:ga.map(({label:c,value:d})=>e.jsx(Re,{className:`${Z.dropdown.item.base} item`,onClick:()=>r(d),children:e.jsx("span",{className:`${Z.dropdown.item.text}`,children:c})},d))}),e.jsx(Vs,{onClick:l,children:"Insert"})]})}const z2=function(t,s,n,r,a,l,i,c){if(!t){let d;{const u=[n,r,a,l,i,c];let m=0;d=new Error(s.replace(/%s/g,function(){return u[m++]})),d.name="Invariant Violation"}throw d.framesToPop=1,d}};b.createContext({cellEditorConfig:null,cellEditorPlugins:null,set:()=>{}});function Jp({activeEditor:t,onClose:s}){const[n,r]=b.useState("5"),[a,l]=b.useState("5"),[i,c]=b.useState(!0);b.useEffect(()=>{const u=Number(n),m=Number(a);u&&u>0&&u<=500&&m&&m>0&&m<=50?c(!1):c(!0)},[n,a]);const d=()=>{t.dispatchCommand(Dm,{columns:a,rows:n}),s()};return e.jsxs(e.Fragment,{children:[e.jsx(In,{placeholder:"# of rows (1-500)",label:"Rows",onChange:r,value:n,"data-test-id":"table-modal-rows",type:"number"}),e.jsx(In,{placeholder:"# of columns (1-50)",label:"Columns",onChange:l,value:a,"data-test-id":"table-modal-columns",type:"number"}),e.jsx(yo,{"data-test-id":"table-model-confirm-insert",children:e.jsx(Vs,{disabled:i,onClick:d,children:"Confirm"})})]})}class lt extends Wm{constructor(s,n){super(s),this.title=s,this.keywords=n.keywords||[],this.icon=n.icon,this.keyboardShortcut=n.keyboardShortcut,this.onSelect=n.onSelect.bind(this)}}function P2({index:t,isSelected:s,onClick:n,onMouseEnter:r,option:a,theme:l}){let i=`${l.typeaheadPopover.ul.li.item}`;return s&&(i+=` ${l.typeaheadPopover.ul.li.selected}`),e.jsxs("li",{tabIndex:-1,className:`${i} ${l.typeaheadPopover.ul.li.base}`,ref:a.setRefElement,role:"option","aria-selected":s,id:"typeahead-item-"+t,onMouseEnter:r,onClick:n,children:[a.icon,e.jsx("span",{className:l.typeaheadPopover.ul.li.text,children:a.title})]},a.key)}function R2(t,s){const n=[];if(s==null)return n;const r=s.match(/^([1-9]\d?)(?:x([1-9]\d?)?)?$/);if(r!==null){const a=r[1],l=r[2]?[r[2]]:[1,2,3,4,5,6,7,8,9,10].map(String);n.push(...l.map(i=>new lt(`${a}x${i} Table`,{icon:e.jsx("i",{className:`${theme.typeaheadPopover.ul.li.icon} ${theme.icon.table}`}),keywords:["table"],onSelect:()=>t.dispatchCommand(Dm,{columns:i,rows:a})})))}return n}function H2(t,s){var r;const n=((r=t==null?void 0:t._config)==null?void 0:r.theme)||{};return[new lt("Paragraph",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.paragraph}`}),keywords:["normal","paragraph","p","text"],onSelect:()=>t.update(()=>{const a=We();Ke(a)&&fs(a,()=>ct())})}),...[1,2,3,4].map(a=>new lt(`Heading ${a}`,{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon[`h${a}`]}`}),keywords:["heading","header",`h${a}`],onSelect:()=>t.update(()=>{const l=We();Ke(l)&&fs(l,()=>Vm(`h${a}`))})})),new lt("Table",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.table}`}),keywords:["table","grid","spreadsheet","rows","columns"],onSelect:()=>s("Insert Table",a=>e.jsx(Jp,{activeEditor:t,onClose:a}))}),...Bp.map(a=>new lt(`Embed ${a.contentName}`,{icon:a.icon,keywords:[...a.keywords,"embed"],onSelect:()=>t.dispatchCommand(b0,a.type)})),new lt("Numbered List",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.number}`}),keywords:["numbered list","ordered list","ol"],onSelect:()=>t.dispatchCommand(zm,void 0)}),new lt("Bulleted List",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.bullet}`}),keywords:["bulleted list","unordered list","ul"],onSelect:()=>t.dispatchCommand(Pm,void 0)}),new lt("Check List",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.check}`}),keywords:["check list","todo list"],onSelect:()=>t.dispatchCommand(Rm,void 0)}),new lt("Quote",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.quote}`}),keywords:["block quote"],onSelect:()=>t.update(()=>{const a=We();Ke(a)&&fs(a,()=>Um())})}),new lt("Code",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.code}`}),keywords:["javascript","python","js","codeblock"],onSelect:()=>t.update(()=>{const a=We();if(Ke(a))if(a.isCollapsed())fs(a,()=>ur());else{const l=a.getTextContent(),i=ur();a.insertNodes([i]),a.insertRawText(l)}})}),new lt("Divider",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.horizontalRule}`}),keywords:["horizontal rule","divider","hr"],onSelect:()=>t.dispatchCommand(Hm,void 0)}),new lt("Image",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.image}`}),keywords:["image","photo","picture","file"],onSelect:()=>s("Insert Image",a=>e.jsx(Wp,{activeEditor:t,onClose:a}))}),new lt("Collapsible",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.caretRight}`}),keywords:["collapse","collapsible","toggle"],onSelect:()=>t.dispatchCommand(Bi,void 0)}),new lt("Collapsible No Preview",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.caretRight}`}),keywords:["collapse","collapsible","toggle"],onSelect:()=>t.dispatchCommand(zp,void 0)}),new lt("Columns Layout",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.columns}`}),keywords:["columns","layout","grid"],onSelect:()=>s("Insert Columns Layout",a=>e.jsx(F2,{activeEditor:t,onClose:a}))}),new lt("Button",{icon:e.jsx("i",{className:`${n.typeaheadPopover.ul.li.icon} ${n.icon.columns}`}),keywords:["button"],onSelect:()=>s("Insert Button",a=>e.jsx(Hp,{activeEditor:t,onClose:a}))}),...["left","center","right","justify"].map(a=>new lt(`Align ${a}`,{icon:e.jsx("i",{className:`icon ${a}-align`}),keywords:["align","justify",a],onSelect:()=>t.dispatchCommand(Is,a)}))]}function W2(){var u;const[t]=He(),[s,n]=Mr(),[r,a]=b.useState(null),l=((u=t==null?void 0:t._config)==null?void 0:u.theme)||{},i=Bm("/",{minLength:0}),c=b.useMemo(()=>{const m=H2(t,n);if(!r)return m;const p=new RegExp(r,"i");return[...R2(t,r),...m.filter(x=>p.test(x.title)||x.keywords.some(h=>p.test(h)))]},[t,r,n]),d=b.useCallback((m,p,x,h)=>{t.update(()=>{p==null||p.remove(),m.onSelect(h),x()})},[t]);return e.jsxs(e.Fragment,{children:[s,e.jsx(Fm,{onQueryChange:a,onSelectOption:d,triggerFn:i,options:c,menuRenderFn:(m,{selectedIndex:p,selectOptionAndCleanUp:x,setHighlightedIndex:h})=>m.current&&c.length?Zt.createPortal(e.jsx("div",{className:`${l.typeaheadPopover.base} ${l.componentPickerMenu}`,children:e.jsx("ul",{children:c.map((f,g)=>e.jsx(P2,{index:g,isSelected:p===g,theme:l,onClick:()=>{h(g),x(f)},onMouseEnter:()=>{h(g)},option:f},f.key))})}),m.current):null})]})}const id=["image/","image/heic","image/heif","image/gif","image/webp"];function V2(){const[t]=He();return b.useEffect(()=>t.registerCommand(y0,s=>((async()=>{const n=await v0(s,[id].flatMap(r=>r));for(const{file:r,result:a}of n)w0(r,id)&&t.dispatchCommand(wo,{altText:r.name,src:a})})(),!0),ut),[t]),null}function sl(t){return t instanceof HTMLElement}class Xp{constructor(s,n){this._x=s,this._y=n}get x(){return this._x}get y(){return this._y}equals({x:s,y:n}){return this.x===s&&this.y===n}calcDeltaXTo({x:s}){return this.x-s}calcDeltaYTo({y:s}){return this.y-s}calcHorizontalDistanceTo(s){return Math.abs(this.calcDeltaXTo(s))}calcVerticalDistance(s){return Math.abs(this.calcDeltaYTo(s))}calcDistanceTo(s){return Math.sqrt(Math.pow(this.calcDeltaXTo(s),2)+Math.pow(this.calcDeltaYTo(s),2))}}function U2(t){return t instanceof Xp}class Es{constructor(s,n,r,a){const[l,i]=n<=a?[n,a]:[a,n],[c,d]=s<=r?[s,r]:[r,s];this._top=l,this._right=d,this._left=c,this._bottom=i}get top(){return this._top}get right(){return this._right}get bottom(){return this._bottom}get left(){return this._left}get width(){return Math.abs(this._left-this._right)}get height(){return Math.abs(this._bottom-this._top)}equals({top:s,left:n,bottom:r,right:a}){return s===this._top&&r===this._bottom&&n===this._left&&a===this._right}contains(s){if(U2(s)){const{x:n,y:r}=s,a=r<this._top,l=r>this._bottom,i=n<this._left,c=n>this._right;return{reason:{isOnBottomSide:l,isOnLeftSide:i,isOnRightSide:c,isOnTopSide:a},result:!a&&!l&&!i&&!c}}else{const{top:n,left:r,bottom:a,right:l}=s;return n>=this._top&&n<=this._bottom&&a>=this._top&&a<=this._bottom&&r>=this._left&&r<=this._right&&l>=this._left&&l<=this._right}}intersectsWith(s){const{left:n,top:r,width:a,height:l}=s,{left:i,top:c,width:d,height:u}=this,m=n+a>=i+d?n+a:i+d,p=r+l>=c+u?r+l:c+u,x=n<=i?n:i,h=r<=c?r:c;return m-x<=a+d&&p-h<=l+u}generateNewRect({left:s=this.left,top:n=this.top,right:r=this.right,bottom:a=this.bottom}){return new Es(s,n,r,a)}static fromLTRB(s,n,r,a){return new Es(s,n,r,a)}static fromLWTH(s,n,r,a){return new Es(s,r,s+n,r+a)}static fromPoints(s,n){const{y:r,x:a}=s,{y:l,x:i}=n;return Es.fromLTRB(a,r,i,l)}static fromDOM(s){const{top:n,width:r,left:a,height:l}=s.getBoundingClientRect();return Es.fromLWTH(a,r,n,l)}}const Hl=4,q2=2,G2="draggable-block-menu",cd="application/x-lexical-drag-block",dd=28,J2=1,X2=-1,ud=0;let ba=1/0;function Z2(t){return t===0?1/0:ba>=0&&ba<t?ba:Math.floor(t/2)}function Y2(t){return t.getEditorState().read(()=>Al().getChildrenKeys())}function Zp(t){const s=(d,u)=>d?parseFloat(window.getComputedStyle(d)[u]):0,{marginTop:n,marginBottom:r}=window.getComputedStyle(t),a=s(t.previousElementSibling,"marginBottom"),l=s(t.nextElementSibling,"marginTop"),i=Math.max(parseFloat(n),a);return{marginBottom:Math.max(parseFloat(r),l),marginTop:i}}function nl(t,s,n,r=!1){const a=t.getBoundingClientRect(),l=Y2(s);let i=null;return s.getEditorState().read(()=>{if(r){const[u,m]=[s.getElementByKey(l[0]),s.getElementByKey(l[l.length-1])],[p,x]=[u==null?void 0:u.getBoundingClientRect(),m==null?void 0:m.getBoundingClientRect()];if(p&&x&&(n.y<p.top?i=u:n.y>x.bottom&&(i=m),i))return}let c=Z2(l.length),d=ud;for(;c>=0&&c<l.length;){const u=l[c],m=s.getElementByKey(u);if(m===null)break;const p=new Xp(n.x,n.y),x=Es.fromDOM(m),{marginTop:h,marginBottom:f}=Zp(m),g=x.generateNewRect({bottom:x.bottom+f,left:a.left,right:a.right,top:x.top-h}),{result:y,reason:{isOnTopSide:v,isOnBottomSide:j}}=g.contains(p);if(y){i=m,ba=c;break}d===ud&&(v?d=X2:j?d=J2:d=1/0),c+=d}}),i}function Q2(t){return!!t.closest(`.${G2}`)}function K2(t,s,n){if(!t){s.style.opacity="0",s.style.transform="translate(-10000px, -10000px)";return}const r=t.getBoundingClientRect(),a=window.getComputedStyle(t),l=s.getBoundingClientRect(),i=n.getBoundingClientRect(),c=r.top+(parseInt(a.lineHeight,10)-l.height)/2-i.top,d=Hl;s.style.opacity="1",s.style.transform=`translate(${d}px, ${c}px)`}function ew(t,s){const{transform:n}=s.style;s.style.transform="translateZ(0)",t.setDragImage(s,0,0),setTimeout(()=>{s.style.transform=n})}function tw(t,s,n,r){const{top:a,height:l}=s.getBoundingClientRect(),{top:i,width:c}=r.getBoundingClientRect(),{marginTop:d,marginBottom:u}=Zp(s);let m=a;n>=a?m+=l+u/2:m-=d/2;const p=m-i-q2,x=dd-Hl;t.style.transform=`translate(${x}px, ${p}px)`,t.style.width=`${c-(dd-Hl)*2}px`,t.style.opacity=".4"}function sw(t){t&&(t.style.opacity="0",t.style.transform="translate(-10000px, -10000px)")}function nw(t,s,n){var x;const r=s.parentElement,a=b.useRef(null),l=b.useRef(null),i=b.useRef(!1),c=((x=t==null?void 0:t._config)==null?void 0:x.theme)||{},[d,u]=b.useState(null);b.useEffect(()=>{function h(g){const y=g.target;if(!sl(y)){u(null);return}if(Q2(y))return;const v=nl(s,t,g);u(v)}function f(){u(null)}return r==null||r.addEventListener("mousemove",h),r==null||r.addEventListener("mouseleave",f),()=>{r==null||r.removeEventListener("mousemove",h),r==null||r.removeEventListener("mouseleave",f)}},[r,s,t]),b.useEffect(()=>{a.current&&K2(d,a.current,s)},[s,d]),b.useEffect(()=>{function h(g){if(!i.current)return!1;const[y]=Tc(g);if(y)return!1;const{pageY:v,target:j}=g;if(!sl(j))return!1;const N=nl(s,t,g,!0),S=l.current;return N===null||S===null?!1:(tw(S,N,v,s),g.preventDefault(),!0)}function f(g){if(!i.current)return!1;const[y]=Tc(g);if(y)return!1;const{target:v,dataTransfer:j,pageY:N}=g,S=(j==null?void 0:j.getData(cd))||"",w=$n(S);if(!w||!sl(v))return!1;const k=nl(s,t,g,!0);if(!k)return!1;const $=Os(k);if(!$)return!1;if($===w)return!0;const E=k.getBoundingClientRect().top;return N>=E?$.insertAfter(w):$.insertBefore(w),u(null),!0}return pt(t.registerCommand(Tm,g=>h(g),ut),t.registerCommand(Am,g=>f(g),Ia))},[s,t]);function m(h){const f=h.dataTransfer;if(!f||!d)return;ew(f,d);let g="";t.update(()=>{const y=Os(d);y&&(g=y.getKey())}),i.current=!0,f.setData(cd,g)}function p(){i.current=!1,sw(l.current)}return Zt.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`icon ${c.draggableBlockMenu.base}`,ref:a,draggable:!0,onDragStart:m,onDragEnd:p,children:e.jsx("div",{className:n?`${c.draggableBlockMenu.icon}  icon`:""})}),e.jsx("div",{className:`draggable-block-target-line ${c.draggableBlockTargetLine.base}`,ref:l})]}),s)}function rw({anchorElem:t=document.body}){const[s]=He();return nw(s,t,s._editable)}class pr extends ao{static getType(){return"icon"}static clone(s){return new pr(s.__iconName,s.__key)}constructor(s,n){super(n),this.__iconName=s}static importJSON(s){return new pr(s.iconName)}exportJSON(){return{type:"icon",version:1,iconName:this.__iconName}}createDOM(s){const n=document.createElement("span");return n.className="inline-block align-middle mr-1",n}updateDOM(){return!1}decorate(s,n){var a;const r=(a=n==null?void 0:n.theme)==null?void 0:a.Icons[this.__iconName];return r?C.createElement(r,{className:"w-[1.5em] h-[1.5em] -mt-[5px]"}):e.jsx("span",{children:"Icon not found"})}isInline(){return!0}}function aw(t){return new pr(t)}const ow={search:t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M17.5 17.5L22 22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M20 11C20 6.02944 15.9706 2 11 2C6.02944 2 2 6.02944 2 11C2 15.9706 6.02944 20 11 20C15.9706 20 20 15.9706 20 11Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"})]})};class md extends Wm{constructor(s,n,r){super(s),this.title=s,this.emoji=n,this.keywords=r.keywords||[]}}function lw({index:t,theme:s,isSelected:n,onClick:r,onMouseEnter:a,option:l}){let i=`${s.typeaheadPopover.ul.li.item}`;return n&&(i+=` ${s.typeaheadPopover.ul.li.selected}`),e.jsx("li",{tabIndex:-1,className:`${i} ${s.typeaheadPopover.ul.li.base}`,ref:l.setRefElement,role:"option","aria-selected":n,id:"typeahead-item-"+t,onMouseEnter:a,onClick:r,children:e.jsxs("span",{className:s.typeaheadPopover.ul.li.text,children:[typeof l.emoji=="string"?e.jsx(e.Fragment,{children:l.emoji}):e.jsx("span",{className:"inline-block align-middle mr-1",children:l.emoji}),l.title]})},l.key)}const iw=10;function cw(){var p;const[t]=He(),[s,n]=b.useState(null),[r,a]=b.useState([]),l=((p=t==null?void 0:t._config)==null?void 0:p.theme)||{};b.useEffect(()=>{_p(()=>import("./emoji-list-Dtzdqy2u.js"),[]).then(x=>a(x.default))},[]);const i=Object.entries((l==null?void 0:l.Icons)||ow).map(([x,h])=>new md(x,e.jsx(h,{className:"w-[1em] h-[1em]"}),{keywords:[x]})),c=b.useMemo(()=>{const x=(r||[]).map(({emoji:h,aliases:f,tags:g})=>new md(f[0],h,{keywords:[...f,...g]}));return[...i,...x]},[r]),d=Bm(":",{minLength:0}),u=b.useMemo(()=>c.filter(x=>s!=null?new RegExp(s,"gi").exec(x.title)||x.keywords!=null?x.keywords.some(h=>new RegExp(s,"gi").exec(h)):!1:c).slice(0,iw),[c,s]),m=b.useCallback((x,h,f)=>{t.update(()=>{const g=We();!Ke(g)||x==null||(h&&h.remove(),typeof x.emoji=="string"?g.insertNodes([wi(x.emoji)]):g.insertNodes([aw(x.title)]),f())})},[t]);return e.jsx(Fm,{onQueryChange:n,onSelectOption:m,triggerFn:d,options:u,menuRenderFn:(x,{selectedIndex:h,selectOptionAndCleanUp:f,setHighlightedIndex:g})=>x.current==null||u.length===0?null:x.current&&u.length?Zt.createPortal(e.jsx("div",{className:`${l.typeaheadPopover.base} ${l.componentPickerMenu}`,children:e.jsx("ul",{children:u.map((y,v)=>e.jsx(lw,{index:v,theme:l,isSelected:h===v,onClick:()=>{g(v),f(y)},onMouseEnter:()=>{g(v)},option:y},y.key))})}),x.current):null})}function xr(t){const s=t.anchor,n=t.focus,r=t.anchor.getNode(),a=t.focus.getNode();return r===a?r:t.isBackward()?Ol(n)?r:a:Ol(s)?r:a}const dw=10,uw=5;function pd(t,s,n,r=dw,a=uw){const l=n.parentElement;if(t===null||!l){s.style.opacity="0",s.style.transform="translate(-10000px, -10000px)";return}const i=s.getBoundingClientRect(),c=n.getBoundingClientRect(),d=l.getBoundingClientRect();let u=t.top-r,m=t.left-a;u<d.top&&(u+=i.height+t.height+r*2),m+i.width>d.right&&(m=d.right-i.width-a),u-=c.top,m-=c.left,s.style.opacity="1",s.style.transform=`translate(${m}px, ${u}px)`}function mw(t){return!0}function pw({editor:t,isLink:s,setIsLink:n,anchorElem:r,isLinkEditMode:a,setIsLinkEditMode:l}){const i=b.useRef(null),c=b.useRef(null),[d,u]=b.useState(""),[m,p]=b.useState("https://"),[x,h]=b.useState(null),f=b.useCallback(()=>{var k,$;const v=We();if(Ke(v)){const E=xr(v),M=E.getParent();is(M)?u(M.getURL()):is(E)?u(E.getURL()):u("")}const j=i.current,N=window.getSelection(),S=document.activeElement;if(j===null)return;const w=t.getRootElement();if(v!==null&&N!==null&&w!==null&&w.contains(N.anchorNode)&&t.isEditable()){const E=($=(k=N.focusNode)==null?void 0:k.parentElement)==null?void 0:$.getBoundingClientRect();E&&(E.y+=40,pd(E,j,r)),h(v)}else(!S||S.className!==Z.linkEditor.linkInput.base)&&(w!==null&&pd(null,j,r),h(null),l&&l(!1),u(""));return!0},[r,t,l]);b.useEffect(()=>{const v=r.parentElement,j=()=>{t.getEditorState().read(()=>{f()})};return window.addEventListener("resize",j),v&&v.addEventListener("scroll",j),()=>{window.removeEventListener("resize",j),v&&v.removeEventListener("scroll",j)}},[r.parentElement,t,f]),b.useEffect(()=>pt(t.registerUpdateListener(({editorState:v})=>{v.read(()=>{f()})}),t.registerCommand(co,()=>(f(),!0),ut),t.registerCommand(N0,()=>s?(n(!1),!0):!1,Ia)),[t,f,n,s]),b.useEffect(()=>{t.getEditorState().read(()=>{f()})},[t,f]),b.useEffect(()=>{a&&c.current&&c.current.focus()},[a,s]);const g=v=>{v.key==="Enter"?(v.preventDefault(),y()):v.key==="Escape"&&(v.preventDefault(),l&&l(!1))},y=()=>{x!==null&&(d!==""&&t.dispatchCommand(Ds,m),p("https://"),l&&l(!1))};return e.jsx("div",{ref:i,className:Z.linkEditor.base||"link-editor",children:s?a?e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:c,className:Z.linkEditor.linkInput.base||"link-input",value:m,onChange:v=>{p(v.target.value)},onKeyDown:v=>{g(v)}}),e.jsxs("div",{children:[e.jsx("div",{className:Z.linkEditor.div.linkCancel||"link-cancel",role:"button",tabIndex:0,onMouseDown:v=>v.preventDefault(),onClick:()=>{l&&l(!1)}}),e.jsx("div",{className:Z.linkEditor.div.linkConfirm||"link-confirm",role:"button",tabIndex:0,onMouseDown:v=>v.preventDefault(),onClick:y})]})]}):e.jsxs("div",{className:Z.linkEditor.linkView.base||"link-view",children:[e.jsx("a",{className:Z.linkEditor.linkView.a,href:d,target:"_blank",rel:"noopener noreferrer",children:d}),e.jsx("div",{className:Z.linkEditor.div.linkEdit||"link-edit",role:"button",tabIndex:0,onMouseDown:v=>v.preventDefault(),onClick:()=>{p(d),l&&l(!0)}}),e.jsx("div",{className:Z.linkEditor.div.linkTrash||"link-trash",role:"button",tabIndex:0,onMouseDown:v=>v.preventDefault(),onClick:()=>{t.dispatchCommand(Ds,null)}})]}):null})}function xw(t,s,n,r){const[a,l]=b.useState(t),[i,c]=b.useState(!1);return b.useEffect(()=>{function d(){const u=We();if(Ke(u)){const m=xr(u),p=Ts(m,is),x=Ts(m,C0);c(p!==null&&x===null)}}return pt(t.registerUpdateListener(({editorState:u})=>{u.read(()=>{d()})}),t.registerCommand(co,(u,m)=>(d(),l(m),!1),ar),t.registerCommand(j0,u=>{const m=We();if(Ke(m)){const p=xr(m),x=Ts(p,is);if(is(x)&&(u.metaKey||u.ctrlKey))return window.open(x.getURL(),"_blank"),!0}return!1},ut))},[t]),Zt.createPortal(e.jsx(pw,{editor:a,isLink:i,anchorElem:s,setIsLink:c,isLinkEditMode:n,setIsLinkEditMode:r}),s)}function hw({anchorElem:t=document.body,isLinkEditMode:s,setIsLinkEditMode:n}){const[r]=He();return xw(r,t,s,n)}function fw(t,s){const n=t.getRangeAt(0);let r;if(t.anchorNode===s){let a=s;for(;a.firstElementChild!=null;)a=a.firstElementChild;r=a.getBoundingClientRect()}else r=n.getBoundingClientRect();return r}const gw=10,bw=5;function yw(t,s,n,r=gw,a=bw){const l=n.parentElement;if(t===null||!l){s.style.opacity="0",s.style.transform="translate(-10000px, -10000px)";return}const i=s.getBoundingClientRect(),c=n.getBoundingClientRect(),d=l.getBoundingClientRect();let u=t.top-i.height-r,m=t.left-a;u<d.top&&(u+=i.height+t.height+r*2),m+i.width>d.right&&(m=d.right-i.width-a),u-=c.top,m-=c.left,s.style.opacity="1",s.style.transform=`translate(${m}px, ${u}px)`}function vw({editor:t,anchorElem:s,isLink:n,isBold:r,isItalic:a,isUnderline:l,isCode:i,isStrikethrough:c,isSubscript:d,isSuperscript:u}){const m=b.useRef(null),p=b.useCallback(()=>{n?t.dispatchCommand(Ds,null):t.dispatchCommand(Ds,"https://")},[t,n]);function x(g){m!=null&&m.current&&(g.buttons===1||g.buttons===3)&&(m.current.style.pointerEvents="none")}function h(g){m!=null&&m.current&&(m.current.style.pointerEvents="auto")}b.useEffect(()=>{if(m!=null&&m.current)return document.addEventListener("mousemove",x),document.addEventListener("mouseup",h),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",h)}},[m]);const f=b.useCallback(()=>{const g=We(),y=m.current,v=window.getSelection();if(y===null)return;const j=t.getRootElement();if(g!==null&&v!==null&&!v.isCollapsed&&j!==null&&j.contains(v.anchorNode)){const N=fw(v,j);yw(N,y,s)}},[t,s]);return b.useEffect(()=>{const g=s.parentElement,y=()=>{t.getEditorState().read(()=>{f()})};return window.addEventListener("resize",y),g&&g.addEventListener("scroll",y),()=>{window.removeEventListener("resize",y),g&&g.removeEventListener("scroll",y)}},[t,f,s]),b.useEffect(()=>(t.getEditorState().read(()=>{f()}),pt(t.registerUpdateListener(({editorState:g})=>{g.read(()=>{f()})}),t.registerCommand(co,()=>(f(),!1),ut))),[t,f]),e.jsx("div",{ref:m,className:t.isEditable()?`${Z.floatingTextFormatPopup.base}`:"",children:t.isEditable()&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{t.dispatchCommand(Ut,"bold")},className:`${Z.floatingTextFormatPopup.popupItem.base} ${Z.floatingTextFormatPopup.popupItem.spaced} `+(r?`${Z.floatingTextFormatPopup.popupItem.active}`||"active":""),"aria-label":"Format text as bold",children:e.jsx("i",{className:`${Z.floatingTextFormatPopup.popupItem.icon} ${Z.icon.bold}`})}),e.jsx("button",{onClick:()=>{t.dispatchCommand(Ut,"italic")},className:`${Z.floatingTextFormatPopup.popupItem.base} ${Z.floatingTextFormatPopup.popupItem.spaced} `+(a?`${Z.floatingTextFormatPopup.popupItem.active}`||"active":""),"aria-label":"Format text as italics",children:e.jsx("i",{className:`${Z.floatingTextFormatPopup.popupItem.icon} ${Z.icon.italic}`})}),e.jsx("button",{onClick:()=>{t.dispatchCommand(Ut,"underline")},className:`${Z.floatingTextFormatPopup.popupItem.base} ${Z.floatingTextFormatPopup.popupItem.spaced} `+(l?`${Z.floatingTextFormatPopup.popupItem.active}`||"active":""),"aria-label":"Format text to underlined",children:e.jsx("i",{className:`${Z.floatingTextFormatPopup.popupItem.icon} ${Z.icon.underline}`})}),e.jsx("button",{onClick:()=>{t.dispatchCommand(Ut,"strikethrough")},className:`${Z.floatingTextFormatPopup.popupItem.base} ${Z.floatingTextFormatPopup.popupItem.spaced}`+(c?`${Z.floatingTextFormatPopup.popupItem.active}`||"active":""),"aria-label":"Format text with a strikethrough",children:e.jsx("i",{className:`${Z.floatingTextFormatPopup.popupItem.icon} ${Z.icon.strikethrough}`})}),e.jsx("button",{onClick:()=>{t.dispatchCommand(Ut,"subscript")},className:`${Z.floatingTextFormatPopup.popupItem.base} ${Z.floatingTextFormatPopup.popupItem.spaced} `+(d?`${Z.floatingTextFormatPopup.popupItem.active}`||"active":""),title:"Subscript","aria-label":"Format Subscript",children:e.jsx("i",{className:`${Z.floatingTextFormatPopup.popupItem.icon} ${Z.icon.subscript}`})}),e.jsx("button",{onClick:()=>{t.dispatchCommand(Ut,"superscript")},className:`${Z.floatingTextFormatPopup.popupItem.base} ${Z.floatingTextFormatPopup.popupItem.spaced} `+(u?`${Z.floatingTextFormatPopup.popupItem.active}`||"active":""),title:"Superscript","aria-label":"Format Superscript",children:e.jsx("i",{className:`${Z.floatingTextFormatPopup.popupItem.icon} ${Z.icon.subscript}`})}),e.jsx("button",{onClick:()=>{t.dispatchCommand(Ut,"code")},className:`${Z.floatingTextFormatPopup.popupItem.base} ${Z.floatingTextFormatPopup.popupItem.spaced}`+(i?`${Z.floatingTextFormatPopup.popupItem.active}`||"active":""),"aria-label":"Insert code block",children:e.jsx("i",{className:`${Z.floatingTextFormatPopup.popupItem.icon} ${Z.icon.code}`})}),e.jsx("button",{onClick:p,className:`${Z.floatingTextFormatPopup.popupItem.base} ${Z.floatingTextFormatPopup.popupItem.spaced}`+(n?`${Z.floatingTextFormatPopup.popupItem.active}`||"active":""),"aria-label":"Insert link",children:e.jsx("i",{className:`${Z.floatingTextFormatPopup.popupItem.icon} ${Z.icon.link}`})})]})})}function ww(t,s){const[n,r]=b.useState(!1),[a,l]=b.useState(!1),[i,c]=b.useState(!1),[d,u]=b.useState(!1),[m,p]=b.useState(!1),[x,h]=b.useState(!1),[f,g]=b.useState(!1),[y,v]=b.useState(!1),[j,N]=b.useState(!1),S=b.useCallback(()=>{t.getEditorState().read(()=>{if(t.isComposing())return;const w=We(),k=window.getSelection(),$=t.getRootElement();if(k!==null&&(!Ke(w)||$===null||!$.contains(k.anchorNode))){r(!1);return}if(!Ke(w))return;const E=xr(w);c(w.hasFormat("bold")),u(w.hasFormat("italic")),p(w.hasFormat("underline")),h(w.hasFormat("strikethrough")),g(w.hasFormat("subscript")),v(w.hasFormat("superscript")),N(w.hasFormat("code"));const M=E.getParent();is(M)||is(E)?l(!0):l(!1),!k0(w.anchor.getNode())&&w.getTextContent()!==""?r(oo(E)):r(!1);const _=w.getTextContent().replace(/\n/g,"");if(!w.isCollapsed()&&_===""){r(!1);return}})},[t]);return b.useEffect(()=>(document.addEventListener("selectionchange",S),()=>{document.removeEventListener("selectionchange",S)}),[S]),b.useEffect(()=>pt(t.registerUpdateListener(()=>{S()}),t.registerRootListener(()=>{t.getRootElement()===null&&r(!1)})),[t,S]),!n||a?null:Zt.createPortal(e.jsx(vw,{editor:t,anchorElem:s,isLink:a,isBold:i,isItalic:d,isStrikethrough:x,isSubscript:f,isSuperscript:y,isUnderline:m,isCode:j}),s)}function jw({anchorElem:t=document.body}){const[s]=He();return ww(s,t)}class Ln extends $0{static getType(){return"keyword"}static clone(s){return new Ln(s.__text,s.__key)}static importJSON(s){const n=Yp(s.text);return n.setFormat(s.format),n.setDetail(s.detail),n.setMode(s.mode),n.setStyle(s.style),n}exportJSON(){return{...super.exportJSON(),type:"keyword",version:1}}createDOM(s){const n=super.createDOM(s);return n.style.cursor="default",n.className="keyword",n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}isTextEntity(){return!0}}function Yp(t){return new Ln(t)}const Cw=/(^|$|[^A-Za-z-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------])(congrats|congratulations|gratuluju|gratuluji|gratulujeme|blahopeju|blahopeji|blahopejeme|Til lykke|Tillykke|Glckwunsch|Gratuliere|felicitaciones|enhorabuena|paljon onnea|onnittelut|Flicitations|gratula|gratullok|gratullunk|congratulazioni|complimenti|||||gratulerer|Gefeliciteerd|gratulacje|Parabns|parabns|felicitaes|felicitri| |||gratulujem|blahoelm|||tebrikler|tebrik ederim||||||baie geluk|veels geluk||estitam|estitke|estitamo||||badhai|||| |hongera|||||Chc mng| |mazel tov|mazal tov)(^|$|[^A-Za-z-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------])/i;function Nw(){const[t]=He();b.useEffect(()=>{if(!t.hasNodes([Ln]))throw new Error("KeywordsPlugin: KeywordNode not registered on editor")},[t]);const s=b.useCallback(r=>Yp(r.getTextContent()),[]),n=b.useCallback(r=>{const a=Cw.exec(r);if(a===null)return null;const l=a[2].length,i=a.index+a[1].length;return{end:i+l,start:i}},[]);return S0(n,Ln,s),null}function kw(){return e.jsx(_0,{validateUrl:mw})}function $w(t){const s=t.getNodes();return s.length===0?new Set([t.anchor.getNode().getParentOrThrow(),t.focus.getNode().getParentOrThrow()]):new Set(s.map(n=>Ir(n)?n:n.getParentOrThrow()))}function Sw(t){const s=We();if(!Ke(s))return!1;const n=$w(s);let r=0;for(const a of n)if(Dl(a))r=Math.max(Oc(a)+1,r);else if(I0(a)){const l=a.getParent();if(!Dl(l))throw new Error("ListMaxIndentLevelPlugin: A ListItemNode must have a ListNode for a parent.");r=Math.max(Oc(l)+1,r)}return r<=t}function _w({maxDepth:t}){const[s]=He();return b.useEffect(()=>s.registerCommand(qm,()=>!Sw(t??7),ar),[s,t]),null}function Iw({maxLength:t}){const[s]=He();return b.useEffect(()=>{let n=null;return s.registerNodeTransform(L0,r=>{const a=We();if(!Ke(a)||!a.isCollapsed())return;const l=s.getEditorState(),i=l.read(()=>r.getTextContentSize()),c=r.getTextContentSize();if(i!==c){const d=c-t,u=a.anchor;d>0&&(i===t&&n!==l?(n=l,E0(s,l)):M0(s,u,d))}})},[s,t]),null}const Lw=1,Ew=100;let Qp=0,xd=!1;function Mw(){window.addEventListener("keydown",t=>{t.keyCode===9&&(Qp=t.timeStamp)},!0)}function Aw(){const[t]=He();return b.useEffect(()=>(xd||(Mw(),xd=!0),t.registerCommand(A0,s=>{const n=We();return Ke(n)&&Qp+Ew>s.timeStamp&&ji(n.clone()),!1},Lw)),[t]),null}const Tw=33,hd=92;function Ow({editor:t}){const s=b.useRef(null),n=b.useRef(null),r=b.useRef(null),[a,l]=b.useState(!1),i=b.useRef(null),[c,d]=b.useState(null),[u,m]=b.useState(null),[p,x]=b.useState(null),h=b.useCallback(()=>{m(null),s.current=null,x(null),i.current=null,r.current=null},[]);b.useEffect(()=>{const $=new Set;return pt(t.registerMutationListener(cr,E=>{for(const[M,_]of E)_==="destroyed"?$.delete(M):$.add(M);l($.size>0)}),t.registerNodeTransform(cr,E=>{if(E.getColWidths())return E;const M=E.getColumnCount(),_=hd;return E.setColWidths(Array(M).fill(_)),E}))},[t]),b.useEffect(()=>{if(!a)return;const $=L=>{const D=L.target;if(Jm(D)){if(p){L.preventDefault(),L.stopPropagation(),d({x:L.clientX,y:L.clientY});return}if(!(n.current&&n.current.contains(D))&&s.current!==D){s.current=D;const A=O0(D);A&&u!==A?t.getEditorState().read(()=>{const T=Os(A.elem);if(!T)throw new Error("TableCellResizer: Table cell node not found.");const O=Jo(T),B=Xm(O,t.getElementByKey(O.getKey()));if(!B)throw new Error("TableCellResizer: Table element not found.");s.current=D,r.current=B.getBoundingClientRect(),m(A)},{editor:t}):A==null&&h()}}},E=L=>{L.pointerType==="touch"&&$(L)},M=n.current;M==null||M.addEventListener("pointermove",$,{capture:!0});const _=t.registerRootListener((L,D)=>{D==null||D.removeEventListener("pointermove",$),D==null||D.removeEventListener("pointerdown",E),L==null||L.addEventListener("pointermove",$),L==null||L.addEventListener("pointerdown",E)});return()=>{_(),M==null||M.removeEventListener("pointermove",$)}},[u,p,t,h,a]);const f=$=>$==="bottom",g=b.useCallback($=>{if(!u)throw new Error("TableCellResizer: Expected active cell.");t.update(()=>{const E=Os(u.elem);if(!dr(E))throw new Error("TableCellResizer: Table cell node not found.");const M=Jo(E),_=Gm(E),L=M.getChildren(),A=E.getColSpan()===M.getColumnCount()?_:_+E.getRowSpan()-1;if(A>=L.length||A<0)throw new Error("Expected table cell to be inside of table row.");const T=L[A];if(!_a(T))throw new Error("Expected table row");let O=T.getHeight();if(O===void 0){const F=T.getChildren();O=Math.min(...F.map(z=>y(z,t)??1/0))}const B=Math.max(O+$,Tw);T.setHeight(B)},{tag:"skip-scroll-into-view"})},[u,t]),y=($,E)=>{const M=E.getElementByKey($.getKey());return M==null?void 0:M.clientHeight},v=($,E)=>{for(let M=0;M<E.length;M++)for(let _=0;_<E[M].length;_++)if(E[M][_].cell===$)return _},j=b.useCallback($=>{if(!u)throw new Error("TableCellResizer: Expected active cell.");t.update(()=>{const E=Os(u.elem);if(!dr(E))throw new Error("TableCellResizer: Table cell node not found.");const M=Jo(E),[_]=T0(M,null,null),L=v(E,_);if(L===void 0)throw new Error("TableCellResizer: Table column not found.");const D=M.getColWidths();if(!D)return;const A=D[L];if(A===void 0)return;const T=[...D],O=Math.max(A+$,hd);T[L]=O,M.setColWidths(T)},{tag:"skip-scroll-into-view"})},[u,t]),N=b.useCallback($=>{const E=M=>{if(M.preventDefault(),M.stopPropagation(),!u)throw new Error("TableCellResizer: Expected active cell.");if(i.current){const{x:_,y:L}=i.current;if(u===null)return;const D=Dc(M.target);if(f($)){const A=(M.clientY-L)/D;g(A)}else{const A=(M.clientX-_)/D;j(A)}h(),document.removeEventListener("pointerup",E)}};return E},[u,h,j,g]),S=b.useCallback($=>E=>{if(E.preventDefault(),E.stopPropagation(),!u)throw new Error("TableCellResizer: Expected active cell.");i.current={x:E.clientX,y:E.clientY},d(i.current),x($),document.addEventListener("pointerup",N($))},[u,N]),k=b.useCallback(()=>{if(u){const{height:$,width:E,top:M,left:_}=u.elem.getBoundingClientRect(),L=Dc(u.elem),D=16,A={bottom:{backgroundColor:"none",cursor:"row-resize",height:`${D}px`,left:`${window.scrollX+_}px`,top:`${window.scrollY+M+$-D/2}px`,width:`${E}px`},right:{backgroundColor:"none",cursor:"col-resize",height:`${$}px`,left:`${window.scrollX+_+E-D/2}px`,top:`${window.scrollY+M}px`,width:`${D}px`}},T=r.current;return p&&c&&T&&(f(p)?(A[p].left=`${window.scrollX+T.left}px`,A[p].top=`${window.scrollY+c.y/L}px`,A[p].height="3px",A[p].width=`${T.width}px`):(A[p].top=`${window.scrollY+T.top}px`,A[p].left=`${window.scrollX+c.x/L}px`,A[p].width="3px",A[p].height=`${T.height}px`),A[p].backgroundColor="#adf",A[p].mixBlendMode="unset"),A}return{bottom:null,left:null,right:null,top:null}},[u,p,c])();return e.jsx("div",{ref:n,children:u!=null&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"TableCellResizer__resizer TableCellResizer__ui",style:k.right||void 0,onPointerDown:S("right")}),e.jsx("div",{className:"TableCellResizer__resizer TableCellResizer__ui",style:k.bottom||void 0,onPointerDown:S("bottom")})]})})}function Dw(){const[t]=He(),s=io();return b.useMemo(()=>s?Zt.createPortal(e.jsx(Ow,{editor:t}),document.body):null,[t,s])}function rl(t,s){var r;const n=(r=t())==null?void 0:r[s];return z2(typeof n=="string","getThemeClass: required theme property %s not defined",String(s)),n.split(/\s+/g).map(a=>`.${a}`).join()}function Bw(t,s,n){const r=b.useRef(null);return r.current=t,b.useMemo(()=>D0((...a)=>{r.current&&r.current(...a)},s,{maxWait:n}),[s,n])}const fd=20;function Fw({anchorElem:t}){var v,j;const[s,{getTheme:n}]=He(),r=io(),[a,l]=b.useState(!1),[i,c]=b.useState(!1),[d,u]=b.useState(!1),[m,p]=b.useState({}),x=b.useRef(new Set),h=b.useRef(null),f=Bw(N=>{const{isOutside:S,tableDOMNode:w}=zw(N,n);if(S){l(!1),c(!1);return}if(!w)return;h.current=w;let k=null,$=null,E=null;if(s.getEditorState().read(()=>{var _;const M=Os(w);if(dr(M)){const L=Ts(M,D=>As(D));if(!As(L))return;if(E=Xm(L,s.getElementByKey(L.getKey())),E){const D=L.getChildrenSize(),A=(_=L.getChildAtIndex(0))==null?void 0:_.getChildrenSize(),T=Gm(M),O=B0(M);T===D-1?k=M:O===A-1&&($=M)}}},{editor:s}),E){const{width:M,y:_,right:L,left:D,bottom:A,height:T}=E.getBoundingClientRect(),O=E.parentElement;let B=!1;O&&O.classList.contains("PlaygroundEditorTheme__tableScrollableWrapper")&&(B=O.scrollWidth>O.clientWidth);const{y:F,left:z}=t.getBoundingClientRect();k?(c(!1),l(!0),p({height:fd,left:B&&O?O.offsetLeft:D-z,top:A-F+5,width:B&&O?O.offsetWidth:M})):$&&(c(!0),l(!1),p({height:T,left:L-z+5,top:_-F,width:fd}))}},50,250),g=b.useMemo(()=>new ResizeObserver(()=>{l(!1),c(!1)}),[]);b.useEffect(()=>{if(d)return document.addEventListener("mousemove",f),()=>{l(!1),c(!1),f.cancel(),document.removeEventListener("mousemove",f)}},[d,f]),b.useEffect(()=>pt(s.registerMutationListener(cr,N=>{s.getEditorState().read(()=>{let S=!1;for(const[w,k]of N)switch(k){case"created":{x.current.add(w),S=!0;break}case"destroyed":{x.current.delete(w),S=!0;break}}if(S){g.disconnect();for(const w of x.current){const{tableElement:k}=F0(w);g.observe(k)}u(x.current.size>0)}},{editor:s})},{skipInitialization:!1})),[s,g]);const y=N=>{s.update(()=>{if(h.current){const S=Os(h.current);S==null||S.selectEnd(),N?(z0(),l(!1)):(P0(),c(!1))}})};return r?e.jsxs(e.Fragment,{children:[a&&e.jsx("button",{className:`${(v=n())==null?void 0:v.tableAddRows}`,style:{...m},onClick:()=>y(!0)}),i&&e.jsx("button",{className:`${(j=n())==null?void 0:j.tableAddColumns}`,style:{...m},onClick:()=>y(!1)})]}):null}function zw(t,s){const n=t.target,r=rl(s,"tableCell");if(Jm(n)){const a=n.closest(`td${r}, th${r}`);return{isOutside:!(a||n.closest(`button${rl(s,"tableAddRows")}`)||n.closest(`button${rl(s,"tableAddColumns")}`)||n.closest("div.TableCellResizer__resizer")),tableDOMNode:a}}else return{isOutside:!0,tableDOMNode:null}}function Pw({anchorElem:t=document.body}){return io()?Zt.createPortal(e.jsx(Fw,{anchorElem:t}),t):null}const Oa=624,Kp=9;function Rw(t){if(t==="h2")return"heading2";if(t==="h3")return"heading3"}function Hw(t){const s=t==null?void 0:t.getClientRects()[0].y;return s>=Oa&&s<=Oa+Kp}function ta(t){return(t==null?void 0:t.getClientRects()[0].y)<Oa}function al(t){return(t==null?void 0:t.getClientRects()[0].y)>=Oa+Kp}function Ww({tableOfContents:t}){const[s,n]=b.useState(""),r=b.useRef(0),[a]=He();function l(i,c){a.getEditorState().read(()=>{const d=a.getElementByKey(i);d!==null&&(d.scrollIntoView(),n(i),r.current=c)})}return b.useEffect(()=>{function i(){if(t.length!==0&&r.current<t.length-1){let m=a.getElementByKey(t[r.current][0]);if(m!==null){if(al(m)){for(;m!==null&&al(m)&&r.current>0;){const x=a.getElementByKey(t[r.current-1][0]);x!==null&&(ta(x)||al(x))&&r.current--,m=x}const p=t[r.current][0];n(p)}else if(ta(m)){for(;m!==null&&ta(m)&&r.current<t.length-1;){const x=a.getElementByKey(t[r.current+1][0]);x!==null&&(Hw(x)||ta(x))&&r.current++,m=x}const p=t[r.current][0];n(p)}}}else r.current=0}let c;function d(m,p){clearTimeout(c),c=setTimeout(m,p)}function u(){d(i,10)}return document.addEventListener("scroll",u),()=>document.removeEventListener("scroll",u)},[t,a]),e.jsx("div",{className:"table-of-contents",children:e.jsx("ul",{className:"headings",children:t.map(([i,c,d],u)=>u===0?e.jsxs("div",{className:"normal-heading-wrapper",children:[e.jsx("div",{className:"first-heading",onClick:()=>l(i,u),role:"button",tabIndex:0,children:(""+c).length>20?c.substring(0,20)+"...":c}),e.jsx("br",{})]},i):e.jsx("div",{className:`normal-heading-wrapper ${s===i?"selected-heading-wrapper":""}`,children:e.jsx("div",{onClick:()=>l(i,u),role:"button",className:Rw(d),tabIndex:0,children:e.jsx("li",{className:`normal-heading ${s===i?"selected-heading":""}
                    `,children:(""+c).length>27?c.substring(0,27)+"...":c})})},i))})})}function Vw(){return e.jsx(R0,{children:t=>e.jsx(Ww,{tableOfContents:t})})}const Uw=Er&&"documentMode"in document?document.documentMode:null,gd=Er&&/Mac|iPod|iPhone|iPad/.test(navigator.platform);Er&&"InputEvent"in window&&!Uw&&"getTargetRanges"in new window.InputEvent("input");const qw=["#d0021b","#f5a623","#f8e71c","#8b572a","#7ed321","#417505","#bd10e0","#9013fe","#4a90e2","#50e3c2","#b8e986","#000000","#4a4a4a","#9b9b9b","#ffffff"],Un=214,bd=150,es={"color-picker-wrapper":"p-[20px]","color-picker-basic-color":"flex flex-wrap gap-[10px] m-0 p-0","color-picker-basic-color-button":"border-[1px] border-[solid] border-[#ccc] rounded-[4px] h-[16px] w-[16px] cursor-pointer list-none","color-picker-basic-color-button.active":"[box-shadow:0px_0px_2px_2px_rgba(0,_0,_0,_0.3)]","color-picker-saturation":"w-full relative mt-[15px] h-[150px] bg-[linear-gradient(transparent,_black),_linear-gradient(to_right,_white,_transparent)] select-none","color-picker-saturation_cursor":"absolute w-[20px] h-[20px] border-[2px] border-[solid] border-[#ffffff] rounded-[50%] [box-shadow:0_0_15px_#00000026] box-border -translate-x-[10px] -translate-y-[10px]","color-picker-hue":"w-full relative mt-[15px] h-[12px] bg-[linear-gradient(_to_right,_rgb(255,_0,_0),_rgb(255,_255,_0),_rgb(0,_255,_0),_rgb(0,_255,_255),_rgb(0,_0,_255),_rgb(255,_0,_255),_rgb(255,_0,_0)_)] select-none rounded-[12px]","color-picker-hue_cursor":"absolute w-[20px] h-[20px] border-[2px] border-[solid] border-[#ffffff] rounded-full [box-shadow:#0003_0_0_0_0.5px] box-border -translate-x-[10px] -translate-y-[4px]","color-picker-color":"border-[1px] border-[solid] border-[#ccc] mt-[15px] w-full h-[20px]"};function Gw({color:t,onChange:s}){const[n,r]=b.useState(on("hex",t)),[a,l]=b.useState(t),i=b.useRef(null),c=b.useMemo(()=>({x:n.hsv.s/100*Un,y:(100-n.hsv.v)/100*bd}),[n.hsv.s,n.hsv.v]),d=b.useMemo(()=>({x:n.hsv.h/360*Un}),[n.hsv]),u=x=>{if(l(x),/^#[0-9A-Fa-f]{6}$/i.test(x)){const h=on("hex",x);r(h)}},m=({x,y:h})=>{const f={...n.hsv,s:x/Un*100,v:100-h/bd*100},g=on("hsv",f);r(g),l(g.hex)},p=({x})=>{const h={...n.hsv,h:x/Un*360},f=on("hsv",h);r(f),l(f.hex)};return b.useEffect(()=>{i.current!==null&&s&&(s(n.hex),l(n.hex))},[n,s]),b.useEffect(()=>{if(t===void 0)return;const x=on("hex",t);r(x),l(x.hex)},[t]),e.jsxs("div",{className:`${es["color-picker-wrapper"]}`,style:{width:Un},ref:i,children:[e.jsx(In,{label:"Hex",onChange:u,value:a}),e.jsx("div",{className:`${es["color-picker-basic-color"]}`,children:qw.map(x=>e.jsx("button",{className:`${es["color-picker-basic-color-button"]} ${x===n.hex?es["color-picker-basic-color-button.active"]:""}`,style:{backgroundColor:x},onClick:()=>{l(x),r(on("hex",x))}},x))}),e.jsx(yd,{className:`${es["color-picker-saturation"]}`,style:{backgroundColor:`hsl(${n.hsv.h}, 100%, 50%)`},onChange:m,children:e.jsx("div",{className:`${es["color-picker-saturation_cursor"]}`,style:{backgroundColor:n.hex,left:c.x,top:c.y}})}),e.jsx(yd,{className:`${es["color-picker-hue"]}`,onChange:p,children:e.jsx("div",{className:`${es["color-picker-hue_cursor"]}`,style:{backgroundColor:`hsl(${n.hsv.h}, 100%, 50%)`,left:d.x}})}),e.jsx("div",{className:`${es["color-picker-color"]}`,style:{backgroundColor:n.hex}})]})}function yd({className:t,style:s,onChange:n,children:r}){const a=b.useRef(null),l=c=>{if(a.current){const{current:d}=a,{width:u,height:m,left:p,top:x}=d.getBoundingClientRect(),h=vd(c.clientX-p,u,0),f=vd(c.clientY-x,m,0);n({x:h,y:f})}},i=c=>{if(c.button!==0)return;l(c);const d=m=>{l(m)},u=m=>{document.removeEventListener("mousemove",d,!1),document.removeEventListener("mouseup",u,!1),l(m)};document.addEventListener("mousemove",d,!1),document.addEventListener("mouseup",u,!1)};return e.jsx("div",{ref:a,className:t,style:s,onMouseDown:i,children:r})}function vd(t,s,n){return t>s?s:t<n?n:t}function wd(t){if(t.startsWith("#")){if(t.length===4||t.length===5)return t=t.split("").map((s,n)=>n?s+s:"#").join(""),t;if(t.length===7||t.length===9)return t}else{const s=document.createElement("canvas").getContext("2d");if(!s)throw new Error("2d context not supported or canvas already initialized");return s.fillStyle=t,s.fillStyle}return"#000000"}function jd(t){const s=(t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(n,r,a,l)=>"#"+r+r+a+a+l+l).substring(1).match(/.{2}/g)||[]).map(n=>parseInt(n,16));return{b:s[2],g:s[1],r:s[0]}}function ol({r:t,g:s,b:n}){t/=255,s/=255,n/=255;const r=Math.max(t,s,n),a=r-Math.min(t,s,n),l=a?(r===t?(s-n)/a+(s<n?6:0):r===s?2+(n-t)/a:4+(t-s)/a)*60:0,i=r?a/r*100:0,c=r*100;return{h:l,s:i,v:c}}function Jw({h:t,s,v:n}){s/=100,n/=100;const r=~~(t/60),a=t/60-r,l=n*(1-s),i=n*(1-s*a),c=n*(1-s*(1-a)),d=r%6,u=Math.round([n,i,l,l,c,n][d]*255),m=Math.round([c,n,n,i,l,l][d]*255);return{b:Math.round([l,l,c,n,n,i][d]*255),g:m,r:u}}function Cd({b:t,g:s,r:n}){return"#"+[n,s,t].map(r=>r.toString(16).padStart(2,"0")).join("")}function on(t,s){let n=wd("#121212"),r=jd(n),a=ol(r);return t==="hex"?(n=wd(s),r=jd(n),a=ol(r)):t==="rgb"?(r=s,n=Cd(r),a=ol(r)):t==="hsv"&&(a=s,r=Jw(a),n=Cd(r)),{hex:n,hsv:a,rgb:r}}function Nd({disabled:t=!1,stopCloseOnClickSelf:s=!0,color:n,onChange:r,...a}){return e.jsx(gs,{...a,disabled:t,stopCloseOnClickSelf:s,children:e.jsx(Gw,{color:n,onChange:r})})}const Wl={bullet:"Bulleted List",check:"Check List",code:"Code Block",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6",number:"Numbered List",paragraph:"Normal",quote:"Quote"};function Xw(){const t=[];for(const[s,n]of Object.entries(H0))t.push([s,n]);return t}const Zw=Xw(),qn={center:{icon:"centerAlign",iconRTL:"rightAlign",name:"Center Align"},end:{icon:"rightAlign",iconRTL:"leftAlign",name:"End Align"},justify:{icon:"justifyAlign",iconRTL:"justifyAlign",name:"Justify Align"},left:{icon:"leftAlign",iconRTL:"leftAlign",name:"Left Align"},right:{icon:"rightAlign",iconRTL:"leftAlign",name:"Right Align"},start:{icon:"leftAlign",iconRTL:"rightAlign",name:"Start Align"}};function vt(t){return t?`${Z.dropdownItemActive}`||"active dropdown-item-active":""}function Yw({editor:t,blockType:s,rootType:n,disabled:r=!1}){const a=()=>{t.update(()=>{const p=We();Ke(p)&&fs(p,()=>ct())})},l=p=>{s!==p&&t.update(()=>{const x=We();fs(x,()=>Vm(p))})},i=()=>{s!=="bullet"?t.dispatchCommand(Pm,void 0):a()},c=()=>{s!=="check"?t.dispatchCommand(Rm,void 0):a()},d=()=>{s!=="number"?t.dispatchCommand(zm,void 0):a()},u=()=>{s!=="quote"&&t.update(()=>{const p=We();fs(p,()=>Um())})},m=()=>{s!=="code"&&t.update(()=>{let p=We();if(p!==null)if(p.isCollapsed())fs(p,()=>ur());else{const x=p.getTextContent(),h=ur();p.insertNodes([h]),p=We(),Ke(p)&&p.insertRawText(x)}})};return e.jsxs(gs,{disabled:r,buttonClassName:`${Z.toolbar.toolbarItem.base} block-controls`,buttonIconClassName:`${Z.toolbar.toolbarItem.icon} block-type ${Z.icon[s]}`+s,buttonLabel:Wl[s],buttonAriaLabel:"Formatting options for text style",children:[e.jsxs(Re,{className:`${Z.dropdown.item.base||"item "} `+vt(s==="paragraph"),onClick:a,children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.paragraph}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`,children:"Normal"})]}),e.jsxs(Re,{className:`${Z.dropdown.item.base||"item "} `+vt(s==="h1"),onClick:()=>l("h1"),children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.h1}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`,children:"Heading 1"})]}),e.jsxs(Re,{className:`${Z.dropdown.item.base||"item "} `+vt(s==="h2"),onClick:()=>l("h2"),children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.h2}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`,children:"Heading 2"})]}),e.jsxs(Re,{className:`${Z.dropdown.item.base||"item "} `+vt(s==="h3"),onClick:()=>l("h3"),children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.h3}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Heading 3"})]}),e.jsxs(Re,{className:`${Z.dropdown.item.base||"item "} `+vt(s==="h4"),onClick:()=>l("h4"),children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.h4}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Heading 4"})]}),e.jsxs(Re,{className:`${Z.dropdown.item.base||"item "} `+vt(s==="bullet"),onClick:i,children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.bulletList}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Bullet List"})]}),e.jsxs(Re,{className:`${Z.dropdown.item.base||"item "} `+vt(s==="number"),onClick:d,children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.numberedList}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Numbered List"})]}),e.jsxs(Re,{className:`${Z.dropdown.item.base||"item "} `+vt(s==="check"),onClick:c,children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.checkList}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Check List"})]}),e.jsxs(Re,{className:`${Z.dropdown.item.base||"item "} `+vt(s==="quote"),onClick:u,children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.quote}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Quote"})]}),e.jsxs(Re,{className:`${Z.dropdown.item.base||"item "} `+vt(s==="code"),onClick:m,children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.code}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Code Block"})]})]})}function Qw(){return e.jsx("div",{className:Z.dropdown.divider||"divider"})}function Kw({editor:t,value:s,isRTL:n,disabled:r=!1}){const a=qn[s||"left"];return e.jsxs(gs,{disabled:r,buttonLabel:a.name,buttonIconClassName:`${Z.actions.i.base} mr-[8px] ${Z.icon[n?a.iconRTL:a.icon]}`,buttonClassName:`${Z.toolbar.toolbarItem.base} ${Z.toolbar.toolbarItem.spaced} alignment`,buttonAriaLabel:"Formatting options for text alignment",children:[e.jsxs(Re,{onClick:()=>{t.dispatchCommand(Is,"left")},className:`${Z.dropdown.item.base}`||"item",children:[e.jsx("i",{className:`${Z.actions.i.base} ${Z.icon.leftAlign}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Left Align"})]}),e.jsxs(Re,{onClick:()=>{t.dispatchCommand(Is,"center")},className:`${Z.dropdown.item.base}`||"item",children:[e.jsx("i",{className:`${Z.actions.i.base} ${Z.icon.centerAlign}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Center Align"})]}),e.jsxs(Re,{onClick:()=>{t.dispatchCommand(Is,"right")},className:`${Z.dropdown.item.base}`||"item",children:[e.jsx("i",{className:`${Z.actions.i.base} ${Z.icon.rightAlign}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Right Align"})]}),e.jsxs(Re,{onClick:()=>{t.dispatchCommand(Is,"justify")},className:`${Z.dropdown.item.base}`||"item",children:[e.jsx("i",{className:`${Z.actions.i.base} ${Z.icon.justifyAlign}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Justify Align"})]}),e.jsxs(Re,{onClick:()=>{t.dispatchCommand(Is,"start")},className:`${Z.dropdown.item.base}`,children:[e.jsx("i",{className:`${Z.actions.i.base} ${Z.icon[n?qn.start.iconRTL:qn.start.icon]}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`,children:"Start Align"})]}),e.jsxs(Re,{onClick:()=>{t.dispatchCommand(Is,"end")},className:`${Z.dropdown.item.base}`,children:[e.jsx("i",{className:`${Z.actions.i.base} ${Z.icon[n?qn.end.iconRTL:qn.end.icon]}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`,children:"End Align"})]}),e.jsx(Qw,{}),e.jsxs(Re,{onClick:()=>{t.dispatchCommand(tb,void 0)},className:`${Z.dropdown.item.base}`||"item",children:[e.jsx("i",{className:`${Z.actions.i.base} ${Z.icon[n?"indent":"outdent"]}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Outdent"})]}),e.jsxs(Re,{onClick:()=>{t.dispatchCommand(qm,void 0)},className:`${Z.dropdown.item.base}`||"item",children:[e.jsx("i",{className:`${Z.actions.i.base} ${Z.icon[n?"outdent":"indent"]}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Indent"})]})]})}function e5({setIsLinkEditMode:t}){const[s]=He(),[n,r]=b.useState(s),[a,l]=b.useState("paragraph"),[i,c]=b.useState("root"),[d,u]=b.useState(null),[m,p]=b.useState("15px"),[x,h]=b.useState("#000"),[f,g]=b.useState("#dfe6ef"),[y,v]=b.useState("Arial"),[j,N]=b.useState("left"),[S,w]=b.useState(!1),[k,$]=b.useState(!1),[E,M]=b.useState(!1),[_,L]=b.useState(!1),[D,A]=b.useState(!1),[T,O]=b.useState(!1),[B,F]=b.useState(!1),[z,P]=b.useState(!1),[U,R]=b.useState(!1),[W,V]=b.useState(!1),[X,q]=Mr(),[Q,Y]=b.useState(!1),[H,J]=b.useState(""),[G,se]=b.useState(()=>s.isEditable()),le=b.useCallback(()=>{const ae=We();if(Ke(ae)){const de=ae.anchor.getNode();let te=de.getKey()==="root"?de:Ts(de,we=>{const be=we.getParent();return be!==null&&Om(be)});te===null&&(te=de.getTopLevelElementOrThrow());const re=te.getKey(),ee=n.getElementByKey(re);$(ae.hasFormat("bold")),M(ae.hasFormat("italic")),L(ae.hasFormat("underline")),A(ae.hasFormat("strikethrough")),O(ae.hasFormat("subscript")),F(ae.hasFormat("superscript")),P(ae.hasFormat("code")),Y(W0(ae));const xe=xr(ae),ke=xe.getParent();is(ke)||is(xe)?w(!0):w(!1);const he=Ts(xe,As);if(As(he)?c("table"):c("root"),ee!==null)if(u(re),Dl(te)){const we=V0(de,Zm),be=we?we.getListType():te.getListType();l(be)}else{const we=Bc(te)?te.getTag():te.getType();if(we in Wl&&l(we),Tl(te)){const be=te.getLanguage();J(be?U0[be]||be:"");return}}p(Yr(ae,"font-size","15px")),h(Yr(ae,"color","#000")),g(Yr(ae,"background-color","#dfe6ef")),v(Yr(ae,"font-family","Arial")),N((Ir(xe)?xe.getFormatType():ke==null?void 0:ke.getFormatType())||"left")}},[n]);b.useEffect(()=>s.registerCommand(co,(ae,de)=>(le(),r(de),!1),ar),[s,le]),b.useEffect(()=>(G!==s.isEditable()&&se(s.isEditable()),pt(s.registerEditableListener(ae=>{se(ae)}),n.registerUpdateListener(({editorState:ae})=>{ae.read(()=>{le()})}),n.registerCommand(G0,ae=>(R(ae),!1),ar),n.registerCommand(q0,ae=>(V(ae),!1),ar))),[le,n,s]),b.useEffect(()=>n.registerCommand(J0,ae=>{const de=ae,{code:te,ctrlKey:re,metaKey:ee}=de;return te==="KeyK"&&(re||ee)?(de.preventDefault(),t(!S),n.dispatchCommand(Ds,"https://")):!1},X0),[n,S,t]);const ce=b.useCallback((ae,de)=>{n.update(()=>{const te=We();te!==null&&Z0(te,ae)},de?{tag:"historic"}:{})},[n]),je=b.useCallback(()=>{n.update(()=>{const ae=We();if(Ke(ae)){const de=ae.anchor,te=ae.focus,re=ae.getNodes();if(de.key===te.key&&de.offset===te.offset)return;re.forEach((ee,xe)=>{oo(ee)?(xe===0&&de.offset!==0&&(ee=ee.splitText(de.offset)[1]||ee),xe===re.length-1&&(ee=ee.splitText(te.offset)[0]||ee),ee.__style!==""&&ee.setStyle(""),ee.__format!==0&&(ee.setFormat(0),Y0(ee).setFormat(""))):Bc(ee)||Q0(ee)?ee.replace(ct(),!0):K0(ee)&&ee.setFormat("")})}})},[n]),Ce=b.useCallback(ae=>{ce({color:ae})},[ce]),oe=b.useCallback(ae=>{ce({"background-color":ae}),ce({padding:"4px 12px"}),ce({border:"1px solid"}),ce({"border-color":"#60a5fa"}),ce({"border-radius":"8px"}),ce({padding:"6px"}),ce({display:"block"})},[ce]);b.useCallback(()=>{S?s.dispatchCommand(Ds,null):s.dispatchCommand(Ds,"https://")},[s,S]);const ve=b.useCallback(ae=>{n.update(()=>{if(d!==null){const de=$n(d);Tl(de)&&de.setLanguage(ae)}})},[n,d]);return G?e.jsxs("div",{className:Z.toolbar.base||"toolbar",children:[e.jsx("button",{disabled:!U||!G,onClick:()=>{n.dispatchCommand(Im,void 0)},title:gd?"Undo (Z)":"Undo (Ctrl+Z)",type:"button",className:`${Z.toolbar.toolbarItem.base} ${Z.toolbar.toolbarItem.spaced}`,"aria-label":"Undo",children:e.jsx("i",{className:`${Z.toolbar.toolbarItem.iconFormat} ${Z.icon.undo}`})}),e.jsx("button",{disabled:!W||!G,onClick:()=>{n.dispatchCommand(Lm,void 0)},title:gd?"Redo (Y)":"Redo (Ctrl+Y)",type:"button",className:`${Z.toolbar.toolbarItem.base}`,"aria-label":"Redo",children:e.jsx("i",{className:`${Z.toolbar.toolbarItem.iconFormat} ${Z.icon.redo}`})}),e.jsx("div",{className:Z.toolbar.divider}),a in Wl&&n===s&&e.jsxs(e.Fragment,{children:[e.jsx(Yw,{disabled:!G,blockType:a,rootType:i,editor:s}),e.jsx("div",{className:Z.toolbar.divider})]}),a==="code"?e.jsx(gs,{disabled:!G,buttonClassName:`${Z.toolbar.toolbarItem.base} ${Z.toolbar.codeLanguage}`,buttonLabel:eb(H),buttonAriaLabel:"Select language",children:Zw.map(([ae,de])=>e.jsx(Re,{className:`${Z.dropdown.item.base} ${vt(ae===H)}`,onClick:()=>ve(ae),children:e.jsx("span",{className:`${Z.dropdown.item.base}`||"text",children:de})},ae))}):e.jsxs(e.Fragment,{children:[e.jsx(Nd,{disabled:!G,buttonClassName:`${Z.toolbar.toolbarItem.base} color-picker`,buttonAriaLabel:"Formatting text color",buttonIconClassName:`${Z.dropdown.item.icon} ${Z.icon.fontColor}`,color:x,onChange:Ce,title:"text color"}),e.jsx(Nd,{disabled:!G,buttonClassName:`${Z.toolbar.toolbarItem.base} color-picker`,buttonAriaLabel:"Formatting background color",buttonIconClassName:`${Z.dropdown.item.icon} ${Z.icon.bgColor}`,color:f,onChange:oe,title:"bg color"}),e.jsxs(gs,{disabled:!G,buttonClassName:`${Z.toolbar.toolbarItem.base} ${Z.toolbar.toolbarItem.spaced}`,buttonLabel:"",buttonAriaLabel:"Formatting options for additional text styles",buttonIconClassName:`${Z.dropdown.item.icon} ${Z.icon.dropdownMore}`,children:[e.jsxs(Re,{onClick:()=>{n.dispatchCommand(Ut,"strikethrough")},className:`${Z.dropdown.item.base||"item "} `+vt(D),title:"Strikethrough","aria-label":"Format text with a strikethrough",children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.strikethrough}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Strikethrough"})]}),e.jsxs(Re,{onClick:()=>{n.dispatchCommand(Ut,"subscript")},className:`${Z.dropdown.item.base||"item "} `+vt(T),title:"Subscript","aria-label":"Format text with a subscript",children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.subscript}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`,children:"Subscript"})]}),e.jsxs(Re,{onClick:()=>{n.dispatchCommand(Ut,"superscript")},className:`${Z.dropdown.item.base||"item "} `+vt(B),title:"Superscript","aria-label":"Format text with a superscript",children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.superscript}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Superscript"})]}),e.jsxs(Re,{onClick:je,className:`${Z.dropdown.item.base}`||"item",title:"Clear text formatting","aria-label":"Clear all text formatting",children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.clear}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Clear Formatting"})]})]}),e.jsx("div",{className:Z.toolbar.divider}),i==="table"&&e.jsxs(e.Fragment,{children:[e.jsx(gs,{disabled:!G,buttonClassName:`${Z.toolbar.toolbarItem.base} ${Z.toolbar.toolbarItem.spaced}`,buttonLabel:"Table",buttonAriaLabel:"Open table toolkit",buttonIconClassName:`${Z.dropdown.item.icon} ${Z.icon.table} secondary`,children:e.jsx(Re,{onClick:()=>{},className:`${Z.dropdown.item.base}`||"item",children:e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"TODO"})})}),e.jsx("div",{className:Z.toolbar.divider})]}),e.jsxs(gs,{disabled:!G,buttonClassName:`${Z.toolbar.toolbarItem.base} ${Z.toolbar.toolbarItem.spaced}`,buttonLabel:"Insert",buttonAriaLabel:"Insert specialized editor node",buttonIconClassName:`${Z.dropdown.item.icon} ${Z.icon.plus}`,children:[e.jsxs(Re,{onClick:()=>{n.dispatchCommand(Hm,void 0)},className:`${Z.dropdown.item.base}`||"item",children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.horizontalRule}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Horizontal Rule"})]}),e.jsxs(Re,{onClick:()=>{q("Insert Image",ae=>e.jsx(Wp,{activeEditor:n,onClose:ae}))},className:`${Z.dropdown.item.base}`||"item",children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.image}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Image"})]}),e.jsxs(Re,{onClick:()=>{q("Insert Table",ae=>e.jsx(Jp,{activeEditor:n,onClose:ae}))},className:`${Z.dropdown.item.base}`||"item",children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.table}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Table"})]}),e.jsxs(Re,{onClick:()=>{s.dispatchCommand(Bi,void 0)},className:`${Z.dropdown.item.base}`||"item",children:[e.jsx("i",{className:`${Z.dropdown.item.icon} ${Z.icon.caretRight}`}),e.jsx("span",{className:`${Z.dropdown.item.text}`||"text",children:"Collapsible container"})]})]})]}),e.jsx("div",{className:Z.toolbar.divider}),e.jsx(Kw,{disabled:!G,value:j,editor:s,isRTL:Q}),X]}):e.jsx("div",{className:Z.toolbar.base||"toolbar"})}function t5(){const[t]=He();return e.jsx(sb,{viewClassName:Z.treeViewOutput||"tree-view-output",treeTypeButtonClassName:Z.debugTreetypeButton||"debug-treetype-button",timeTravelPanelClassName:Z.debugTimetravelPanel.base||"debug-timetravel-panel",timeTravelButtonClassName:Z.debugTimetravelButton||"debug-timetravel-button",timeTravelPanelSliderClassName:Z.debugTimetravelPanel.slider||"debug-timetravel-panel-slider",timeTravelPanelButtonClassName:Z.debugTimetravelPanel.button||"debug-timetravel-panel-button",editor:t})}function kd(t){var a;const{className:s,editor:n}=t,r=((a=n==null?void 0:n._config)==null?void 0:a.theme)||{};return e.jsx(nb,{className:s||(r==null?void 0:r.contentEditable)})}function s5({children:t,className:s}){return e.jsx("div",{className:s||"text-[15px] text-[#999] overflow-hidden absolute overflow-ellipsis top-[8px] left-[8px] lg:left-[28px] right-[28px] select-none whitespace-nowrap inline-block pointer-events-none",children:t})}function n5(t){const{historyState:s}=mv(),{isAutocomplete:n,isMaxLength:r,isCharLimit:a,isCharLimitUtf8:l,isRichText:i=!0,showTreeView:c,showTableOfContents:d,showActionBar:u,placeholderText:m="",editable:p=!0,bgColor:x,isCard:h,tableCellBackgroundColor:f=!0,tableCellMerge:g=!0,tableHorizontalScroll:y=!0,theme:v}=t,j=e.jsx(s5,{children:m}),[N,S]=b.useState(null),[w,k]=b.useState(!1),[$,E]=b.useState(!1),M=_=>{_!==null&&S(_)};return b.useEffect(()=>{const _=()=>{const L=Er&&window.matchMedia("(max-width: 1025px)").matches;L!==$&&E(L)};return window.addEventListener("resize",_),()=>{window.removeEventListener("resize",_)}},[$]),e.jsxs(e.Fragment,{children:[i&&p&&e.jsx(e5,{}),e.jsxs("div",{className:`
                    ${p?`${v.editorContainer}`||"editor-container":`${v.editorViewContainer}`||"view-container"} 
                    ${c?"tree-view":""} ${i?"":"plain-text"}
                    ${h?v.card:""}
                `,style:{backgroundColor:x},children:[r&&e.jsx(Iw,{maxLength:30}),e.jsx(V2,{}),e.jsx(rb,{}),e.jsx(W2,{}),e.jsx(cw,{}),e.jsx(t2,{}),e.jsx(Nw,{}),e.jsx(Av,{}),e.jsx(a2,{}),i?e.jsxs(e.Fragment,{children:[e.jsx(Fc,{externalHistoryState:s}),e.jsx(ab,{contentEditable:e.jsx("div",{className:p?`${v.editorScroller}`||"editor-scroller":`${v.viewScroller}`||"view-scroller",children:e.jsx("div",{className:v.editor.base||"editor",ref:M,children:e.jsx(kd,{className:v.contentEditable})})}),placeholder:j,ErrorBoundary:zc}),e.jsx(o2,{}),e.jsx(ob,{}),e.jsx(lb,{}),e.jsx(_w,{maxDepth:7}),e.jsx(ib,{hasCellMerge:g,hasCellBackgroundColor:f,hasHorizontalScroll:y}),e.jsx(Dw,{}),e.jsx($2,{}),e.jsx(C2,{}),e.jsx(kw,{}),e.jsx(Xv,{}),e.jsx(cb,{}),e.jsx(Aw,{}),e.jsx(db,{}),e.jsx(p2,{editable:p}),e.jsx(y2,{editable:p}),e.jsx(B2,{}),N&&!$&&e.jsxs(e.Fragment,{children:[e.jsx(rw,{anchorElem:N}),e.jsx(hw,{anchorElem:N,isLinkEditMode:w,setIsLinkEditMode:k}),e.jsx(Pw,{anchorElem:N}),e.jsx(jw,{anchorElem:N,showComments:!0})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(ub,{contentEditable:e.jsx(kd,{}),placeholder:j,ErrorBoundary:zc}),e.jsx(Fc,{externalHistoryState:s})]}),(a||l)&&e.jsx(mb,{charset:a?"UTF-16":"UTF-8",maxLength:5}),n&&e.jsx(Vv,{}),e.jsx("div",{children:d&&e.jsx(Vw,{})}),u&&e.jsx(Dv,{isRichText:i})]}),c&&e.jsx(t5,{})]})}const r5=[pb,Zm,xb,hb,fb,cr,Nm,Cm,gb,bb,yb,vb,nn,Tr,Ln,km,Or,wb,Us,qs,Dr,Bn,Fn,Gs,Br,Js,Xs,zn,pr];function ex({value:t,onChange:s,bgColor:n,editable:r=!1,id:a,theme:l}){var d,u,m,p;const i=Ze(pe(Z),pe((l==null?void 0:l.lexical)||{})),c={editorState:(d=JSON.parse(t||"{}"))!=null&&d.root&&((p=(m=(u=JSON.parse(t||"{}"))==null?void 0:u.root)==null?void 0:m.children)!=null&&p.length)?t:null,namespace:"dms-lexical",nodes:[...r5],editable:r,readOnly:!r,onError:x=>{throw x},theme:i};return e.jsx(jb,{initialConfig:c,children:e.jsx("div",{className:`${i.editorShell}`,children:e.jsx(a5,{value:t,onChange:s,bgColor:n,editable:r,theme:i})})},a)}function a5({value:t,onChange:s,bgColor:n,theme:r,editable:a}){const l=C.useRef(!0),[i]=He();return C.useEffect(()=>{var c,d;if(l.current&&(l.current=!1),!a&&!l.current){const u=JSON.parse(t||"{}"),m=u.root&&((d=(c=u==null?void 0:u.root)==null?void 0:c.children)!=null&&d.length)?t:null;if(m){const p=i.parseEditorState(m);queueMicrotask(()=>{i.setEditorState(p)})}}},[l.current,t,r]),e.jsxs(e.Fragment,{children:[e.jsx(n5,{theme:r,editable:a,bgColor:n}),e.jsx(Cb,{onChange:s})]})}function o5(t){try{JSON.parse(t)}catch{return!1}return!0}function tx(t){return t&&typeof t=="object"?JSON.stringify(t):o5(t)?t:null}const l5=({value:t,onChange:s,theme:n,...r})=>e.jsx(ex,{value:tx(t),onChange:a=>s(a),editable:!0,theme:n,...r}),i5=({value:t,theme:s,...n})=>e.jsx(ex,{value:tx(t),editable:!1,theme:s,...n,onChange:()=>{}}),jo={EditComp:l5,ViewComp:i5},c5={text:"text",textarea:"text area",select:"dropdown",multiselect:"dropdown (multiple choice)",lexical:"rich text",radio:"radio",calculated:"calculated"},d5={numeric:"Numeric",text:"Text",date:"Date",timestamp:"Timestamp"},u5={data:"Simple Data",meta:"Group-able/Meta",fips:"fips",geoid:"geoid",calculated:"calculated"},m5={sum:"Sum",list:"List",count:"Count"},p5={yes:"Yes",no:"No"},Fr="text-sm font-light capitalize font-gray-700",Wi="bg-white w-full border p-2 rounded-md",Vi=t=>{try{JSON.parse(t)}catch{return!1}return!0},ll=({label:t,value:s,col:n,attr:r,disabled:a,updateAttribute:l})=>{const[i,c]=b.useState(s),d=u=>setTimeout(l(n,{[r]:u}),500);return e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("label",{className:Fr,children:t}),e.jsx("input",{disabled:a,className:Wi,value:i,placeholder:t,onChange:u=>{c(u.target.value),d(u.target.value)}})]})},Gn=({label:t,value:s,col:n,attr:r,updateAttribute:a,placeholder:l,options:i})=>e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("label",{className:Fr,children:t}),e.jsxs("select",{className:Wi,value:s,onChange:c=>{a(n,{[r]:c.target.value})},children:[e.jsx("option",{children:l}),Object.keys(i).map(c=>e.jsx("option",{value:c,children:i[c]},c))]})]}),x5=({label:t,value:s,col:n,attr:r,updateAttribute:a})=>e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("label",{className:Fr,children:t}),e.jsx(jo.EditComp,{value:s,bgColor:"#ffffff",onChange:l=>{a(n,{[r]:l})},placeholder:t})]}),h5=({col:t,drivingAttribute:s,attr:n,value:r=[],updateAttribute:a})=>{if(!["select","multiselect","radio"].includes(s))return null;const[l,i]=b.useState(void 0),c=b.useMemo(()=>r==null?void 0:r.map(m=>m.label?m:{label:m,value:m}),[r]),d=(m,p)=>{const x=p!=null&&p.label?[...m||[],p]:[...m||[],{label:p,value:p}];a(t,{[n]:x}),i("")},u=(m,p)=>{const x=m.filter(h=>(h.value||h)!==(p.value||p));a(t,{[n]:x})};return e.jsxs("div",{className:"flex flex-col items-start w-full",children:[e.jsx("label",{className:Fr,children:"Options"}),e.jsxs("div",{className:"w-full flex flex-col",children:[e.jsxs("div",{className:"w-full flex",children:[e.jsx("input",{className:"bg-white p-2 flex-1 px-2 shadow bg-blue-100 focus:ring-blue-700 focus:border-blue-500  border-gray-300 rounded-none rounded-md",value:l,onChange:m=>i(m.target.value),onKeyDown:m=>m.key==="Enter"&&d(r,l),placeholder:"Add new option..."}),e.jsx("button",{className:"p-2",onClick:m=>d(r,l),children:"add"})]}),e.jsx("div",{className:"flex flex-row flex-wrap",children:c==null?void 0:c.map(m=>e.jsxs("div",{className:"bg-red-500 hover:bg-red-700 text-white text-xs font-semibold px-1.5 py-1 m-1 flex no-wrap items-center rounded-md",children:[(m==null?void 0:m.label)||m,e.jsx("div",{title:"remove",className:"p-0.5 px-1 cursor-pointer",onClick:p=>u(r,m),children:"x"})]}))})]})]})},f5=async({format:t,apiLoad:s,length:n})=>{var d,u;const r=Vi(t==null?void 0:t.config)?((d=t.config)==null?void 0:d.attributes)||[]:((u=JSON.parse((t==null?void 0:t.config)||"{}"))==null?void 0:u.attributes)||[],a=0,l=n-1,i=[{type:()=>{},action:"list",path:"/",filter:{fromIndex:m=>a,toIndex:m=>l,options:JSON.stringify({}),stopFullDataLoad:!0}}];return await s({app:t.app,type:t.type,format:t,attributes:r,children:i})},$d=async({format:t,apiLoad:s,length:n,attributes:r,groupBy:a=[],filterBy:l={}})=>{var p,x;const i=r||(Vi(t==null?void 0:t.config)?((p=t.config)==null?void 0:p.attributes)||[]:((x=JSON.parse((t==null?void 0:t.config)||"{}"))==null?void 0:x.attributes)||[]),c=0,d=n-1,u=[{type:()=>{},action:"load",path:"/",filter:{fromIndex:h=>c,toIndex:h=>d,options:JSON.stringify({groupBy:a,aggregatedLen:a.length,filter:l}),attributes:i,stopFullDataLoad:!0}}];return await s({app:t.app,type:t.type,format:t,attributes:i,children:u})},il=async({format:t,apiLoad:s,groupBy:n=[],filterBy:r})=>{var c,d;const a=Vi(t==null?void 0:t.config)?((c=t.config)==null?void 0:c.attributes)||[]:((d=JSON.parse((t==null?void 0:t.config)||"{}"))==null?void 0:d.attributes)||[],l=[{type:()=>{},action:"filteredLength",path:"/",filter:{options:JSON.stringify({groupBy:n,aggregatedLen:n.length,filter:r})}}];return await s({app:t.app,type:t.type,format:t,attributes:a,children:l})},g5=({col:t,drivingAttribute:s,attr:n,value:r=[],updateAttribute:a,apiLoad:l,format:i})=>{var w,k,$,E,M,_;const[c,d]=b.useState(!1),[u,m]=b.useState([]),[p,x]=b.useState({}),[h,f]=b.useState([]),[g,y]=b.useState([]),[v,j]=b.useState(),N=Ue.multiselect.EditComp,S="p-1 truncate";return b.useEffect(()=>{if(!c)return;async function L(){const D=await il({format:{...i,app:"dms-site",type:"forms-config"},apiLoad:l}),A=await f5({format:{...i,app:"dms-site",type:"forms-config"},apiLoad:l,length:D});m(A.map(T=>({...T,config:JSON.parse(T.config||"{}")})))}L()},[c]),b.useEffect(()=>{async function L(){if(!c)return;const D=`data->>'${t}' as ${t}`,A=await il({format:i,apiLoad:l,groupBy:[`data->>'${t}'`]}),T=await $d({format:i,apiLoad:l,length:A,attributes:[D],groupBy:[`data->>'${t}'`]});y(T==null?void 0:T.map(O=>O[D]).filter(O=>typeof O!="object"))}L()},[c]),b.useEffect(()=>{async function L(){if(!p.selectedFormat||!p.selectedAttribute)return;const D=`data->>'${p.selectedAttribute}' as ${p.selectedAttribute}`,A=await il({format:p.selectedFormat.config,apiLoad:l,groupBy:[`data->>'${p.selectedAttribute}'`]}),T=await $d({format:p.selectedFormat.config,apiLoad:l,length:A,attributes:[D],groupBy:[`data->>'${p.selectedAttribute}'`]});f(T==null?void 0:T.map(O=>O[D]))}L()},[p.selectedAttribute]),e.jsxs("div",{children:["meta mappings",e.jsx("div",{className:"w-full grid grid-cols-6 border-t-2 border-gray-300 rounded-md",children:["#","Source Values","Target Data Type","Target Column","Target Values","Actions"].map(L=>e.jsx("div",{className:"p-1",children:L}))}),r.map((L,D)=>{var A,T,O;return e.jsxs("div",{className:"w-full grid grid-cols-6 border-2 border-gray-300 rounded-md items-center font-semibold justify-between hover:bg-blue-200",children:[e.jsxs("div",{className:`${S} text-xs`,children:["Mapping ",D+1]}),e.jsxs("div",{className:S,children:[((A=L==null?void 0:L.srcValues)==null?void 0:A.length)||0," source values"]}),e.jsx("div",{className:S,children:(T=L==null?void 0:L.selectedFormat)==null?void 0:T.name}),e.jsx("div",{className:S,children:L==null?void 0:L.selectedAttribute}),e.jsxs("div",{className:S,children:[(O=L==null?void 0:L.mappedValues)==null?void 0:O.length," mapped values"]}),e.jsxs("div",{className:"p-1",children:[e.jsx("button",{className:"bg-blue-300 hover:bg-blue-500 text-white text-sm p-1 rounded-md",onClick:()=>{x(L),j(D),d(!0)},children:"edit"}),e.jsx("button",{className:"bg-red-300 hover:bg-red-500 text-white text-sm p-1 rounded-md",onClick:()=>a(t,{[n]:r.filter((B,F)=>F!==D)}),children:"remove"})]})]})}),c?e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("button",{className:"bg-red-300 hover:bg-red-500 text-white text-sm p-1 rounded-md",onClick:()=>d(!1),children:"done"}),e.jsxs("div",{className:"grid grid-cols-6 w-full items-start",children:[e.jsxs("div",{className:"p-1 text-xs",children:["Mapping ",(r==null?void 0:r.length)+1]}),e.jsx(N,{className:`border rounded-md bg-white h-full ${(w=p.srcValues)!=null&&w.length?"p-1":"p-4"}`,placeholder:"Please select values...",value:p.srcValues,onChange:L=>{x({...p,srcValues:L})},options:g,displayInvalidMsg:!1}),e.jsxs("select",{className:"border p-2 rounded-md bg-white",value:($=(k=p.selectedFormat)==null?void 0:k.config)==null?void 0:$.type,onChange:L=>{x({...p,selectedFormat:u.find(D=>D.config.type===L.target.value)})},children:[e.jsx("option",{children:"Please select a format"}),u.map(L=>e.jsx("option",{value:L.config.type,children:L.name},L.config.type))]}),(M=(E=p.selectedFormat)==null?void 0:E.config)!=null&&M.attributes?e.jsxs("select",{className:"border p-2 rounded-md bg-white",value:p.selectedAttribute,onChange:L=>{x({...p,selectedAttribute:L.target.value})},children:[e.jsx("option",{children:"Please select a format"}),p.selectedFormat.config.attributes.map(L=>e.jsx("option",{value:L.name,children:L.name},L.display_name||L.name))]}):e.jsx("div",{}),h!=null&&h.length?e.jsx(N,{className:`border rounded-md bg-white h-full ${(_=p.mappedValues)!=null&&_.length?"p-1":"p-4"}`,placeholder:"Please select values...",value:p.mappedValues,onChange:L=>{x({...p,mappedValues:L})},options:h}):e.jsx("div",{}),h.length&&v!==void 0?e.jsxs("div",{className:"p-1",children:[e.jsx("button",{title:"save",className:"bg-blue-300 hover:bg-blue-500 text-white text-sm p-1 rounded-md h-fit self-center",onClick:()=>{a(t,{[n]:r.map((L,D)=>D===v?p:L)}),x({}),j(void 0)},children:" save"}),e.jsx("button",{title:"cancel",className:"bg-red-300 hover:bg-red-500 text-white text-sm p-1 rounded-md h-fit self-center",onClick:()=>{x({}),j(void 0),d(!1)},children:" cancel"})]}):e.jsx("div",{children:e.jsx("button",{title:"add mapping",className:"bg-blue-300 hover:bg-blue-500 text-white text-sm p-2 rounded-md h-fit self-end",onClick:()=>{a(t,{[n]:[...r,p]}),x({})},children:"+"})})]})]}):e.jsx("div",{className:"flex flex-col items-start",children:e.jsx("button",{className:"bg-blue-300 hover:bg-blue-500 text-white text-sm p-1 rounded-md",onClick:()=>d(!0),children:"+ add mappings"})})]})},b5=({value:t,col:s,drivingAttribute:n,attr:r,updateAttribute:a})=>n==="meta"?e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("label",{className:Fr,children:"Meta Lookup"}),e.jsx("textarea",{className:Wi,value:t,placeholder:"Please enter meta lookup if available",onChange:l=>{a(s,{[r]:l.target.value})}})]}):null,y5=({col:t,removeAttribute:s})=>{const[n,r]=b.useState(void 0),a=()=>{r(void 0),s(t)};return e.jsx("div",{className:"w-full",children:e.jsx("button",{className:`${n?"bg-blue-300 hover:bg-blue-500":"bg-red-300 hover:bg-red-500"} w-fit p-1 m-2 text-white float-right rounded-md`,onClick:()=>{if(n)clearTimeout(n),r(void 0);else{const l=setTimeout(a,1500);r(l)}},children:n?"undo":"remove"})})},v5=({i:t,item:s,attribute:n,updateAttribute:r,removeAttribute:a,apiLoad:l,format:i,dragStart:c,dragEnter:d,dragOver:u,drop:m})=>{const[p,x]=b.useState(!1);return e.jsxs("div",{className:`${t%2?"bg-blue-50":"bg-white"} hover:bg-blue-100 border-l-4 border-blue-100 hover:border-blue-300 mb-1 px-2 pb-2 w-full flex flex-col`,onDragStart:h=>c(h,t),onDragEnter:h=>d(h,t),onDragOver:u,onDragEnd:m,draggable:!0,children:[e.jsxs("div",{className:"flex items-center w-full gap-2",children:[e.jsx("div",{className:"h-4 w-4 m-1 text-gray-800",children:e.jsx("svg",{"data-v-4e778f45":"",className:"nc-icon cursor-move !h-3.75 text-gray-600 mr-1",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",children:e.jsx("path",{fill:"currentColor",d:"M8.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m0 6.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0M15.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1.5 8a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"})})}),e.jsxs("div",{className:"w-full flex flex-wrap justify-between flex-col sm:flex-row items-center",children:[e.jsx(ll,{disabled:!0,label:"name",attr:"name",value:n,col:s.name},`${s.name}-name`),e.jsx(ll,{label:"display name",attr:"display_name",value:s.display_name,col:s.name,updateAttribute:r},`${s.name}-display_name`),e.jsx(Gn,{label:"Input Type",value:s.type,col:s.name,attr:"type",options:c5,updateAttribute:r},`${s.name}-type`),e.jsx(Gn,{label:"Data Type",value:s.dataType,col:s.name,attr:"dataType",options:d5,updateAttribute:r},`${s.name}-data-type`),e.jsx("div",{title:"Advanced Settings",className:"cursor-pointer p-2 text-gray-500 hover:text-gray-900 text-xl",onClick:()=>x(!p),children:"..."})]})]}),e.jsxs("div",{className:p?"flex flex-col":"hidden",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx(x5,{label:"description",attr:"description",value:s.description,col:s.name,updateAttribute:r},`${s.name}-description`),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(Gn,{label:"Behaviour Type",value:s.display,col:s.name,attr:"display",options:s.type==="calculated"?{calculated:"calculated"}:u5,updateAttribute:r,placeholder:"Please select behaviour type"},`${s.name}-display`),e.jsx(Gn,{label:"Default Fn",value:s.defaultFn,col:s.name,attr:"defaultFn",options:m5,updateAttribute:r,placeholder:"Please select default function"},`${s.name}-defaultFn`),e.jsx(Gn,{label:"Required",value:s.required,col:s.name,attr:"required",options:p5,updateAttribute:r,placeholder:"Please select property"},`${s.name}-required`)]})]}),e.jsx(ll,{label:"prompt",attr:"prompt",value:s.prompt,col:s.name,updateAttribute:r},`${s.name}-prompt`),e.jsx(h5,{col:s.name,drivingAttribute:s.type,value:s.options,attr:"options",updateAttribute:r},`${s.name}-options`),e.jsx(b5,{col:s.name,drivingAttribute:s.display,value:s.meta_lookup,attr:"meta_lookup",updateAttribute:r},`${s.name}-meta_lookup`),e.jsx(g5,{col:s.name,drivingAttribute:s.display,value:s.mappings,attr:"mappings",updateAttribute:r,apiLoad:l,format:i},`${s.name}-mappings`),e.jsx(y5,{col:s.name,removeAttribute:a},`${s.name}-removeBtn`)]})]},t)},sx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("title",{children:t.title}),e.jsx("path",{d:"M22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M12.2422 17V12C12.2422 11.5286 12.2422 11.2929 12.0957 11.1464C11.9493 11 11.7136 11 11.2422 11",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.992 8H12.001",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),w5=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"#fff",...t,children:e.jsx("path",{d:"M18 9.00005C18 9.00005 13.5811 15 12 15C10.4188 15 6 9 6 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),Da=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:e.jsx("path",{d:"M9.00005 6C9.00005 6 15 10.4189 15 12C15 13.5812 9 18 9 18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),j5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M11.992 12H12.001",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.9842 18H11.9932",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.9998 6H12.0088",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),C5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M12 4V20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 12H20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),Ui=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("title",{children:t.title}),e.jsx("path",{d:"M5.32171 9.6829C7.73539 5.41196 8.94222 3.27648 10.5983 2.72678C11.5093 2.42437 12.4907 2.42437 13.4017 2.72678C15.0578 3.27648 16.2646 5.41196 18.6783 9.6829C21.092 13.9538 22.2988 16.0893 21.9368 17.8293C21.7376 18.7866 21.2469 19.6548 20.535 20.3097C19.241 21.5 16.8274 21.5 12 21.5C7.17265 21.5 4.75897 21.5 3.46496 20.3097C2.75308 19.6548 2.26239 18.7866 2.06322 17.8293C1.70119 16.0893 2.90803 13.9538 5.32171 9.6829Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M12.2422 17V13C12.2422 12.5286 12.2422 12.2929 12.0957 12.1464C11.9493 12 11.7136 12 11.2422 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.992 8.99997H12.001",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),N5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M17 2V4M12 2V4M7 2V4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M3.5 10C3.5 6.70017 3.5 5.05025 4.52513 4.02513C5.55025 3 7.20017 3 10.5 3H13.5C16.7998 3 18.4497 3 19.4749 4.02513C20.5 5.05025 20.5 6.70017 20.5 10V15C20.5 18.2998 20.5 19.9497 19.4749 20.9749C18.4497 22 16.7998 22 13.5 22H10.5C7.20017 22 5.55025 22 4.52513 20.9749C3.5 19.9497 3.5 18.2998 3.5 15V10Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M8 15H12M8 10H16",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),k5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M16.9017 6.12874C18 7.25748 18 9.07416 18 12.7075V14.2925C18 17.9258 18 19.7425 16.9017 20.8713C15.8033 22 14.0355 22 10.5 22C6.96447 22 5.1967 22 4.09835 20.8713C3 19.7425 3 17.9258 3 14.2925V12.7075C3 9.07416 3 7.25748 4.09835 6.12874C5.1967 5 6.96447 5 10.5 5C14.0355 5 15.8033 5 16.9017 6.12874Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M7.5 5.5V10.3693C7.5 11.3046 7.5 11.7722 7.78982 11.9396C8.35105 12.2638 9.4038 11.1823 9.90375 10.8567C10.1937 10.6678 10.3387 10.5734 10.5 10.5734C10.6613 10.5734 10.8063 10.6678 11.0962 10.8567C11.5962 11.1823 12.6489 12.2638 13.2102 11.9396C13.5 11.7722 13.5 11.3046 13.5 10.3693V5.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M9 2H11C15.714 2 18.0711 2 19.5355 3.46447C21 4.92893 21 7.28595 21 12V18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),$5=({theme:t,placeholder:s,attributes:n=[],className:r,addAttribute:a})=>{const[l,i]=b.useState(""),[c,d]=b.useState("empty name");function u(){a({name:l}),i(""),d("empty name"),document.activeElement!==document.body&&document.activeElement.blur()}const m=()=>setTimeout(u,500);return e.jsxs("div",{className:"w-full flex flex-col sm:flex-row",children:[e.jsx("input",{className:`w-1/4 p-2 border ${c?"border-red-500":""} rounded-md`,value:l,placeholder:s,onChange:p=>{n.find(x=>x.name===p.target.value)?d("already exists"):p.target.value===""?d("empty name"):c&&d(null),i(p.target.value.toLowerCase().replaceAll(/\s+/g," "))},onBlur:p=>{p.target.value!==""&&!c&&m()},onKeyDown:p=>!c&&p.key==="Enter"&&m()}),e.jsx("button",{className:`p-2 ${c?"bg-red-500":"bg-blue-300 hover:bg-blue-500"} text-white rounded-md`,onClick:p=>u(),children:c?e.jsxs("div",{className:"flex items-center ",children:[e.jsx(Ui,{className:"text-white px-1"})," ",c," "]}):e.jsxs("div",{className:"flex items-center ",children:[e.jsx(C5,{className:"text-white px-1"})," ","add"]})})]})},S5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M16.2141 4.98239L17.6158 3.58063C18.39 2.80646 19.6452 2.80646 20.4194 3.58063C21.1935 4.3548 21.1935 5.60998 20.4194 6.38415L19.0176 7.78591M16.2141 4.98239L10.9802 10.2163C9.93493 11.2616 9.41226 11.7842 9.05637 12.4211C8.70047 13.058 8.3424 14.5619 8 16C9.43809 15.6576 10.942 15.2995 11.5789 14.9436C12.2158 14.5877 12.7384 14.0651 13.7837 13.0198L19.0176 7.78591M16.2141 4.98239L19.0176 7.78591",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21 12C21 16.2426 21 18.364 19.682 19.682C18.364 21 16.2426 21 12 21C7.75736 21 5.63604 21 4.31802 19.682C3 18.364 3 16.2426 3 12C3 7.75736 3 5.63604 4.31802 4.31802C5.63604 3 7.75736 3 12 3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),_5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M21.544 11.045C21.848 11.4713 22 11.6845 22 12C22 12.3155 21.848 12.5287 21.544 12.955C20.1779 14.8706 16.6892 19 12 19C7.31078 19 3.8221 14.8706 2.45604 12.955C2.15201 12.5287 2 12.3155 2 12C2 11.6845 2.15201 11.4713 2.45604 11.045C3.8221 9.12944 7.31078 5 12 5C16.6892 5 20.1779 9.12944 21.544 11.045Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15C13.6569 15 15 13.6569 15 12Z",stroke:"currentColor",strokeWidth:"1.5"})]}),I5=({size:t=24,className:s,...n})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:t,height:t,color:"#000000",fill:"none",className:s,...n,children:[e.jsx("path",{d:"M15.2141 5.98239L16.6158 4.58063C17.39 3.80646 18.6452 3.80646 19.4194 4.58063C20.1935 5.3548 20.1935 6.60998 19.4194 7.38415L18.0176 8.78591M15.2141 5.98239L6.98023 14.2163C5.93493 15.2616 5.41226 15.7842 5.05637 16.4211C4.70047 17.058 4.3424 18.5619 4 20C5.43809 19.6576 6.94199 19.2995 7.57889 18.9436C8.21579 18.5877 8.73844 18.0651 9.78375 17.0198L18.0176 8.78591M15.2141 5.98239L18.0176 8.78591",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11 20H17",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),L5=({className:t,...s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),E5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 8V16M16 12H8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),M5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M20.3584 13.3567C19.1689 14.546 16.9308 14.4998 13.4992 14.4998C11.2914 14.4998 9.50138 12.7071 9.50024 10.4993C9.50024 7.07001 9.454 4.83065 10.6435 3.64138C11.8329 2.45212 12.3583 2.50027 17.6274 2.50027C18.1366 2.49809 18.3929 3.11389 18.0329 3.47394L15.3199 6.18714C14.6313 6.87582 14.6294 7.99233 15.3181 8.68092C16.0068 9.36952 17.1234 9.36959 17.8122 8.68109L20.5259 5.96855C20.886 5.60859 21.5019 5.86483 21.4997 6.37395C21.4997 11.6422 21.5479 12.1675 20.3584 13.3567Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M13.5 14.5L7.32842 20.6716C6.22386 21.7761 4.433 21.7761 3.32843 20.6716C2.22386 19.567 2.22386 17.7761 3.32843 16.6716L9.5 10.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M5.50896 18.5H5.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),A5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M4 5.00024L10 5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M13 5L20 5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M16 9L16 15",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M10 2L10 8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M12 16L12 22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M16 12L20 12.0002",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4 12.0002L13 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M12 19L20 19",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4 19.0002L9 19",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),T5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M4 4.5L20 4.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 14.5L20 14.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 9.5L20 9.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 19.5L20 19.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),O5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M12 22C6.47711 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C16.4776 2 20.2257 4.94289 21.5 9H19",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 8V12L14 14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21.9551 13C21.9848 12.6709 22 12.3373 22 12M15 22C15.3416 21.8876 15.6753 21.7564 16 21.6078M20.7906 17C20.9835 16.6284 21.1555 16.2433 21.305 15.8462M18.1925 20.2292C18.5369 19.9441 18.8631 19.6358 19.1688 19.3065",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),D5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M12.2422 17V12C12.2422 11.5286 12.2422 11.2929 12.0957 11.1464C11.9493 11 11.7136 11 11.2422 11",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.992 8H12.001",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),qi=({title:t,height:s=16,width:n=16,...r})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:s,height:n,color:"#000000",fill:"none",...r,children:[e.jsx("title",{children:t}),e.jsx("path",{d:"M5.32171 9.6829C7.73539 5.41196 8.94222 3.27648 10.5983 2.72678C11.5093 2.42437 12.4907 2.42437 13.4017 2.72678C15.0578 3.27648 16.2646 5.41196 18.6783 9.6829C21.092 13.9538 22.2988 16.0893 21.9368 17.8293C21.7376 18.7866 21.2469 19.6548 20.535 20.3097C19.241 21.5 16.8274 21.5 12 21.5C7.17265 21.5 4.75897 21.5 3.46496 20.3097C2.75308 19.6548 2.26239 18.7866 2.06322 17.8293C1.70119 16.0893 2.90803 13.9538 5.32171 9.6829Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M11.992 16H12.001",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 13L12 8.99997",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),B5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M19.5 5.5L18.8803 15.5251C18.7219 18.0864 18.6428 19.3671 18.0008 20.2879C17.6833 20.7431 17.2747 21.1273 16.8007 21.416C15.8421 22 14.559 22 11.9927 22C9.42312 22 8.1383 22 7.17905 21.4149C6.7048 21.1257 6.296 20.7408 5.97868 20.2848C5.33688 19.3626 5.25945 18.0801 5.10461 15.5152L4.5 5.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M3 5.5H21M16.0557 5.5L15.3731 4.09173C14.9196 3.15626 14.6928 2.68852 14.3017 2.39681C14.215 2.3321 14.1231 2.27454 14.027 2.2247C13.5939 2 13.0741 2 12.0345 2C10.9688 2 10.436 2 9.99568 2.23412C9.8981 2.28601 9.80498 2.3459 9.71729 2.41317C9.32164 2.7167 9.10063 3.20155 8.65861 4.17126L8.05292 5.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M9.5 16.5L9.5 10.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M14.5 16.5L14.5 10.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),F5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M16 12L8 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4.64856 5.07876C4.78691 4.93211 4.92948 4.7895 5.0761 4.65111M7.94733 2.72939C8.12884 2.6478 8.31313 2.57128 8.5 2.5M2.73172 7.94192C2.64925 8.12518 2.57195 8.31127 2.5 8.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),z5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M2.75 12C2.75 17.5228 7.22715 22 12.75 22C18.2728 22 22.75 17.5228 22.75 12C22.75 6.47714 18.2728 1.99998 12.75 1.99998",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M5.39856 5.07874C5.53691 4.9321 5.67948 4.78948 5.8261 4.65109M8.69733 2.72938C8.87884 2.64779 9.06313 2.57126 9.25 2.49998M3.48172 7.94191C3.39925 8.12517 3.32195 8.31126 3.25 8.49999",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M15.75 9L12.75 12M12.75 12L9.75 15M12.75 12L15.75 15M12.75 12L9.75 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),P5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M8 22V19C8 17.1144 8 16.1716 8.58579 15.5858C9.17157 15 10.1144 15 12 15C13.8856 15 14.8284 15 15.4142 15.5858C16 16.1716 16 17.1144 16 19V22",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),e.jsx("path",{d:"M10 7H14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M3 11.8584C3 7.28199 3 4.99376 4.38674 3.54394C4.43797 3.49038 4.49038 3.43797 4.54394 3.38674C5.99376 2 8.28199 2 12.8584 2C13.943 2 14.4655 2.00376 14.9628 2.18936C15.4417 2.3681 15.8429 2.70239 16.6452 3.37099L18.8411 5.20092C19.9027 6.08561 20.4335 6.52795 20.7168 7.13266C21 7.73737 21 8.42833 21 9.81025V13C21 16.7497 21 18.6246 20.0451 19.9389C19.7367 20.3634 19.3634 20.7367 18.9389 21.0451C17.6246 22 15.7497 22 12 22C8.25027 22 6.3754 22 5.06107 21.0451C4.6366 20.7367 4.26331 20.3634 3.95491 19.9389C3 18.6246 3 16.7497 3 13V11.8584Z",stroke:"currentColor",strokeWidth:"1.5"})]}),R5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4.64856 5.07876C4.7869 4.93211 4.92948 4.7895 5.0761 4.65111M7.94733 2.72939C8.12884 2.6478 8.31313 2.57128 8.5 2.5M2.5 8.5C2.57195 8.31127 2.64925 8.12518 2.73172 7.94192",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 8V16M16 12L8 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),H5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M16.2141 4.98239L17.6158 3.58063C18.39 2.80646 19.6452 2.80646 20.4194 3.58063C21.1935 4.3548 21.1935 5.60998 20.4194 6.38415L19.0176 7.78591M16.2141 4.98239L10.9802 10.2163C9.93493 11.2616 9.41226 11.7842 9.05637 12.4211C8.70047 13.058 8.3424 14.5619 8 16C9.43809 15.6576 10.942 15.2995 11.5789 14.9436C12.2158 14.5877 12.7384 14.0651 13.7837 13.0198L19.0176 7.78591M16.2141 4.98239L19.0176 7.78591",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21 12C21 16.2426 21 18.364 19.682 19.682C18.364 21 16.2426 21 12 21C7.75736 21 5.63604 21 4.31802 19.682C3 18.364 3 16.2426 3 12C3 7.75736 3 5.63604 4.31802 4.31802C5.63604 3 7.75736 3 12 3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),W5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M9.5 13.5C9.99153 14.0057 11.2998 16 12 16M14.5 13.5C14.0085 14.0057 12.7002 16 12 16M12 16V8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5"})]}),V5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M9.5 10.5C9.99153 9.9943 11.2998 8 12 8M14.5 10.5C14.0085 9.9943 12.7002 8 12 8M12 8V16",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5"})]}),U5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M17 10C17 10 13.3176 14 12 14C10.6824 14 7 10 7 10",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),q5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M17 14C17 14 13.3176 10 12 10C10.6824 9.99999 7 14 7 14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),G5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M12.2422 17V12C12.2422 11.5286 12.2422 11.2929 12.0957 11.1464C11.9493 11 11.7136 11 11.2422 11",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.992 8H12.001",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),J5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M11.992 12H12.001",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.9842 16H11.9932",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.9998 8H12.0088",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2.48438 12C2.48438 7.52166 2.48438 5.28249 3.87562 3.89124C5.26686 2.5 7.50603 2.5 11.9844 2.5C16.4627 2.5 18.7019 2.5 20.0931 3.89124C21.4844 5.28249 21.4844 7.52166 21.4844 12C21.4844 16.4783 21.4844 18.7175 20.0931 20.1088C18.7019 21.5 16.4627 21.5 11.9844 21.5C7.50603 21.5 5.26686 21.5 3.87562 20.1088C2.48438 18.7175 2.48438 16.4783 2.48438 12Z",stroke:"currentColor",strokeWidth:"1.5"})]}),X5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M12 2C17.5237 2 22 6.47778 22 12C22 17.5222 17.5237 22 12 22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M9 21.5C7.81163 21.0953 6.69532 20.5107 5.72302 19.7462M5.72302 4.25385C6.69532 3.50059 7.81163 2.90473 9 2.5M2 10.2461C2.21607 9.08813 2.66019 7.96386 3.29638 6.94078M2 13.7539C2.21607 14.9119 2.66019 16.0361 3.29638 17.0592",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M8 16.5C10.0726 14.302 13.9051 14.1986 16 16.5M14.2179 9.75C14.2179 10.9926 13.2215 12 11.9925 12C10.7634 12 9.76708 10.9926 9.76708 9.75C9.76708 8.50736 10.7634 7.5 11.9925 7.5C13.2215 7.5 14.2179 8.50736 14.2179 9.75Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),nx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"#fff",...t,children:[e.jsx("path",{d:"M6.57757 15.4816C5.1628 16.324 1.45336 18.0441 3.71266 20.1966C4.81631 21.248 6.04549 22 7.59087 22H16.4091C17.9545 22 19.1837 21.248 20.2873 20.1966C22.5466 18.0441 18.8372 16.324 17.4224 15.4816C14.1048 13.5061 9.89519 13.5061 6.57757 15.4816Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M16.5 6.5C16.5 8.98528 14.4853 11 12 11C9.51472 11 7.5 8.98528 7.5 6.5C7.5 4.01472 9.51472 2 12 2C14.4853 2 16.5 4.01472 16.5 6.5Z",stroke:"currentColor",strokeWidth:"1.5"})]}),Z5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("circle",{cx:"1.5",cy:"1.5",r:"1.5",transform:"matrix(1 0 0 -1 16 8)",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2.77423 11.1439C1.77108 12.2643 1.7495 13.9546 2.67016 15.1437C4.49711 17.5033 6.49674 19.5029 8.85633 21.3298C10.0454 22.2505 11.7357 22.2289 12.8561 21.2258C15.8979 18.5022 18.6835 15.6559 21.3719 12.5279C21.6377 12.2187 21.8039 11.8397 21.8412 11.4336C22.0062 9.63798 22.3452 4.46467 20.9403 3.05974C19.5353 1.65481 14.362 1.99377 12.5664 2.15876C12.1603 2.19608 11.7813 2.36233 11.472 2.62811C8.34412 5.31646 5.49781 8.10211 2.77423 11.1439Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M7 14L10 17",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),rx=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:e.jsx("path",{d:"M17.9998 15C17.9998 15 13.5809 9.00001 11.9998 9C10.4187 8.99999 5.99985 15 5.99985 15",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),rn=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:e.jsx("path",{d:"M18 9.00005C18 9.00005 13.5811 15 12 15C10.4188 15 6 9 6 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),Y5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M8 7H20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 7H4.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M8 12H8.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M8 17H8.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 12H20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 17H20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),ax=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:e.jsx("path",{d:"M8.85746 12.5061C6.36901 10.6456 4.59564 8.59915 3.62734 7.44867C3.3276 7.09253 3.22938 6.8319 3.17033 6.3728C2.96811 4.8008 2.86701 4.0148 3.32795 3.5074C3.7889 3 4.60404 3 6.23433 3H17.7657C19.396 3 20.2111 3 20.672 3.5074C21.133 4.0148 21.0319 4.8008 20.8297 6.37281C20.7706 6.83191 20.6724 7.09254 20.3726 7.44867C19.403 8.60062 17.6261 10.6507 15.1326 12.5135C14.907 12.6821 14.7583 12.9567 14.7307 13.2614C14.4837 15.992 14.2559 17.4876 14.1141 18.2442C13.8853 19.4657 12.1532 20.2006 11.226 20.8563C10.6741 21.2466 10.0043 20.782 9.93278 20.1778C9.79643 19.0261 9.53961 16.6864 9.25927 13.2614C9.23409 12.9539 9.08486 12.6761 8.85746 12.5061Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),ox=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M20.9987 4.5C20.9869 4.06504 20.8956 3.75346 20.672 3.5074C20.2111 3 19.396 3 17.7657 3H6.23433C4.60404 3 3.7889 3 3.32795 3.5074C2.86701 4.0148 2.96811 4.8008 3.17033 6.3728C3.22938 6.8319 3.3276 7.09253 3.62734 7.44867C4.59564 8.59915 6.36901 10.6456 8.85746 12.5061C9.08486 12.6761 9.23409 12.9539 9.25927 13.2614C9.53961 16.6864 9.79643 19.0261 9.93278 20.1778C10.0043 20.782 10.6741 21.2466 11.226 20.8563C12.1532 20.2006 13.8853 19.4657 14.1141 18.2442C14.1986 17.7934 14.3136 17.0803 14.445 16",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21 7L15 13M21 13L15 7",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),lx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M7 7.99678H6.17647C4.67907 7.99678 3.93037 7.99678 3.46518 7.55782C3 7.11886 3 6.41236 3 4.99937C3 3.58638 3 2.87988 3.46518 2.44091C3.93037 2.00195 4.67907 2.00195 6.17647 2.00195H17.8235C19.3209 2.00195 20.0696 2.00195 20.5348 2.44091C21 2.87988 21 3.58638 21 4.99937C21 6.41236 21 7.11886 20.5348 7.55782C20.0696 7.99678 19.3209 7.99678 17.8235 7.99678H16.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M18.0296 21.9913C17.9799 20.2775 18.1199 20.0519 18.2514 19.6706C18.3828 19.2893 19.1984 17.9357 19.5236 16.9534C20.576 13.7752 19.7712 13.2378 18.5104 12.2723C17.0658 11.1661 14.6208 10.6032 13.0946 10.7248V6.63467C13.0946 5.77207 12.2692 5.02148 11.3432 5.02148C10.4172 5.02148 9.59704 5.77207 9.59704 6.63467V14.3866L7.62568 12.7092C7.0938 12.1718 6.24275 12.221 5.62664 12.6277C5.43494 12.7543 5.27952 12.9319 5.18075 13.1393C4.90045 13.7279 4.98135 14.3942 5.42292 14.9396L6.54372 16.3843M9.52799 21.9972V21.0506C9.60063 19.8883 8.54484 18.9548 7.42153 17.516M7.42153 17.516C7.34059 17.4123 7.49821 17.613 7.42153 17.516ZM7.42153 17.516C7.08118 17.0856 6.81124 16.708 6.54372 16.3843M7.42153 17.516L8.52852 18.8698M7.42153 17.516L6.54372 16.3843",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),Q5=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M12 4V20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 12H20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),K5=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:22,height:22,color:"#000000",fill:"none",...t,children:e.jsx("path",{d:"M9.00005 6C9.00005 6 15 10.4189 15 12C15 13.5812 9 18 9 18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),Vl=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M19.75 5.5L19.25 11.5M4.75 5.5L5.35461 15.5368C5.50945 18.1073 5.58688 19.3925 6.22868 20.3167C6.546 20.7737 6.9548 21.1594 7.42905 21.4493C8.01127 21.8051 8.71343 21.945 9.75 22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M11.25 15.5L12.3863 16.9657C12.958 14.8319 15.1514 13.5655 17.2852 14.1373C18.3775 14.43 19.2425 15.1475 19.75 16.0646M21.25 20.5L20.1137 19.0363C19.5419 21.1701 17.3486 22.4365 15.2147 21.8647C14.1478 21.5788 13.2977 20.8875 12.7859 20.001",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M3.25 5.5H21.25M16.3057 5.5L15.6231 4.09173C15.1696 3.15626 14.9428 2.68852 14.5517 2.39681C14.465 2.3321 14.3731 2.27454 14.277 2.2247C13.8439 2 13.3241 2 12.2845 2C11.2188 2 10.686 2 10.2457 2.23412C10.1481 2.28601 10.055 2.3459 9.96729 2.41317C9.57164 2.7167 9.35063 3.20155 8.90861 4.17126L8.30292 5.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),zs={PencilEditSquare:S5,ViewIcon:_5,PencilIcon:I5,CirclePlus:L5,SquarePlus:E5,WrenchIcon:M5,SlidersIcon:A5,MenuIcon:T5,ClockIcon:O5,InfoCircle:D5,Alert:qi,TrashCan:B5,RemoveCircle:F5,CancelCircle:z5,FloppyDisk:P5,CirclePlusDot:R5,PencilSquare:H5,ArrowDownSquare:W5,ArrowUpSquare:V5,ChevronDownSquare:U5,ChevronUpSquare:q5,InfoSquare:G5,MoreSquare:J5,UserCircle:X5,User:nx,Tags:Z5,ArrowUp:rx,ArrowDown:rn,ArrowRight:K5,Group:Y5,Filter:ax,FilterRemove:ox,TouchInteraction:lx,Add:Q5},Sd=t=>{try{return JSON.parse(t)}catch{return t}},ej=({value:t="{}",onChange:s,className:n,placeholder:r,manageTemplates:a,apiLoad:l,format:i,...c})=>{const d=et(),[u,m]=b.useState(Sd(t)),[p,x]=b.useState(""),h=b.useRef(),f=b.useRef();b.useEffect(()=>m(Sd(t)),[t]);const g=(k,$)=>{h.current=$,k.dataTransfer.effectAllowed="move"},y=(k,$)=>{f.current=$},v=k=>{k.preventDefault(),k.dataTransfer.dropEffect="move"},j=k=>{const $=pe(u.attributes),E=$[h.current];$.splice(h.current,1),$.splice(f.current,0,E),h.current=null,f.current=null;const M={...u,attributes:$};m(M),s(JSON.stringify(M))},N=(k,$)=>{const E=((u==null?void 0:u.attributes)||[]).map(_=>_.name===k?{..._,...$}:_),M={...u,attributes:E,is_dirty:!0};m(M),s(JSON.stringify(M))},S=k=>{const $={...u,attributes:[...u.attributes||[],k],is_dirty:!0};m($),s(JSON.stringify($))},w=k=>{const $={...u,attributes:u.attributes.filter(E=>E.name!==k),is_dirty:!0};m($),s(JSON.stringify($))};return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("input",{className:"p-2 mb-2 w-full border rounded-md shrink",value:p,onChange:k=>x(k.target.value),placeholder:"search..."}),u.is_dirty?e.jsxs("div",{className:"flex text-sm italic items-center",children:[e.jsx(qi,{className:"text-yellow-600 cursor-pointer mx-1"}),e.jsx("span",{children:"Metadata has changed since last data validation. Please re-run validate to ensure accuracy."})]}):null]}),e.jsx("div",{className:"max-h-[74dvh] overflow-auto scrollbar-sm",children:((u==null?void 0:u.attributes)||[]).filter(k=>!p||k.name.toLowerCase().includes(p.toLowerCase())||k.display_name.toLowerCase().includes(p.toLowerCase())).map((k,$)=>e.jsx(v5,{i:$,item:k,placeholder:r,id:`field-comp-${$}`,attribute:k==null?void 0:k.name,theme:d,updateAttribute:N,removeAttribute:w,apiLoad:l,format:i,dragStart:g,dragEnter:y,dragOver:v,drop:j},`field-comp-${$}`))}),e.jsx("div",{className:"w-full p-2",children:e.jsx($5,{attributes:u.attributes,placeholder:"New field name...",theme:d,className:n,addAttribute:S})})]})},tj=({value:t,className:s})=>{var r;if(!t)return!1;const n=et();return e.jsx("div",{className:s||((r=n==null?void 0:n.text)==null?void 0:r.view),children:t})},sj={EditComp:ej,ViewComp:tj},nj=({value:t,item:s,onChange:n,className:r,attributes:a={},...l})=>(console.log("can i pass item here?",s,t,l),et(),Object.keys(a).map(i=>{const c=a[i].EditComp;return e.jsx(c,{placeholder:a[i].key,...a[i],...l})})),rj=({value:t,className:s,...n})=>{var a;if(!t)return!1;console.log("template",t,n);const r=et();return e.jsx("div",{className:s||((a=r==null?void 0:r.text)==null?void 0:a.view),children:JSON.stringify(t)})},aj={EditComp:nj,ViewComp:rj};function oj({value:t,onChange:s,attributes:n={}}){console.log("dms-format",t,n);const r=(a,l)=>{Qe(t,{...t,[a]:l})||s({...t,[a]:l})};return e.jsx("div",{children:Object.keys(n).map((a,l)=>{let i=n[a].EditComp;return e.jsxs("div",{children:[e.jsx("div",{children:a}),e.jsx("div",{children:e.jsx(i,{value:t==null?void 0:t[a],onChange:c=>r(a,c)},`${a}-${l}`)})]},`${a}-${l}`)})})}const lj=({value:t={},attributes:s={}})=>(console.log("dms-format value",t,s),e.jsx("div",{children:Object.keys(s).map((n,r)=>{let a=s[n].ViewComp;return e.jsxs("div",{children:[e.jsx("div",{children:n}),e.jsx("div",{children:e.jsx(a,{value:t[n]},`${n}-${r}`)})]},`${n}-${r}`)})})),ij={EditComp:oj,ViewComp:lj},cj=({Component:t,value:s,onChange:n,attr:r})=>{(!s||!s.map)&&(s=[]);const[a,l]=C.useState(""),i=()=>{n([...s,a]),l("")};return e.jsxs(e.Fragment,{children:[s.map((c,d)=>b.createElement(t.ViewComp,{value:c,...r,key:d})),e.jsx(t.EditComp,{value:a,onChange:l,...r}),e.jsx("button",{onClick:i,children:"Add"})]})},dj=({Component:t,value:s,attr:n})=>!s||!s.map?"":s.map((r,a)=>b.createElement(t.ViewComp,{...n,key:a,value:r})),ix={EditComp:cj,ViewComp:dj},uj=({value:t="",onChange:s,className:n,placeholder:r,displayInvalidMsg:a=!0,options:l=[],...i})=>{var u,m;const c=et(),d=t&&!l.find(p=>(p.value||p)===t);return e.jsxs(e.Fragment,{children:[d?e.jsx(Ui,{className:(u=c==null?void 0:c.select)==null?void 0:u.error,title:`Invalid Value: ${JSON.stringify(t)}`}):null,e.jsxs("select",{className:n||((m=c==null?void 0:c.select)==null?void 0:m.input)||"w-full border p-2",value:t,onChange:p=>s(p.target.value),children:[e.jsx("option",{value:"",children:r}),l.map((p,x)=>e.jsx("option",{value:p.value||p,children:p.label||p},x))]})]})},mj=({className:t,value:s,options:n=[],...r})=>{var i,c;if(!s)return e.jsx("div",{className:`${t||((i=a==null?void 0:a.select)==null?void 0:i.input)}`});const a=et(),l=n.find(d=>(d.value||d)===s)||s;return s&&n.find(d=>(d.value||d)===s),e.jsx("div",{className:`${t||((c=a==null?void 0:a.select)==null?void 0:c.input)}`,...r,children:(l==null?void 0:l.label)||l})},pj={EditComp:uj,ViewComp:mj},xj="flex px-2 py-1 w-full text-sm font-light border focus:border-blue-300 bg-white hover:bg-gray-100 transition ease-in",hj="w-full",fj="focus:outline-none w-full",gj="flex px-2 py-1 mx-1 bg-gray-100 hover:bg-gray-300 rounded-md transition ease-in",bj="fa fa-x px-1 text-xs text-red-300 hover:text-red-500 self-center transition ease-in",yj="p-2 shadow-lg z-10",cl="px-2 py-1 hover:bg-gray-300 hover:cursor-pointer transition ease-in",cx=(t,s)=>t==null&&s==null?!0:typeof t=="object"||typeof s=="object"?!1:String(t)===String(s),dx=({token:t,value:s,onChange:n,theme:r,isSearching:a,setIsSearching:l})=>{var i,c;return e.jsxs("div",{className:((i=r==null?void 0:r.multiselect)==null?void 0:i.tokenWrapper)||gj,children:[e.jsx("div",{onClick:()=>l(!a),children:t.label||t}),n&&e.jsx("div",{className:((c=r==null?void 0:r.multiselect)==null?void 0:c.removeIcon)||bj,onClick:d=>n(s.filter(u=>(u.value||u)!==(t.value||t))),children:" x "})]})},vj=({loading:t,options:s=[],isSearching:n,setIsSearching:r,placeholder:a,setSearchKeyword:l,searchKeyword:i,value:c,onChange:d,singleSelectOnly:u,theme:m})=>{var f,g,y;const p=c.filter(v=>v).map(v=>v.value||v),x={label:"Select All",value:"select-all"},h={label:"Remove All",value:"remove-all"};return e.jsxs("div",{className:`${n?"block":"hidden"} ${((f=m==null?void 0:m.multiselect)==null?void 0:f.menuWrapper)||yj}`,children:[e.jsx("input",{autoFocus:!0,placeholder:a||"search...",className:((g=m==null?void 0:m.multiselect)==null?void 0:g.input)||fj,onChange:v=>l(v.target.value),onFocus:()=>r(!0)},"input"),e.jsx("div",{className:m.multiselect.smartMenuWrapper,children:[x,h].filter(v=>u?!1:v.value==="select-all"?c.length!==(s==null?void 0:s.length):v.value==="remove-all"?c.length:!0).map((v,j)=>{var N;return e.jsx("div",{className:((N=m==null?void 0:m.multiselect)==null?void 0:N.smartMenuItem)||cl,onClick:S=>{d(v.value==="select-all"?s:v.value==="remove-all"?[]:[...c,v]),r(!1)},children:v.label||v},`smart-option-${j}`)})}),t?e.jsx("div",{className:((y=m==null?void 0:m.multiselect)==null?void 0:y.menuItem)||cl,children:"loading..."}):(s||[]).filter(v=>{var j,N;return!p.includes(v.value||v)&&((N=(j=v.label||v)==null?void 0:j.toString())==null?void 0:N.toLowerCase().includes(i==null?void 0:i.toLowerCase()))}).map((v,j)=>{var N;return e.jsx("div",{className:((N=m==null?void 0:m.multiselect)==null?void 0:N.menuItem)||cl,onClick:S=>{d(v.value==="select-all"?s:v.value==="remove-all"?[]:u?[v]:[...c,v]),r(!1)},children:v.label||v},`option-${j}`)})]})};function wj(t){const[s,n]=b.useState(t),r=b.useRef(null),a=i=>{(i.key==="Escape"||i.key==="Tab")&&n(!1)},l=i=>{r.current&&!r.current.contains(i.target)&&n(!1)};return b.useEffect(()=>(document.addEventListener("keydown",a,!0),document.addEventListener("click",l,!0),()=>{document.removeEventListener("keydown",a,!0),document.removeEventListener("click",l,!0)})),{ref:r,isSearching:s,setIsSearching:n}}const jj=({value:t=[],loading:s,onChange:n,className:r,placeholder:a,options:l=[],displayInvalidMsg:i=!0,menuPosition:c="bottom",singleSelectOnly:d=!1})=>{var v,j,N;const[u,m]=b.useState(""),p=(Array.isArray(t)?t:[t]).map(S=>l.find(w=>cx(w.value||w,S.value||S))||S),x=et(),{ref:h,isSearching:f,setIsSearching:g}=wj(!1),y=p.filter(S=>S&&(S.value||S)&&!(l!=null&&l.some(w=>(w.value||w)===(S.value||S))));return e.jsxs("div",{ref:h,className:`${((v=x==null?void 0:x.multiselect)==null?void 0:v.mainWrapper)||hj} ${c==="top"?"flex flex-col flex-col-reverse":""} ${s?"cursor-wait":""}`,children:[y.length&&i?e.jsx(Ui,{className:(j=x==null?void 0:x.multiselect)==null?void 0:j.error,title:`Invalid Values: ${JSON.stringify(y)}`}):null,e.jsxs("div",{className:r||((N=x==null?void 0:x.multiselect)==null?void 0:N.inputWrapper)||xj,onClick:()=>{g(!f)},children:[p.filter(S=>S).map((S,w)=>e.jsx(dx,{token:S,value:p,onChange:n,isSearching:f,setIsSearching:g,theme:x},w)),e.jsx(w5,{className:"ml-auto self-center font-bold",width:16,height:16})]}),e.jsx(vj,{loading:s,isSearching:f,setIsSearching:g,placeholder:a,setSearchKeyword:m,searchKeyword:u,value:p,onChange:n,options:l,singleSelectOnly:d,theme:x})]})},Cj=({className:t,value:s,options:n=[]})=>{var l,i,c;const r=et();if(!s)return e.jsx("div",{className:(l=r==null?void 0:r.multiselect)==null?void 0:l.mainWrapper});const a=(Array.isArray(s)?s:[s]).map(d=>n.find(u=>cx(u.value||u,d.value||d))||d);return e.jsx("div",{className:(i=r==null?void 0:r.multiselect)==null?void 0:i.mainWrapper,children:e.jsx("div",{className:t||((c=r==null?void 0:r.text)==null?void 0:c.inputWrapper),children:a.map((d,u)=>e.jsx(dx,{token:d,isSearching:!1,setIsSearching:()=>{},theme:r},u))})})},Nj={EditComp:jj,ViewComp:Cj},kj=({value:t="",onChange:s,options:n=[],inline:r})=>{var i;const a=et(),l=t&&!n.find(c=>(c.value||c)===t);return e.jsxs(e.Fragment,{children:[l?e.jsxs("div",{className:(i=a==null?void 0:a.radio)==null?void 0:i.error,children:["Invalid Value: ",JSON.stringify(t)]}):null,e.jsx("div",{className:`flex ${r?"flex-row":"flex-col"}`,children:n.map((c,d)=>{var u,m,p;return e.jsxs("div",{className:((u=a==null?void 0:a.radio)==null?void 0:u.wrapper)||"p-1 flex",children:[e.jsx("input",{id:c.value||c,className:((m=a==null?void 0:a.radio)==null?void 0:m.input)||"self-center p-1",type:"radio",value:c.value||c,checked:t===(c.value||c),onChange:x=>s(x.target.value)}),e.jsxs("label",{htmlFor:c.label||c,className:((p=a==null?void 0:a.radio)==null?void 0:p.label)||"text-sm font-light p-1 self-center",children:[" ",c.label||c," "]})]},d)})})]})},$j=({className:t,value:s})=>{var r;if(!s)return!1;const n=et();return e.jsx("div",{className:t||((r=n==null?void 0:n.text)==null?void 0:r.view),children:s})},Sj={EditComp:kj,ViewComp:$j},Ue={text:Qo,datetime:Qo,textarea:lv,config:sj,"form-template":aj,boolean:dv,"dms-format":ij,lexical:jo,select:pj,multiselect:Nj,radio:Sj,default:Qo};function _j(t,s){Ue[t]=s}function Ij(t){const{type:s="default",isArray:n=!1,attributes:r}=t;let a=ne(Ue,`[${s}]`,Ue.default),l=a.ViewComp;if(n){let i=t.DisplayComp?t.DisplayComp.ViewComp:ix.ViewComp;l=c=>e.jsx(i,{Component:a,...c,attr:t})}return l}function Lj(t){const{type:s="default",isArray:n=!1,attributes:r}=t;let a=ne(Ue,`[${s}]`,Ue.default),l=a.EditComp;if(n){let i=t.DisplayComp?t.DisplayComp.EditComp:ix.EditComp;l=c=>e.jsx(i,{Component:a,...c,attr:t})}return l}function zr(t,s={},n=""){const r=ux(t),a=(s==null?void 0:s.accessor)||"key",l=t.attributes.filter(c=>n!=="edit"||typeof c.editable>"u"||!!c.editable).reduce((c,d)=>(d.format&&r[d.format]?c[d[a]]={...d,attributes:zr(r[d.format])}:c[d[a]]=d,c),{}),i=Object.keys(l);return Object.keys(l).filter(c=>i.includes(c)).forEach(c=>{l[c].ViewComp=Ij(ne(l,`${c}`,{})),l[c].EditComp=Lj(ne(l,`${c}`,{}))}),l}function ux(t,s={}){if(!t)return s;const n=pe(t);return n.registerFormats&&n.registerFormats.forEach(r=>ux(r,s)),s[`${n.app}+${n.type}`]=n,s}const Ej=(t,s="update")=>{let n=new FormData;return n.append("data",JSON.stringify(t)),n.append("requestType",s),n};function Mj({Component:t,format:s,options:n,params:r,user:a,...l}){const{falcor:i}=Gt.useFalcor(),{app:c,type:d}=s,u=zr(s,n,"edit"),m=bt(),{pathname:p,search:x}=Ge(),{data:h=[]}=Ci(),[f,g]=C.useState({updating:0,loading:0});Nb();const{defaultSort:y=E=>E}=s,[v,j]=C.useState(y(h).filter(E=>Ul(E,r,s))[0]||{});b.useEffect(()=>{let E=h.filter(M=>Ul(M,r,s))[0];!Qe(v,E)&&E&&(console.log("updating item"),j(E||{}))},[h,r]);const N=(E,M,_)=>{j(_?{...v,..._}:{...v,[E]:M})},S=()=>{m(Ej(v),{method:"post",action:`${p}${x}`})},w=async({data:E,config:M={format:s},requestType:_="",newPath:L=`${p}${x}`})=>{g(A=>({...A,updating:A.updating+1}));const D=await ys(i,M,E,_);if(m(null,{action:L}),g(A=>({...A,updating:A.updating-1})),!E.id)return D;E.app!==c||E.type},k=async(E,M)=>{g(L=>({...L,loading:L.loading+1}));let _=await St(i,E,M||"/");return g(L=>({...L,loading:L.loading-1})),_},$=C.useMemo(()=>t,[]);return C.useMemo(()=>e.jsx($,{...l,format:s,attributes:u,item:v,dataItems:h,busy:f,params:r,apiUpdate:w,apiLoad:k,options:n,user:a,submit:S,updateAttribute:N}),[h,v])}function Aj({Component:t,format:s,options:n,user:r,...a}){const{falcor:l}=Gt.useFalcor(),i=zr(s,n),{app:c,type:d}=s,{pathname:u,search:m}=Ge(),{data:p=[]}=Ci()||{},x=bt(),h=async({data:y,config:v={format:s},requestType:j=""})=>{const N=await ys(l,v,y,j);if(!y.id)return N;y.app!==c||y.type!==d||x(null,{action:`${u}${m}`})},f=async(y,v)=>await St(l,y,v),g=C.useMemo(()=>t,[]);return C.useMemo(()=>e.jsx(g,{...a,format:s,attributes:i,dataItems:p,apiUpdate:h,apiLoad:f,options:n,user:r},n==null?void 0:n.path),[p])}function Tj({Component:t,format:s,options:n,params:r,user:a,...l}){const{falcor:i}=Gt.useFalcor(),c=bt(),{pathname:d,search:u}=Ge();let m=zr(s,n);const{data:p=[]}=Ci()||{},{defaultSort:x=N=>N}=s,[h,f]=C.useState({updating:0,loading:0}),g=x(p).filter(N=>Ul(N,r,s))[0]||p[0],y=C.useMemo(()=>t,[]),v=async({data:N,config:S={format:s},requestType:w="",newPath:k=`${d}${u}`})=>{f(E=>({...E,updating:E.updating+1}));const $=await ys(i,S,N,w);if(c(null,{action:k}),f(E=>({...E,updating:E.updating-1})),!N.id)return $},j=async(N,S)=>{f(k=>({...k,loading:k.loading+1}));let w=await St(i,N,S||"/");return f(k=>({...k,loading:k.loading-1})),w};return e.jsx(y,{...l,format:s,attributes:m,item:g,dataItems:p,options:n,user:a,apiLoad:j,apiUpdate:v,busy:h})}function Oj({Component:t,format:s,options:n,user:r,...a}){let l=zr(s,n);return e.jsx(t,{...a,format:s,attributes:l,dataItems:[],options:n,user:r})}const ya={edit:Mj,error:Oj,list:Aj,view:Tj};function Dj(t){return e.jsx("div",{children:"404 - Config not found"})}function Ba({item:t,attributes:s,next:n,nextDisabled:r,prev:a,prevDisabled:l,sectionId:i,preferredTheme:c}){var u,m,p;const d=c||et();return t?e.jsxs("div",{className:ne(d,"card.wrapper",""),children:[Object.keys(s).filter(x=>!i||s[x].section===i).map((x,h)=>{var g,y;let f=s[x].ViewComp;return e.jsxs("div",{className:ne(d,"card.row",""),children:[e.jsx("div",{className:ne(d,"card.rowLabel",""),children:((g=s[x])==null?void 0:g.display_name)||((y=s[x])==null?void 0:y.label)||x}),e.jsx("div",{className:ne(d,"card.rowContent",""),children:e.jsx(f,{value:t[x],...s[x]})})]},h)}),(a||n)&&i&&e.jsxs("div",{className:(u=d==null?void 0:d.card)==null?void 0:u.btnWrapper,children:[a&&i&&e.jsx("button",{className:(m=d==null?void 0:d.card)==null?void 0:m.backBtn,disabled:l,onClick:()=>a(),children:" Back "}),n&&i&&e.jsx("button",{className:(p=d==null?void 0:d.card)==null?void 0:p.continueBtn,disabled:r,onClick:()=>n(),children:" Continue "})]})]},t.id):e.jsx("div",{})}function Bj({dataItems:t=[],attributes:s}){return et(),e.jsxs("div",{className:"border border-pink-300",children:["Landing",t.map((n,r)=>e.jsx(Ba,{item:n,attributes:s},r))]})}function _d(t,s){var n=/:(\w+)/g;return t.replace(n,function(r,a){return s[a]||":"+a})}const Id={data:function({data:s,column:n,className:r,key:a}){return e.jsxs("td",{className:r,children:[" ",ne(s,[n.path],"").toString()," "]},a)},date:function({data:s,column:n,className:r,key:a}){return e.jsxs("td",{className:r,children:[" ",new Date(s[n.path]).toLocaleString()," "]},a)},link:function({data:s,column:n,className:r,key:a}){return e.jsx("td",{className:r,children:e.jsx(ue,{to:_d(n.to,s),children:_d(n.text,s)})},a)}};function Fj({data:t,column:s,className:n}){let r=ne(Id,[s.type],Id.data);return e.jsx(r,{data:t,column:s,className:n})}function zj({dataItems:t=[],attributes:s={},options:n={}}){var l,i,c;const r=et();let{columns:a=[]}=n;return a.length===0?e.jsx("div",{children:" No columns specified. "}):e.jsx("div",{className:"",children:e.jsxs("table",{className:`${(l=r==null?void 0:r.table)==null?void 0:l.table}`,children:[e.jsx("thead",{className:`${(i=r==null?void 0:r.table)==null?void 0:i.thead}`,children:e.jsx("tr",{children:a.map((d,u)=>{var m;return e.jsx("th",{className:`${(m=r==null?void 0:r.table)==null?void 0:m.th}`,children:d.name},u)})})}),e.jsx("tbody",{className:`${(c=r==null?void 0:r.table)==null?void 0:c.tbody}`,children:t.map(d=>e.jsx("tr",{children:a.map((u,m)=>{var p;return e.jsx(Fj,{className:`${(p=r==null?void 0:r.table)==null?void 0:p.td}`,data:d,column:u},`${u.name}-${m}`)})},d.id))})]})})}function mx({item:t={},attributes:s,updateAttribute:n,status:r,submit:a,next:l,nextDisabled:i,prev:c,prevDisabled:d,sectionId:u,...m}){var x,h,f,g;const p=et();return e.jsxs("div",{className:ne(p,"card.wrapper",""),children:[r?e.jsx("div",{children:JSON.stringify(r)}):"",Object.keys(s).filter(y=>!u||s[y].section===u).map((y,v)=>{var N,S,w,k;let j=s[y].EditComp;return e.jsxs("div",{className:ne(p,"card.row",""),children:[e.jsxs("div",{className:ne(p,"card.rowHeader",""),children:[e.jsx("div",{className:ne(p,"card.rowLabel",""),children:((N=s[y])==null?void 0:N.display_name)||((S=s[y])==null?void 0:S.label)||y}),((w=s[y])==null?void 0:w.prompt)&&e.jsx("i",{title:(k=s[y])==null?void 0:k.prompt,className:ne(p,"card.infoIcon","fad fa-info")})]}),e.jsx("div",{className:ne(p,"card.rowContent",""),children:e.jsx(j,{value:t==null?void 0:t[y],onChange:$=>n(y,$),...s[y]},`${y}-${v}`)})]},`${y}-${v}`)}),e.jsxs("div",{className:(x=p==null?void 0:p.card)==null?void 0:x.btnWrapper,children:[c&&u&&e.jsx("button",{className:(h=p==null?void 0:p.card)==null?void 0:h.backBtn,disabled:d,onClick:()=>c(),children:" Back "}),l&&u&&e.jsx("button",{className:(f=p==null?void 0:p.card)==null?void 0:f.continueBtn,disabled:i,onClick:()=>l(),children:" Continue "}),e.jsx("button",{className:(g=p==null?void 0:p.card)==null?void 0:g.submitBtn,onClick:()=>a(),children:" Save"})]})]},t.id)}const Pj=({theme:t={},tabs:s=[],activeIndex:n=0,setActiveIndex:r=null})=>{if(!s)return null;const[a,l]=C.useState(n);return C.useEffect(()=>{l(n)},[n]),e.jsx("div",{className:`${t.tabpanelWrapper}`,children:e.jsx("div",{className:`${t.tabWrapper}`,children:s.map(({icon:i,title:c,subtitle:d},u)=>e.jsxs("div",{onClick:m=>r?r(u):l(u),className:`${u===a?t.tabActive:t.tab}`,children:[e.jsx("span",{className:`${i} ${t.icon}`}),e.jsxs("span",{className:`${t.tabTitle}`,children:[" ",c," "]}),e.jsxs("span",{className:`${t.tabSubtitle}`,children:[" ",d," "]})]},u))})})};function Rj({item:t,updateAttribute:s,attributes:n,status:r,submit:a,format:l,...i}){var m,p,x;const[c,d]=b.useState(l!=null&&l.sections?0:void 0),u=et();return e.jsxs(e.Fragment,{children:[e.jsx(Pj,{tabs:l==null?void 0:l.sections,activeIndex:c,setActiveIndex:d,theme:u.form}),e.jsx(mx,{item:t,status:r,attributes:n,sectionId:(p=(m=l==null?void 0:l.sections)==null?void 0:m[c])==null?void 0:p.id,updateAttribute:s,submit:a,next:()=>d(c+1),nextDisabled:c===((x=l==null?void 0:l.sections)==null?void 0:x.length)-1,prev:()=>d(c-1),prevDisabled:c===0})]})}function Hj({item:t,updateAttribute:s,attributes:n,status:r,submit:a,format:l,...i}){var d;const c=et();return e.jsx("div",{className:(d=c==null?void 0:c.form)==null?void 0:d.sectionsWrapper,children:l!=null&&l.sections?((l==null?void 0:l.sections)||[]).map(u=>{var m,p,x,h,f;return e.jsxs("div",{className:(m=c==null?void 0:c.form)==null?void 0:m.sections,children:[e.jsxs("div",{className:(p=c==null?void 0:c.form)==null?void 0:p.tab,children:[e.jsx("span",{className:`${u.icon} ${(x=c==null?void 0:c.form)==null?void 0:x.icon}`}),e.jsxs("span",{className:`${(h=c==null?void 0:c.form)==null?void 0:h.tabTitle}`,children:[" ",u.title," "]}),e.jsxs("span",{className:`${(f=c==null?void 0:c.form)==null?void 0:f.tabSubtitle}`,children:[" ",u.subtitle," "]})]}),e.jsx(Ba,{preferredTheme:c==null?void 0:c.form,item:t,status:r,attributes:n,sectionId:u==null?void 0:u.id})]},u==null?void 0:u.id)}):e.jsx(Ba,{preferredTheme:c==null?void 0:c.form,item:t,status:r,attributes:n})})}function Wj({config:t}){return e.jsxs("div",{children:[" Invalid DMS Config :",e.jsx("pre",{style:{background:"#dedede"},children:JSON.stringify(t,null,3)})]})}function Vj({path:t}){return e.jsxs("div",{children:[" These aren't the droids you are looking for",e.jsx("div",{className:"text-5xl",children:"404"}),e.jsxs("div",{children:["/",t]})]})}const lr={devinfo:Dj,"dms-landing":Bj,"dms-table":zj,"dms-card":Ba,"dms-edit":mx,"dms-form-edit":Rj,"dms-form-view":Hj,InvalidConfig:Wj,NoRouteMatch:Vj},Uj=lr==null?void 0:lr.devinfo,qj=ya==null?void 0:ya.error;let Gj=0;function px(t,s){let r=(uo(t.map(a=>({path:a.path,...a})),{pathname:s})||[]).reduce((a,l)=>(a[l.route.path]=l,a),{});return t.filter((a,l)=>{let i=(r==null?void 0:r[a.path])||!1;return i&&(a.params=i.params),i})}function xx(t,s,n,r,a=0){return px(t,s).map(i=>{const c=typeof i.type=="function"?i.type:lr[i.type]||Uj,d=ya[i.action]||qj;let u=[];return i.children&&(u=xx(i.children,s,n,r,a+1)),e.jsx(d,{Component:c,format:n,...i,children:u,user:r},Gj++)})}function Gi(t=[],s="/",n=0){let r=pe(px(t,s)),a=r.reduce((l,i)=>{var d;let c=(d=i.children)!=null&&d.length?Gi(i.children,s,n+1):[];return c.length?[...l,...c]:l},[]);return[...r,...a]}function Jj(t){return t&&t.attributes&&t.attributes.length>0}function Ul(t,s,n){var l;let r=((l=n==null?void 0:n.attributes)==null?void 0:l.reduce((i,c)=>(c.matchWildcard&&(i=c.key),i),""))||"",a=!1;return Object.keys(s).forEach(i=>{t[i]==s[i]||t[r]&&t[r]===s["*"]?a=!0:a=!1}),s.id==t.id?!0:a}const Xj=(t,s,n,r)=>{var g,y,v,j,N,S,w,k,$,E,M,_,L;const{app:a,type:l,view_id:i,env:c}=s;let d=((g=t==null?void 0:t.filter)==null?void 0:g.attributes)||[],u=d.length>0?d.map(D=>`data ->> '${D}'`):["data"],m=typeof((y=t==null?void 0:t.filter)==null?void 0:y.fromIndex)=="function"?(v=t==null?void 0:t.filter)==null?void 0:v.fromIndex(n):+((N=t.params)==null?void 0:N[(j=t==null?void 0:t.filter)==null?void 0:j.fromIndex])||0,p=typeof((S=t==null?void 0:t.filter)==null?void 0:S.toIndex)=="function"?(w=t==null?void 0:t.filter)==null?void 0:w.toIndex(n):+(($=t.params)==null?void 0:$[(k=t==null?void 0:t.filter)==null?void 0:k.toIndex])||r-1,x=((E=t==null?void 0:t.filter)==null?void 0:E.options)||"{}",h=((M=t==null?void 0:t.filter)==null?void 0:M.tags)||[],f=((_=t==null?void 0:t.filter)==null?void 0:_.searchType)||"byTag";if(((L=t==null?void 0:t.filter)==null?void 0:L.type)==="new")return[];switch(t.action){case"list":return["dms","data",`${a}+${l}`,x!=="{}"?"opts":!1,x!=="{}"?x:!1,"byIndex",{from:m,to:p},["id","app","type",...u]].filter(D=>D);case"view":case"edit":{const D=hx(t,s);return D||["dms","data",`${a}+${l}`,"byIndex",{from:m,to:p},["id","updated_at","created_at","app","type",...u]]}case"load":return["dms","data",`${a}+${l}`,"options",x,"byIndex",{from:m,to:p},[...d.length>0?d:["data"]]];case"uda":return["uda",c,"viewsById",i,"options",x,"dataByIndex",{from:m,to:p},[...d.length>0?d:["data"]]];case"search":return["dms","search",`${a}+${l}`,f,h];case"searchTags":return["dms","search",`${a}+${l}`,"tags"];case"searchPageTitles":return["dms","search",`${a}+${l}`,"pageTitles"];default:return[]}};function hx(t,s){var m,p;const{app:n,type:r,defaultSearch:a,attributes:l=[]}=s;let i=((m=t==null?void 0:t.filter)==null?void 0:m.attributes)||[],c=i.length>0?i.map(x=>`data ->> '${x}'`):["data"];const d=(l==null?void 0:l.reduce((x,h)=>(h.matchWildcard&&(x=h.key),x),""))||"";let u=(p=t.params)==null?void 0:p.id;return u?["dms","data","byId",u,["id","updated_at","created_at","app","type",...c]]:d?["dms","data",`${n}+${r}`,"searchOne",[JSON.stringify({wildKey:`data ->> '${d}'`,params:t.params["*"]||"",defaultSearch:a})],["id","updated_at","created_at","app","type",...c]]:null}async function Zj(t,s,n,r,a,l,i,c,d){var f;const u=Array.isArray(s)?s.map(g=>+g):s;let m=[],p=Object.values(ne(t,["dms","data","byId"],{})).filter(g=>(n?(u==null?void 0:u.length)&&u.includes(+g.id):!0)&&g.id&&g.app===a&&g.type===l);const x=c.attributes.reduce((g,y)=>(g[y.key]=y,g),{});for(const g in p){let y=pe(p[g]),v=((f=y==null?void 0:y.data)==null?void 0:f.value)||{};Object.keys(y).filter(j=>j!=="data").forEach(j=>{var N;if(j.includes("data ->> ")){let S=j.split("->>")[1].trim().replace(/[']/g,""),w=y[j];((N=x[S])==null?void 0:N.type)==="json"&&typeof w!="object"&&(w=JSON.parse(w)||{}),v[S]=w}else v[j]=y[j]}),m.push(v)}c!=null&&c.defaultSort&&(m=c.defaultSort(m));let h=0;for(const g in m)(u==="loadAll"||u.includes(+m[g].id)||h===0)&&await fx(m[g],i,c,d),h++;return m}async function fx(t,s,n,r){var i,c,d,u,m;if(!t)return;let a=Object.keys(t).filter(p=>Object.keys(s).includes(p)),l=Object.keys(s).reduce((p,x)=>{var f,g;let h=(g=(f=n==null?void 0:n.registerFormats)==null?void 0:f.filter(y=>y.type===s[x].format.split("+")[1]))==null?void 0:g[0];return h&&(p[x]=h),p},{});for(const p of a){const x=[],h=Object.values(((i=l==null?void 0:l[p])==null?void 0:i.attributes)||{}).filter(g=>g.type==="dms-format").reduce((g,y)=>(g[y.key]=y,g),{});typeof(t==null?void 0:t[p])=="string"&&(t[p]=JSON.parse(t[p]));const f=["data","created_at","updated_at","created_by","updated_by"];if(typeof((c=t==null?void 0:t[p])==null?void 0:c[Symbol.iterator])=="function")for(let g of t[p])g.id&&x.push(["dms","data","byId",g.id,f]);else(d=t[p])!=null&&d.id&&x.push(["dms","data","byId",(u=t[p])==null?void 0:u.id,f]);if(x.length>0){let g=await r.get(...x);if(typeof((m=t==null?void 0:t[p])==null?void 0:m[Symbol.iterator])=="function"){let y=0;for(let v of t[p])if(v.id){let j=ne(g,["json","dms","data","byId",v.id,"data"]);const N=f.filter(S=>S!=="data").reduce((S,w)=>({...S,[w]:ne(g,["json","dms","data","byId",v.id,w])}),{});Object.keys(h).length>0&&await fx(j,h,l[p],r),t[p][y]={...v,...j,...N},y+=1}}else{let y=ne(g,["json","dms","data","byId",t[p].id,"data"]);const v=f.filter(j=>j!=="data").reduce((j,N)=>({...j,[N]:ne(g,["json","dms","data","byId",t[p].id,N])}),{});t[p]={...t[p],...y,...v}}}}}async function Yj(t,s,n){var a,l,i,c,d;let r={};for(const u of Object.keys(t)){r[u]=[];let[m,p]=s[u].format.split("+");const x=Array.isArray(t[u])?t[u]:[t[u]];for(const h of x){let f=pe(h),g=(f==null?void 0:f.id)||!1;for(const y of["id","ref","created_at","updated_at","created_by","updated_by"])delete f[y];if(g){let y=ne(n.getCache(["dms","data","byId",g,"data"]),["dms","data","byId",g,"data","value"],{});for(const v of["id","ref","created_at","updated_at","created_by","updated_by"])delete y[v];Qe(y,f)||(await n.call(["dms","data","edit"],[g,f]),console.log("invalidate",g,h),await n.invalidate(["dms","data","byId",g])),r[u].push({ref:`${m}+${p}`,id:g})}else{const y=await n.call(["dms","data","create"],[m,p,f]);let v=((c=Object.keys(((i=(l=(a=y==null?void 0:y.json)==null?void 0:a.dms)==null?void 0:l.data)==null?void 0:i.byId)||{}).filter(j=>j!=="$__path"))==null?void 0:c[0])||-1;v!==-1&&r[u].push({ref:`${m}+${p}`,id:v})}}r[u]=Array.isArray(t[u])?r[u]:((d=r[u])==null?void 0:d[0])||""}return r}let Qj={};async function St(t,s,n="/"){var $,E,M,_,L,D,A,T,O,B,F,z,P,U,R,W,V,X,q,Q,Y,H,J,G,se,le,ce,je,Ce;s.formatFn&&(s.format=await s.formatFn());const{format:r}=s,{app:a,type:l,view_id:i,env:c,attributes:d={}}=r,u=Gi(s.children,n),m=Object.values(d).filter(oe=>oe.type==="dms-format").reduce((oe,ve)=>(oe[ve.key]=ve,oe),{});let p=["dms","data",`${a}+${l}`,"length"];if(u.find(oe=>["list","load","filteredLength"].includes(oe.action))){const oe=(E=($=u.find(ve=>["list","load","filteredLength"].includes(ve.action)))==null?void 0:$.filter)==null?void 0:E.options;oe&&(p=["dms","data",`${a}+${l}`,"options",oe,"length"])}if(u.find(oe=>["udaLength"].includes(oe.action))){const oe=(_=(M=u.find(ve=>["udaLength"].includes(ve.action)))==null?void 0:M.filter)==null?void 0:_.options;oe&&(p=["uda",c,"viewsById",i,"options",oe,"length"])}const x=ne(await t.get(p),["json",...p],0);if(u.find(oe=>["length","filteredLength","udaLength","udaLength"].includes(oe.action)))return x;let h=((D=(L=u[0])==null?void 0:L.filter)==null?void 0:D.options)||"{}";const f=["dms","data",`${a}+${l}`,h!=="{}"?"opts":!1,h!=="{}"?h:!1,"byIndex"].filter(oe=>oe),g=u.map(oe=>Xj(oe,r,n,x)).filter(oe=>oe==null?void 0:oe.length);g.length>0&&await t.get(...g);let y=t.getCache();if(u.find(oe=>oe.action==="search")){const oe=((T=(A=u.find(ae=>ae.action==="search"))==null?void 0:A.filter)==null?void 0:T.searchType)||"byTag",ve=g[0].filter((ae,de)=>de<=g[0].indexOf(oe));return ne(y,ve,{})}if(u.find(oe=>oe.action==="searchTags")){const oe=g[0].filter((ve,ae)=>ae<=g[0].indexOf("tags"));return ne(y,oe,{})}if(u.find(oe=>oe.action==="searchPageTitles")){const oe=g[0].filter((ve,ae)=>ae<=g[0].indexOf("pageTitles"));return ne(y,oe,{})}if(u.find(oe=>oe.action==="load")){const oe=g[0].filter((ve,ae)=>ae<=g[0].indexOf("byIndex"));return Object.values(ne(y,oe,{}))}if(u.find(oe=>oe.action==="uda")){const oe=g[0].filter((de,te)=>te<=g[0].indexOf("dataByIndex")),{from:ve,to:ae}=g[0][g[0].indexOf("dataByIndex")+1];return Array.from({length:ae+1-ve},(de,te)=>ne(y,[...oe,te+ve],{}))}const v=u.filter(oe=>oe.action!=="load").map(oe=>hx(oe,r)).filter(oe=>oe==null?void 0:oe.length).map(oe=>{let ve=ne(y,oe.slice(0,-1),!1);return(ve==null?void 0:ve.$type)==="ref"?+ve.value[3]:+(ve==null?void 0:ve.id)}).filter(oe=>oe);let j=(B=(O=u[0])==null?void 0:O.params)==null?void 0:B.id,N=typeof((z=(F=u==null?void 0:u[0])==null?void 0:F.filter)==null?void 0:z.fromIndex)=="function"?(U=(P=u==null?void 0:u[0])==null?void 0:P.filter)==null?void 0:U.fromIndex(n):+((X=(R=u==null?void 0:u[0])==null?void 0:R.params)==null?void 0:X[(V=(W=u==null?void 0:u[0])==null?void 0:W.filter)==null?void 0:V.fromIndex]),S=typeof((Q=(q=u==null?void 0:u[0])==null?void 0:q.filter)==null?void 0:Q.toIndex)=="function"?(H=(Y=u==null?void 0:u[0])==null?void 0:Y.filter)==null?void 0:H.toIndex(n):+((le=(J=u==null?void 0:u[0])==null?void 0:J.params)==null?void 0:le[(se=(G=u==null?void 0:u[0])==null?void 0:G.filter)==null?void 0:se.toIndex]);const w=!j&&N!==void 0&&S!==void 0?Object.keys(ne(y,[...f],{})).filter(oe=>+oe>=+N&&+oe<=+S-1).map(oe=>ne(y,[...f,oe,"value",3])).filter(oe=>oe):[];v.push(...w||[]);const k=await Zj(y,v,(je=(ce=u==null?void 0:u[0])==null?void 0:ce.filter)==null?void 0:je.stopFullDataLoad,w==null?void 0:w.length,a,l,m,r,t);return(Ce=u==null?void 0:u[0])!=null&&Ce.lazyLoad&&Qj[`${a}+${l}`],k}async function ys(t,s,n={},r){const{app:a,type:l}=s.format,i=async d=>{var g,y,v,j;const{id:u}=d,m=Object.keys(d).filter(N=>!["id","updated_at","created_at"].includes(N)),p=Object.values(((g=s==null?void 0:s.format)==null?void 0:g.attributes)||{}).filter(N=>N.type==="dms-format").reduce((N,S)=>(N[S.key]=S,N),{}),h=m.filter(N=>Object.keys(p).includes(N)).reduce((N,S)=>(N[S]=d[S],delete d[S],N),{});let f=await Yj(h,p,t);if(d={...d,...f},r==="delete"&&u)return await t.call(["dms","data","delete"],[a,l,u]),await t.invalidate(["dms","data",`${a}+${l}`,"length"]),{response:`Deleted item ${u}`};if(r==="updateType"&&u)return d.type?(await t.call(["dms","type","edit"],[u,d.type]),await t.invalidate(["dms","data","byId",u]),{message:"Update successful."}):{message:"No type found."};if(u&&m.length>0)return await t.call(["dms","data","edit"],[u,d]),await t.invalidate(["dms","data","byId",u]),{message:`Update successful: id ${u}.`};if(m.length>0){const N=await t.call(["dms","data","create"],[a,l,d]);return await t.invalidate(["dms","data",`${a}+${l}`,"length"]),{response:"Item created.",id:Object.keys(((j=(v=(y=N==null?void 0:N.json)==null?void 0:y.dms)==null?void 0:v.data)==null?void 0:j.byId)||{})[0]}}return{message:"Not sure how I got here."}};let c={messages:[]};return Array.isArray(n)?c.messages=await Promise.all(n.map(d=>i(d))):c=await i(n),c}const Kj=(t,{user:s},n,r,a)=>{let i=(c=>c.reduce((d,u)=>{let m=u.authLevel||-1;return Math.max(d,m)},-1))(n);t({user:s,authLevel:i},r,a)},e4=(t,s,n)=>{const{user:r={}}=t;let a=(t==null?void 0:t.authLevel)||-1;const l=(t==null?void 0:t.auth)||!1;a=Math.max(a,l?0:-1);const i=(r==null?void 0:r.authed)||!1,c=(r==null?void 0:r.authLevel)||-1,d=!i&&a>=0,u=c<a;return d?s("/auth/login",{state:{from:t.path}}):u&&n!=="/"&&s("/"),!1},{InvalidConfig:t4,NoRouteMatch:s4}=lr,n4=t=>{const{config:s,path:n="",user:r,navigate:a}=t,{check:l=Kj,checkAuth:i=e4}=s;if(C.useEffect(()=>{if(l&&r){let d=Gi(s.children,n,s.format);l(i,t,d,a,n)}},[n]),!s.children||!Jj(s.format))return e.jsx(t4,{config:s});const c=C.useMemo(()=>xx(s.children,n,s.format,r),[n]);return c?C.useMemo(()=>e.jsx(e.Fragment,{children:c}),[c]):e.jsx(s4,{path:n})};function r4(){const{pathname:t}=Ge();return b.useEffect(()=>{window.scrollTo(0,0)},[t]),null}function Ld(t,s=r=>r,n=Sp){let{API_HOST:r="https://graph.availabs.org",baseUrl:a=""}=t;const l=`${a}${a==="/"?"":"/"}`,i=Gt.falcorGraph(r);async function c({request:m,params:p}){return{data:await St(i,t,`/${p["*"]||""}`)}}async function d({request:m,params:p}){const x=await m.formData();return ys(i,t,JSON.parse(x.get("data")),x.get("requestType"),p["*"])}function u(){const m=Be(),p=Le(),x=s(n4);return C.useMemo(()=>e.jsx(Gt.FalcorProvider,{falcor:i,children:e.jsx(x,{path:`/${m["*"]||""}`,config:t,theme:n,navigate:p})}),[m["*"]])}return{path:`${l}*`,Component:m=>e.jsxs(e.Fragment,{children:[e.jsx(r4,{}),e.jsx(u,{...m})]}),loader:c,action:d}}function a4(t){const s=t instanceof Date?t:new Date(t),n=new Intl.RelativeTimeFormat("en"),r={years:3600*24*365,months:3600*24*30,weeks:3600*24*7,days:3600*24,hours:3600,minutes:60,seconds:1},a=(s.getTime()-Date.now())/1e3;for(let l in r)if(r[l]<Math.abs(a)){const i=a/r[l];return n.format(Math.round(i),l)}}function ql(t,s,n="",r){var c;let a=s.filter(d=>t.id&&d.parent===t.id).sort((d,u)=>d.index-u.index),l=((c=hr(t))==null?void 0:c.menuItems)||[];if(a.length===0&&(l==null?void 0:l.length)===0)return!1;if(a.length===0&&(l==null?void 0:l.length)!==0)return l;const i=a.filter(d=>!(d!=null&&d.hide_in_nav)).map((d,u)=>{var x;let m={id:d.id,path:`${r?`${n}/edit`:n}/${d.url_slug||d.id}`,name:d.title,description:d.description,hideInNav:d.hide_in_nav};d!=null&&d.icon&&(d==null?void 0:d.icon)!=="none"&&(m.icon=d.icon),(x=hr(d))!=null&&x.menuItems;const p=ql(d,s,n,r)||[];return m.subMenus=p.filter(h=>h.name),m});return i!=null&&i.length?i:l}function o4(t,s){const n=window.location.pathname.replace(s,"").replace("/","").replace("edit/","");return n===""?t.find(r=>r.index===0&&r.parent===""):t.find((r,a)=>r.url_slug===n||r.id===n)}function l4(t,s){var l,i;const n=o4(t,s),r=t.filter(c=>c.parent===(n==null?void 0:n.id)).length;return(n?(i=(l=n.url_slug)==null?void 0:l.split("/"))==null?void 0:i.length:1)+(r?1:0)}function Co(t,s="",n=!1,r=1){return t.sort((a,l)=>a.index-l.index).filter(a=>!a.parent).filter(a=>n||a.published!=="draft").map((a,l)=>{let i={id:a.id,path:`${n?`${s}/edit`:s}/${a.url_slug||a.id}`,name:`${a.title} ${a.published==="draft"?"*":""}`,description:a.description,hideInNav:a.hide_in_nav};return a!=null&&a.icon&&(a==null?void 0:a.icon)!=="none"&&(i.icon=a.icon),ql(i,t,s,n)&&(i.subMenus=ql(a,t,s,n).filter(c=>c.name)),i})}const mt=(t,s="update")=>{let n=new FormData;return n.append("data",JSON.stringify(t)),n.append("requestType",s),n},i4=(t,s)=>t.parent?`${s.filter(r=>r.id===t.parent)[0].url_slug}/`:"",vs=(t,s)=>{let n=`${i4(t,s)}${gx(t.title)}`;return t.url_slug&&t.url_slug===n||!s.map(r=>r.url_slug).includes(n)?n:`${n}_${t.index}`},gx=t=>t&&t.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map(s=>s.toLowerCase()).join("_"),c4=(t,s,n)=>{var r;if(!t.draft_section_groups&&(t!=null&&t.id)){let a={id:t.id};a.draft_section_groups=[{name:"default",position:"content",index:0,theme:"content"}],t!=null&&t.header&&(t==null?void 0:t.header)!=="none"&&a.draft_section_groups.push({name:"header",position:"top",index:0,theme:"header",full_width:"show"}),a.draft_sections=pe(t.draft_sections||[]),t!=null&&t.footer&&(t==null?void 0:t.footer)!=="none"&&(a.draft_section_groups.push({name:"footer",position:"bottom",index:99,theme:"clearCentered",full_width:"show"}),(r=t.draft_sections.filter(l=>l.is_footer))!=null&&r[0]||a.draft_sections.push({size:"2",group:"footer",is_footer:!0,order:0,element:{"element-type":"Footer: MNY Footer"},trackingId:tn()})),a.draft_sections.forEach((l,i)=>{l.is_header&&(l.group="header",l.padding="p-0")}),n(mt(a),{method:"post",action:`${s}/edit/${t.url_slug}`})}},d4=(t,s,n)=>{var r,a;if(!t.section_groups&&t.id){let l={id:t.id};l.section_groups=[{name:"default",position:"content",index:0,theme:"content"}],l.sections=pe((t==null?void 0:t.sections)||[]),t!=null&&t.header&&(t==null?void 0:t.header)!=="none"&&l.section_groups.push({name:"header",position:"top",index:0,theme:"header",full_width:"show"}),t!=null&&t.footer&&(t==null?void 0:t.footer)!=="none"&&(l.section_groups.push({name:"footer",position:"bottom",index:99,theme:"clearCentered",full_width:"show"}),(r=t.sections.filter(i=>i.is_footers))!=null&&r[0]||l.sections.push({size:"2",group:"footer",is_footer:"true",order:0,element:{"element-type":"Footer: MNY Footer"},trackingId:tn()})),(a=l.sections)==null||a.forEach((i,c)=>{i.is_header&&(i.group="header")}),n(mt(l),{method:"post",action:`${s}/${t.url_slug}`})}},u4=t=>{var s;return t?typeof t=="object"?t:(s=JSON.parse(t))==null?void 0:s.text:{}};function hr(t,s){const n=t;return{menuItems:(Array.isArray(n==null?void 0:n.sections)?n.sections:[]).reduce((a,{title:l,element:i,level:c,...d})=>{var p,x,h;if(!i)return a;const u=i["element-type"]==="lexical"||!i["element-type"];if((!l||c!=="1")&&!u||c!=="1")return a;const m=u?(h=(x=(p=u4(i["element-data"]))==null?void 0:p.root)==null?void 0:x.children)==null?void 0:h.reduce((f,{type:g,tag:y,children:v,...j})=>{var S,w,k;const N=g==="heading"&&y==="h1"&&((w=(S=v[0])==null?void 0:S.text)!=null&&w.length)?[{name:(k=v[0])==null?void 0:k.text,onClick:$=>{const E=[...window.document.querySelectorAll(y)].find(M=>{var _,L;return((_=M==null?void 0:M.children[0])==null?void 0:_.innerHTML)===((L=v[0])==null?void 0:L.text)});E==null||E.scrollIntoView({behavior:"smooth"})}}]:[];return[...f,...N]},[]):[];return[...a,{name:l,onClick:f=>{const g=window.document.getElementById(`#${l==null?void 0:l.replace(/ /g,"_")}`);g==null||g.scrollIntoView({behavior:"smooth"})}},...m||[]]},[]),themeOptions:{size:"full",color:"transparent"}}}const Ji=(t,s={})=>{if(typeof t=="object")return t;let n=s;try{n=JSON.parse(t)}catch{}return n},bx=t=>typeof(t==null?void 0:t.value)=="object"?bx(t.value):(t==null?void 0:t.value)||t,No=(t,s,n)=>(Array.isArray(t)&&(t=t.map(r=>(r.app=s,r.type=`${n}|${r.type}`,r.registerFormats=No(r.registerFormats,s,n),r.attributes=Xi(r.attributes,s,n),r))),t),Xi=(t,s,n)=>(Array.isArray(t)&&(t=t.map(r=>(r.format=r.format?`${s}+${n}|${r.format.split("+")[1]}`:void 0,No(r,s,n)))),t),Ed=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M16.2141 4.98239L17.6158 3.58063C18.39 2.80646 19.6452 2.80646 20.4194 3.58063C21.1935 4.3548 21.1935 5.60998 20.4194 6.38415L19.0176 7.78591M16.2141 4.98239L10.9802 10.2163C9.93493 11.2616 9.41226 11.7842 9.05637 12.4211C8.70047 13.058 8.3424 14.5619 8 16C9.43809 15.6576 10.942 15.2995 11.5789 14.9436C12.2158 14.5877 12.7384 14.0651 13.7837 13.0198L19.0176 7.78591M16.2141 4.98239L19.0176 7.78591",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21 12C21 16.2426 21 18.364 19.682 19.682C18.364 21 16.2426 21 12 21C7.75736 21 5.63604 21 4.31802 19.682C3 18.364 3 16.2426 3 12C3 7.75736 3 5.63604 4.31802 4.31802C5.63604 3 7.75736 3 12 3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),Md=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M21.544 11.045C21.848 11.4713 22 11.6845 22 12C22 12.3155 21.848 12.5287 21.544 12.955C20.1779 14.8706 16.6892 19 12 19C7.31078 19 3.8221 14.8706 2.45604 12.955C2.15201 12.5287 2 12.3155 2 12C2 11.6845 2.15201 11.4713 2.45604 11.045C3.8221 9.12944 7.31078 5 12 5C16.6892 5 20.1779 9.12944 21.544 11.045Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15C13.6569 15 15 13.6569 15 12Z",stroke:"currentColor",strokeWidth:"1.5"})]}),yx=({size:t=24,className:s})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:t,height:t,fill:"none",className:s,children:[e.jsx("path",{d:"M15.2141 5.98239L16.6158 4.58063C17.39 3.80646 18.6452 3.80646 19.4194 4.58063C20.1935 5.3548 20.1935 6.60998 19.4194 7.38415L18.0176 8.78591M15.2141 5.98239L6.98023 14.2163C5.93493 15.2616 5.41226 15.7842 5.05637 16.4211C4.70047 17.058 4.3424 18.5619 4 20C5.43809 19.6576 6.94199 19.2995 7.57889 18.9436C8.21579 18.5877 8.73844 18.0651 9.78375 17.0198L18.0176 8.78591M15.2141 5.98239L18.0176 8.78591",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11 20H17",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),m4=({className:t,...s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),Ad=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 8V16M16 12H8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),p4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M20.3584 13.3567C19.1689 14.546 16.9308 14.4998 13.4992 14.4998C11.2914 14.4998 9.50138 12.7071 9.50024 10.4993C9.50024 7.07001 9.454 4.83065 10.6435 3.64138C11.8329 2.45212 12.3583 2.50027 17.6274 2.50027C18.1366 2.49809 18.3929 3.11389 18.0329 3.47394L15.3199 6.18714C14.6313 6.87582 14.6294 7.99233 15.3181 8.68092C16.0068 9.36952 17.1234 9.36959 17.8122 8.68109L20.5259 5.96855C20.886 5.60859 21.5019 5.86483 21.4997 6.37395C21.4997 11.6422 21.5479 12.1675 20.3584 13.3567Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M13.5 14.5L7.32842 20.6716C6.22386 21.7761 4.433 21.7761 3.32843 20.6716C2.22386 19.567 2.22386 17.7761 3.32843 16.6716L9.5 10.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M5.50896 18.5H5.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),x4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M4 5.00024L10 5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M13 5L20 5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M16 9L16 15",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M10 2L10 8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M12 16L12 22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M16 12L20 12.0002",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4 12.0002L13 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M12 19L20 19",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4 19.0002L9 19",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),Td=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M4 4.5L20 4.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 14.5L20 14.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 9.5L20 9.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 19.5L20 19.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),h4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M12 22C6.47711 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C16.4776 2 20.2257 4.94289 21.5 9H19",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 8V12L14 14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21.9551 13C21.9848 12.6709 22 12.3373 22 12M15 22C15.3416 21.8876 15.6753 21.7564 16 21.6078M20.7906 17C20.9835 16.6284 21.1555 16.2433 21.305 15.8462M18.1925 20.2292C18.5369 19.9441 18.8631 19.6358 19.1688 19.3065",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),vx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M12.2422 17V12C12.2422 11.5286 12.2422 11.2929 12.0957 11.1464C11.9493 11 11.7136 11 11.2422 11",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.992 8H12.001",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),wx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M19.5 5.5L18.8803 15.5251C18.7219 18.0864 18.6428 19.3671 18.0008 20.2879C17.6833 20.7431 17.2747 21.1273 16.8007 21.416C15.8421 22 14.559 22 11.9927 22C9.42312 22 8.1383 22 7.17905 21.4149C6.7048 21.1257 6.296 20.7408 5.97868 20.2848C5.33688 19.3626 5.25945 18.0801 5.10461 15.5152L4.5 5.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M3 5.5H21M16.0557 5.5L15.3731 4.09173C14.9196 3.15626 14.6928 2.68852 14.3017 2.39681C14.215 2.3321 14.1231 2.27454 14.027 2.2247C13.5939 2 13.0741 2 12.0345 2C10.9688 2 10.436 2 9.99568 2.23412C9.8981 2.28601 9.80498 2.3459 9.71729 2.41317C9.32164 2.7167 9.10063 3.20155 8.65861 4.17126L8.05292 5.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M9.5 16.5L9.5 10.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M14.5 16.5L14.5 10.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),jx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M16 12L8 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4.64856 5.07876C4.78691 4.93211 4.92948 4.7895 5.0761 4.65111M7.94733 2.72939C8.12884 2.6478 8.31313 2.57128 8.5 2.5M2.73172 7.94192C2.64925 8.12518 2.57195 8.31127 2.5 8.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),Cx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,fill:"none",...t,children:[e.jsx("path",{d:"M2.75 12C2.75 17.5228 7.22715 22 12.75 22C18.2728 22 22.75 17.5228 22.75 12C22.75 6.47714 18.2728 1.99998 12.75 1.99998",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M5.39856 5.07874C5.53691 4.9321 5.67948 4.78948 5.8261 4.65109M8.69733 2.72938C8.87884 2.64779 9.06313 2.57126 9.25 2.49998M3.48172 7.94191C3.39925 8.12517 3.32195 8.31126 3.25 8.49999",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M15.75 9L12.75 12M12.75 12L9.75 15M12.75 12L15.75 15M12.75 12L9.75 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),Nx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M8 22V19C8 17.1144 8 16.1716 8.58579 15.5858C9.17157 15 10.1144 15 12 15C13.8856 15 14.8284 15 15.4142 15.5858C16 16.1716 16 17.1144 16 19V22",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),e.jsx("path",{d:"M10 7H14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M3 11.8584C3 7.28199 3 4.99376 4.38674 3.54394C4.43797 3.49038 4.49038 3.43797 4.54394 3.38674C5.99376 2 8.28199 2 12.8584 2C13.943 2 14.4655 2.00376 14.9628 2.18936C15.4417 2.3681 15.8429 2.70239 16.6452 3.37099L18.8411 5.20092C19.9027 6.08561 20.4335 6.52795 20.7168 7.13266C21 7.73737 21 8.42833 21 9.81025V13C21 16.7497 21 18.6246 20.0451 19.9389C19.7367 20.3634 19.3634 20.7367 18.9389 21.0451C17.6246 22 15.7497 22 12 22C8.25027 22 6.3754 22 5.06107 21.0451C4.6366 20.7367 4.26331 20.3634 3.95491 19.9389C3 18.6246 3 16.7497 3 13V11.8584Z",stroke:"currentColor",strokeWidth:"1.5"})]}),f4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4.64856 5.07876C4.7869 4.93211 4.92948 4.7895 5.0761 4.65111M7.94733 2.72939C8.12884 2.6478 8.31313 2.57128 8.5 2.5M2.5 8.5C2.57195 8.31127 2.64925 8.12518 2.73172 7.94192",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 8V16M16 12L8 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),g4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M16.2141 4.98239L17.6158 3.58063C18.39 2.80646 19.6452 2.80646 20.4194 3.58063C21.1935 4.3548 21.1935 5.60998 20.4194 6.38415L19.0176 7.78591M16.2141 4.98239L10.9802 10.2163C9.93493 11.2616 9.41226 11.7842 9.05637 12.4211C8.70047 13.058 8.3424 14.5619 8 16C9.43809 15.6576 10.942 15.2995 11.5789 14.9436C12.2158 14.5877 12.7384 14.0651 13.7837 13.0198L19.0176 7.78591M16.2141 4.98239L19.0176 7.78591",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21 12C21 16.2426 21 18.364 19.682 19.682C18.364 21 16.2426 21 12 21C7.75736 21 5.63604 21 4.31802 19.682C3 18.364 3 16.2426 3 12C3 7.75736 3 5.63604 4.31802 4.31802C5.63604 3 7.75736 3 12 3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),b4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M9.5 13.5C9.99153 14.0057 11.2998 16 12 16M14.5 13.5C14.0085 14.0057 12.7002 16 12 16M12 16V8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5"})]}),y4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M9.5 10.5C9.99153 9.9943 11.2998 8 12 8M14.5 10.5C14.0085 9.9943 12.7002 8 12 8M12 8V16",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5"})]}),v4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M17 10C17 10 13.3176 14 12 14C10.6824 14 7 10 7 10",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),w4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M17 14C17 14 13.3176 10 12 10C10.6824 9.99999 7 14 7 14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),ko=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M2.5 12C2.5 7.52166 2.5 5.28249 3.89124 3.89124C5.28249 2.5 7.52166 2.5 12 2.5C16.4783 2.5 18.7175 2.5 20.1088 3.89124C21.5 5.28249 21.5 7.52166 21.5 12C21.5 16.4783 21.5 18.7175 20.1088 20.1088C18.7175 21.5 16.4783 21.5 12 21.5C7.52166 21.5 5.28249 21.5 3.89124 20.1088C2.5 18.7175 2.5 16.4783 2.5 12Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M12.2422 17V12C12.2422 11.5286 12.2422 11.2929 12.0957 11.1464C11.9493 11 11.7136 11 11.2422 11",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.992 8H12.001",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),kx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M11.992 12H12.001",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.9842 16H11.9932",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M11.9998 8H12.0088",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2.48438 12C2.48438 7.52166 2.48438 5.28249 3.87562 3.89124C5.26686 2.5 7.50603 2.5 11.9844 2.5C16.4627 2.5 18.7019 2.5 20.0931 3.89124C21.4844 5.28249 21.4844 7.52166 21.4844 12C21.4844 16.4783 21.4844 18.7175 20.0931 20.1088C18.7019 21.5 16.4627 21.5 11.9844 21.5C7.50603 21.5 5.26686 21.5 3.87562 20.1088C2.48438 18.7175 2.48438 16.4783 2.48438 12Z",stroke:"currentColor",strokeWidth:"1.5"})]}),j4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M12 2C17.5237 2 22 6.47778 22 12C22 17.5222 17.5237 22 12 22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M9 21.5C7.81163 21.0953 6.69532 20.5107 5.72302 19.7462M5.72302 4.25385C6.69532 3.50059 7.81163 2.90473 9 2.5M2 10.2461C2.21607 9.08813 2.66019 7.96386 3.29638 6.94078M2 13.7539C2.21607 14.9119 2.66019 16.0361 3.29638 17.0592",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M8 16.5C10.0726 14.302 13.9051 14.1986 16 16.5M14.2179 9.75C14.2179 10.9926 13.2215 12 11.9925 12C10.7634 12 9.76708 10.9926 9.76708 9.75C9.76708 8.50736 10.7634 7.5 11.9925 7.5C13.2215 7.5 14.2179 8.50736 14.2179 9.75Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),$x=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"#fff",...t,children:[e.jsx("path",{d:"M6.57757 15.4816C5.1628 16.324 1.45336 18.0441 3.71266 20.1966C4.81631 21.248 6.04549 22 7.59087 22H16.4091C17.9545 22 19.1837 21.248 20.2873 20.1966C22.5466 18.0441 18.8372 16.324 17.4224 15.4816C14.1048 13.5061 9.89519 13.5061 6.57757 15.4816Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M16.5 6.5C16.5 8.98528 14.4853 11 12 11C9.51472 11 7.5 8.98528 7.5 6.5C7.5 4.01472 9.51472 2 12 2C14.4853 2 16.5 4.01472 16.5 6.5Z",stroke:"currentColor",strokeWidth:"1.5"})]}),Zi=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("circle",{cx:"1.5",cy:"1.5",r:"1.5",transform:"matrix(1 0 0 -1 16 8)",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2.77423 11.1439C1.77108 12.2643 1.7495 13.9546 2.67016 15.1437C4.49711 17.5033 6.49674 19.5029 8.85633 21.3298C10.0454 22.2505 11.7357 22.2289 12.8561 21.2258C15.8979 18.5022 18.6835 15.6559 21.3719 12.5279C21.6377 12.2187 21.8039 11.8397 21.8412 11.4336C22.0062 9.63798 22.3452 4.46467 20.9403 3.05974C19.5353 1.65481 14.362 1.99377 12.5664 2.15876C12.1603 2.19608 11.7813 2.36233 11.472 2.62811C8.34412 5.31646 5.49781 8.10211 2.77423 11.1439Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M7 14L10 17",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),Yi=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:e.jsx("path",{d:"M17.9998 15C17.9998 15 13.5809 9.00001 11.9998 9C10.4187 8.99999 5.99985 15 5.99985 15",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),ds=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:e.jsx("path",{d:"M18 9.00005C18 9.00005 13.5811 15 12 15C10.4188 15 6 9 6 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),Sx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,stroke:"currentColor",fill:"none",...t,children:[e.jsx("title",{children:t.title}),e.jsx("path",{d:"M16.9637 8.98209C16.9613 6.03194 16.9167 4.50384 16.0578 3.45753C15.892 3.25546 15.7067 3.07019 15.5047 2.90436C14.4008 1.99854 12.7609 1.99854 9.48087 1.99854C6.20089 1.99854 4.5609 1.99854 3.45708 2.90436C3.255 3.07018 3.06971 3.25546 2.90387 3.45753C1.99799 4.56128 1.99799 6.20116 1.99799 9.48091C1.99799 12.7607 1.99799 14.4005 2.90387 15.5043C3.0697 15.7063 3.255 15.8916 3.45708 16.0574C4.50346 16.9162 6.03167 16.9608 8.98201 16.9632",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M14.0283 9.02455L16.994 8.98193M14.0143 22.0013L16.9799 21.9586M21.9716 14.0221L21.9436 16.9818M9.01033 14.0357L8.98236 16.9953M11.4873 9.02455C10.6545 9.17371 9.31781 9.32713 9.01033 11.0488M19.4946 21.9586C20.3296 21.8223 21.6685 21.6894 22.0025 19.9726M19.4946 9.02455C20.3274 9.17371 21.6641 9.32713 21.9716 11.0488M11.5 21.9573C10.6672 21.8086 9.33039 21.6559 9.02197 19.9344",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),_x=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,stroke:"currentColor",fill:"none",...t,children:[e.jsx("title",{children:t.title}),e.jsx("path",{d:"M12 14.5L12 4.5M12 14.5C11.2998 14.5 9.99153 12.5057 9.5 12M12 14.5C12.7002 14.5 14.0085 12.5057 14.5 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M20 16.5C20 18.982 19.482 19.5 17 19.5H7C4.518 19.5 4 18.982 4 16.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),C4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:18,height:18,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M17.2014 2H6.79876C5.341 2 4.06202 2.9847 4.0036 4.40355C3.93009 6.18879 5.18564 7.37422 6.50435 8.4871C8.32861 10.0266 9.24075 10.7964 9.33642 11.7708C9.35139 11.9233 9.35139 12.0767 9.33642 12.2292C9.24075 13.2036 8.32862 13.9734 6.50435 15.5129C5.14932 16.6564 3.9263 17.7195 4.0036 19.5964C4.06202 21.0153 5.341 22 6.79876 22L17.2014 22C18.6591 22 19.9381 21.0153 19.9965 19.5964C20.043 18.4668 19.6244 17.342 18.7352 16.56C18.3298 16.2034 17.9089 15.8615 17.4958 15.5129C15.6715 13.9734 14.7594 13.2036 14.6637 12.2292C14.6487 12.0767 14.6487 11.9233 14.6637 11.7708C14.7594 10.7964 15.6715 10.0266 17.4958 8.4871C18.8366 7.35558 20.0729 6.25809 19.9965 4.40355C19.9381 2.9847 18.6591 2 17.2014 2Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M9 21.6381C9 21.1962 9 20.9752 9.0876 20.7821C9.10151 20.7514 9.11699 20.7214 9.13399 20.6923C9.24101 20.509 9.42211 20.3796 9.78432 20.1208C10.7905 19.4021 11.2935 19.0427 11.8652 19.0045C11.955 18.9985 12.045 18.9985 12.1348 19.0045C12.7065 19.0427 13.2095 19.4021 14.2157 20.1208C14.5779 20.3796 14.759 20.509 14.866 20.6923C14.883 20.7214 14.8985 20.7514 14.9124 20.7821C15 20.9752 15 21.1962 15 21.6381V22H9V21.6381Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),N4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:20,height:20,color:"#000000",fill:"none",...t,children:[e.jsx("title",{children:t.title}),e.jsx("path",{d:"M8.85746 12.5061C6.36901 10.6456 4.59564 8.59915 3.62734 7.44867C3.3276 7.09253 3.22938 6.8319 3.17033 6.3728C2.96811 4.8008 2.86701 4.0148 3.32795 3.5074C3.7889 3 4.60404 3 6.23433 3H17.7657C19.396 3 20.2111 3 20.672 3.5074C21.133 4.0148 21.0319 4.8008 20.8297 6.37281C20.7706 6.83191 20.6724 7.09254 20.3726 7.44867C19.403 8.60062 17.6261 10.6507 15.1326 12.5135C14.907 12.6821 14.7583 12.9567 14.7307 13.2614C14.4837 15.992 14.2559 17.4876 14.1141 18.2442C13.8853 19.4657 12.1532 20.2006 11.226 20.8563C10.6741 21.2466 10.0043 20.782 9.93278 20.1778C9.79643 19.0261 9.53961 16.6864 9.25927 13.2614C9.23409 12.9539 9.08486 12.6761 8.85746 12.5061Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),k4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:18,height:18,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M19 11C19 10.1825 19 9.4306 18.8478 9.06306C18.6955 8.69552 18.4065 8.40649 17.8284 7.82843L13.0919 3.09188C12.593 2.593 12.3436 2.34355 12.0345 2.19575C11.9702 2.165 11.9044 2.13772 11.8372 2.11401C11.5141 2 11.1614 2 10.4558 2C7.21082 2 5.58831 2 4.48933 2.88607C4.26731 3.06508 4.06508 3.26731 3.88607 3.48933C3 4.58831 3 6.21082 3 9.45584V14C3 17.7712 3 19.6569 4.17157 20.8284C5.34315 22 7.22876 22 11 22H19M12 2.5V3C12 5.82843 12 7.24264 12.8787 8.12132C13.7574 9 15.1716 9 18 9H18.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21 14H19C18.4477 14 18 14.4477 18 15V16.5M18 16.5V19M18 16.5H20.5M7 19V17M7 17V14H8.5C9.32843 14 10 14.6716 10 15.5C10 16.3284 9.32843 17 8.5 17H7ZM12.5 14H13.7857C14.7325 14 15.5 14.7462 15.5 15.6667V17.3333C15.5 18.2538 14.7325 19 13.7857 19H12.5V14Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),$4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:18,height:18,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M7.35396 18C5.23084 18 4.16928 18 3.41349 17.5468C2.91953 17.2506 2.52158 16.8271 2.26475 16.3242C1.87179 15.5547 1.97742 14.5373 2.18868 12.5025C2.36503 10.8039 2.45321 9.95455 2.88684 9.33081C3.17153 8.92129 3.55659 8.58564 4.00797 8.35353C4.69548 8 5.58164 8 7.35396 8H16.646C18.4184 8 19.3045 8 19.992 8.35353C20.4434 8.58564 20.8285 8.92129 21.1132 9.33081C21.5468 9.95455 21.635 10.8039 21.8113 12.5025C22.0226 14.5373 22.1282 15.5547 21.7352 16.3242C21.4784 16.8271 21.0805 17.2506 20.5865 17.5468C19.8307 18 18.7692 18 16.646 18",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M17 8V6C17 4.11438 17 3.17157 16.4142 2.58579C15.8284 2 14.8856 2 13 2H11C9.11438 2 8.17157 2 7.58579 2.58579C7 3.17157 7 4.11438 7 6V8",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),e.jsx("path",{d:"M13.9887 16L10.0113 16C9.32602 16 8.98337 16 8.69183 16.1089C8.30311 16.254 7.97026 16.536 7.7462 16.9099C7.57815 17.1904 7.49505 17.5511 7.32884 18.2724C7.06913 19.3995 6.93928 19.963 7.02759 20.4149C7.14535 21.0174 7.51237 21.5274 8.02252 21.7974C8.40513 22 8.94052 22 10.0113 22L13.9887 22C15.0595 22 15.5949 22 15.9775 21.7974C16.4876 21.5274 16.8547 21.0174 16.9724 20.4149C17.0607 19.963 16.9309 19.3995 16.6712 18.2724C16.505 17.5511 16.4218 17.1904 16.2538 16.9099C16.0297 16.536 15.6969 16.254 15.3082 16.1089C15.0166 16 14.674 16 13.9887 16Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),e.jsx("path",{d:"M18 12H18.009",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Ix=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M12 4V20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 12H20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),Pr=({className:t="size-6",...s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),S4=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})}),_4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M11.1004 3.00208C7.4515 3.00864 5.54073 3.09822 4.31962 4.31931C3.00183 5.63706 3.00183 7.75796 3.00183 11.9997C3.00183 16.2415 3.00183 18.3624 4.31962 19.6801C5.6374 20.9979 7.75836 20.9979 12.0003 20.9979C16.2421 20.9979 18.3631 20.9979 19.6809 19.6801C20.902 18.4591 20.9916 16.5484 20.9982 12.8996",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M20.4803 3.51751L14.931 9.0515M20.4803 3.51751C19.9863 3.023 16.6587 3.0691 15.9552 3.0791M20.4803 3.51751C20.9742 4.01202 20.9282 7.34329 20.9182 8.04754",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),Lx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:22,height:22,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M19.7502 11V10C19.7502 6.22876 19.7502 4.34315 18.5786 3.17157C17.407 2 15.5214 2 11.7502 2H10.7503C6.97907 2 5.09346 2 3.92189 3.17156C2.75032 4.34312 2.7503 6.22872 2.75027 9.99993L2.75024 14C2.7502 17.7712 2.75019 19.6568 3.92172 20.8284C5.09329 21.9999 6.97897 22 10.7502 22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M7.25024 7H15.2502M7.25024 12H15.2502",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M13.2502 20.8268V22H14.4236C14.833 22 15.0377 22 15.2217 21.9238C15.4058 21.8475 15.5505 21.7028 15.84 21.4134L20.6636 16.5894C20.9366 16.3164 21.0731 16.1799 21.1461 16.0327C21.285 15.7525 21.285 15.4236 21.1461 15.1434C21.0731 14.9961 20.9366 14.8596 20.6636 14.5866C20.3905 14.3136 20.254 14.1771 20.1067 14.1041C19.8265 13.9653 19.4975 13.9653 19.2173 14.1041C19.0701 14.1771 18.9335 14.3136 18.6605 14.5866L18.6605 14.5866L13.8369 19.4106C13.5474 19.7 13.4027 19.8447 13.3265 20.0287C13.2502 20.2128 13.2502 20.4174 13.2502 20.8268Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"})]}),Ex=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:22,height:22,stroke:"currentColor",fill:"none",...t,children:e.jsx("path",{d:"M15 6C15 6 9.00001 10.4189 9 12C8.99999 13.5812 15 18 15 18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),Pn=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:22,height:22,stroke:"currentColor",fill:"none",...t,children:e.jsx("path",{d:"M9.00005 6C9.00005 6 15 10.4189 15 12C15 13.5812 9 18 9 18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),I4=({className:t="size-6",...s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),L4=({className:t="size-6",...s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"})}),Mx=({className:t="size-6",...s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),E4=({className:t="size-6",...s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Ax=({className:t="size-6",...s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"})}),Tx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M5 4V20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M9 4V20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M13 4V20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M17 4V20",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4 18L18 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),Ox=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M8 5L20 5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4 5H4.00898",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 12H4.00898",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 19H4.00898",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M8 12L20 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M8 19L20 19",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),Dx=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:14,height:14,color:"#000000",fill:"none",...t,children:e.jsx("path",{d:"M19 17.14c0 1.5 0 2.25-.35 2.8-.18.29-.43.53-.72.71-.56.35-1.32.35-2.85.35H9.2c-2.59 0-3.88 0-4.15-.74-.27-.73.71-1.56 2.68-3.22l3.94-3.33c.94-.8 1.41-1.19 1.41-1.7 0-.52-.47-.91-1.41-1.71L7.72 6.96C5.75 5.3 4.77 4.47 5.05 3.73c.28-.73 1.57-.73 4.15-.73h5.89c1.53 0 2.3 0 2.85.34.29.18.54.43.72.72.35.55.35 1.31.35 2.81",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),Bx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M4 6H16",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4 12H16",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4 18H16",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M19 4V8C19 9 20 10 21 10",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M19 20V16C19 15 20 14 21 14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),Fx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"#fff",...t,children:[e.jsx("path",{d:"M4 14H8.42109C9.35119 14 9.81624 14 9.94012 14.2801C10.064 14.5603 9.74755 14.8963 9.11466 15.5684L5.47691 19.4316C4.84402 20.1037 4.52757 20.4397 4.65145 20.7199C4.77533 21 5.24038 21 6.17048 21H10",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 9L6.10557 4.30527C6.49585 3.43509 6.69098 3 7 3C7.30902 3 7.50415 3.43509 7.89443 4.30527L10 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M17.5 20V4M17.5 20C16.7998 20 15.4915 18.0057 15 17.5M17.5 20C18.2002 20 19.5085 18.0057 20 17.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),zx=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"#fff",...t,children:[e.jsx("path",{d:"M4 3H8.42109C9.35119 3 9.81624 3 9.94012 3.28013C10.064 3.56026 9.74755 3.89632 9.11466 4.56842L5.47691 8.43158C4.84402 9.10368 4.52757 9.43974 4.65145 9.71987C4.77533 10 5.24038 10 6.17048 10H10",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M4 21L6.10557 16.3053C6.49585 15.4351 6.69098 15 7 15C7.30902 15 7.50415 15.4351 7.89443 16.3053L10 21",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M17.5 20V4M17.5 20C16.7998 20 15.4915 18.0057 15 17.5M17.5 20C18.2002 20 19.5085 18.0057 20 17.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),$o=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M17.5 17.5L22 22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M20 11C20 6.02944 15.9706 2 11 2C6.02944 2 2 6.02944 2 11C2 15.9706 6.02944 20 11 20C15.9706 20 20 15.9706 20 11Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"})]}),M4=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"})}),A4=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})}),T4=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})}),O4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t,children:[e.jsx("path",{d:"M12 22C6.47711 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C16.4776 2 20.2257 4.94289 21.5 9H19",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 8V12L14 14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21.9551 13C21.9848 12.6709 22 12.3373 22 12M15 22C15.3416 21.8876 15.6753 21.7564 16 21.6078M20.7906 17C20.9835 16.6284 21.1555 16.2433 21.305 15.8462M18.1925 20.2292C18.5369 19.9441 18.8631 19.6358 19.1688 19.3065",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),D4=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"})}),B4=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,stroke:"currentColor",fill:"none",...t}),F4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:[e.jsx("path",{d:"M3 12H21",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M14.5 5.5C14.5 6.88071 13.3807 8 12 8C10.6193 8 9.5 6.88071 9.5 5.5C9.5 4.11929 10.6193 3 12 3C13.3807 3 14.5 4.11929 14.5 5.5Z",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M14.5 18.5C14.5 19.8807 13.3807 21 12 21C10.6193 21 9.5 19.8807 9.5 18.5C9.5 17.1193 10.6193 16 12 16C13.3807 16 14.5 17.1193 14.5 18.5Z",stroke:"currentColor",strokeWidth:"1.5"})]}),z4=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:e.jsx("path",{d:"M18 6L12 12M12 12L6 18M12 12L18 18M12 12L6 6",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),P4=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,color:"#000000",fill:"none",...t,children:e.jsx("path",{d:"M20 12L4 12",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),R4=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"42",viewBox:"0 0 30 42",fill:"none",...t,children:e.jsx("path",{d:"M29.55 10.95L19.05 0.450044C18.918 0.303466 18.7558 0.18731 18.5745 0.109612C18.3932 0.0319142 18.1972 -0.00547053 18 4.40737e-05H3C2.20507 0.00237881 1.44336 0.319199 0.881259 0.881303C0.319155 1.44341 0.00233473 2.20511 0 3.00004V39C0.00233473 39.795 0.319155 40.5567 0.881259 41.1188C1.44336 41.6809 2.20507 41.9977 3 42H27C27.7949 41.9977 28.5566 41.6809 29.1187 41.1188C29.6808 40.5567 29.9977 39.795 30 39V12C30.0055 11.8029 29.9681 11.6069 29.8904 11.4256C29.8127 11.2443 29.6966 11.082 29.55 10.95ZM18 3.60004L26.4 12H18V3.60004ZM27 39H3V3.00004H15V12C15.0023 12.795 15.3192 13.5567 15.8813 14.1188C16.4434 14.6809 17.2051 14.9977 18 15H27V39Z",fill:"#2D3E4C"})}),H4=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",...t,children:[e.jsxs("g",{clipPath:"url(#clip0_2741_71019)",children:[e.jsx("path",{d:"M38.55 13.95L28.05 3.45C27.75 3.15 27.45 3 27 3H12C10.35 3 9 4.35 9 6V42C9 43.65 10.35 45 12 45H36C37.65 45 39 43.65 39 42V15C39 14.55 38.85 14.25 38.55 13.95ZM27 6.6L35.4 15H27V6.6ZM36 42H12V6H24V15C24 16.65 25.35 18 27 18H36V42Z",fill:"#2D3E4C"}),e.jsx("path",{d:"M15 33H33V36H15V33Z",fill:"#2D3E4C"}),e.jsx("path",{d:"M15 24H33V27H15V24Z",fill:"#2D3E4C"})]}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_2741_71019",children:e.jsx("rect",{width:"48",height:"48",fill:"white"})})})]}),Gl={Default:M4,Settings:A4,Pages:T4,History:O4,InsertSection:Ad,Menu:Td,Blank:B4,ViewPage:Md,EditPage:Ed,Sections:D4,CaretDown:I4,CaretUp:L4,PencilEditSquare:Ed,ViewIcon:Md,PencilIcon:yx,CirclePlus:m4,SquarePlus:Ad,WrenchIcon:p4,SlidersIcon:x4,MenuIcon:Td,ClockIcon:h4,InfoCircle:vx,TrashCan:wx,CircleCheck:Mx,RemoveCircle:jx,CancelCircle:Cx,FloppyDisk:Nx,CirclePlusDot:f4,PencilSquare:g4,ArrowDownSquare:b4,ArrowUpSquare:y4,ChevronDownSquare:v4,ChevronUpSquare:w4,InfoSquare:ko,MoreSquare:kx,UserCircle:j4,User:$x,Tags:Zi,ArrowUp:Yi,ArrowDown:ds,ArrowRight:Pn,ArrowLeft:Ex,Copy:Sx,PDF:k4,Printer:$4,XMark:Pr,AdjustmentsHorizontal:S4,LinkSquare:_4,DraftPage:Lx,EllipsisVertical:Ax,Filter:N4,LoadingHourGlass:C4,TallyMark:Tx,LeftToRightListBullet:Ox,Sum:Dx,Group:Bx,SortAsc:Fx,SortDesc:zx,Search:$o,Download:_x},Px=({navItem:t,parent:s,depth:n=0,maxDepth:r=1,children:a,icon:l,to:i,onClick:c,className:d=null,type:u="side",active:m=!1,subMenus:p=[],themeOptions:x,subMenuActivate:h="onHover",subMenuOpen:f=!1})=>{var A,T,O,B,F,z;const{theme:g}=C.useContext(me)||{},y=(g==null?void 0:g[u==="side"?"sidenav":"topnav"])||{},v=Le(),j=C.useMemo(()=>Array.isArray(i)?i:[i],[i]),N=C.useMemo(()=>{const P=p.reduce((U,R)=>(Array.isArray(R.path)?U.push(...R.path):R.path&&U.push(R.path),U),[]);return[...j,...P]},[j,p]),S=!!_r({path:`${N[0]}/*`||"",end:!0}),w=u==="side"?y==null?void 0:y.navitemSide:y==null?void 0:y.navitemTop,k=u==="side"?y==null?void 0:y.navitemSideActive:y==null?void 0:y.navitemTopActive,$=S||m,E=$?k:w,[M,_]=C.useState(f),[L,D]=C.useState(!1);return b.useEffect(()=>{_(S&&h==="onActive")},[S]),e.jsx("div",{className:s!=null&&s.description?((A=y==null?void 0:y.menuItemWrapper1Parent)==null?void 0:A[n])||(y==null?void 0:y.menuItemWrapper1Parent):((T=y==null?void 0:y.menuItemWrapper1)==null?void 0:T[n])||(y==null?void 0:y.menuItemWrapper1),onMouseOutCapture:()=>{D(!1),_(!1)},onMouseMove:()=>{D(!0),_(!0)},children:e.jsx("div",{className:`${d||E}`,onClick:P=>{if(P.stopPropagation(),c)return c(j[0]);j[0]&&v(j[0])},children:e.jsxs("div",{className:((O=y.menuItemWrapper2)==null?void 0:O[n])||(y==null?void 0:y.menuItemWrapper2),children:[e.jsxs("div",{className:"flex-1 flex items-center gap-[2px]",children:[l?e.jsx(qe,{icon:l,className:u==="side"?$?y==null?void 0:y.menuIconSideActive:y==null?void 0:y.menuIconSide:$?y==null?void 0:y.menuIconTopActive:y==null?void 0:y.menuIconTop}):null,e.jsx("div",{children:t!=null&&t.description?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"",children:t==null?void 0:t.name}),e.jsx("div",{className:((B=y==null?void 0:y.navItemDescription)==null?void 0:B[n])||(y==null?void 0:y.navItemDescription),children:t==null?void 0:t.description})]}):e.jsx("div",{className:((F=y==null?void 0:y.navItemContent)==null?void 0:F[n])||((z=y==null?void 0:y.navItemContent)==null?void 0:z[0]),children:t==null?void 0:t.name})}),e.jsx("div",{onClick:()=>{h==="onClick"&&_(!M)},children:n<r&&p.length?e.jsx(qe,{icon:(y==null?void 0:y.indicatorIcon)||"ArrowDown",className:y==null?void 0:y.indicatorIconWrapper}):null})]}),n<r&&p.length?e.jsx(W4,{parent:t,depth:n,showSubMenu:M,subMenuActivate:h,active:S,hovering:L,subMenus:p,type:u,className:d,maxDepth:r}):""]})})})},W4=({parent:t,depth:s,showSubMenu:n,subMenus:r,type:a,hovering:l,subMenuActivate:i,active:c,maxDepth:d})=>{var p,x;const{theme:u}=C.useContext(me),m=(u==null?void 0:u[a==="side"?"sidenav":"topnav"])||{};return n?e.jsx("div",{className:((p=m==null?void 0:m.subMenuWrapper1)==null?void 0:p[s])||(m==null?void 0:m.subMenuWrapper1),children:e.jsxs("div",{className:`${(x=m==null?void 0:m.subMenuWrapper2)==null?void 0:x[s]} || ${m==null?void 0:m.subMenuWrapper2}`,children:[(t==null?void 0:t.description)&&e.jsxs("div",{className:m==null?void 0:m.subMenuParentContent,children:[e.jsx("div",{className:m==null?void 0:m.subMenuParentName,children:t==null?void 0:t.name}),e.jsx("div",{className:m==null?void 0:m.subMenuParentDesc,children:t==null?void 0:t.description}),(t==null?void 0:t.path)&&e.jsx("div",{className:"pt-8 pb-2",children:e.jsx(ue,{className:m==null?void 0:m.subMenuParentLink,to:t.path,children:t.linkText||"Explore"})})]}),e.jsx("div",{className:t!=null&&t.description?m.subMenuItemsWrapperParent:m.subMenuItemsWrapper,children:r.map((h,f)=>e.jsx(Px,{parent:t,depth:s+1,to:h.path,icon:h.icon,type:a,className:h.className,onClick:h.onClick,subMenus:h.subMenus,navItem:h,maxDepth:d},f))})]})}):e.jsx(e.Fragment,{})},Qi=({depth:t=0,navItem:s,children:n,icon:r,to:a,onClick:l,className:i=null,type:c="side",active:d=!1,subMenus:u=[],subMenuActivate:m="onClick",subMenuOpen:p=!1})=>{var _,L,D,A;const{theme:x}=C.useContext(me)||{},h=(x==null?void 0:x.sidenav)||{},f=Le(),g=C.useMemo(()=>Array.isArray(a)?a:[a],[a]),y=C.useMemo(()=>{const T=u.reduce((O,B)=>(Array.isArray(B.path)?O.push(...B.path):B.path&&O.push(B.path),O),[]);return[...g,...T]},[g,u]),v=!!_r({path:`${y[0]}/*`||"",end:!0}),j=c==="side"?h==null?void 0:h.navitemSide:h==null?void 0:h.navitemTop,N=c==="side"?h==null?void 0:h.navitemSideActive:h==null?void 0:h.navitemTopActive,S=v||d,w=S?N:j,[k,$]=C.useState(p||v),[E,M]=C.useState(!1);return e.jsx("div",{className:c==="side"?h==null?void 0:h.subMenuParentWrapper:null,onMouseOutCapture:()=>m==="onHover"&&M(!0)&&$(!1),onMouseMove:()=>m==="onHover"&&M(!0)&&$(!0),children:e.jsx("div",{className:`${i||w}`,children:e.jsxs("div",{className:((_=h==null?void 0:h.menuItemWrapper)==null?void 0:_[t])||((L=h==null?void 0:h.menuItemWrapper)==null?void 0:L[0])||(h==null?void 0:h.menuItemWrapper),children:[e.jsxs("div",{className:"flex-1 flex items-center",children:[r?e.jsx(qe,{icon:r,className:c==="side"?S?h==null?void 0:h.menuIconSideActive:h==null?void 0:h.menuIconSide:S?h==null?void 0:h.menuIconTopActive:h==null?void 0:h.menuIconTop}):null,e.jsx("div",{className:`${h==null?void 0:h.navItemContent} ${i?"":((D=h==null?void 0:h.navItemContents)==null?void 0:D[t])||(h==null?void 0:h.navItemContents)}`,onClick:T=>{if(T.stopPropagation(),l)return l(g[0]);g[0]&&f(g[0])},children:s==null?void 0:s.name}),e.jsx("div",{className:"pr-2",onClick:()=>{m==="onClick"&&$(!k)},children:u.length?e.jsx(qe,{className:h==null?void 0:h.indicatorIconWrapper,icon:k?(h==null?void 0:h.indicatorIconOpen)||"ArrowRight":(h==null?void 0:h.indicatorIcon)||"ArrowDown"}):null})]}),e.jsx("div",{className:(A=h==null?void 0:h.subMenuOuterWrappers)==null?void 0:A[t],children:u.length?e.jsx(V4,{depth:t,showSubMenu:k,subMenuActivate:m,active:v,hovering:E,subMenus:u,type:c,className:i}):""})]})})})},V4=({depth:t,showSubMenu:s,subMenus:n,type:r,hovering:a,subMenuActivate:l,active:i})=>{var m;const{theme:c}=C.useContext(me),d=(c==null?void 0:c.sidenav)||{},u=!i&&l!=="onHover"&&a;return(!s||!n.length)&&!u?null:e.jsx("div",{className:r==="side"?((m=d==null?void 0:d.subMenuWrappers)==null?void 0:m[t])||(d==null?void 0:d.subMenuWrapper):u&&t===0?d==null?void 0:d.subMenuWrapperInactiveFlyout:u&&t>0?d==null?void 0:d.subMenuWrapperInactiveFlyoutBelow:d==null?void 0:d.subMenuWrapperTop,children:e.jsx("div",{className:`
							${u&&(d==null?void 0:d.subMenuWrapperInactiveFlyoutDirection)}
							${!u&&(d==null?void 0:d.subMenuWrapperChild)}
				`,children:n.map((p,x)=>e.jsx(Qi,{depth:t+1,to:p.path,icon:p.icon,navItem:p,type:r,className:p.className,onClick:p.onClick,subMenus:p.subMenus},x))})})},U4={fixed:"mt-8",topnavWrapper:"px-[24px] bg-slate-100  w-full h-full flex items-center md:rounded-lg shadow pointer-events-auto",topnavContent:"flex items-center w-full h-full  ",topnavMenu:"hidden py-2  md:flex items-center flex-1  h-full overflow-x-auto overflow-y-hidden scrollbar-sm",mobileButton:"md:hidden bg-slate-100 inline-flex items-center justify-center pt-[12px] px-2 hover:text-blue-400  text-gray-400 hover:bg-gray-100 ",indicatorIcon:"ArrowDown",indicatorIconOpen:"ArrowDown",indicatorIconWrapper:"size-3",menuItemWrapper1:[" ",""],menuItemWrapper1Parent:[" ","bg-[#F3F8F9] p-4 rounded-lg"],menuItemWrapper2:["flex text-[#37576B] "," "],menuIconTop:"text-blue-400 mr-3 text-lg group-hover:text-blue-500",menuIconTopActive:"text-blue-500 mr-3 text-lg group-hover:text-blue-500",menuOpenIcon:"Menu",menuCloseIcon:"XMark",navitemTop:`
          w-fit group  whitespace-nowrap
          flex items-center 
          text-[16px] font-['Proxima_Nova'] font-[500] 
          px-2 uppercase
          focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
          transition cursor-pointer
      `,navitemTopActive:` w-fit group  whitespace-nowrap
          flex  items-center 
          text-[16px] font-['Proxima_Nova'] font-[500] 
          px-2 text-blue uppercase
          focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
          transition cursor-pointer 
        `,navItemDescription:["hidden","text-[16px] font-['Proxima_Nova'] font-[400] text-[#37576B] text-wrap"],topmenuRightNavContainer:"hidden md:flex h-full items-center",topnavMobileContainer:"bg-slate-50 pointer-events-auto",subMenuWrapper1:["absolute left-0 right-0 normal-case mt-4 z-10 px-4 pt-[42px] px-[62px] cursor-default"],subMenuWrapper2:"bg-white flex items-stretch rounded-lg p-4 shadow",subMenuParentContent:"basis-1/3  text-wrap pr-[64px]",subMenuParentName:"text-[36px] font-['Oswald'] font-500 text-[#2D3E4C] uppercase pb-2",subMenuParentDesc:"text-[16px] font-['Proxima_Nova'] font-[400] text-[#37576B]",subMenuParentLink:"w-fit h-fit cursor-pointer uppercase border boder-[#E0EBF0] bg-white hover:bg-[#E0EBF0] text-[#37576B] font-[700] leading-[14.62px] rounded-full text-[12px] text-center py-[16px] px-[24px]",subMenuItemsWrapperParent:"grid grid-cols-2 gap-1 flex-1",subMenuItemsWrapper:"grid grid-cols-4 flex-1"},Rx=({open:t,toggle:s,menuItems:n=[],rightMenu:r=null,themeOptions:a={}})=>{const{theme:l}=C.useContext(me)||{},i=(l==null?void 0:l.topnav)||{};return e.jsxs("div",{className:`${t?"md:hidden":"hidden"} ${i==null?void 0:i.topnavMobileContainer}`,id:"mobile-menu",children:[e.jsx("div",{className:"",children:n.map((c,d)=>e.jsx(Qi,{type:"top",to:c.path,icon:c.icon,themeOptions:a,subMenus:ne(c,"subMenus",[]),navItem:c},d))}),e.jsx("div",{className:"",children:r})]})},q4=({open:t,toggle:s,menuItems:n=[],rightMenu:r=null,leftMenu:a=null,subMenuActivate:l,themeOptions:i={}})=>{const{theme:c}=C.useContext(me)||{},d=(c==null?void 0:c.topnav)||{};return e.jsx("div",{className:`${d==null?void 0:d.topnavWrapper}`,children:e.jsxs("div",{className:`${d==null?void 0:d.topnavContent} justify-between`,children:[e.jsx("div",{children:a}),e.jsx("div",{className:`${d==null?void 0:d.topnavMenu}`,children:n.map((u,m)=>e.jsx(Px,{type:"top",to:u.path,icon:u.icon,subMenuActivate:l,themeOptions:i,subMenus:ne(u,"subMenus",[]),navItem:u},m))}),e.jsxs("div",{className:"flex items-center justify-center h-full",children:[e.jsx("div",{className:`${d==null?void 0:d.topmenuRightNavContainer}`,children:r}),e.jsxs("button",{type:"button",className:`${d==null?void 0:d.mobileButton}`,onClick:()=>s(!t),children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("div",{className:"flex justify-center items-center text-2xl",children:e.jsx(qe,{icon:t?d==null?void 0:d.menuCloseIcon:d==null?void 0:d.menuOpenIcon})})]})]})]})})},G4=({...t})=>{const[s,n]=b.useState(!1);return e.jsxs("nav",{children:[e.jsx(q4,{open:s,toggle:n,...t}),e.jsx(Rx,{open:s,...t})]})},J4={fixed:"",logoWrapper:"w-44 bg-neutral-100 text-slate-800",topNavWrapper:"flex flex-row md:flex-col",sidenavWrapper:"hidden md:block border-r w-44 h-full z-20",menuItemWrapper:"flex flex-col",menuIconSide:"group w-6 mr-2 text-blue-500  group-hover:text-blue-800",menuIconSideActive:"group w-6 mr-2 text-blue-500  group-hover:text-blue-800",itemsWrapper:"border-slate-200 pt-5  ",navItemContent:"transition-transform duration-300 ease-in-out flex-1",navItemContents:["text-[14px] font-light hover:bg-blue-50 text-slate-700 px-4 py-2"],navitemSide:`
   	group  flex flex-col
   	group flex 
   	focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
   	transition-all cursor-pointer border-l-2 border-white`,navitemSideActive:`
   	group  flex flex-col   
    	focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
   	transition-all cursor-pointer border-l-2 border-blue-500`,indicatorIcon:"ArrowRight",indicatorIconOpen:"ArrowDown",subMenuWrappers:["w-full bg-[#F3F8F9] rounded-[12px]","w-full bg-[#E0EBF0]"],subMenuOuterWrappers:["pl-4"],subMenuWrapper:"pl-2 w-full",subMenuParentWrapper:"flex flex-col w-full",bottomMenuWrapper:""},Hx=({i:t,item:s,subMenuActivate:n})=>e.jsx(Qi,{to:s.path,navItem:s,icon:s.icon,className:s.className,onClick:s.onClick,subMenuActivate:n,subMenus:ne(s,"subMenus",[])},t),X4=({open:t,toggle:s,logo:n=null,topMenu:r,menuItems:a=[],bottomMenu:l,themeOptions:i={},subMenuActivate:c,subMenuStyle:d,...u})=>{const{theme:m}=C.useContext(me)||{},p=(m==null?void 0:m.sidenav)||{};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden",onClick:()=>s(!t),children:e.jsx("span",{className:t?p==null?void 0:p.menuIconOpen:p==null?void 0:p.menuIconClosed})}),e.jsxs("div",{style:{display:t?"block":"none"},className:"md:hidden",children:[e.jsx("div",{className:"fixed inset-0 z-20 transition-opacity ease-linear duration-300",children:e.jsx("div",{className:"absolute inset-0 opacity-75"})}),e.jsx("div",{className:`fixed inset-0 flex z-40 ${p==null?void 0:p.contentBgAccent}`,children:e.jsxs("div",{className:`flex-1 flex flex-col max-w-xs w-full transform ease-in-out duration-300 ${p==null?void 0:p.contentBg}`,children:[e.jsx("div",{className:"absolute top-0 right-0 -mr-14 p-1",children:e.jsx("button",{onClick:()=>s(!t),className:"flex items-center justify-center h-12 w-12 rounded-full focus:outline-none focus:bg-gray-600 os-icon os-icon-x"})}),e.jsxs("div",{className:"flex-1 h-0 pt-2 pb-4 overflow-y-auto overflow-x-hidden flex",children:[e.jsx("div",{children:r}),e.jsx("nav",{className:"flex-1",children:a.map((x,h)=>e.jsx("div",{className:x.sectionClass,children:Hx({i:h,subMenuActivate:c})},h))}),e.jsx("div",{className:p.bottomMenuWrapper,children:l})]})]})})]})]})},Z4=({menuItems:t=[],logo:s=null,topMenu:n,bottomMenu:r,toggle:a,open:l,mobile:i,themeOptions:c={},subMenuActivate:d="onClick",subMenuStyle:u,...m})=>{const{theme:p}=C.useContext(me),x=(p==null?void 0:p.sidenav)||{};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`${x==null?void 0:x.sidenavWrapper}`,children:[n,e.jsx("nav",{className:`${x==null?void 0:x.itemsWrapper}`,children:t.map((h,f)=>Hx({i:f,item:h,subMenuActivate:d}))}),e.jsx("div",{className:x.bottomMenuWrapper,children:r})]}),i==="side"?"":e.jsx("div",{className:`${x==null?void 0:x.topnavWrapper} md:hidden`,children:e.jsxs("div",{className:`${x==null?void 0:x.topnavContent} justify-between`,children:[e.jsx("div",{children:n}),e.jsxs("div",{className:"flex items-center justify-center h-full",children:[e.jsx("div",{className:`${x==null?void 0:x.topmenuRightNavContainer}`,children:r}),e.jsxs("button",{type:"button",className:x==null?void 0:x.mobileButton,onClick:()=>a(!l),children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("div",{className:"flex justify-center items-center text-2xl",children:e.jsx("span",{className:l?x==null?void 0:x.menuCloseIcon:x==null?void 0:x.menuOpenIcon})})]})]})]})})]})},Ki=t=>{const[s,n]=b.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Z4,{...t,open:s,toggle:n}),t.mobile==="side"?e.jsx(X4,{open:s,toggle:n,...t}):e.jsx(Rx,{open:s,...t,themeOptions:{}})]})},Wx={tags:"byTag",page_title:"byPageTitle"},Vx=({value:t,baseUrl:s,type:n="tags"})=>!s||s===""?`/search/?q=${t}&type=${n}`:`${s}/search/?q=${t}&type=${n}`,Fa=(t,s)=>{const n=new RegExp(`(${s})`,"gi");return t.filter(r=>r).reduce((r,a)=>a.toLowerCase()===s.toLowerCase()?r+1:n.test(a)?r+.5:r,0)},jn=(t,s)=>{if(!s)return t;const n=t.split(new RegExp(`(${s})`,"gi"));return e.jsx(e.Fragment,{children:n.map((r,a)=>{var l,i;return r.toLowerCase()===s.toLowerCase()?e.jsx(C.Fragment,{children:e.jsxs("div",{className:"inline-block font-bold",children:[a>0&&((l=n[a-1])!=null&&l.endsWith(" "))?" ":"",r,a<n.length-1&&((i=r[a+1])!=null&&i.startsWith(" "))?" ":""]})},a):r})})},Y4=({individualTags:t,query:s,setQuery:n,navigate:r,baseUrl:a})=>t.filter(l=>!(s!=null&&s.length)||l.toLowerCase().includes(s.toLowerCase())).length>0&&e.jsxs("div",{className:"max-h-96 scroll-py-3 overflow-y-auto p-3 flex items-center",children:[e.jsx("span",{className:"text-xs italic",children:"suggestions: "}),e.jsx("div",{className:"flex",children:t.filter(l=>!(s!=null&&s.length)||l.toLowerCase().includes(s.toLowerCase())).filter((l,i)=>i<=5).map(l=>e.jsx("div",{onClick:()=>{n&&n(l),r&&r(Vx({value:l,baseUrl:a}))},className:"mx-0.5 cursor-pointer rounded-xl py-0.5 px-1.5 bg-gray-500 text-white text-xs",children:l},l))})]}),Q4=({items:t,query:s,setQuery:n})=>e.jsx("div",{className:"max-h-[calc(100vh-150px)] scroll-py-3 overflow-y-auto overflow-x-hidden p-3 bg-slate-100 scrollbar-sm",children:Object.keys(t).sort((r,a)=>t[a].score-t[r].score).map(r=>e.jsxs("div",{className:"select-none rounded-xl p-3 bg-slate-10 hover:bg-slate-200 transition ease-in",children:[e.jsxs("div",{className:"group w-full flex items-center text-xl font-medium w-fit text-gray-700 hover:text-gray-700 cursor-pointer",onClick:a=>{n||(window.location=`${t[r].url}`)},children:[e.jsx(N5,{className:"flex items-center h-6 w-6 mr-2 border rounded-md"}),e.jsx("div",{children:jn(t[r].page_title||r,s)}),e.jsx(Da,{className:"h-6 w-6 ml-2 text-transparent group-hover:text-gray-900"})]}),e.jsx("div",{className:"ml-3 pl-4 flex-auto border-l border-gray-900",children:e.jsx("div",{children:(t[r].sections||[]).map(({section_id:a,section_title:l,tags:i="",score:c})=>e.jsxs("div",{className:"w-full cursor-pointer group",onClick:()=>{n||(window.location=`${t[r].url}#${a}`)},children:[e.jsxs("div",{className:"w-full flex items-center text-md font-medium text-gray-700 hover:text-gray-700",children:[e.jsx(k5,{className:"h-6 w-6 mr-2 border rounded-md"}),e.jsx("div",{children:jn(l||a,s)}),e.jsx(Da,{className:"h-6 w-6 ml-2 text-transparent group-hover:text-gray-900"})]}),e.jsx("div",{className:"w-full ml-8",children:i==null?void 0:i.split(",").filter(d=>d&&d.length).map(d=>e.jsx("span",{className:`tracking-wide p-1 text-xs text-white font-semibold rounded-md border 
                                                ${d.toLowerCase()===s.toLowerCase()?"border-1 border-red-600 bg-red-400":"bg-red-300"}`,children:jn(d,s)}))})]}))})})]},r))}),K4=({loading:t,query:s,itemsLen:n})=>t?e.jsxs("div",{className:"p-2 mx-auto w-1/4 h-full flex items-center justify-middle",children:[e.jsx("i",{className:"px-2 fa fa-loader text-gray-400"}),e.jsx("p",{className:"font-semibold text-gray-900",children:"Loading..."})]}):s&&s!==""&&n===0&&e.jsxs("div",{className:"px-6 py-14 text-center text-sm sm:px-14",children:[e.jsx("i",{className:"fa fa-exclamation mx-auto h-6 w-6 text-gray-400"}),e.jsx("p",{className:"mt-4 font-semibold text-gray-900",children:"No results found"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"No components found for this search term. Please try again."})]}),eC=({item:t,dataItems:s,format:n,attributes:r,logo:a,rightMenu:l})=>{var T;const i=Le(),[c]=Rt(),{baseUrl:d,theme:u,user:m,falcor:p,falcorCache:x,...h}=b.useContext(me)||{},[f,g]=b.useState(!1),[y,v]=b.useState([]),[j,N]=b.useState([]),[S,w]=b.useState({}),[k,$]=b.useState(),[E,M]=b.useState(c.get("type")||"tags"),_=c.get("q"),L=n==null?void 0:n.app,D=n==null?void 0:n.type;Ue.radio.EditComp;const A=C.useMemo(()=>Co(s,d,!1),[s]);return b.useEffect(()=>{async function O(){g(!0);const B=za({app:L,type:D,action:E==="tags"?"searchTags":"searchPageTitles"});return St(p,B,"/")}O().then(B=>{v(B.value.map(F=>F[E]).sort()),N([...new Set(B.value.reduce((F,z)=>[...F,...z[E].split(",")],[]))].sort()),g(!1)})},[E]),b.useEffect(()=>{if(!_)return;const O=setTimeout(()=>{g(!0);async function B(){const F=za({app:L,type:D,action:"search",tags:Array.isArray(_)?_:[_],searchType:Wx[E]});return await St(p,F,"/")}B().then(F=>{w(F),g(!1)})},500);return()=>{clearTimeout(O)}},[_]),b.useEffect(()=>{var B,F;const O=(F=(B=S[_])==null?void 0:B.value)==null?void 0:F.reduce((z,{page_id:P,page_title:U,url_slug:R,section_id:W,section_title:V,tags:X,...q})=>{var Y,H;const Q=Fa([...(V==null?void 0:V.split(" "))||[],...(X==null?void 0:X.split(","))||[]],_);return z[P]={page_title:U,url:`${d}/${R}`,sections:[...((Y=z[P])==null?void 0:Y.sections)||[],{section_id:W,section_title:V,tags:X,score:Q}].sort((J,G)=>G.score-J.score),score:Fa([U],_)+Q+(((H=z[P])==null?void 0:H.sections)||[]).reduce((J,G)=>J+(G.score||0),0)},z},{});$(O||{})},[S,_]),console.log("query",d,_,f,k),e.jsx(Rr,{navItems:A,children:e.jsxs("div",{className:`${(T=u==null?void 0:u.page)==null?void 0:T.wrapper1} ${u==null?void 0:u.navPadding[0]}`,children:[e.jsxs("div",{className:"w-full text-xl border-2 p-2 rounded-md",children:[e.jsx("input",{className:"w-full",placeholder:"Search...",value:_,onChange:O=>{i(Vx({value:O.target.value,baseUrl:d,type:E}))},onKeyDown:()=>g(!0)}),e.jsx(Y4,{individualTags:j,query:_,navigate:i,baseUrl:d})]}),k&&Object.keys(k).length?e.jsx(Q4,{items:k,query:_}):e.jsx(K4,{query:_,loading:f,itemsLen:k&&Object.keys(k).length})]})})},sa=({app:t,type:s})=>{const[n,r]=b.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:`
                bg-white flex justify-between items-center 
                h-[48px] w-[217px] py-[8px] pr-[8px] pl-[24px] 
                border border-[#E0EBF0] rounded-[1000px]
                shadow-sm transition ease-in
                `,onClick:()=>r(!0),children:[e.jsx("span",{className:"uppercase text-[#2D3E4C] font-medium text-[12px] leading-[14.62px] tracking-none",children:"Search"}),e.jsx("div",{className:"bg-[#37576B] p-[10px] rounded-full",children:e.jsx($o,{height:12,width:12,className:"text-white"})})]}),e.jsx(Ux,{open:n,setOpen:r,app:t,type:s})]})},tC=({items:t,query:s,theme:n})=>Object.keys(t).length?e.jsx("div",{className:n.resultsWrapper,children:Object.keys(t).sort((r,a)=>t[a].score-t[r].score).map(r=>e.jsx("div",{className:"select-none pt-[12px]",children:e.jsxs("div",{className:n.resultItemWrapper,children:[e.jsxs("div",{className:"group w-full flex items-center text-xl font-medium text-gray-700 hover:text-gray-700 cursor-pointer",onClick:a=>{window.location=`${t[r].url}`},children:[e.jsx(R4,{width:15,height:21}),e.jsx("div",{className:n.pageTitle,children:jn(t[r].page_title||r,s)}),e.jsx(Da,{className:"h-6 w-6 ml-2 text-transparent group-hover:text-gray-900"})]}),e.jsx("div",{className:n.sectionsWrapper,children:(t[r].sections||[]).map(({section_id:a,section_title:l,tags:i="",score:c})=>e.jsxs("div",{className:"w-full cursor-pointer group",onClick:()=>window.location=`${t[r].url}#${a}`,children:[e.jsxs("div",{className:"w-full flex items-center text-md font-medium text-gray-700 hover:text-gray-700",children:[e.jsx(H4,{width:18,height:18}),e.jsx("div",{className:n.sectionTitle,children:jn(l||a,s)}),e.jsx(Da,{className:"h-6 w-6 ml-2 text-transparent group-hover:text-gray-900"})]}),e.jsx("div",{className:"w-full ml-8",children:i==null?void 0:i.split(",").filter(d=>d&&d.length).map(d=>e.jsx("span",{className:`tracking-wide p-1 text-xs text-white font-semibold rounded-md border 
                                                ${d.toLowerCase()===s.toLowerCase()?"border-1 border-red-600 bg-red-400":"bg-red-300"}`,children:jn(d,s)}))})]}))})]},r)},r))}):null,sC=({loading:t,query:s,itemsLen:n})=>t?e.jsxs("div",{className:"p-2 mx-auto w-1/4 h-full flex items-center justify-middle",children:[e.jsx("i",{className:"px-2 fa fa-loader text-gray-400"}),e.jsx("p",{className:"font-semibold text-gray-900",children:"Loading..."})]}):s&&s!==""&&n===0&&e.jsxs("div",{className:"px-6 py-14 text-center text-sm sm:px-14",children:[e.jsx("i",{className:"fa fa-exclamation mx-auto h-6 w-6 text-gray-400"}),e.jsx("p",{className:"mt-4 font-semibold text-gray-900",children:"No results found"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"No components found for this search term. Please try again."})]}),Ux=({open:t,setOpen:s,app:n,type:r,searchStr:a})=>{const{baseUrl:l,falcor:i,falcorCache:c}=b.useContext(me)||{},[d,u]=b.useState(),[m,p]=b.useState(a),[x,h]=b.useState(!1),[f,g]=b.useState([]),[y,v]=b.useState([]),[j,N]=b.useState({}),[S,w]=b.useState({}),k="tags",$={dialoguePanel:"relative max-w-3xl sm:w-[637px] max-h-3/4 sm:h-[700px] p-[16px] flex flex-col gap-[8px] overflow-hidden rounded-[12px] bg-[#F3F8F9] transition-all",input:"px-0.5 flex-1 font-[Proxima Nova] font-normal text-[16px] text-[#2D3E4C] leading-[140%] bg-transparent focus:ring-0 sm:text-sm rounded-full ring-0 outline-none",searchIcon:"text-[#2D3E4C]",resultsWrapper:"bg-white rounded-[12px] px-[12px] py-[24px] flex flex-col gap-[8px] divide-y divide-[#E0EBF0] max-h-[500px] transform-gpu scroll-py-3 overflow-x-hidden overflow-y-auto scrollbar-sm",resultItemWrapper:"flex flex-col gap-[12px] pb-[12px] w-full select-none rounded-[12px] transition ease-in",pageTitle:"pl-2 font-[Oswald] font-medium text-[16px] leading-[100%] uppercase text-[#2D3E4C]",sectionTitle:"pl-1 font-[Proxima Nova] font-normal text-[16px] leading-[140%] tracking-normal",sectionsWrapper:"ml-3 pl-4 flex flex-col gap-[12px]"};return b.useEffect(()=>{p(a)},[a]),b.useEffect(()=>{const E=setTimeout(()=>{u(m)},500);return()=>{clearTimeout(E)}},[m]),b.useEffect(()=>{async function E(){h(!0);const M=za({app:n,type:r,action:"searchTags"});return St(i,M,"/")}E().then(M=>{g(M.value.map(_=>_[k]).sort()),v([...new Set(M.value.reduce((_,L)=>[..._,...L[k].split(",")],[]))].sort()),h(!1)})},[]),b.useEffect(()=>{if(!d)return;h(!0);const E=za({app:n,type:r,action:"search",tags:Array.isArray(d)?d:[d],searchType:Wx[k]});async function M(){return await St(i,E,"/")}M().then(_=>{console.log("data",_),N(_),h(!1)})},[d]),b.useEffect(()=>{function E(){var L,D,A,T;return(D=(L=j[d])==null?void 0:L.value)!=null&&D.length?(T=(A=j[d])==null?void 0:A.value)==null?void 0:T.reduce((O,{page_id:B,page_title:F,url_slug:z,section_id:P,section_title:U,tags:R,...W})=>{var X,q;const V=Fa([...(U==null?void 0:U.split(" "))||[],...(R==null?void 0:R.split(","))||[]],d);return O[B]={page_title:F,url:`${l}/${z}`,sections:[...((X=O[B])==null?void 0:X.sections)||[],{section_id:P,section_title:U,tags:R,score:V}].sort((Q,Y)=>Y.score-Q.score),score:Fa([F],d)+V+(((q=O[B])==null?void 0:q.sections)||[]).reduce((Q,Y)=>Q+(Y.score||0),0)},O},{}):{}}const M=E();w(M)},[j,d]),e.jsx(Oe.Root,{show:t,as:b.Fragment,afterLeave:()=>u(""),appear:!0,children:e.jsxs(Je,{as:"div",className:"relative z-20",onClose:s,children:[e.jsx(Oe.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-[60%] transition-opacity"})}),e.jsx("div",{className:"fixed inset-0 z-20 w-screen overflow-y-auto p-4 sm:p-6 md:p-20 flex items-center place-content-center",children:e.jsx(Oe.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(mo,{className:$.dialoguePanel,children:[e.jsxs("div",{className:"w-full flex items-center relative px-[24px] py-[16px] bg-white w-full rounded-full border border-[#E0EBF0]",children:[e.jsx(Ni,{autoFocus:!0,className:$.input,placeholder:"Search...",value:m,onChange:E=>{p(E.target.value)}}),e.jsx("div",{className:"p-0.5",children:e.jsx($o,{height:24,width:24,className:$.searchIcon})})]}),e.jsx(tC,{items:S,query:d,theme:$},"search-items"),e.jsx(sC,{query:d,loading:x,itemsLen:Object.keys(S).length,theme:$},"search-suggestions")]})})})]},"search-dialogue")})},za=({app:t,type:s,filter:n,action:r="load",tags:a,searchType:l,attributes:i=[{key:"id",label:"id"},{key:"app",label:"app"},{key:"type",label:"type"},{key:"data",label:"data"},{key:"updated_at",label:"updated_at"}]})=>({format:{app:t,type:s,attributes:i},children:[{type:()=>{},action:r,filter:{options:JSON.stringify({filter:n}),tags:a,searchType:l,attributes:i.map(c=>c.key)},path:"/"}]}),nC=()=>e.jsx("div",{className:"h-12"}),rC={wrapper:"relative isolate flex min-h-svh w-full max-lg:flex-col",wrapper2:"flex-1 flex items-start flex-col items-stretch max-w-full",wrapper3:"flex flex-1",childWrapper:"flex-1 h-full",topnavContainer1:"sticky top-0 left-0 right-0 z-20 ",topnavContainer2:"",sidenavContainer1:"w-44",sidenavContainer2:"sticky top-12 h-[calc(100vh_-_50px)]",navTitle:"flex-1 text-[24px] font-['Oswald'] font-[500] leading-[24px] text-[#2D3E4C] py-3 px-4 uppercase"};function aC(t,s=1,n,r=""){var l,i,c,d,u,m;let a=null;if(s>1){let p="/"+n.replace("/edit","").split("/").filter(f=>f).filter((f,g)=>g<s-1).join("/"),x=t.map(f=>({...f,path:f.path.replace("/edit","")})),h=uo(x,{pathname:p});a=((i=(l=h==null?void 0:h[0])==null?void 0:l.route)==null?void 0:i.subMenus)||[],r&&((d=(c=h==null?void 0:h[0])==null?void 0:c.route)!=null&&d.name)&&(a=[{name:(m=(u=h==null?void 0:h[0])==null?void 0:u.route)==null?void 0:m.name,className:r},...a])}return a||t}const Rr=({children:t,navItems:s,secondNav:n,title:r,pageTheme:a,EditPane:l,yPadding:i="0px",...c})=>{var N,S,w,k,$,E,M,_;const{theme:d,app:u,type:m,Menu:p}=C.useContext(me)||{},{pathname:x}=Ge(),h=Ze(pe(d),pe(a)),{sideNav:f={},topNav:g={},logo:y=nC}=pe(h==null?void 0:h.navOptions)||{},v={size:f.size||"none",color:f.color||"transparent",menuItems:((f==null?void 0:f.nav)==="main"?aC(s,f.depth,x,h.layout.navTitle):(f==null?void 0:f.nav)==="secondary"?n||[]:[]).filter(L=>!L.hideInNav),topMenu:e.jsxs("div",{className:h.sidenav.topNavWrapper,children:[(f==null?void 0:f.logo)==="top"&&y,(f==null?void 0:f.dropdown)==="top"&&e.jsx(p,{}),(f==null?void 0:f.search)==="top"&&e.jsx(sa,{app:u,type:m})]}),bottomMenu:e.jsxs("div",{className:"flex flex-row md:flex-col",children:[(f==null?void 0:f.logo)==="bottom"&&y,(f==null?void 0:f.search)==="bottom"&&e.jsx(sa,{app:u,type:m}),(f==null?void 0:f.dropdown)==="bottom"&&e.jsx(p,{}),l&&(f==null?void 0:f.dropdown)==="bottom"&&e.jsx(l,{})]})},j={position:g.position||"block",size:g.size||"compact",menu:g.menu||"left",subMenuStyle:g.subMenuStyle||"row",menuItems:((g==null?void 0:g.nav)==="main"?s:[]).filter(L=>!L.hideInNav),leftMenu:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[(g==null?void 0:g.logo)==="left"&&y,(g==null?void 0:g.search)==="left"&&e.jsx(sa,{app:u,type:m}),(g==null?void 0:g.dropdown)==="left"&&e.jsx(p,{})]}),rightMenu:e.jsxs(e.Fragment,{children:[g==null?void 0:g.rightMenu,(g==null?void 0:g.search)==="right"&&e.jsx(sa,{app:u,type:m}),(g==null?void 0:g.dropdown)==="right"&&e.jsx(p,{}),(g==null?void 0:g.logo)==="right"&&y,l&&e.jsx(l,{})]})};return v.logo,e.jsx("div",{className:(N=h==null?void 0:h.layout)==null?void 0:N.wrapper,children:e.jsxs("div",{className:(S=h==null?void 0:h.layout)==null?void 0:S.wrapper2,style:{minHeight:`calc(100vh - ${i}`},children:[j.size==="none"?"":e.jsx(e.Fragment,{children:e.jsx("div",{className:`${(w=h==null?void 0:h.layout)==null?void 0:w.topnavContainer1}`,children:e.jsx("div",{className:`${(k=h==null?void 0:h.layout)==null?void 0:k.topnavContainer2}`,children:e.jsx(G4,{themeOptions:j,leftMenu:j.leftMenu,menuItems:j.menuItems,rightMenu:j.rightMenu})})})}),e.jsxs("div",{className:`${($=h==null?void 0:h.layout)==null?void 0:$.wrapper3}`,children:[v.size==="none"?"":e.jsx("div",{className:`${(E=h==null?void 0:h.layout)==null?void 0:E.sidenavContainer1} `,children:e.jsx("div",{className:`${(M=h==null?void 0:h.layout)==null?void 0:M.sidenavContainer2} ${g.size!=="none"&&g.position==="fixed"?h.topnav.fixed:""}`,children:e.jsx(Ki,{topMenu:v.topMenu,bottomMenu:v.bottomMenu,themeOptions:v,menuItems:v.menuItems})})}),e.jsx("div",{className:`
						${(_=h==null?void 0:h.layout)==null?void 0:_.childWrapper} 
						${f.size!=="none"&&f.position==="fixed"?h.sidenav.fixed:""} 
						`,children:t})]})]})})},oC=[{name:"Tab1",Component:()=>e.jsx("div",{children:"This is Tab 1"})},{name:"Tab2",Component:()=>e.jsx("div",{children:"This is Tab 2"})}],qx={tablist:"flex gap-4",tab:`
    py-1 px-3 font-semibold text-slate-600 focus:outline-none border-b-2 border-white text-xs hover:text-slate-900
    data-[selected]:border-blue-500 data-[selected]:bg-white/10 data-[hover]:bg-white/5 data-[selected]:data-[hover]:bg-white/10 data-[focus]:outline-1 data-[focus]:outline-white
  `,tabpanels:"",tabpanel:"rounded-xl bg-white/5"};function lC({tabs:t=oC,defaultIndex:s=0,selectedIndex:n,setSelectedIndex:r}){var c,d;const[a,l]=C.useState(n||s);C.useEffect(()=>l(n),[n]);const{theme:i={tabs:qx}}=C.useContext(me)||{};return e.jsxs(kb,{selectedIndex:a,onChange:r||l,children:[e.jsx($b,{className:(c=i==null?void 0:i.tabs)==null?void 0:c.tablist,children:t.map(({name:u},m)=>{var p;return e.jsx(Te,{className:(p=i==null?void 0:i.tabs)==null?void 0:p.tab,children:u},m)})}),e.jsx(Sb,{className:(d=i==null?void 0:i.tabs)==null?void 0:d.tabpanels,children:t.map(({name:u,Component:m},p)=>{var x;return e.jsx(_b,{className:(x=i==null?void 0:i.tabs)==null?void 0:x.tabpanel,children:e.jsx(m,{})},p)})})]})}const Gx={default:"cursor-pointer inline-flex items-center gap-2  bg-gray-700 py-1.5  text-sm/6 font-semibold text-white shadow-inner shadow-white/10 focus:outline-none data-[hover]:bg-gray-600 data-[open]:bg-gray-700 data-[focus]:outline-1 data-[focus]:outline-white",plain:"cursor-pointer relative isolate inline-flex items-center justify-center gap-x-2 rounded-lg border text-base/6 font-semibold  sm:text-sm/6 focus:outline-none data-[focus]:outline data-[focus]:outline-2 data-[focus]:outline-offset-2 data-[focus]:outline-blue-500 data-[disabled]:opacity-50 [&>[data-slot=icon]]:-mx-0.5 [&>[data-slot=icon]]:my-0.5 [&>[data-slot=icon]]:size-5 [&>[data-slot=icon]]:shrink-0 [&>[data-slot=icon]]:text-[--btn-icon] [&>[data-slot=icon]]:sm:my-1 [&>[data-slot=icon]]:sm:size-4 forced-colors:[--btn-icon:ButtonText] forced-colors:data-[hover]:[--btn-icon:ButtonText] border-transparent text-zinc-950 data-[active]:bg-zinc-950/5 data-[hover]:bg-zinc-950/5 dark:text-white dark:data-[active]:bg-white/10 dark:data-[hover]:bg-white/10 [--btn-icon:theme(colors.zinc.500)] data-[active]:[--btn-icon:theme(colors.zinc.700)] data-[hover]:[--btn-icon:theme(colors.zinc.700)] dark:[--btn-icon:theme(colors.zinc.500)] dark:data-[active]:[--btn-icon:theme(colors.zinc.400)] dark:data-[hover]:[--btn-icon:theme(colors.zinc.400)] cursor-default",active:"cursor-pointer px-4 inline-flex  justify-center cursor-pointer text-sm font-semibold  bg-blue-600 text-white hover:bg-blue-500 shadow-lg border border-b-4 border-blue-800 hover:border-blue-700 active:border-b-2 active:mb-[2px] active:shadow-none",inactive:"inline-flex  px-4 justify-center cursor-not-allowed text-sm font-semibold bg-slate-300 text-white shadow border border-slate-400 border-b-4",rounded:"rounded-lg",padding:"px-[calc(theme(spacing[3.5])-1px)] py-[calc(theme(spacing[2.5])-1px)] sm:px-[calc(theme(spacing.3)-1px)] sm:py-[calc(theme(spacing[1.5])-1px)]"};function qt({children:t,disabled:s,onClick:n=()=>{},type:r="default",padding:a,rounded:l,className:i,...c}){var u,m,p,x;const{theme:d={button:Gx}}=C.useContext(me)||{};return e.jsx(Ib,{disabled:s,className:`${i} ${((u=d==null?void 0:d.button)==null?void 0:u[r])||((m=d==null?void 0:d.button)==null?void 0:m.default)} ${a||((p=d==null?void 0:d.button)==null?void 0:p.padding)} ${l||((x=d==null?void 0:d.button)==null?void 0:x.rounded)}`,onClick:n,...c,children:t})}const Jx={iconWrapper:"",icon:"size-6"},iC=({...t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"})});function qe({icon:t="Default",className:s,...n}){var l;const{theme:r={icon:Jx}}=C.useContext(me)||{};let a=((l=r==null?void 0:r.Icons)==null?void 0:l[t])||iC;return e.jsx(a,{className:s||r.icon.icon,...n})}const ec={input:"relative w-full block appearance-none rounded-lg px-[calc(theme(spacing[3.5])-1px)] py-[calc(theme(spacing[2.5])-1px)] sm:px-[calc(theme(spacing[3])-1px)] sm:py-[calc(theme(spacing[1.5])-1px)] text-base/6 text-zinc-950 placeholder:text-zinc-500 sm:text-sm/6 dark:text-white border border-zinc-950/10 data-[hover]:border-zinc-950/20 dark:border-white/10 dark:data-[hover]:border-white/20 bg-transparent dark:bg-white/5 focus:outline-none data-[invalid]:border-red-500 data-[invalid]:data-[hover]:border-red-500 data-[invalid]:dark:border-red-500 data-[invalid]:data-[hover]:dark:border-red-500 data-[disabled]:border-zinc-950/20 dark:data-[hover]:data-[disabled]:border-white/15 data-[disabled]:dark:border-white/15 data-[disabled]:dark:bg-white/[2.5%] dark:[color-scheme:dark]",inputContainer:"group flex relative w-full before:absolute before:inset-px before:rounded-[calc(theme(borderRadius.lg)-1px)] before:bg-white before:shadow dark:before:hidden after:pointer-events-none after:absolute after:inset-0 after:rounded-lg after:ring-inset after:ring-transparent sm:after:focus-within:ring-2 sm:after:focus-within:ring-blue-500 has-[[data-disabled]]:opacity-50 before:has-[[data-disabled]]:bg-zinc-950/5 before:has-[[data-disabled]]:shadow-none before:has-[[data-invalid]]:shadow-red-500/10",confirmButtonContainer:"absolute right-0 hidden group-hover:flex items-center",editButton:"py-1.5 px-2 text-slate-400 hover:text-blue-500 cursor-pointer bg-white/10",cancelButton:"text-slate-400 hover:text-red-500 cursor-pointer  py-1.5 pr-1 ",confirmButton:"text-green-500 hover:text-white hover:bg-green-500 cursor-pointer rounded-full"};function tc({type:t="text",label:s,description:n,value:r,onChange:a=()=>{},placeholder:l,disabled:i,onClick:c=()=>{},rounded:d,...u}){var p,x;const{theme:m={input:ec,field:fieldTheme}}=C.useContext(me)||{};return e.jsx("span",{className:`${(p=m==null?void 0:m.input)==null?void 0:p.inputContainer}`,children:e.jsx(Ni,{type:t,className:`${(x=m==null?void 0:m.input)==null?void 0:x.input}`,value:r,onChange:a,...u})})}function cC({type:t="text",label:s,description:n,value:r,onChange:a=()=>{},placeholder:l,disabled:i,onClick:c=()=>{},rounded:d,EditIcon:u=yx,ConfirmIcon:m=Mx,CancelIcon:p=E4}){var v,j,N,S,w,k,$,E;const{theme:x={input:ec,field:fieldTheme}}=C.useContext(me)||{},[h,f]=C.useState(r),[g,y]=C.useState(!1);return C.useEffect(()=>f(r),[r]),e.jsxs("span",{className:`${(v=x==null?void 0:x.input)==null?void 0:v.inputContainer}`,children:[g?e.jsx(Ni,{type:t,value:h,onChange:M=>f(M.target.value),className:`${(j=x==null?void 0:x.input)==null?void 0:j.input}`}):e.jsx("div",{className:`${(N=x==null?void 0:x.input)==null?void 0:N.input}`,children:h}),g?e.jsxs("div",{className:`${(k=x==null?void 0:x.input)==null?void 0:k.confirmButtonContainer}`,children:[e.jsx("div",{className:`${($=x==null?void 0:x.input)==null?void 0:$.confirmButton}`,onClick:()=>{a(h),y(!1)},children:e.jsx(m,{})}),e.jsx("div",{className:`${(E=x==null?void 0:x.input)==null?void 0:E.cancelButton}`,onClick:()=>{f(r),y(!1)},children:e.jsx(p,{})})]}):e.jsx("div",{className:`${(S=x==null?void 0:x.input)==null?void 0:S.confirmButtonContainer} ${(w=x==null?void 0:x.input)==null?void 0:w.editButton}`,onClick:()=>y(!0),children:e.jsx(u,{className:"size-5.5"})})]})}const dC=t=>Object.prototype.toString.call(t).slice(8,-1),uC=t=>dC(t)==="Array",mC=(t,s)=>{for(;t;){if(t.matches&&t.matches(s))return t;t=t.parentNode}return null},pC=t=>{var s=t.getBoundingClientRect(),n=document.body,r=document.documentElement,a=window.pageYOffset||r.scrollTop||n.scrollTop,l=window.pageXOffset||r.scrollLeft||n.scrollLeft,i=r.clientTop||n.clientTop||0,c=r.clientLeft||n.clientLeft||0,d=s.top+a-i,u=s.left+l-c;return{top:Math.round(d),left:Math.round(u)}},xC=t=>{let s=0,n=0;for(;t=t.parentNode;)s+=t.scrollTop||0,n+=t.scrollLeft||0;return{top:s,left:n}},hC=(t,s)=>({transform:"translate("+t+"px, "+s+"px)"}),Jl=(t,s)=>t.map(n=>({...n,[s]:n[s]?Jl(n[s],s):[]})),va=(t,{idProp:s,childrenProp:n})=>{let r=[];return t.filter(l=>l[n].length).map(l=>(r=r.concat(va(l[n],{idProp:s,childrenProp:n})),l[s])).concat(r)};let fC=class extends b.PureComponent{render(){const{children:s,className:n,isCollapsed:r,...a}=this.props;return e.jsxs(e.Fragment,{children:["++ ",r?e.jsx(Pn,{}):e.jsx(ds,{})]})}};const Xl=t=>{var A,T;const{theme:s}=C.useContext(me)||{},{item:n,isCopy:r,options:a,index:l,depth:i=0}=t,c=({isCollapsed:O})=>e.jsx(fC,{className:"nestable-item-icon",isCollapsed:O}),d=O=>a.onMouseEnter(O,n),u=O=>a.onDragStart(O,n),{dragItem:m,renderItem:p,handler:x,disableCollapse:h,disableDrag:f,idProp:g,childrenProp:y,checkIfCollapsed:v,renderCollapseIcon:j=c}=a,N=v(n),S=!r&&m&&m[g]===n[g],w=n[y]&&n[y].length>0;let k=!0,$={},E={},M;r||(m?$={...$,onMouseEnter:d}:(typeof f=="function"?k=f({item:n,index:l,depth:i}):typeof f<"u"&&(k=!f),k&&(E={...E,draggable:!0,onDragStart:u}))),x?M=e.jsx("span",{className:"nestable-item-handler",...E,children:x}):$={...$,...E};const _=h?void 0:()=>a.onToggleCollapse(n),L=w?e.jsx("span",{onClick:_,children:j({isCollapsed:N,item:n})}):null,D=p({handleCollapseIconClick:_,isCollapsed:N,collapseIcon:L,depth:i,handler:M,index:l,isDraggable:k,item:n});return D?e.jsxs("li",{className:`nestable-item${r?"-copy":""} relative ${S&&((A=s==null?void 0:s.nestable)==null?void 0:A.dragBefore)}`,children:[e.jsx("div",{className:"nestable-item-name",...$,children:D}),w&&!N&&e.jsx("ol",{className:`nestable-list ${(T=s==null?void 0:s.nestable)==null?void 0:T.subList}`,children:n[y].map((O,B)=>e.jsx(Xl,{index:B,depth:i+1,item:O,options:a,isCopy:r,isChild:!0},B))})]}):null},$c=class $c extends b.Component{constructor(s){super(s),this.el=null,this.elCopyStyles=null,this.mouse={last:{x:0},shift:{x:0}},this.collapse=n=>{const{idProp:r,childrenProp:a,collapsed:l}=this.props,{items:i}=this.state;n==="NONE"?this.setState({collapsedItems:l?va(i,{idProp:r,childrenProp:a}):[]}):n==="ALL"?this.setState({collapsedItems:l?[]:va(i,{idProp:r,childrenProp:a})}):uC(n)&&this.setState({collapsedItems:va(i,{idProp:r,childrenProp:a}).filter(c=>n.indexOf(c)>-1!==l)})},this.startTrackMouse=()=>{document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onDragEnd),document.addEventListener("keydown",this.onKeyDown)},this.stopTrackMouse=()=>{document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onDragEnd),document.removeEventListener("keydown",this.onKeyDown),this.elCopyStyles=null},this.getItemDepth=n=>{const{childrenProp:r}=this.props;let a=1;if(n[r].length>0){const l=n[r].map(this.getItemDepth);a+=Math.max(...l)}return a},this.checkIfCollapsed=n=>{const{collapsed:r,idProp:a}=this.props,{collapsedItems:l}=this.state;return l.indexOf(n[a])>-1!==r},this.onDragStart=(n,r)=>{const{onDragStart:a}=this.props;n.preventDefault(),n.stopPropagation(),n.target instanceof Element&&(this.el=mC(n.target,".nestable-item"),this.startTrackMouse(),this.onMouseMove(n),a({dragItem:r}),this.setState({dragItem:r,itemsOld:this.state.items}))},this.onDragEnd=(n,r)=>{const{onDragEnd:a}=this.props;n==null||n.preventDefault(),this.stopTrackMouse(),this.el=null,a(),r?this.dragRevert():this.dragApply()},this.onMouseMove=n=>{const{group:r,threshold:a}=this.props,{dragItem:l}=this.state,{clientX:i,clientY:c}=n,d=hC(i,c),u=document.querySelector(`.nestable-${r} .nestable-drag-layer > .nestable-list`);if(this.elCopyStyles){this.elCopyStyles={...this.elCopyStyles,...d},Object.keys(d).forEach(p=>{u.style[p]=d[p]});const m=i-this.mouse.last.x;m>=0&&this.mouse.shift.x>=0||m<=0&&this.mouse.shift.x<=0?this.mouse.shift.x+=m:this.mouse.shift.x=0,this.mouse.last.x=i,Math.abs(this.mouse.shift.x)>a&&(this.mouse.shift.x>0?this.tryIncreaseDepth(l):this.tryDecreaseDepth(l),this.mouse.shift.x=0)}else{const m=pC(this.el),p=xC(this.el);this.elCopyStyles={marginTop:m.top-c-p.top,marginLeft:m.left-i-p.left,...d}}},this.onMouseEnter=(n,r)=>{n.preventDefault(),n.stopPropagation();const{collapsed:a,idProp:l,childrenProp:i}=this.props,{dragItem:c}=this.state;if(c[l]===r[l])return;const d=this.getPathById(c[l]),u=this.getPathById(r[l]);let m={};if(a&&d.length>1){const p=this.getItemByPath(d.slice(0,-1));p[i].length===1&&(m=this.onToggleCollapse(p,!0))}this.moveItem({dragItem:c,pathFrom:d,pathTo:u},m)},this.onToggleCollapse=(n,r)=>{const{collapsed:a,idProp:l}=this.props,{collapsedItems:i}=this.state,d={collapsedItems:this.checkIfCollapsed(n)!==a?i.filter(u=>u!==n[l]):i.concat(n[l])};if(r)return d;this.setState(d),this.onCollapseChange(d.collapsedItems)},this.onCollapseChange=n=>{const{collapsed:r,onCollapseChange:a}=this.props;a(r?{openIds:n}:{closedIds:n})},this.onKeyDown=n=>{n.which===27&&this.onDragEnd(null,!0)},this.state={items:[],itemsOld:null,dragItem:null,isDirty:!1,collapsedItems:s.collapsedIds||[]}}componentDidMount(){let{items:s}=this.props;const{collapsedIds:n,childrenProp:r}=this.props;s=Jl(s,r),this.setState({items:s,collapsedItems:n})}componentDidUpdate(s,n){const{props:{items:r,childrenProp:a},state:l}=this;!Qe(s,this.props)&&(this.stopTrackMouse(),this.setState(c=>{const d={...c,items:Jl(r,a),dragItem:null,isDirty:!1};return s.collapsed!==this.props.collapsed&&(d.collapsedItems=[],this.onCollapseChange(d.collapsedItems)),d}))}componentWillUnmount(){this.stopTrackMouse()}moveItem({dragItem:s,pathFrom:n,pathTo:r},a={}){const{childrenProp:l,confirmChange:i}=this.props,c=this.getItemDepth(s);let{items:d}=this.state;const u=this.getRealNextPath(n,r,c);if(u.length===0)return;const m=u.length>r.length?r:r.slice(0,-1),p=this.getItemByPath(m);if(!i({dragItem:s,destinationParent:p}))return;const x=this.getSplicePath(n,{numToRemove:1,childrenProp:l}),h=this.getSplicePath(u,{numToRemove:0,itemsToInsert:[s],childrenProp:l});d=Pc(d,x),d=Pc(d,h),this.setState(f=>({...f,items:d,isDirty:!0,...a})),a.collapsedItems!==this.state.collapsedItems&&this.onCollapseChange(a.collapsedItems)}tryIncreaseDepth(s){const{maxDepth:n,idProp:r,childrenProp:a,collapsed:l}=this.props,i=this.getPathById(s[r]),c=i[i.length-1],d=i.length+this.getItemDepth(s);if(c>0&&d<=n){const u=this.getItemByPath(i.slice(0,-1).concat(c-1));if(!u[a].length||!this.checkIfCollapsed(u)){const m=i.slice(0,-1).concat(c-1).concat(u[a].length);let p={};l&&!u[a].length&&(p=this.onToggleCollapse(u,!0)),this.moveItem({dragItem:s,pathFrom:i,pathTo:m},p)}}}tryDecreaseDepth(s){const{idProp:n,childrenProp:r,collapsed:a}=this.props,l=this.getPathById(s[n]),i=l[l.length-1];if(l.length>1){const c=this.getItemByPath(l.slice(0,-1));if(i+1===c[r].length){const d=l.slice(0,-1);d[d.length-1]+=1;let u={};a&&c[r].length===1&&(u=this.onToggleCollapse(c,!0)),this.moveItem({dragItem:s,pathFrom:l,pathTo:d},u)}}}dragApply(){const{onChange:s,idProp:n}=this.props,{items:r,isDirty:a,dragItem:l}=this.state;if(this.setState({itemsOld:null,dragItem:null,isDirty:!1}),s&&a){const i=this.getPathById(l[n],r);s({items:r,dragItem:l,targetPath:i})}}dragRevert(){const{itemsOld:s}=this.state;this.setState({items:s,itemsOld:null,dragItem:null,isDirty:!1})}getPathById(s,n=this.state.items){const{idProp:r,childrenProp:a}=this.props;let l=[];return n.every((i,c)=>{if(i[r]===s)l.push(c);else if(i[a]){const d=this.getPathById(s,i[a]);d.length&&(l=l.concat(c).concat(d))}return l.length===0}),l}getItemByPath(s,n=this.state.items){const{childrenProp:r}=this.props;let a=null;return s.forEach(l=>{a=(a?a[r]:n)[l]}),a}getSplicePath(s,n={}){const r={},a=n.numToRemove||0,l=n.itemsToInsert||[],i=s.length-1;let c=r;return s.forEach((d,u)=>{if(u===i)c.$splice=[[d,a,...l]];else{const m={};c[d]={[n.childrenProp]:m},c=m}}),r}getRealNextPath(s,n,r){const{childrenProp:a,maxDepth:l}=this.props,i=s.length-1,c=n.length-1,d=n.length+r-1;if(s.length<n.length){let u=!1;return d>l&&n.length?this.getRealNextPath(s,n.slice(0,-1),r):n.map((m,p)=>u?p===c?m+1:m:typeof s[p]!="number"?m:n[p]>s[p]&&p===i?(u=!0,m-1):m)}else if(s.length===n.length&&n[c]>s[c]){const u=this.getItemByPath(n);if(d<l&&u[a]&&u[a].length&&!this.checkIfCollapsed(u))return n.slice(0,-1).concat(n[c]-1).concat(0)}return n}getItemOptions(){const{renderItem:s,renderCollapseIcon:n,handler:r,disableCollapse:a,disableDrag:l,idProp:i,childrenProp:c}=this.props,{dragItem:d}=this.state;return{dragItem:d,idProp:i,childrenProp:c,disableCollapse:a,disableDrag:l,renderItem:s,renderCollapseIcon:n,handler:r,checkIfCollapsed:this.checkIfCollapsed,onDragStart:this.onDragStart,onMouseEnter:this.onMouseEnter,onToggleCollapse:this.onToggleCollapse}}renderDragLayer(){const{group:s,idProp:n}=this.props,{dragItem:r}=this.state,a=document.querySelector(`.nestable-${s} .nestable-item-${r[n]}`);let l={};a&&(l.width=a.clientWidth),this.elCopyStyles&&(l={...l,...this.elCopyStyles});const i=this.getItemOptions();return e.jsx("div",{className:"nestable-drag-layer fixed top-0 left-0 z-50 pointer-events-none ",children:e.jsx("ol",{className:"nestable-list absolute top-0 left-0 p-0",style:l,children:e.jsx(Xl,{item:r,options:i,isCopy:!0})})})}render(){const{group:s,className:n="",idProp:r}=this.props,{items:a,dragItem:l}=this.state,i=this.getItemOptions();return e.jsxs("div",{className:`${n} nestable relative max-w-full nestable-${s}`,children:[e.jsx("ol",{className:"nestable-list list-none max-w-full",children:a.map((c,d)=>e.jsx(Xl,{index:d,item:c,options:i},c[r]))}),l&&this.renderDragLayer()]})}};$c.defaultProps={childrenProp:"children",collapsed:!1,confirmChange:()=>!0,disableCollapse:!1,disableDrag:!1,group:Math.random().toString(36).slice(2),idProp:"id",items:[],maxDepth:10,collapsedIds:[],onChange:()=>{},onCollapseChange:()=>{},onDragEnd:()=>{},onDragStart:()=>{},renderItem:({item:s})=>String(s),threshold:30};let Pa=$c;const So={container:"max-w-full max-h-full  pb-6 ",navListContainer:"h-full border-l  pt-3 pl-2 overflow-auto max-h-[calc(100vh_-_155px)] min-h-[calc(100vh_-_155px)]",navItemContainer:"text-slate-600 border-l border-y rounded border-transparent flex items-center gap-1 cursor-pointer group group-hover:bg-blue-100",navItemContainerActive:"bg-white text-blue-500  border-l rounded border-y border-slate-300 flex items-center gap-1 cursor-pointer group group-hover:bg-blue-100",navLink:"flex-1 px-4 py-2 font-light text-elipses",subList:"pl-[30px]",collapseIcon:"text-gray-400 hover:text-gray-500",dragBefore:"before:absolute before:top-0 before:left-0 before:right-0 before:bottom-0 before:bg-blue-300 before:border-dashed before:rounded before:border before:border-blue-600"};function gC({item:t,dataItems:s,handleCollapseIconClick:n,isCollapsed:r,edit:a,OpenIcon:l=ds,ClosedIcon:i=Pn}){var x,h,f,g,y,v;const{baseUrl:c,user:d,theme:u={nestable:So}}=C.useContext(me),{pathname:m="/edit"}=Ge(),p=uo([{path:t.url_slug}],m.replace("/edit")).length>0;return e.jsx("div",{className:"group",children:e.jsxs("div",{className:`${p?(x=u==null?void 0:u.nestable)==null?void 0:x.navItemContainerActive:(h=u==null?void 0:u.nestable)==null?void 0:h.navItemContainer}`,children:[e.jsx(Ym,{className:(f=u==null?void 0:u.nestable)==null?void 0:f.navLink,to:`${a?`${c}/edit`:c}/${t.url_slug||t.id}`,children:t.title}),e.jsx("div",{className:"flex gap-0.5 items-center"}),(g=t.children)!=null&&g.length?r?e.jsx(l,{className:(y=u==null?void 0:u.nestable)==null?void 0:y.collapsIcon,onClick:()=>n()}):e.jsx(i,{className:(v=u==null?void 0:u.nestable)==null?void 0:v.collapsIcon,onClick:()=>n()}):e.jsx("div",{className:"size-6"})]})},t.id)}function bC({item:t,dataItems:s,NavComp:n=gC,edit:r=!0}){var f,g,y,v,j;const{baseUrl:a,theme:l={nestable:So}}=C.useContext(me)||{},i=bt(),{pathname:c="/edit"}=Ge(),d=s.sort((N,S)=>N.index-S.index).filter(N=>!N.parent).map((N,S)=>({id:N.id,index:N.index,title:N.title,url_slug:N.url_slug,children:Zx(N,s,a,r)||[]})),u=C.useCallback(N=>{let S=s.reduce(($,E)=>($[E.id]=E,$),{}),w=Xx(N.items,"",S),k=[...w,...s.filter($=>!w.map(E=>E.id).includes($.id))];w.forEach($=>$.url_slug=vs($,k)),Promise.all(w.map($=>{i(mt($),{method:"post",action:c})})).then($=>{})},[]),m=(N,S)=>{var k,$;let w=($=(k=s.filter(E=>+E.id==+S))==null?void 0:k[0])==null?void 0:$.parent;return w?[S,...m(N,w)].filter(E=>E):[S]};let p=s.map(N=>({...N,path:`${N.url_slug}/*`})),x=((y=(g=(f=uo(p,{pathname:c.replace("edit/","")}))==null?void 0:f[0])==null?void 0:g.route)==null?void 0:y.id)||-1,h=m(s,x);return e.jsxs("div",{className:(v=l==null?void 0:l.nestable)==null?void 0:v.container,children:[e.jsx("div",{className:(j=l==null?void 0:l.nestable)==null?void 0:j.navListContainer,children:e.jsx(Pa,{items:d,onChange:u,collapsedIds:p.filter(N=>!h.includes(N.id)).map(N=>N.id),maxDepth:4,renderItem:N=>e.jsx(n,{activeItem:t,edit:r,item:N.item,dataItems:s,handleCollapseIconClick:N.handleCollapseIconClick,isCollapsed:N.isCollapsed})})}),r&&e.jsx(yC,{dataItems:s})]})}function yC({dataItems:t}){const s=bt(),{pathname:n="/edit"}=Ge(),{baseUrl:r,user:a,theme:l={nestable:So}}=C.useContext(me),[i,c]=b.useState(!1),d=t.filter(p=>!p.parent).reduce((p,x)=>Math.max(isNaN(x.index)?-1:x.index,p),-1),u={title:`Page ${d+1}`,index:d+1,published:"draft",history:[{type:" created Page.",user:a.email,time:new Date().toString()}]};u.url_slug=vs(u,t);const m=async()=>{c(!0),await s(mt(u),{method:"post",action:n}),c(!1)};return e.jsx("div",{className:"border px-4 py-2 rounded ",children:e.jsx(qt,{onClick:m,className:"w-full",children:i?"Adding Page":"+ Add Page"})})}function Xx(t,s="",n){let r=[];return t.forEach((a,l)=>{let i=n[a.id];const c={id:i.id,index:i.index,title:i.title,url_slug:i.url_slug};(i.index!==l||i.parent!==s)&&(c.index=l,c.parent=s,r.push(c)),a.children&&(r=[...r,...Xx(a.children,a.id,n)])}),r}function Zx(t,s,n,r=!0){let a=s.filter(l=>l.parent===t.id).sort((l,i)=>l.index-i.index);return a.length===0?!1:a.map((l,i)=>({id:l.id,index:l.index,title:l.title,url_slug:l.url_slug,children:Zx(l,s,n,r)||[]}))}const Yx={backdrop:"fixed inset-0 flex w-screen justify-center overflow-y-auto bg-zinc-950/25 px-2 py-2 transition duration-100 focus:outline-0 data-[closed]:opacity-0 data-[enter]:ease-out data-[leave]:ease-in sm:px-6 sm:py-8 lg:px-8 lg:py-16 dark:bg-zinc-950/50",dialogContainer:"fixed inset-0 w-screen overflow-y-auto pt-6 sm:pt-0",dialogContainer2:"grid min-h-full grid-rows-[1fr_auto] justify-items-center sm:grid-rows-[1fr_auto_3fr] sm:p-4",dialogPanel:`
    row-start-2 w-full min-w-0 rounded-t-3xl bg-white p-[--gutter] shadow-lg ring-1 ring-zinc-950/10 [--gutter:theme(spacing.8)] sm:mb-auto sm:rounded-2xl dark:bg-zinc-900 dark:ring-white/10 forced-colors:outline
    transition duration-100 data-[closed]:translate-y-12 data-[closed]:opacity-0 data-[enter]:ease-out data-[leave]:ease-in sm:data-[closed]:translate-y-0 sm:data-[closed]:data-[enter]:scale-95
  `,sizes:{xs:"sm:max-w-xs",sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-lg",xl:"sm:max-w-xl","2xl":"sm:max-w-2xl","3xl":"sm:max-w-3xl","4xl":"sm:max-w-4xl","5xl":"sm:max-w-5xl"}};function Qx({size:t="lg",open:s=!1,onClose:n=()=>{},className:r,children:a,...l}){var c,d,u;const{theme:i={dialog:Yx}}=C.useContext(me)||{};return e.jsxs(Je,{open:s,onClose:n,...l,children:[e.jsx(Lb,{transition:!0,className:(c=i==null?void 0:i.dialog)==null?void 0:c.backdrop}),e.jsx("div",{className:(d=i==null?void 0:i.dialog)==null?void 0:d.dialogContainer,children:e.jsx("div",{className:(u=i==null?void 0:i.dialog)==null?void 0:u.dialogContainer2,children:e.jsx(mo,{transition:!0,className:`
              ${r}
              ${i.dialog.sizes[t]}
              ${i.dialog.dialogPanel}
            `,children:a})})})]})}const Kx={button:"flex items-center cursor-pointer pt-1 pr-1",container:"absolute shadow-lg z-30 transform overflow-visible z-50 rounded-md"},vC=e.jsx(ko,{className:"text-blue-400 hover:text-blue-600  w-[24px] h-[24px]",title:"Help Text"}),wC=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:18,height:18,color:"#000000",fill:"none",...t,children:e.jsx("path",{d:"M17.9998 15C17.9998 15 13.5809 9.00001 11.9998 9C10.4187 8.99999 5.99985 15 5.99985 15",stroke:"currentColor",strokeWidth:"1",strokeLinejoin:"round"})});function ir({children:t,button:s=vC,onClick:n=()=>{},anchor:r="bottom",width:a="max-w-sm lg:max-w-lg",...l}){var u,m;const{theme:i={popover:Kx}}=C.useContext(me)||{},c="#ffffff",d="rgba(0,0,0,0.01)";return e.jsxs(Tt,{className:"relative",children:[e.jsx(Tt.Button,{className:(u=i==null?void 0:i.popover)==null?void 0:u.button,children:s}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:e.jsxs(Tt.Panel,{anchor:"bottom",className:`${(m=i==null?void 0:i.popover)==null?void 0:m.container} ${a}`,children:[e.jsx("div",{className:"w-full flex items-center justify-center",children:e.jsx(wC,{color:d,fill:c})}),e.jsx("div",{className:"-mt-[7.52px] border rounded-md",style:{backgroundColor:c,borderColor:d},children:t})]})})]})}const eh={selectContainer:["group relative block w-full","before:absolute before:inset-px before:rounded-[calc(theme(borderRadius.lg)-1px)] before:bg-white before:shadow","dark:before:hidden","after:pointer-events-none after:absolute after:inset-0 after:rounded-lg after:ring-inset after:ring-transparent after:has-[[data-focus]]:ring-2 after:has-[[data-focus]]:ring-blue-500","has-[[data-disabled]]:opacity-50 before:has-[[data-disabled]]:bg-zinc-950/5 before:has-[[data-disabled]]:shadow-none"].join(" "),select:["relative block w-full appearance-none rounded-lg py-[calc(theme(spacing[2.5])-1px)] sm:py-[calc(theme(spacing[1.5])-1px)]","px-[calc(theme(spacing[3.5])-1px)] sm:px-[calc(theme(spacing.3)-1px)]","[&_optgroup]:font-semibold","text-base/6 text-zinc-950 placeholder:text-zinc-500 sm:text-sm/6 dark:text-white dark:*:text-white","border border-zinc-950/10 data-[hover]:border-zinc-950/20 dark:border-white/10 dark:data-[hover]:border-white/20","bg-transparent dark:bg-white/5 dark:*:bg-zinc-800","focus:outline-none","data-[invalid]:border-red-500 data-[invalid]:data-[hover]:border-red-500 data-[invalid]:dark:border-red-600 data-[invalid]:data-[hover]:dark:border-red-600","data-[disabled]:border-zinc-950/20 data-[disabled]:opacity-100 dark:data-[hover]:data-[disabled]:border-white/15 data-[disabled]:dark:border-white/15 data-[disabled]:dark:bg-white/[2.5%]"].join(" ")},th=b.forwardRef(function({className:s,multiple:n,options:r=[],value:a,onChange:l=()=>{},...i},c){var u,m;const{theme:d={select:eh}}=C.useContext(me)||{};return e.jsxs("span",{"data-slot":"control",className:`${s} ${(u=d==null?void 0:d.select)==null?void 0:u.selectContainer}`,children:[e.jsx(Eb,{ref:c,multiple:n,...i,className:(m=d==null?void 0:d.select)==null?void 0:m.select,value:a,onChange:l,children:r.map(p=>e.jsx("option",{className:(p==null?void 0:p.className)||"",value:p.value,children:p.label},p.label))}),!n&&e.jsx("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:e.jsxs("svg",{className:"size-5 stroke-zinc-500 group-has-[[data-disabled]]:stroke-zinc-600 sm:size-4 dark:stroke-zinc-400 forced-colors:stroke-[CanvasText]",viewBox:"0 0 16 16","aria-hidden":"true",fill:"none",children:[e.jsx("path",{d:"M5.75 10.75L8 13L10.25 10.75",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10.25 5.25L8 3L5.75 5.25",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})]})})]})}),jC={listboxContainer:["group relative block w-full","before:absolute before:inset-px before:rounded-[calc(theme(borderRadius.lg)-1px)] before:bg-white before:shadow","dark:before:hidden","after:pointer-events-none after:absolute after:inset-0 after:rounded-lg after:ring-inset after:ring-transparent after:has-[[data-focus]]:ring-2 after:has-[[data-focus]]:ring-blue-500","has-[[data-disabled]]:opacity-50 before:has-[[data-disabled]]:bg-zinc-950/5 before:has-[[data-disabled]]:shadow-none"].join(" "),listboxOptions:"w-[var(--button-width)] z-20 bg-white rounded-xl border p-1 [--anchor-gap:var(--spacing-1)] focus:outline-none transition duration-100 ease-in data-[leave]:data-[closed]:opacity-0",listboxOption:"group flex gap-2 bg-white data-[focus]:bg-blue-100 z-30",listboxButton:"relative block w-full rounded-lg bg-white/5 py-1.5 pr-8 pl-3 text-left text-sm/6 text-white focus:outline-none data-[focus]:outline-2 data-[focus]:-outline-offset-2 data-[focus]:outline-white/25"};function CC({className:t,placeholder:s,autoFocus:n,"aria-label":r,options:a,value:l,onChange:i,...c}){const d=a.map((u,m)=>e.jsx(NC,{value:u.value,children:u.label},u.value));return console.log("test options",a,l),e.jsx("div",{className:"relative",children:e.jsxs(Mb,{multiple:!1,value:l,onChange:i,children:[e.jsxs(Ab,{autoFocus:n,"data-slot":"control","aria-label":r,className:[t,"group relative block w-full","before:absolute before:inset-px before:rounded-[calc(theme(borderRadius.lg)-1px)] before:bg-white before:shadow","dark:before:hidden","focus:outline-none","after:pointer-events-none after:absolute after:inset-0 after:rounded-lg after:ring-inset after:ring-transparent after:data-[focus]:ring-2 after:data-[focus]:ring-blue-500","data-[disabled]:opacity-50 before:data-[disabled]:bg-zinc-950/5 before:data-[disabled]:shadow-none"].join(" "),children:[e.jsx(Tb,{as:"span",options:d,placeholder:s&&e.jsx("span",{className:"block truncate text-zinc-500",children:s}),className:["relative block w-full appearance-none rounded-lg py-[calc(theme(spacing[2.5])-1px)] sm:py-[calc(theme(spacing[1.5])-1px)]","min-h-11 sm:min-h-9","pl-[calc(theme(spacing[3.5])-1px)] pr-[calc(theme(spacing.7)-1px)] sm:pl-[calc(theme(spacing.3)-1px)]","text-left text-base/6 text-zinc-950 placeholder:text-zinc-500 sm:text-sm/6 dark:text-white forced-colors:text-[CanvasText]","border border-zinc-950/10 group-data-[active]:border-zinc-950/20 group-data-[hover]:border-zinc-950/20 dark:border-white/10 dark:group-data-[active]:border-white/20 dark:group-data-[hover]:border-white/20","bg-transparent dark:bg-white/5","group-data-[invalid]:border-red-500 group-data-[invalid]:group-data-[hover]:border-red-500 group-data-[invalid]:dark:border-red-600 group-data-[invalid]:data-[hover]:dark:border-red-600","group-data-[disabled]:border-zinc-950/20 group-data-[disabled]:opacity-100 group-data-[disabled]:dark:border-white/15 group-data-[disabled]:dark:bg-white/[2.5%] dark:data-[hover]:group-data-[disabled]:border-white/15"].join(" ")}),e.jsx("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:e.jsxs("svg",{className:"size-5 stroke-zinc-500 group-data-[disabled]:stroke-zinc-600 sm:size-4 dark:stroke-zinc-400 forced-colors:stroke-[CanvasText]",viewBox:"0 0 16 16","aria-hidden":"true",fill:"none",children:[e.jsx("path",{d:"M5.75 10.75L8 13L10.25 10.75",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10.25 5.25L8 3L5.75 5.25",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),e.jsx(Ob,{transition:!0,anchor:"selection start",className:["z-50 [--anchor-offset:-1.625rem] [--anchor-padding:theme(spacing.4)] sm:[--anchor-offset:-1.375rem]","isolate w-max min-w-[calc(var(--button-width)+1.75rem)] select-none scroll-py-1 rounded-xl p-1","outline outline-1 outline-transparent focus:outline-none","overflow-y-scroll overscroll-contain","bg-white/75 backdrop-blur-xl dark:bg-zinc-800/75","shadow-lg ring-1 ring-zinc-950/10 dark:ring-inset dark:ring-white/10","transition-opacity duration-100 ease-in data-[transition]:pointer-events-none data-[closed]:data-[leave]:opacity-0"].join(" "),children:d})]})})}function NC({children:t,className:s,...n}){let r=["flex min-w-0 items-center","[&>[data-slot=icon]]:size-5 [&>[data-slot=icon]]:shrink-0 sm:[&>[data-slot=icon]]:size-4","[&>[data-slot=icon]]:text-zinc-500 [&>[data-slot=icon]]:group-data-[focus]/option:text-white [&>[data-slot=icon]]:dark:text-zinc-400","forced-colors:[&>[data-slot=icon]]:text-[CanvasText] forced-colors:[&>[data-slot=icon]]:group-data-[focus]/option:text-[Canvas]","[&>[data-slot=avatar]]:-mx-0.5 [&>[data-slot=avatar]]:size-6 sm:[&>[data-slot=avatar]]:size-5"].join(" ");return e.jsx(Db,{as:b.Fragment,...n,children:({selectedOption:a})=>a?e.jsx("div",{className:[s,r].join(" "),children:t}):e.jsxs("div",{className:["group/option grid cursor-default grid-cols-[theme(spacing.5),1fr] items-baseline gap-x-2 rounded-lg py-2.5 pl-2 pr-3.5 sm:grid-cols-[theme(spacing.4),1fr] sm:py-1.5 sm:pl-1.5 sm:pr-3","text-base/6 text-zinc-950 sm:text-sm/6 dark:text-white forced-colors:text-[CanvasText]","outline-none data-[focus]:bg-blue-500 data-[focus]:text-white","forced-color-adjust-none forced-colors:data-[focus]:bg-[Highlight] forced-colors:data-[focus]:text-[HighlightText]","data-[disabled]:opacity-50"].join(" "),children:[e.jsx("svg",{className:"relative hidden size-5 self-center stroke-current group-data-[selected]/option:inline sm:size-4",viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M4 8.5l3 3L12 4",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("span",{className:[s,r,"col-start-2"].join(" "),children:t})]})})}const kC={Input:tc,ConfirmInput:cC,Select:th,Listbox:CC},sc={field:"pb-2",label:"select-none text-base/6 text-zinc-950 data-[disabled]:opacity-50 sm:text-sm/6 dark:text-white",description:"text-base/6 text-zinc-500 data-[disabled]:opacity-50 sm:text-sm/6 dark:text-zinc-400"};function $C({components:t}){const{theme:s={ield:sc}}=C.useContext(me)||{};return e.jsx(Bb,{children:t.map((n,r)=>{let a=kC[n.type]||tc;return e.jsx(SC,{...n,children:e.jsx(a,{...n})},r)})})}function SC({label:t,description:s,children:n}){var a,l;const{theme:r={input:inputTheme,field:sc}}=C.useContext(me)||{};return e.jsxs(Fb,{className:r.field.field,children:[t&&e.jsx(zb,{className:(a=r==null?void 0:r.field)==null?void 0:a.label,children:t}),s&&e.jsx(Pb,{className:(l=r==null?void 0:r.field)==null?void 0:l.description,children:s}),n]})}const _C={groupBy:"group",notNull:"excludeNA",openOutCols:"openOut",visibleCols:"show"},IC=[],LC=/\s+as\s+/i,EC=t=>t.split(LC),ln=(t,s)=>t.findIndex(n=>n.name===s||n.accessor===s||EC(n.name)[0]===s),dl=(t,s)=>t&&s.toLowerCase().includes("disaster_number")?JSON.stringify({...JSON.parse(t),view_id:1723}):t,MC=t=>{let s={columns:[],data:[],display:{usePagination:!0,pageSize:5},sourceInfo:{columns:[],env:"hazmit_dama",srcEnv:"hazmit_dama"}};Object.keys(t).filter(a=>!IC.includes(a)).sort((a,l)=>a.localeCompare(l)).forEach(a=>{var i,c,d,u;const l=t[a];if(a==="columns"&&(s.columns=l.map(m=>{const p=(t.additionalVariables||[]).filter(g=>m.name===g.name||m.accessor===g.name),x=p.filter(({action:g})=>g==="include").reduce((g,{defaultValue:y})=>Array.isArray(y)?[...g,...y]:[...g,y],[]),h=p.filter(({action:g})=>g==="exclude").reduce((g,{defaultValue:y})=>Array.isArray(y)?[...g,...y]:[...g,y],[]),f=[Array.isArray(x)&&x.length?{type:"internal",operation:"filter",values:x}:null,Array.isArray(h)&&h.length?{type:"internal",operation:"exclude",values:h}:null].filter(g=>g);return{...m,justify:m.align,filters:f.length?f:void 0,meta_lookup:m.meta_lookup?dl(m.meta_lookup,m.name):void 0,...m.link||{}}})),["dataSize","pageSize","extFiltersDefaultOpen","showCsvDownload","striped"].includes(a)&&(s.display[a]=l),a==="showTotal"&&(s.display.showTotal=!!l.length),["groupBy","notNull","openOutCols","visibleCols"].includes(a)){const m=_C[a];l.forEach(p=>{const x=ln(s.columns,p);if(x!==-1)s.columns[x][m]=!0;else{const h=ln(s.sourceInfo.columns,p);h!==-1?s.push({...s.sourceInfo.columns[h],[m]:!0}):console.log(`${a} col not found.`,p,JSON.stringify(s.columns,null,2))}})}if(a==="sortBy"&&Object.keys(l).forEach(m=>{const p=ln(s.columns,m);p!==-1&&(s.columns[p].sort=l[m]==="asc"?"asc nulls last":l[m]==="desc"?"desc nulls last":l[m])}),a==="fn"&&Object.keys(l).forEach(m=>{const p=ln(s.columns,m);p!==-1?s.columns[p].fn=l[m].toString().startsWith("array_to_string(array_agg(distinct")?"list":l[m].toString().startsWith("sum(")?"sum":l[m].toString().startsWith("count(")?"count":void 0:console.log("fn col not found",m)}),a==="version"&&(s.sourceInfo.view_id=l,s.sourceInfo.view_name=(i=t==null?void 0:t.attributionData)==null?void 0:i.version,s.sourceInfo.updated_at=(d=(c=t==null?void 0:t.attributionData)==null?void 0:c._modified_timestamp)==null?void 0:d.value),a==="dataSource"){const m=t.dataSources.find(p=>p.source_id===l);m?s.sourceInfo={...s.sourceInfo,source_id:m.source_id,name:m.name,columns:(((u=m.metadata)==null?void 0:u.columns)||[]).map(p=>({...p,meta_lookup:p.meta_lookup?dl(p.meta_lookup,p.name):void 0}))}:s.sourceInfo.source_id=l}}),(t.additionalVariables||[]).filter(({name:a})=>ln(s.columns,a)===-1).reduce((a,{name:l,action:i,defaultValue:c})=>{const d=i==="include"?"internalFilter":"internalExclude",u=a.findIndex(m=>m.name===l);if(u!==-1){const m=a[u][d]||[];return a[u][d]=Array.isArray(c)?[...m,...c]:[...m,c],a}else a.push({name:l,[d]:Array.isArray(c)?c:[c]});return a},[]).forEach(({name:a,internalFilter:l,internalExclude:i})=>{const c=ln(s.sourceInfo.columns,a),d=s.sourceInfo.columns[c],u={name:a},m=[Array.isArray(l)&&l.length?{type:"internal",operation:"filter",values:l}:null,Array.isArray(i)&&i.length?{type:"internal",operation:"exclude",values:i}:null].filter(p=>p);s.columns.push({...d||u,filters:m.length?m:void 0})});const r=s.columns.reduce((a,l)=>((l.filters||[]).forEach(({type:i,operation:c,values:d})=>{a[c]={...a[c]||{},[l.name]:d}}),l.excludeNA&&(a.exclude=a.exclude&&a.exclude[l.name]?{...a.exclude,[l.name]:[...a.exclude[l.name],"null"]}:{...a.exclude||[],[l.name]:["null"]}),a),{});return s.dataRequest={...r,groupBy:s.columns.filter(a=>a.group).map(a=>a.name),orderBy:s.columns.filter(a=>a.sort).reduce((a,l)=>({...a,[l.name]:(typeof l.sort=="object"?Object.values(l.sort)[0]:l.sort).includes("asc")?"asc nulls last":"desc nulls last"}),{}),fn:s.columns.filter(a=>a.fn).reduce((a,l)=>({...a,[l.name]:l.fn}),{}),meta:s.columns.filter(a=>a.show&&["meta-variable","geoid-variable","meta"].includes(a.display)&&a.meta_lookup).reduce((a,l)=>({...a,[l.name]:dl(l.meta_lookup,l.name)}),{})},s},AC=t=>{try{JSON.parse(t)}catch{return!1}return!0};function TC({value:t,i:s,onChange:n,attributes:r,size:a,onCancel:l,onSave:i,onRemove:c,siteType:d,apiLoad:u,apiUpdate:m,format:p}){var w,k,$,E,M,_;const[x,h]=b.useState(!1);let f=t==null?void 0:t.title,{theme:g}=C.useContext(me)||{};const y=(L,D)=>{console.log("change",L,D,{...t,[L]:D}),Qe(t,{...t,[L]:D})||(console.log("change",L,D,{...t,[L]:D}),n({...t,[L]:D}))};let v=(w=r==null?void 0:r.title)==null?void 0:w.EditComp,j=(k=r==null?void 0:r.level)==null?void 0:k.EditComp;($=r==null?void 0:r.tags)==null||$.EditComp;let N=(E=r==null?void 0:r.element)==null?void 0:E.EditComp,S=(M=r==null?void 0:r.helpText)==null?void 0:M.EditComp;return e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex w-full",children:[e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"z-10 relative",children:e.jsxs("div",{className:"absolute mr-16 top-[-24px] right-[-60px] flex",children:[e.jsx(qt,{type:"plain",padding:"p-1",onClick:()=>h(!x),children:e.jsx(wx,{className:"text-red-400 hover:text-red-600 w-[24px] h-[24px]",title:"Delete Section"})}),e.jsx(rh,{title:`Delete Section ${(t==null?void 0:t.title)||""} ${t==null?void 0:t.id}`,open:x,prompt:`Are you sure you want to delete this section? All of the section data will be permanently removed
                                            from our servers forever. This action cannot be undone.`,setOpen:L=>h(L),onDelete:()=>{async function L(){await c(s),h(!1)}L()}}),e.jsx(ir,{button:e.jsx(ko,{className:"text-blue-400 hover:text-blue-600  w-[24px] h-[24px]",title:"Help Text"}),children:e.jsx(S,{value:t==null?void 0:t.helpText,onChange:L=>y("helpText",L)})}),e.jsx(ir,{button:e.jsx(Zi,{className:"text-blue-400 hover:text-blue-600  w-[24px] h-[24px]",title:"Tags"}),children:e.jsx(nh,{edit:!0,className:"p-2 flex-0",value:t==null?void 0:t.tags,placeholder:"Add Tag...",onChange:L=>y("tags",L)})}),e.jsx(qt,{type:"plain",padding:"p-1",onClick:i,children:e.jsx(Nx,{className:"text-slate-400 hover:text-blue-500 w-[24px] h-[24px]"})}),e.jsx(qt,{type:"plain",padding:"p-1",onClick:l,children:e.jsx(Cx,{className:"text-slate-400 hover:text-red-500 w-[24px] h-[24px]"})}),e.jsx(ir,{button:e.jsx(kx,{className:"text-blue-400 hover:text-blue-600  w-[24px] h-[24px]",title:"section details"}),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"flex-0 grow",children:e.jsx(v,{className:`${(_=g==null?void 0:g.heading)==null?void 0:_.base} ${(g==null?void 0:g.heading[t==null?void 0:t.level])||(g==null?void 0:g.heading.default)}`,placeholder:"Section Title",value:t==null?void 0:t.title,onChange:L=>y("title",L)})}),e.jsx("div",{children:e.jsx(j,{className:"p-2 w-full bg-transparent",value:t==null?void 0:t.level,placeholder:"level",options:r.level.options,onChange:L=>y("level",L)})}),e.jsx("div",{className:"self-center pl-2",children:e.jsx(BC,{size:t==null?void 0:t.size,onChange:L=>y("size",L)})})]})})]})})]}),f&&e.jsx("div",{className:"flex h-[50px]",children:e.jsx("div",{className:"flex",children:e.jsx(v,{className:`p-2 w-full font-sans font-medium text-md  ${(t==null?void 0:t.level)==="1"?"text-blue-500 font-bold text-xl tracking-wider py-1 pl-1":(t==null?void 0:t.level)==="2"?"text-lg tracking-wider":(t==null?void 0:t.level)==="3"?"text-md tracking-wide":""}`,placeholder:"Section Title",value:t==null?void 0:t.title,onChange:L=>y("title",L)})})}),e.jsx("div",{className:"",children:e.jsx(N,{value:t==null?void 0:t.element,onChange:L=>y("element",L),handlePaste:(L,D)=>FC(L,D,t,n),size:a,siteType:d,apiLoad:u,apiUpdate:m,pageFormat:p})})]})}let OC=t=>{var n;if(((n=t==null?void 0:t.element)==null?void 0:n["element-type"])==="Table: Cenrep II"){const r=MC(JSON.parse(t.element["element-data"])),a={...t,element:{"element-type":"Spreadsheet","element-data":JSON.stringify(r)}};console.log(a),navigator.clipboard.writeText(JSON.stringify(a));return}navigator.clipboard.writeText(JSON.stringify(t))};function sh({value:t,i:s,attributes:n,edit:r,onEdit:a,onChange:l,onRemove:i,moveItem:c,addAbove:d,siteType:u,apiLoad:m,apiUpdate:p,format:x}){var B,F,z,P,U,R,W,V,X,q,Q,Y,H,J,G,se,le,ce,je,Ce,oe,ve,ae,de,te,re;const[h,f]=b.useState(!1);let[g,y]=b.useState(),[v,j]=b.useState();Qm(g,v);const{baseUrl:N,user:S,theme:w}=C.useContext(me)||{},k=(ee,xe)=>{Qe(t,{...t,[ee]:xe})||l(s,{...t,[ee]:xe})};let $=(B=n==null?void 0:n.title)==null?void 0:B.ViewComp;(F=n==null?void 0:n.tags)==null||F.ViewComp;let E=(z=n==null?void 0:n.element)==null?void 0:z.ViewComp,M=(P=n==null?void 0:n.helpText)==null?void 0:P.ViewComp,_=(t==null?void 0:t.helpText)&&!(((W=(R=(U=t==null?void 0:t.helpText)==null?void 0:U.root)==null?void 0:R.children)==null?void 0:W.length)===1&&((Y=(Q=(q=(X=(V=t==null?void 0:t.helpText)==null?void 0:V.root)==null?void 0:X.children)==null?void 0:q[0])==null?void 0:Q.children)==null?void 0:Y.length)===0||((G=(J=(H=t==null?void 0:t.helpText)==null?void 0:H.root)==null?void 0:J.children)==null?void 0:G.length)===0),L=(t==null?void 0:t.title)||(t==null?void 0:t.tags)||_,D=!1,A=r&&typeof a=="function"&&!0;const T=C.useMemo(()=>e.jsx(E,{value:t==null?void 0:t.element,siteType:u,apiLoad:m,apiUpdate:p,pageFormat:x}),[t]);if(!((se=t==null?void 0:t.element)!=null&&se["element-type"])&&!((le=t==null?void 0:t.element)!=null&&le["element-data"]))return null;const O=[{icon:"PencilSquare",name:"Edit",onClick:a},{icon:"Copy",name:"Copy Section",onClick:()=>OC(t)},{type:"seperator"},{icon:"ChevronUpSquare",name:"Move Up",onClick:()=>c(s,-1)},{icon:"ChevronDownSquare",name:"Move Down",onClick:()=>c(s,1)},{type:"seperator"},{icon:"Column",name:"Width",type:"menu",value:(t==null?void 0:t.size)||1,items:Object.keys(((ce=w==null?void 0:w.sectionArray)==null?void 0:ce.sizes)||{}).sort((ee,xe)=>{var we,be,Me,Ve;let ke=+((be=(we=w==null?void 0:w.sectionArray)==null?void 0:we.sizes)==null?void 0:be[ee].iconSize)||100,he=+((Ve=(Me=w==null?void 0:w.sectionArray)==null?void 0:Me.sizes)==null?void 0:Ve[xe].iconSize)||100;return ke-he}).map((ee,xe)=>({icon:ee==((t==null?void 0:t.size)||"1")?"CircleCheck":"Blank",name:ee,onClick:()=>{console.log("colspan Item name click",ee),k("size",ee)}}))},{icon:"Row",name:"Rowspan",type:"menu",value:(t==null?void 0:t.rowspan)||1,items:Object.keys(((je=w==null?void 0:w.sectionArray)==null?void 0:je.rowspans)||{}).sort((ee,xe)=>+ee-+xe).map((ee,xe)=>({icon:ee==((t==null?void 0:t.rowspan)||"1")?"CircleCheck":"Blank",name:ee,onClick:()=>{k("rowspan",ee)}}))},{icon:"Padding",name:"Offset",type:"menu",value:(t==null?void 0:t.offset)||16,items:[25,50,100,150,200,250,300,350,400,500].map((ee,xe)=>({icon:ee==((t==null?void 0:t.offset)||"1")?"CircleCheck":"Blank",name:`${ee}px`,onClick:()=>{k("offset",ee)}}))},{icon:"Padding",name:"padding",type:"menu",value:(t==null?void 0:t.padding)||((Ce=w==null?void 0:w.sectionArray)==null?void 0:Ce.sectionPadding),items:["p-0","p-1","p-2",(oe=w==null?void 0:w.sectionArray)==null?void 0:oe.sectionPadding].map((ee,xe)=>({icon:ee==((t==null?void 0:t.padding)||"1")?"CircleCheck":"Blank",name:`${ee}`,onClick:()=>{console.log("padding Item name click",ee),k("padding",ee)}}))},{icon:"Border",name:"Border",type:"menu",value:(t==null?void 0:t.border)||1,items:Object.keys(((ve=w==null?void 0:w.sectionArray)==null?void 0:ve.border)||{}).map((ee,xe)=>({icon:ee==((t==null?void 0:t.border)||"None")?"CircleCheck":"Blank",name:ee,onClick:()=>{k("border",ee)}}))},{type:"seperator"},{icon:"TrashCan",name:"Delete",onClick:()=>f(!h)}];return e.jsxs("div",{className:"",style:{pageBreakInside:"avoid"},children:[e.jsx(rh,{title:`Delete Section ${(t==null?void 0:t.title)||""} ${t==null?void 0:t.id}`,open:h,prompt:`Are you sure you want to delete this section? All of the section data will be permanently removed
                            from our servers forever. This action cannot be undone.`,setOpen:ee=>f(ee),onDelete:()=>{async function ee(){await i(s),f(!1)}ee()}}),e.jsxs("div",{className:"flex w-full",children:[e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"z-10",children:e.jsx("div",{className:"absolute top-[6px] right-[6px] hidden group-hover:flex items-center",children:A&&e.jsx(e.Fragment,{children:e.jsx(Mo,{items:O,children:e.jsx("div",{className:"p-1 hover:bg-slate-100/75 rounded-lg",children:e.jsx(qe,{icon:"Menu",className:"text-slate-500 hover:text-slate-900 size-6"})})})})})})]}),(L||D)&&e.jsxs("div",{className:`flex w-full min-h-[50px] items-center  pb-2 ${t!=null&&t.title?"":"absolute top-2 -right-2 -left-2 pointer-events-none"} false`,children:[e.jsxs("div",{id:`#${(ae=t==null?void 0:t.title)==null?void 0:ae.replace(/ /g,"_")}`,className:`flex-1 flex flex-row pb-2 font-display font-medium uppercase scroll-mt-36 items-center ${L?"":"invisible"}`,children:[e.jsx("div",{className:"flex-1",children:e.jsx($,{className:`w-full ${w.heading[t==null?void 0:t.level]||w.heading.default}`,value:t==null?void 0:t.title})}),e.jsxs("div",{className:"flex item-center h-full pointer-events-auto",children:[(de=t==null?void 0:t.tags)!=null&&de.length?e.jsx(ir,{button:e.jsx("div",{className:"p-2 border border-[#E0EBF0] rounded-full",children:e.jsx(Zi,{className:"text-slate-400 hover:text-blue-500 size-4",title:"Tags"})}),children:e.jsx(nh,{className:"p-2 flex-0",value:t==null?void 0:t.tags,placeholder:"Add Tag...",onChange:ee=>k("tags",ee)})}):null,_&&e.jsx(ir,{button:e.jsx(ko,{className:"text-blue-400 hover:text-blue-500 w-[24px] h-[24px]",title:"Move Up"}),children:e.jsx(M,{value:t==null?void 0:t.helpText})})]})]}),((re=(te=t==null?void 0:t.element)==null?void 0:te["element-type"])==null?void 0:re.includes("Map:"))&&e.jsx(ue,{className:"hidden",to:`/interact/${t==null?void 0:t.id}`,title:"interact",children:e.jsx("i",{className:"fa-light fa-window-restore"})})]}),e.jsx("div",{className:"h-full ",children:T})]})}const DC=(t=50,s=20,n=30,r=!1)=>{let a=100-t;return e.jsxs("svg",{width:n,height:s,children:[e.jsx("line",{x1:"0",y1:"0",x2:"0",y2:s,stroke:"black",strokeDasharray:"4 1.5 4 1.5"}),e.jsx("rect",{x:t===100?0:5,y:"0",width:Math.max(Math.floor(n*t/100)-(t===100?0:6),0),height:s,rx:"1",ry:"1",style:{fill:"white",stroke:"black",strokeWidth:1,opacity:.5}}),e.jsx("rect",{x:n*t/100-1,y:"0",width:Math.max(Math.floor(n*a/100)-(t===100?0:6),0),height:s,rx:"1",ry:"1",style:{fill:"white",stroke:"black",strokeWidth:1,opacity:.5}}),e.jsx("line",{x1:n,y1:"0",x2:n,y2:s,stroke:"black",strokeDasharray:"4 1.5 4 1.5"})]})};function BC({size:t="1",setSize:s,onChange:n}){var i;const{baseUrl:r,user:a,theme:l}=C.useContext(me)||{};return e.jsx("div",{className:"flex space-x-1 z-50 rounded-lg bg-blue-50 p-0.5",role:"tablist","aria-orientation":"horizontal",children:Object.keys(((i=l==null?void 0:l.sectionArray)==null?void 0:i.sizes)||{}).map((c,d)=>{var u,m;return e.jsx("button",{className:c===t?"flex items-center rounded-md py-[0.4375rem] pl-2 pr-2 text-sm font-semibold lg:pr-3 bg-white shadow":"flex items-center rounded-md py-[0.4375rem] pl-2 pr-2 text-sm font-semibold lg:pr-3 hover:text-blue-500",id:"headlessui-tabs-tab-3",role:"tab",type:"button",tabIndex:-1,onClick:()=>n(c),children:DC(((m=(u=l==null?void 0:l.sectionArray)==null?void 0:u.sizes)==null?void 0:m[c].iconSize)||100)},d)})})}function nh({value:t,placeholder:s,onChange:n,edit:r=!1}){var d;const a=Array.isArray(t)?t:((d=t==null?void 0:t.split(","))==null?void 0:d.filter(u=>u==null?void 0:u.length))||[],[l,i]=b.useState(""),c=["Hazard","Hurricane","Avalanche","Earthquake","Rec","S1","S1-a","S2","S2-a","S2-a1","S2-a2","S2-a3","S2-a4","S2-a5","S2-a6","S2-a7","S2-a8","S2-a9","S3","S3-a","S3-a1","S3-a2","S3-a3","S3-b2","S4","S4-a","S4-b","S5","S5-a","S5-b","S5-1","S6","S6-a","S6-a1","S6-a2","S6-a2.i","S6-a2.ii","S6-a2.iii","S6-b","S7","S7-a","S7-a1","S7-a2","S7-a3","S7-a4","S8","S8-1","S8-a","S8-a1","S8-a2","S8-a2.i","S8-a3","S8-a3.i","S8-a3.ii","S8-a3.iii","S8-a3.iv","S8-a3.v","S8-a4","S8-b","S8-b1","S8-b2","S8-b3","S8-c","S8-c1","S8-c2","S9","S9-a","S9-b","S10","S10-a","S10-b","S10-c","S10-d","S11","S11-a","S11-b","S12","S12-a","S12-b","S13","S13-a","S13-b","S13-b1","S13-b2","S14","S14-a","S14-a1","S14-a2","S14-a3","S14-b","S14-b1","S14-b2","S15","S15-a","S15-a1","S15-a2","S15-a3","S16","S16-a","S16-b","S17","S17-1","S17-1a","S17-1b","S18","S18-a","S18-b","S18-b1","S18-b2","S18-b3","S18-c","S19","S19-a","S19-1","S20","S20-a","S20-b","HHPD1","HHPD1-1","HHPD1-a","HHPD1-b","HHPD1-b1","HHPD1-b2","HHPD1-2","HHPD2","HHPD2-1","HHPD2-a","HHPD2-b","HHPD2-b1","HHPD2-b2","HHPD2-b3","HHPD2-b4","HHPD2-c","HHPD3","HHPD3-1","HHPD3-a","HHPD3-a1","HHPD3-a2","HHPD3-a3","HHPD3-a4","HHPD3-b","HHPD4","HPPD4-1","HPPD4-a","HPPD4-a1","HPPD4-a2","HPPD4-a3","HPPD4-a4","HPPD4-a5","HHPD4-b","HHPD4-c","HHPD5","HHPD5-a","HHPD6","HHPD6-1","HHPD6-a","HHPD6-b","HHPD6-c","HHPD7","HHPD7-1","HHPD7-a","HHPD7-b","FMAG1","FMAG1-a","FMAG1-b","FMAG1-c","FMAG1-d","FMAG2","FMAG2-a"];return e.jsxs("div",{className:"w-full",children:[r&&e.jsxs(rs,{children:[e.jsx("div",{className:"relative z-20",children:e.jsx(rs.Input,{className:"h-12 w-[189px] bg-blue-50 m-1 p-2 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm",placeholder:s,value:l,onChange:u=>{i(u.target.value)},onKeyUp:u=>{u.key==="Enter"&&l.length>0&&(n([...a,l].join(",")),i(""))}})}),c.filter(u=>!(l!=null&&l.length)||u.toLowerCase().includes(l.toLowerCase())).length?e.jsx(rs.Options,{static:!0,className:"max-h-96 transform-gpu scroll-py-3 overflow-y-auto p-3",children:c.filter(u=>l.length>0&&u.toLowerCase().includes(l.toLowerCase())).filter((u,m)=>m<=5).map(u=>e.jsx(rs.Option,{value:u,onClick:()=>{i(u)},className:({active:m})=>`flex cursor-pointer select-none rounded-xl p-1 ${m&&"bg-gray-100"}`,children:e.jsx(ti,{text:u})},u))}):null]}),e.jsx("div",{className:"w-full min-h-8 flex flex-col gap-1 px-1 py-2",children:a.sort((u,m)=>u.localeCompare(m)).map((u,m)=>e.jsx(ti,{text:e.jsxs("div",{className:"flex justify-between items-center",children:[u,r?e.jsx("div",{className:"cursor-pointer",onClick:()=>n(a.filter(p=>p!==u).join(",")),children:e.jsx(jx,{className:"text-red-400 hover:text-red-600  w-[16px] h-[16px]"})}):null]},m)}))})]})}const FC=async(t,s,n,r)=>{var a;t.preventDefault();try{const l=await navigator.clipboard.readText(),i=AC(l)&&JSON.parse(l||"{}");if(!i||!((a=i.element)!=null&&a["element-type"]))return;s(i.element["element-type"]);const c={};Object.keys(i).filter(d=>!["id","ref"].includes(d)).map(d=>{c[d]=i[d]}),r({...n,...c})}catch(l){console.error("<paste>",l)}};function rh({title:t,prompt:s,item:n={},open:r,setOpen:a,onDelete:l}){const i=b.useRef(null),{baseUrl:c}=C.useContext(me)||{},[d,u]=b.useState(!1);return e.jsxs(Vr,{open:r,setOpen:a,initialFocus:i,children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fa fa-danger h-6 w-6 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[e.jsx("h3",{className:"text-base font-semibold leading-6 text-gray-900",children:t||`Delete ${n.title||""} ${n.id}`}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:s||`Are you sure you want to delete this page? All of the page data will be permanently removed
              from our servers forever. This action cannot be undone.`})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{type:"button",disabled:d,className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",onClick:l,children:["Delet",d?"ing...":"e"]}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>a(!1),ref:i,children:"Cancel"})]})]})}const zC=t=>{try{JSON.parse(t)}catch{return!1}return!0},ah={container:"w-full grid grid-cols-6 ",gridSize:6,layouts:{centered:"max-w-[1020px] mx-auto",fullwidth:""},sectionEditWrapper:"relative group",sectionEditHover:"absolute inset-0 group-hover:border border-blue-300 border-dashed pointer-events-none z-10",sectionViewWrapper:"relative group",sectionPadding:"p-4",gridviewGrid:"z-0 bg-slate-50 h-full",gridviewItem:"border-x bg-white border-slate-100/75 border-dashed h-full p-[6px]",defaultOffset:16,sizes:{"1/3":{className:"col-span-6 md:col-span-2",iconSize:33},"1/2":{className:"col-span-6 md:col-span-3",iconSize:50},"2/3":{className:"col-span-6 md:col-span-4",iconSize:66},1:{className:"col-span-6 md:col-span-6",iconSize:100}},rowspans:{1:{className:""},2:{className:"md:row-span-2"},3:{className:"md:row-span-3"},4:{className:"md:row-span-4"},5:{className:"md:row-span-5"},6:{className:"md:row-span-6"},7:{className:"md:row-span-7"},8:{className:"md:row-span-8"}},border:{none:"",full:"border border-[#E0EBF0] rounded-lg",openLeft:"border border-[#E0EBF0] border-l-transparent rounded-r-lg",openRight:"border border-[#E0EBF0] border-r-transparent rounded-l-lg",openTop:"border border-[#E0EBF0] border-t-transparent rounded-b-lg",openBottom:"border border-[#E0EBF0] border-b-transparent rounded-t-lg",borderX:"border border-[#E0EBF0] border-y-transparent"}},PC=({value:t,onChange:s,attr:n,group:r,siteType:a,...l})=>{var M,_,L,D;const[i,c]=st([]),{baseUrl:d,user:u,theme:m={sectionArray:ah}}=C.useContext(me)||{},{editPane:p,apiLoad:x,apiUpdate:h,format:f}=C.useContext(dt)||{};C.useEffect(()=>{!t||!t.map?c([""]):Qe(t,i)||c(t)},[t]);const[g,y]=C.useState({index:-1,value:"",type:"new"}),v=A=>y({...g,value:A}),j=A=>y({...g,index:A}),N=()=>{y({index:-1,value:"",type:"new"})},S=(A,T)=>{const O=pe(t||[]);O[A]=T,c([...O,""]),s(O)},w=()=>{var B,F,z,P;let A=pe(t||[]);const T=tn();let O="";g.type==="update"?(A[g.index]=g.value,O=`edited section ${(B=g==null?void 0:g.value)!=null&&B.title?`${(F=g==null?void 0:g.value)==null?void 0:F.title} ${g.index+1}`:g.index+1}`):(A.splice(g.index,0,{...g.value||{},trackingId:T,group:r==null?void 0:r.name}),O=`added section ${(z=g==null?void 0:g.value)!=null&&z.title?`${(P=g==null?void 0:g.value)==null?void 0:P.title} ${g.index+1}`:g.index+1}`),N(),c([...A,""]),s(A,O)},k=A=>{var B,F;let T=pe(t);g.type==="update"?T.splice(g.index,1):T.splice(A,1);const O=`removed section ${(B=g==null?void 0:g.value)!=null&&B.title?`${(F=g==null?void 0:g.value)==null?void 0:F.title} ${g.index+1}`:g.index+1}`;N(),s(T,O)},$=A=>{y({index:A,value:t[A],type:"update"})};function E(A,T){let O=pe(t),B=A+T;if(!(B<0||B>=O.length)){var F=O.splice(A,1)[0];O.splice(B,0,F),s(O)}}return e.jsxs("div",{className:"relative",children:[(p==null?void 0:p.showGrid)&&e.jsx("div",{className:"absolute inset-0 pointer-events-none  ",children:e.jsx("div",{className:`
                        ${(M=m==null?void 0:m.sectionArray)==null?void 0:M.container} 
                        ${(_=m==null?void 0:m.sectionArray)==null?void 0:_.gridviewGrid} 
                        ${(L=m==null?void 0:m.sectionArray)==null?void 0:L.layouts[(r==null?void 0:r.full_width)==="show"?"fullwidth":"centered"]}
                    `,children:[...Array((D=m==null?void 0:m.sectionArray)==null?void 0:D.gridSize).keys()].map(A=>{var T;return e.jsx("div",{className:(T=m==null?void 0:m.sectionArray)==null?void 0:T.gridviewItem})})})}),e.jsxs("div",{className:`
                ${m.sectionArray.container} 
                ${m.sectionArray.layouts[(r==null?void 0:r.full_width)==="show"?"fullwidth":"centered"]}
            `,children:[[...i,{}].map((A,T)=>{var P,U,R,W,V,X,q,Q,Y,H,J,G,se,le,ce,je,Ce;if(!(A.group===r.name||!A.group&&(r==null?void 0:r.name)==="default")&&T!==g.index)return e.jsx(C.Fragment,{},T);const O=(g.index===T?(P=g==null?void 0:g.value)==null?void 0:P.size:A==null?void 0:A.size)||"1",B=(g.index===T?(U=g==null?void 0:g.value)==null?void 0:U.rowspan:A==null?void 0:A.rowspan)||"1",F=(q=((W=(R=m==null?void 0:m.sectionArray)==null?void 0:R.sizes)==null?void 0:W[O])||((X=(V=m==null?void 0:m.sectionArray)==null?void 0:V.sizes)==null?void 0:X["1"]))==null?void 0:q.className,z=(G=((Y=(Q=m==null?void 0:m.sectionArray)==null?void 0:Q.rowspans)==null?void 0:Y[B])||((J=(H=m==null?void 0:m.sectionArray)==null?void 0:H.rowspans)==null?void 0:J["1"]))==null?void 0:G.className;return e.jsxs("div",{id:A==null?void 0:A.id,className:`
                                ${A!=null&&A.padding?A.padding:m.sectionArray.sectionPadding} 
                                ${(se=m==null?void 0:m.sectionArray)==null?void 0:se.sectionEditWrapper} 
                                ${F} ${z}
                                ${(ce=(le=m==null?void 0:m.sectionArray)==null?void 0:le.border)==null?void 0:ce[(A==null?void 0:A.border)||"none"]}
                                
                            `,style:{paddingTop:A==null?void 0:A.offset},children:[e.jsx("div",{className:(je=m==null?void 0:m.sectionArray)==null?void 0:je.sectionEditHover}),(g==null?void 0:g.index)===-1&&e.jsxs("div",{onClick:()=>j(Math.max(T,0)),className:`
                                        cursor-pointer py-0.5 text-sm text-blue-200 hover:text-blue-400 truncate w-full  
                                        hover:bg-blue-50/75 -ml-4 hidden group-hover:flex absolute -top-5
                                    `,children:[e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{children:e.jsx(qe,{icon:"InsertSection",className:"size-6"})})}),e.jsx("div",{className:"flex-1"})]}),g.index===T?e.jsx(TC,{value:g.value,onChange:v,onSave:w,onCancel:N,onRemove:k,attributes:n.attributes,size:O,i:T,siteType:a,apiLoad:x,apiUpdate:h,format:f}):"",A!==""&&!(g.index===T&&g.type==="update")?e.jsx(sh,{value:A,i:T,moveItem:E,attributes:n.attributes,edit:!0,onEdit:g.index===-1?oe=>$(T):null,onRemove:k,onChange:S,addAbove:()=>j(T),siteType:a,apiLoad:x,apiUpdate:h,format:f}):((Ce=A==null?void 0:A.status)==null?void 0:Ce.length)>1?e.jsx(RenderError,{data:A}):""]},T)}),(g==null?void 0:g.index)===-1&&e.jsx(HC,{onClick:()=>j(Math.max(i.length,0))}),e.jsx(oh,{})]})]})},RC=({value:t,attr:s,group:n,siteType:r})=>{if(!t||!t.map)return"";const{baseUrl:a,user:l,theme:i}=C.useContext(me)||{},{apiLoad:c,apiUpdate:d,format:u}=C.useContext(dt)||{},m=p=>{var f;let x=(f=p==null?void 0:p.element)==null?void 0:f["element-data"],h=typeof x=="object"?x:x&&zC(x)?JSON.parse(x):{};return!(h!=null&&h.hideSection)};return e.jsxs("div",{className:`${i.sectionArray.container} ${i.sectionArray.layouts[(n==null?void 0:n.full_width)==="show"?"fullwidth":"centered"]}`,children:[t.filter(p=>m(p)).filter(p=>p.group===n.name||!p.group&&(n==null?void 0:n.name)==="default").map((p,x)=>{var v,j,N,S,w,k,$,E,M,_,L,D,A;const h=(p==null?void 0:p.size)||"1",f=(p==null?void 0:p.rowspan)||"1",g=(w=((j=(v=i==null?void 0:i.sectionArray)==null?void 0:v.sizes)==null?void 0:j[h])||((S=(N=i==null?void 0:i.sectionArray)==null?void 0:N.sizes)==null?void 0:S["1"]))==null?void 0:w.className,y=(_=(($=(k=i==null?void 0:i.sectionArray)==null?void 0:k.rowspans)==null?void 0:$[f])||((M=(E=i==null?void 0:i.sectionArray)==null?void 0:E.rowspans)==null?void 0:M["1"]))==null?void 0:_.className;return e.jsx("div",{id:p==null?void 0:p.id,className:`
                                    ${p!=null&&p.is_header?"":p!=null&&p.padding?p.padding:i.sectionArray.sectionPadding}
                                    ${(L=i==null?void 0:i.sectionArray)==null?void 0:L.sectionViewWrapper} 
                                    ${g} ${y}
                                    ${(A=(D=i==null?void 0:i.sectionArray)==null?void 0:D.border)==null?void 0:A[(p==null?void 0:p.border)||"none"]}
                                `,style:{paddingTop:p==null?void 0:p.offset},children:e.jsx(sh,{attributes:s.attributes,i:x,value:p,siteType:r,apiLoad:c,apiUpdate:d,format:u},x)},x)}),e.jsx(oh,{})]})},Od={EditComp:PC,ViewComp:RC},oh=()=>{const t=Ge();return b.useEffect(()=>{const{hash:s}=t,n=r=>+r.slice(1);if(s){const r=document.getElementById(n(s));if(r){let a=r.getBoundingClientRect();setTimeout(function(){window.scrollTo(a.x,a.y-170)},100)}}},[t]),null},HC=({onClick:t})=>{var n,r,a,l,i,c,d,u,m,p;const{theme:s}=C.useContext(me)||{};return e.jsxs("div",{className:`
                ${s.sectionArray.sectionPadding} 
                ${(n=s==null?void 0:s.sectionArray)==null?void 0:n.sectionEditWrapper} 
                ${(l=(a=(r=s==null?void 0:s.sectionArray)==null?void 0:r.sizes)==null?void 0:a["1"])==null?void 0:l.className} 
                ${(d=(c=(i=s==null?void 0:s.sectionArray)==null?void 0:i.rowspans)==null?void 0:c["1"])==null?void 0:d.className}
                ${(m=(u=s==null?void 0:s.sectionArray)==null?void 0:u.border)==null?void 0:m.none}
            `,children:[e.jsx("div",{className:(p=s==null?void 0:s.sectionArray)==null?void 0:p.sectionEditHover}),e.jsxs("div",{onClick:t,className:`
                        cursor-pointer py-0.5 text-sm text-blue-200 hover:text-blue-400 truncate w-full  
                        hover:bg-blue-50/75 -ml-4 hidden group-hover:flex absolute -top-5
                    `,children:[e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{children:e.jsx(qe,{icon:"InsertSection",className:"size-6"})})}),e.jsx("div",{className:"flex-1"})]})]})};function Zs({enabled:t=!1,setEnabled:s,label:n,size:r="medium"}){const a={xs:"h-2 w-6",small:"h-4 w-8",medium:"h-6 w-11"},l={xs:"h-1.5 w-1.5 p-1",small:"h-3.5 w-3.5 p-1",medium:"h-4 w-4"},i={true:{xs:"translate-x-3.5",small:"translate-x-4",medium:"translate-x-6"},false:{xs:"translate-x-0.5",small:"translate-x-0.5",medium:"translate-x-1"}},c={xs:"rounded-lg",small:"rounded-lg",medium:"rounded-full"};return e.jsxs("div",{role:"switch","aria-checked":t,"aria-label":n,tabIndex:0,onClick:()=>s&&s(!t),onKeyDown:d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),s&&s(!t))},className:`relative inline-flex ${a[r]} items-center ${c[r]} cursor-pointer transition-colors duration-200 ease-in-out ${t?"bg-indigo-600":"bg-gray-200"}`,children:[e.jsx("span",{className:"sr-only",children:n}),e.jsx("span",{className:`inline-block ${l[r]} transform rounded-full bg-white transition-transform duration-200 ease-in-out ${i[t][r]}`})]})}const it=({value:t,setValue:s,title:n,className:r})=>s?e.jsx("div",{children:e.jsxs("div",{className:r||`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular 
            text-gray-900 bg-white hover:bg-gray-50 cursor-pointer`,onClick:()=>s(!t),children:[e.jsx("span",{className:"flex-1 select-none mr-1",children:n}),e.jsx(Zs,{size:"small",enabled:t,setEnabled:()=>{}})]})}):null,WC=t=>{try{JSON.parse(t)}catch{return!1}return!0},VC=(t,s,n)=>n?t:s?`data->>'${t}' as ${t.toLowerCase()}`:t,fr=async({format:t,apiLoad:s,reqName:n,refName:r,allAttributes:a,filterBy:l={}})=>{const i=!n.toLowerCase().startsWith("distinct"),c=!n.toLowerCase().includes(" as "),d=`${i?"distinct ":""}${n}${c?` as ${n}`:""}`,{name:u,display:m,meta_lookup:p}=a.find(j=>j.name===n)||{},x=["meta-variable","geoid-variable","meta"].includes(m)&&p?{[u]:p}:{},h=await UC({format:t,apiLoad:s,groupBy:[r],filterBy:l}),f=0,g=h-1,y=[{type:()=>{},action:"uda",path:"/",filter:{fromIndex:j=>f,toIndex:j=>g,options:JSON.stringify({...l,orderBy:{1:"asc nulls last"},meta:x,keepOriginalValues:!0}),attributes:[d],stopFullDataLoad:!0}}];return(await s({app:t.app,type:t.type,format:t,attributes:[d],children:y})).map(j=>({[n]:j[d]}))},UC=async({format:t,apiLoad:s,groupBy:n=[],filterBy:r})=>{var i,c,d;const a=WC(t==null?void 0:t.config)?((i=t.config)==null?void 0:i.attributes)||[]:((c=JSON.parse((t==null?void 0:t.config)||"{}"))==null?void 0:c.attributes)||((d=t==null?void 0:t.metadata)==null?void 0:d.columns)||[],l=[{type:()=>{},action:"udaLength",path:"/",filter:{options:JSON.stringify({...r,groupBy:n})}}];return await s({app:t.app,type:t.type,format:t,attributes:a,children:l})},Zl=(t,s)=>{const n=(s||[]).find(r=>r.name===t);return n||console.log(`${t} not found in filters.`,s),n.display==="calculated"||n.type==="calculated"||n.origin==="calculated-column"},Dd=t=>{try{return JSON.parse(t)}catch{return t}},qC=(t=[])=>t.reduce((s,n)=>{if(!Array.isArray(n.filters))return s;const r=n.filters.reduce((a,l)=>[...a,...l.values||[]],[]);return s[n.name]=bs(r),s},{}),GC=(t=[])=>t.reduce((s,n)=>{if(!Array.isArray(n.filters))return s;const r=n.filters.reduce((a,l)=>[...a,...l.values||[]],[]);return s.push({column:n.name,values:bs(r)}),s},[]),Bd=(t,s)=>{const n=new URLSearchParams;return Object.keys(t).forEach(r=>{const a=t[r];n.append(r,a.filter(l=>Array.isArray(l)?l.length:l).join(s))}),n.toString()},JC={filter:"IN",exclude:"NOT IN",gt:">",gte:">=",lt:"<",lte:"<="},ul={list:(t,s)=>`array_to_string(array_agg(distinct ${t}), ', ') as ${s}`,default:(t,s,n="max")=>`${n}(${t}) as ${s}`},Fd=(t,s=!1)=>`${s?"$ ":""} ${isNaN(t)?0:parseInt(t).toLocaleString()}`,Yl=(t,s=2,n=!1)=>isNaN(t)?"0":typeof t=="number"&&t<1?`${n?"$":""} ${t==null?void 0:t.toFixed(s)}`:t>=1e15?`${n?"$":""} ${(t/1e15).toFixed(s)} Q`:t>=1e12?`${n?"$":""} ${(t/1e12).toFixed(s)} T`:t>=1e9?`${n?"$":""} ${(t/1e9).toFixed(s)} B`:t>=1e6?`${n?"$":""} ${(t/1e6).toFixed(s)} M`:t>=1e3?`${n?"$":""} ${(t/1e3).toFixed(s)} K`:typeof t=="object"?"":`${n?"$":""} ${parseInt(t)}`,at=(t,s)=>(t==null?void 0:t.name)===(s==null?void 0:s.name)&&(t==null?void 0:t.isDuplicate)===s.isDuplicate&&(t==null?void 0:t.copyNum)===(s==null?void 0:s.copyNum),XC=/\s+as\s+/i,gr=t=>t.split(XC),ZC=({display:t,type:s,origin:n})=>t==="calculated"||s==="calculated"||n==="calculated-column",_o=(t,s,n)=>{var r;return n||(r=gr(t)[0])!=null&&r.includes("data->>")?gr(t)[0]:s?`data->>'${t}'`:t},zd=t=>{try{return JSON.parse(t)}catch{return t}},lh=t=>typeof t=="boolean"?JSON.stringify(t):Array.isArray(t)?t:typeof t=="object"&&(t!=null&&t.value)?lh(t.value):typeof t=="object"&&!(t!=null&&t.value)?void 0:zd(t),ih=(t={},s=!1)=>{const n=t.type==="calculated"||t.display==="calculated"||t.origin==="calculated-column",r=_o(t.name,s,n),a=(n?gr(t.name)[1]:t.name).toLowerCase();return{[void 0]:`${r} as ${a}`,"":`${r} as ${a}`,list:`array_to_string(array_agg(distinct ${r}), ', ') as ${a}`,sum:s?`sum((${r})::integer) as ${a}`:`sum(${r}) as ${a}`,count:`count(${r}) as ${a}`,max:`max(${r}) as ${a}`}[t.fn]},Pd=(t,s)=>t?ih(t,s):null,YC=async({options:t,state:s,apiLoad:n})=>{const{orderBy:r,meta:a,...l}=t,i=[{type:()=>{},action:"udaLength",path:"/",filter:{options:JSON.stringify(l)}}];return await n({format:s.sourceInfo,children:i})},$s=(t,s)=>s.find(n=>n.name===t),Cn=t=>t.customName||t.display_name||t.name,Ql=(t,s)=>{if(t.type==="variable")return s[t.key]??0;const n=Ql(t.left,s),r=Ql(t.right,s);switch(t.operation){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return r!==0?n/r:NaN;default:return}},br=async({state:t,apiLoad:s,fullDataLoad:n,currentPage:r=0})=>{var F,z;const{groupBy:a=[],orderBy:l={},filter:i={},normalFilter:c=[],fn:d={},exclude:u={},meta:m={},...p}=t.dataRequest,x=t.columns.filter(({actionType:P,type:U})=>!P&&U!=="formula").map(P=>{const U={...t.sourceInfo.columns.find(H=>H.name===P.name)||{},...P},R=ZC(P),W=!P.isDuplicate&&t.columns.some(({name:H,isDuplicate:J})=>H===P.name&&J),V=Pd(U,t.sourceInfo.isDms),X=_o(P.name,t.sourceInfo.isDms,R),[q,Q]=gr(P.name),Y=`SUM(CASE WHEN (${X})::text ~ '^-?\\d+(\\.\\d+)?$' THEN (${X})::numeric ELSE NULL END ) as ${Q||q}_total`;return{...U,isCalculatedColumn:R,isCopiedColumn:W,reqName:V,refName:X,totalName:Y}}),h=x.filter(P=>P.show&&!P.isDuplicate&&P.type!=="formula"),f=x.filter(P=>P.type==="formula").reduce((P,U)=>{const R=U.variables.filter(W=>!h.find(V=>at(V,W)));return P.push(...R),P},[]);if(f.length&&h.push(f),c.length){const P=[],U=((F=t.columns.find(V=>V.valueColumn))==null?void 0:F.name)||"value",R=$s(U,x),W=(R==null?void 0:R.refName)||"value";c.forEach(({column:V,values:X,operation:q,fn:Q},Y)=>{const H=t.columns.find(J=>{var G;return J.name===V&&Qe(X,(G=J.filters[0])==null?void 0:G.values)});if(V&&(H!=null&&H.normalName)&&(X!=null&&X.length)){const J=H.normalName,G=["gt","gte","lt","lte"].includes(q)&&Array.isArray(X)?X[0]:Array.isArray(X)?X.map(ce=>`'${ce}'`):X,se=`CASE WHEN ${V} ${JC[q]||"IN"} (${G}) THEN ${W} END`,le=ul[Q]?ul[Q](se,J):ul.default(se,J,Q);P.push({name:J,reqName:le})}}),P.length&&h.push(...P)}const g={},y=[...Object.keys(i),...Object.keys(u).filter(P=>{var U;return!(((U=u[P])==null?void 0:U.length)===1&&u[P][0]==="null")})];for(const P of bs(y)){const{name:U,display:R,meta:W,refName:V,type:X}=$s(P,x),Q=Pd({...{name:U,display:R,meta:W,refName:V,type:X},fn:void 0},t.sourceInfo.isDms),Y=(i[P]||u[P]||[]).map(H=>(H==null?void 0:H.value)||H).map(H=>H===null?"null":H).filter(H=>H);if(Y.length&&X==="multiselect"){const H=await fr({reqName:Q,refName:V,allAttributes:[{name:U,display:R,meta:W}],apiLoad:s,format:t.sourceInfo});try{const J=H.map(G=>{var ce;const se=((ce=G[Q])==null?void 0:ce.value)||G[Q];return(Jt(se)&&Array.isArray(JSON.parse(se))?JSON.parse(se):Array.isArray(se)?se:typeof se=="string"?[se]:[]).find(je=>Y.includes(je))?se:null}).filter(G=>G);Y.includes("null")&&J.push("null"),g[P]=J}catch(J){console.error("Could not load options for",P,J)}}}const v={groupBy:a.map(P=>{var U;return(U=$s(P,x))==null?void 0:U.refName}),orderBy:Object.keys(l).filter(P=>h.find(U=>U.name===P)).reduce((P,U)=>{const R=h.findIndex(X=>X.name===U)+1,{refName:W,isCalculatedColumn:V}=$s(U,h);return{...P,[V?R:W]:l[U]}},{}),filter:Object.keys(i).reduce((P,U)=>{const{refName:R,type:W}=$s(U,x),V=g[U]?g[U].filter(X=>X==="null"||X.length):i[U]||[];return V!=null&&V.length?{...P,[R]:V}:P},{}),exclude:Object.keys(u).reduce((P,U)=>{var V;const R=u[U]||[],W=(R==null?void 0:R.length)===1&&R[0]==="null"?R:g[U]?g[U].filter(X=>X.length):R;return{...P,[(V=$s(U,x))==null?void 0:V.refName]:W}},{}),normalFilter:c,meta:m,...(!a.length||!0)&&Object.keys(p).reduce((P,U)=>{const R=Object.keys(p[U]);return P[U]=R.reduce((W,V)=>{const{refName:X,reqName:q,fn:Q}=$s(V,x);gr(q)[0];const Y=X,H=p[U][V];return W[Y]=Array.isArray(H)?H[0]:H,W},{}),P},{})},N=!v.groupBy.length&&h.filter(P=>P.fn).length===h.length?1:await YC({options:v,state:t,apiLoad:s}),S="uda",w=n?0:r*t.display.pageSize,k=n?N:Math.min(N,r*t.display.pageSize+t.display.pageSize)-1;if(w>N)return{length:N,data:[]};const $=h.some(P=>P.fn);if(!h.length)return{length:N,data:[]};if(t.sourceInfo.isDms&&!v.groupBy.length&&!$)h.push({name:"id",reqName:"id"}),v.orderBy.id=((z=Object.values(v.orderBy||{}))==null?void 0:z[0])||"asc";else{const P=h.findIndex(U=>U.name==="id");P!==-1&&h.splice(P,1),delete v.orderBy.id}const E=x.filter(P=>P.show&&!P.group).length,M=x.filter(P=>P.show).length,_=x.filter(P=>P.group).length,L=x.filter(P=>P.fn).length,D=M>1&&!_&&L>0&&L!==M,A=_&&L!==E;if(D||A){const P=D?`All visible columns don't have a function. # Visible columns: ${M}, # Function applied: ${L}`:A?`All Non grouped columns must have a function applied. # Non grouped columns: ${E}, # Function applied: ${L}.`:"";return{length:N,data:[],invalidState:P}}const O=[{type:()=>{},action:S,path:"/",filter:{fromIndex:P=>w,toIndex:P=>k,options:JSON.stringify(v),attributes:h.map(P=>P.reqName).filter(P=>P),stopFullDataLoad:!0}}];let B;try{B=await s({format:t.sourceInfo,children:O})}catch{return{length:N,data:[],invalidState:"An Error occurred while fetching data."}}if(t.display.showTotal){const P=[{type:()=>{},action:S,path:"/",filter:{fromIndex:R=>0,toIndex:R=>1,options:JSON.stringify({filter:v.filter,exclude:v.exclude}),attributes:h.map(R=>R.totalName).filter(R=>R),stopFullDataLoad:!0}}];let U;try{U=await s({format:t.sourceInfo,children:P})}catch{return{length:N,data:[],invalidState:"An Error occurred while fetching data."}}B.push({...U[0],totalRow:!0})}return{length:N,data:B.map(P=>{const U=h.reduce((W,V)=>({...W,totalRow:P.totalRow,[V.name]:lh(P[P.totalRow?V.totalName:V.reqName])}),{}),R=t.columns.filter(({type:W})=>W==="formula");return R.length&&R.forEach(({name:W,formula:V})=>{U[W]=Ql(V,U)}),U})}},QC=(t,s)=>{const n=new URLSearchParams;return t.forEach(r=>{const{column:a,values:l=[]}=r;n.append(a,l.filter(i=>Array.isArray(i)?i.length:i).map(i=>Array.isArray(i)?i.join(s):i).join(s))}),n.toString()},Jt=t=>{try{JSON.parse(t)}catch{return!1}return!0},Rd={"Very High Risk":"#AA2E26","High Risk":"#DD524C","Moderate Risk":"#EA8954","Low Risk":"#F1CA87","Very Low Risk":"#54B99B",default:"#ccc"},KC=t=>{const s={year:"numeric",month:"2-digit",day:"2-digit"};return t?new Date(t).toLocaleDateString(void 0,s):""},At={abbreviate:(t,s)=>Yl(t,1,s),abbreviate_dollar:t=>Yl(t,1,!0),comma:(t,s)=>Fd(t,s),comma_dollar:t=>Fd(t,!0),date:t=>KC(t),icon:(t,s)=>e.jsxs(e.Fragment,{children:[e.jsx(qe,{icon:t,className:"size-8",...s})," ",e.jsx("span",{children:t})]}),color:(t,s)=>e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{borderRadius:"1000px",height:"10px",width:"10px",backgroundColor:(s==null?void 0:s[t])||Rd[t]||Rd.default}}),e.jsx("div",{children:t})]})},Kt=(t,s,n)=>{const r=b.useCallback(a=>{t.current&&!t.current.contains(a.target)&&a.target.id!==s&&n()},[t,s,n]);b.useEffect(()=>(document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}),[r])},nc={label:"duplicate",type:({attribute:t,setState:s})=>{const n=()=>{s(r=>{let a=r.columns.findIndex(c=>at(c,t));a===-1&&(r.columns.push({...t,normalName:`${t.name}_original`}),a=r.columns.length-1);const l=pe(r.columns[a]),i=r.columns.filter(c=>c.isDuplicate&&c.name===l.name).length;l.isDuplicate=!0,l.copyNum=i+1,l.normalName=`${l.name}_copy_${i+1}`,l.display_name=`${Cn(l)} Copy ${i+1}`,console.log("column to add",l),r.columns.splice(a,0,l)})};return e.jsx("div",{className:"flex place-content-center",onClick:()=>n(),children:e.jsx(Sx,{className:"text-gray-500 hover:text-gray-700"})})}},ch=({currentPage:t,setCurrentPage:s,showPagination:n,setReadyToLoad:r})=>{var x,h,f,g,y,v,j;const{state:a}=b.useContext(xt),{theme:l={table:Hr}}=C.useContext(me)||{};if(!a.columns.filter(N=>N.show).length||!n)return;const i=5,c=Math.ceil(a.display.totalLength/a.display.pageSize),d=Math.floor(i/2);let u=Math.max(0,t-d),m=u+i-1;m>=c&&(m=c-1,u=Math.max(0,m-i+1));const p=[];for(let N=u;N<=m;N++)p.push(N);return p.length===1?null:(a.display.usePagination||r&&r(!0),e.jsx("div",{className:(x=l==null?void 0:l.table)==null?void 0:x.paginationContainer,children:a.display.usePagination?p.length===1?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:(h=l==null?void 0:l.table)==null?void 0:h.paginationInfoContainer,children:[e.jsxs("div",{className:(f=l==null?void 0:l.table)==null?void 0:f.paginationPagesInfo,children:[" Page ",t+1," of ",c," "]}),e.jsxs("div",{className:(g=l==null?void 0:l.table)==null?void 0:g.paginationRowsInfo,children:[" Rows ",t*a.display.pageSize+1," to ",Math.min(+a.display.totalLength,t*a.display.pageSize+a.display.pageSize)," of ",a.display.totalLength]})]}),e.jsxs("div",{className:(y=l==null?void 0:l.table)==null?void 0:y.paginationControlsContainer,children:[p.map(N=>{var S,w,k;return e.jsx("div",{className:`${(S=l==null?void 0:l.table)==null?void 0:S.pageRangeItem}  ${t===N?(w=l==null?void 0:l.table)==null?void 0:w.pageRangeItemActive:(k=l==null?void 0:l.table)==null?void 0:k.pageRangeItemInactive} `,onClick:()=>{s(N),r&&r(!0)},children:N+1},N)}),e.jsx("div",{className:`${(v=l==null?void 0:l.table)==null?void 0:v.pageRangeItem} ${(j=l==null?void 0:l.table)==null?void 0:j.pageRangeItemInactive}`,onClick:()=>s(t<c?t+1:t),children:"next >"})]})]}):e.jsxs("div",{className:"text-xs italic",children:["showing ",a.display.totalLength," rows"]})}))},e3=(t,s,n)=>s(r=>{const a=n.findIndex(l=>at(l,t));a===-1&&r.columns.splice(a,1)}),t3=({filter:t,searchParams:s,onChange:n})=>{const[r,a]=C.useState(!1),[l,i]=C.useState(t.searchParamKey||""),c=C.useRef(null),d=`search-menu-btn-${t.type}-${t.operation}`;Kt(c,d,()=>{i(t.searchParamKey||""),a(!1)});const u="p-1 hover:bg-blue-500/15 hover:text-blue-700 cursor-pointer rounded-md";return e.jsxs("div",{className:"min-w-fit w-full relative bg-white",children:[e.jsx("input",{className:"px-1 text-xs rounded-md bg-blue-500/15 text-blue-700 hover:bg-blue-500/25",id:d,value:l,onChange:m=>i(m.target.value),onFocus:()=>a(!0)}),r?e.jsxs("div",{ref:c,className:"absolute w-full bg-white p-1 text-xs rounded-md shadow-md",children:[l?e.jsxs("div",{className:u,onClick:()=>{n(l),a(!1)},children:["+ add ",l]}):null,Array.from(s.keys()).filter(m=>m.toLowerCase().includes(l.toLowerCase())).map(m=>e.jsx("div",{className:u,onClick:()=>{i(m),n(m),a(!1)},children:m},`${m}`))]}):null]})},s3=({loading:t,isEdit:s,filterColumn:n,filterOptions:r=[],state:a,setState:l,searchParams:i,delimiter:c,filterWithSearchParamKeys:d,columns:u})=>{const m=Le(),{theme:p={filters:rc}}=C.useContext(me)||{},x=b.useMemo(()=>{var y;return(y=r.find(v=>v.column===n.name))==null?void 0:y.uniqValues},[r,n.name]),f=((y=300)=>{const v=b.useRef(null);return b.useCallback(({key:j,value:N,filterColumn:S,filter:w,setState:k})=>{v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{k($=>{var L;const E=$.columns.findIndex(D=>at(D,S));if(E===-1)return;const M=(((L=$.columns[E])==null?void 0:L.filters)||[]).findIndex(D=>D.type===w.type&&D.operation===w.operation);if(M===-1)return;const _=$.columns[E].filters[M];_[j]=N,j==="allowSearchParams"&&N===!0&&!_.searchParamKey&&(_.searchParamKey=S.name),$.display.readyToLoad=!0})},y)},[l])})(300),g=b.useMemo(()=>u.some(({group:y})=>y),[u]);return(n.filters||[]).filter(y=>s||!s&&y.type==="external").map(y=>{const v=["filter","exclude"].includes(y.operation)?"multiselect":"text",j=Ue[v].EditComp,N=["filter","exclude"].includes(y.operation)?y.values||[]:Array.isArray(y.values)?y.values[0]:typeof y.values=="object"?"":y.values,S=a.sourceInfo.columns.findIndex(({name:w})=>w===n.name)===-1;return e.jsxs("div",{className:"w-full p-1 relative text-xs",children:[e.jsxs("div",{className:p.filters.settingPillsWrapper,children:[e.jsxs("select",{className:`${s?"cursor-pointer":"hidden"} ${p.filters.settingPill}`,value:y.type,disabled:!s,onChange:w=>f({key:"type",value:w.target.value,filterColumn:n,filter:y,setState:l}),children:[e.jsx("option",{value:"internal",children:"internal"},"internal"),e.jsx("option",{value:"external",children:"external"},"external")]}),e.jsxs("select",{className:`${s?"cursor-pointer":"hidden"} ${p.filters.settingPill}`,value:y.operation,disabled:!s,onChange:w=>f({key:"operation",value:w.target.value,filterColumn:n,filter:y,setState:l}),children:[e.jsx("option",{value:"filter",children:"include"},"filter"),e.jsx("option",{value:"exclude",children:"exclude"},"exclude"),e.jsxs("option",{value:"gt",children:[" ",">"," "]},"gt"),e.jsxs("option",{value:"gte",children:[" ",">="," "]},"gte"),e.jsxs("option",{value:"lt",children:[" ","<"," "]},"lt"),e.jsxs("option",{value:"lte",children:[" ","<="," "]},"lte")]}),g?e.jsxs("select",{className:`${s?"cursor-pointer":"hidden"} ${p.filters.settingPill}`,value:y.fn,disabled:!s,onChange:w=>f({key:"fn",value:w.target.value,filterColumn:n,filter:y,setState:l}),children:[e.jsx("option",{value:"",children:"no fn"},"none"),e.jsx("option",{value:"sum",children:"sum"},"sum"),e.jsx("option",{value:"count",children:"count"},"count"),e.jsx("option",{value:"max",children:"max"},"max"),e.jsx("option",{value:"list",children:"list"},"list")]}):null,s&&["filter","exclude"].includes(y.operation)?e.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[e.jsx("label",{className:p.filters.settingLabel,children:"Multiselect: "}),e.jsx(Zs,{label:"Use Search Params",enabled:y.isMulti,setEnabled:w=>f({key:"isMulti",value:w,filterColumn:n,filter:y,setState:l}),size:"xs"})]}):null,s?e.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[e.jsx("label",{className:p.filters.settingLabel,children:"Use Search Params: "}),e.jsx(Zs,{label:"Use Search Params",enabled:y.allowSearchParams,setEnabled:w=>f({key:"allowSearchParams",value:w,filterColumn:n,filter:y,setState:l}),size:"xs"})]}):null,y.allowSearchParams&&s?e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx("label",{className:`shrink-0 ${p.filters.settingLabel}`,children:"Search key: "}),e.jsx(t3,{searchParams:i,filter:y,onChange:w=>f({key:"searchParamKey",value:w,filterColumn:n,filter:y,setState:l})})]}):null,s&&S?e.jsx("button",{className:p.filters.settingPill,onClick:()=>e3(n,l,a.sourceInfo.columns),children:"Reset Stale Column"}):null]}),["filter","exclude"].includes(y.operation)?e.jsx(j,{className:`${p.filters.input}`,placeholder:"Search...",loading:t,value:N,options:x||[],singleSelectOnly:!y.isMulti,onChange:w=>{let k=(w||[]).map($=>($==null?void 0:$.value)||$);if(y.allowSearchParams){const $=Object.keys(d).filter(M=>{if((y.searchParamKey||n.name)===M)return!1;const _=d[M];return _==null?void 0:_.length}).reduce((M,_)=>(M[_]=d[_],M),{});k.length&&($[y.searchParamKey||n.name]=k);const E=Bd($,c);m(`?${E}`),f({key:"values",value:k,filterColumn:n,filter:y,setState:l})}else f({key:"values",value:k,filterColumn:n,filter:y,setState:l})},displayInvalidMsg:!1},`filter-${n.name}-${y.type}`):e.jsx(j,{className:`${p.filters.input}`,placeholder:"Please enter a number...",value:N,type:"number",onChange:w=>{let $=[n.type==="number"&&w?+w:w];if(y.allowSearchParams){const E=Object.keys(d).filter(_=>{if((y.searchParamKey||n.name)===_)return!1;const L=d[_];return L==null?void 0:L.length}).reduce((_,L)=>(_[L]=d[L],_),{});$.length&&(E[y.searchParamKey||n.name]=$);const M=Bd(E,c);m(`?${M}`),f({key:"values",value:$,filterColumn:n,filter:y,setState:l})}else f({key:"values",value:$,filterColumn:n,filter:y,setState:l})},onWheel:w=>w.target.blur(),displayInvalidMsg:!1},`filter-${n.name}-${y.type}`)]},`${n.name}-${y.operation}`)})},Hd="|||",rc={filterLabel:"py-0.5 text-gray-500 font-medium",loadingText:"pl-0.5 font-thin text-gray-500",filterSettingsWrapper:"flex flex-col w-full",input:"w-full max-h-[150px] flex text-xs overflow-auto scrollbar-sm border rounded-md bg-white p-2",settingPillsWrapper:"flex flex-row flex-wrap gap-1",settingPill:"px-1 py-0.5 bg-orange-500/15 text-orange-700 hover:bg-orange-500/25 rounded-md",settingLabel:"text-gray-900 font-regular min-w-fit",filtersWrapper:"w-full py-6 flex flex-col rounded-md"},Io=({isEdit:t,state:s={columns:[],sourceInfo:{}},setState:n,apiLoad:r,defaultOpen:a=!0,showNavigate:l=!1})=>{var E;const{theme:i={filters:rc}}=C.useContext(me)||{},[c,d]=b.useState(a),[u,m]=b.useState([]),[p,x]=b.useState(!1),[h]=Rt(),f=(E=s.sourceInfo)==null?void 0:E.isDms,g=b.useMemo(()=>s.columns.filter(({filters:M,isDuplicate:_})=>(M==null?void 0:M.length)&&!_),[s.columns]),y=b.useMemo(()=>s.columns.filter(({filters:M,isDuplicate:_})=>{var L,D;return(M==null?void 0:M.length)&&((D=(L=M==null?void 0:M[0])==null?void 0:L.values)==null?void 0:D.length)&&!_}).reduce((M,_)=>[...M,..._.filters[0].values],[]),[s.columns]),v=b.useMemo(()=>s.columns.filter(({filters:M,isDuplicate:_})=>(M==null?void 0:M.length)&&_),[s.columns]),j=b.useMemo(()=>qC(g),[g]),N=b.useMemo(()=>GC(v),[v]),S=b.useCallback(M=>VC(M,f,Zl(M,s.columns)),[s.columns,f]),w=b.useCallback(M=>_o(M,f,Zl(M,s.columns)),[s.columns,f]),k=b.useMemo(()=>l?Object.keys(j).reduce((M,_)=>{var D,A,T;const L=(D=s.columns.find(O=>O.name===_))==null?void 0:D.filters;return j[_]&&((A=L==null?void 0:L[0])!=null&&A.allowSearchParams)&&(M[(T=L==null?void 0:L[0])==null?void 0:T.searchParamKey]=j[_]),M},{}):{},[j,l]);b.useEffect(()=>{const M=Array.from(h.keys()).reduce((_,L)=>{var A;const D=(A=h.get(L))==null?void 0:A.split(Hd);return _[L]=D,_},{});Object.keys(M).length&&n(_=>{_.columns.forEach(L=>{var D;(D=L.filters)!=null&&D.length&&L.filters.forEach(A=>{const T=M[A.searchParamKey];A.allowSearchParams&&T&&!Qe(A.values,T)&&(A.values=T)})}),_.display.readyToLoad=!0})},[h,j]),b.useEffect(()=>{let M=!1;async function _(){x(!0);const L=await Promise.all([...Object.keys(j),...N==null?void 0:N.map(D=>D.column)].filter(D=>{var T,O;const A=(O=(T=s.columns.find(({name:B})=>B===D))==null?void 0:T.filters)==null?void 0:O[0];if(["gt","gte","lt","lte","like"].includes(A.operation))return!1;if(t||(A==null?void 0:A.type)==="external")return!0}).map(async D=>{const A=await Object.keys(j).filter(F=>F!==D).reduce(async(F,z)=>{var W,V;const P=await F,U=s.columns.find(({name:X})=>X===z),R=(W=U==null?void 0:U.filters)==null?void 0:W[0];if(!((V=R==null?void 0:R.values)!=null&&V.length))return P;if(U.type==="multiselect"){const X=S(z),q=await fr({reqName:X,refName:w(z),allAttributes:[U],apiLoad:r,format:s.sourceInfo}),Q=R.values.map(H=>(H==null?void 0:H.value)||H).map(H=>H===null?"null":H).filter(H=>H),Y=q.map(H=>{var se;const J=((se=H[X])==null?void 0:se.value)||H[X];return(Jt(J)&&Array.isArray(JSON.parse(J))?JSON.parse(J):Array.isArray(J)?J:typeof J=="string"?[J]:[]).find(le=>Q.includes(le))?J:null}).filter(H=>H);P[R.operation]={...P[R.operation]||{},[w(z)]:Y}}else{const X=["gt","gte","lt","lte","like"].includes(R.operation)?R.values[0]:R.values;P[R.operation]={...P[R.operation]||{},[w(z)]:X}}return P},Promise.resolve({})),T=await fr({format:s.sourceInfo,apiLoad:r,reqName:S(D),refName:w(D),allAttributes:s.columns,filterBy:A});if(M){x(!1);return}const O=[],B=T.reduce((F,z)=>{var X;const P=S(D),U=((X=z[P])==null?void 0:X.value)||z[P],R=Dd((U==null?void 0:U.value)||U),W=Dd((U==null?void 0:U.originalValue)||U),V=Array.isArray(W)?W.map((q,Q)=>({label:(R==null?void 0:R[Q])||q,value:q})):[{label:R||W,value:W}];return[...F,...V.filter(({label:q,value:Q})=>q&&typeof q!="object")]},[]);return{column:D,uniqValues:ki(Array.isArray(O)?[...O,...B]:B,F=>F.value)}}));if(M){x(!1);return}m(L),x(!1)}return _(),()=>{M=!0,x(!1)}},[g,y]);const $=s.columns.filter(M=>{var _;return t?(_=M.filters)==null?void 0:_.length:(M.filters||[]).find(L=>L.type==="external")});return $.length?c?e.jsxs("div",{className:i.filters.filtersWrapper,children:[e.jsx("div",{className:"w-fit -mt-4 p-2 border rounded-full self-end",children:e.jsx(qe,{icon:"Filter",className:"text-slate-400 hover:text-blue-500 size-4 hover:cursor-pointer",title:"Filter",onClick:()=>d(!1)})}),$.map((M,_)=>e.jsxs("div",{className:"w-full flex flex-row flex-wrap items-center",children:[e.jsxs("div",{className:"w-full min-w-fit text-sm",children:[e.jsx("span",{className:i.filters.filterLabel,children:M.customName||M.display_name||M.name}),e.jsx("span",{className:i.filters.loadingText,children:p?"loading...":""})]}),e.jsx("div",{className:i.filters.filterSettingsWrapper,children:e.jsx(s3,{isEdit:t,filterColumn:M,filterOptions:u,state:s,setState:n,searchParams:h,loading:p,filterWithSearchParamKeys:k,delimiter:Hd,columns:s.columns},`${M.name}-filter`)})]},_))]}):e.jsx("div",{className:i.filters.filtersWrapper,children:e.jsx("div",{className:"w-fit -mt-4 p-2 border rounded-full self-end",children:e.jsx(qe,{icon:"Filter",className:"text-slate-400 hover:text-blue-500 size-4 hover:cursor-pointer",title:"Filter",onClick:()=>d(!0)})})}):null},dh={wrapper:"w-full p-1 flex gap-1 text-xs text-gray-900",label:"",link:""},uh=()=>{const{theme:t={attribution:dh},damaBaseUrl:s}=C.useContext(me)||{},{state:{sourceInfo:{isDms:n,source_id:r,name:a,view_id:l,view_name:i,updated_at:c}},compType:d}=b.useContext(xt),u={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},m=c?new Date(c).toLocaleString(void 0,u):null;return e.jsxs("div",{className:`${t.attribution.wrapper} ${d==="graph"?"pt-[0px]":"pt-[16px]"}`,children:[e.jsx("span",{className:t.attribution.label,children:"Attribution:"}),e.jsxs(ue,{className:t.attribution.link,to:`${n?"/forms":s}/source/${r}`,children:[a," (",i,") ",m?`(${m})`:null]})]})},n3=(t,s,n)=>{s&&n([])},mh=(t,s,n)=>{var a;let r=(a=t[0])==null?void 0:a.key;s(t),n&&n(r)},r3=({props:t,selected:s,setSelected:n,onChange:r})=>e.jsxs("div",{className:"w-fit inline-block ml-2",children:[t.label,e.jsx("button",{className:"hover:text-red-300 animate ml-1 p-1 rounded-md rbt-token-remove-button",onClick:a=>{const l=s.filter(i=>i.key!==t.key);mh(l,n,r)},children:e.jsx("i",{className:"fa fa-close"})})]},t.label),a3=({results:t,menuProps:s,labelKey:n,filter:r,filters:a,setFilter:l,onChange:i,...c})=>e.jsxs(ep,{className:"bg-slate-100 overflow-hidden z-[100] rounded-md",...s,children:[e.jsx("div",{className:"flex flex-row flex-wrap items-center justify-start gap-1 p-1 bg-slate-200 text-xs font-bold",children:a.map(({icon:d,label:u,value:m,filterText:p,onClick:x})=>{const h=r===p,f=g=>x?x(g):m?i(m):l(h?null:p);return e.jsxs("button",{title:`Filter by: ${p}`,className:`py-1 px-2 my-0.5 
                                    ${h?"bg-slate-300 hover:bg-blue-300":"bg-slate-100 hover:bg-blue-100"} 
                                     rounded-md`,onClick:g=>f(g),children:[e.jsx("i",{className:`${d} pr-2 pl-1`}),u]},p)})}),t.map((d,u)=>e.jsx(tp,{className:"block hover:bg-slate-200 text-xl tracking-wide pl-1",option:d,position:u,children:d.label},`${d.label}_${u}`))]}),Ms=({className:t,value:s,onChange:n,options:r=[],filters:a=[],showAll:l=!1,placeholder:i="Search..."})=>{const[c,d]=b.useState([]),[u,m]=b.useState(""),[p,x]=b.useState(r);return b.useEffect(()=>{if(!s)return;const h=r.filter(f=>f.key===s);d(h)},[s,r]),b.useEffect(()=>{x(r.filter(h=>{var f;return!u||((f=h==null?void 0:h.label)==null?void 0:f.toLowerCase().includes(u.toLowerCase()))}))},[r,u]),e.jsx("div",{className:"flex justify-between",children:e.jsxs("div",{className:`flex flex row ${t} w-full shrink my-1 bg-white p-1 pl-3 rounded-l-md`,children:[e.jsx("i",{className:"fa fa-search font-light text-xl bg-white rounded-r-md"}),e.jsx(Km,{className:"w-full",onSearch:n3,minLength:0,id:"search",placeholder:i,options:p,labelKey:h=>`${h==null?void 0:h.label}`,defaultSelected:c,onChange:h=>mh(h,d,n),selected:c,inputProps:{className:"w-full flex flex-row flex-wrap p-1"},renderMenu:(h,f,g)=>a3({results:h,menuProps:f,labelKey:g,filters:a,filter:u,setFilter:m,onChange:n}),renderToken:h=>e.jsx(r3,{props:h,selected:c,setSelected:d,onChange:n})},"search")]})})},ph=(t,s)=>Array.from({length:s+1-t},(n,r)=>r+t),o3=async({envs:t,falcor:s,apiLoad:n})=>{if(!t||!Object.keys(t))return[];const r=await s.get(["uda",Object.keys(t),"sources","length"]);return(await Promise.all(Object.keys(t).map(async l=>{const i=ne(r,["json","uda",l,"sources","length"]);if(!i)return[];const c=await s.get(["uda",l,"sources","byIndex",{from:0,to:i-1},t[l].srcAttributes]),d=(u,m)=>ne(c,["json","uda",l,"sources","byIndex",u,m]);return ph(0,i-1).map(u=>{const m=d(u,"doc_type"),p=d(u,"app"),x=m?`${p}+${m}`:l;return{...t[l].srcAttributes.reduce((h,f)=>{var y;let g=d(u,f);return["metadata"].includes(f)?(g=(g==null?void 0:g.columns)||[],{...h,columns:g}):["config"].includes(f)?(g=((y=JSON.parse(g||"{}"))==null?void 0:y.attributes)||[],{...h,columns:g}):{...h,[f]:g}},{}),source_id:ne(c,["json","uda",l,"sources","byIndex",u,"$__path",4]),env:x,srcEnv:l,isDms:t[l].isDms}})}))).reduce((l,i)=>[...l,...i],[])},l3=async({envs:t,source:s,falcor:n,apiLoad:r})=>{if(!s||!s.srcEnv||!s.source_id)return[];const{srcEnv:a,source_id:l}=s,i=await n.get(["uda",a,"sources","byId",l,"views","length"]),c=ne(i,["json","uda",a,"sources","byId",l,"views","length"]);if(!c)return[];const d=await n.get(["uda",a,"sources","byId",l,"views","byIndex",{from:0,to:c-1},t[a].viewAttributes]);return ph(0,c-1).map(u=>({view_id:ne(d,["json","uda",a,"sources","byId",l,"views","byIndex",u,"$__path",4]),...t[a].viewAttributes.reduce((m,p)=>({...m,[p]:ne(d,["json","uda",a,"sources","byId",l,"views","byIndex",u,p])}),{})}))},Lo=({state:t,setState:s,formatFromProps:n,apiLoad:r,sourceTypes:a=["external","internal"]})=>{var y,v,j;const{app:l,siteType:i,falcor:c,pgEnv:d}=b.useContext(me),[u,m]=b.useState([]),[p,x]=b.useState([]);if(n!=null&&n.config)return null;const h={...a.includes("external")&&{[d]:{label:"external",srcAttributes:["name","metadata"],viewAttributes:["version","_modified_timestamp"]}},...a.includes("internal")&&{[`${l}+${i}`]:{label:"managed",isDms:!0,srcAttributes:["app","name","doc_type","config"],viewAttributes:["name","updated_at"]}}};b.useEffect(()=>{let N=!1;return o3({envs:h,falcor:c,apiLoad:r}).then(S=>{if(N)return;m(S||[]);const w=S.find(k=>{var $;return k.source_id===(($=t.sourceInfo)==null?void 0:$.source_id)});w&&!Ae(w.columns,t.sourceInfo.columns)&&s(k=>{k.sourceInfo={...k.sourceInfo,...w}})}),()=>{N=!0}},[l,i]),b.useEffect(()=>{let N=!1;return l3({envs:h,source:t.sourceInfo,falcor:c,apiLoad:r}).then(S=>{if(N)return;x(S);const w=S.find(k=>{var $;return k.view_id===(($=t.sourceInfo)==null?void 0:$.view_id)});if(w&&w.view_id!==t.sourceInfo.view_id){const{view_id:k,name:$,version:E,updated_at:M,_modified_timestamp:_}=w;s(L=>{L.sourceInfo={...L.sourceInfo,view_id:k,view_name:E||$,updated_at:_||M}})}}),()=>{N=!0}},[(y=t.sourceInfo)==null?void 0:y.source_id]);const f=u.map(({source_id:N,name:S,srcEnv:w})=>({key:N,label:`${S} (${h[w].label})`})),g=p.map(({view_id:N,name:S,version:w})=>({key:N,label:S||w||N}));return e.jsxs("div",{className:"flex w-full bg-white items-center",children:[e.jsx("label",{className:"p-1",children:"Source: "}),e.jsx("div",{className:"w-1/2",children:e.jsx(Ms,{className:"flex-row-reverse",placeholder:"Search...",options:f,value:(v=t.sourceInfo)==null?void 0:v.source_id,onChange:N=>{const{doc_type:S,...w}=u.find(k=>+k.source_id==+N)||{};s(k=>{k.columns=[],k.sourceInfo={...w},k.sourceInfo.type=S})}})}),e.jsx("label",{className:"p-1",children:"Version: "}),e.jsx("div",{className:"w-1/2",children:e.jsx(Ms,{className:"flex-row-reverse",placeholder:"Search...",options:g,value:(j=t.sourceInfo)==null?void 0:j.view_id,onChange:N=>{const S=p.find(w=>+w.view_id==+N);if(S){const{view_id:w,name:k,version:$,updated_at:E,_modified_timestamp:M}=S;s(_=>{_.sourceInfo={..._.sourceInfo,view_id:w,view_name:$||k,updated_at:M||E}})}}})})]})},Kl=({color:t,text:s,...n})=>{const r={orange:"bg-orange-500/15 text-orange-700 hover:bg-orange-500/25",blue:"bg-blue-500/15 text-blue-700 hover:bg-blue-500/25",gray:"text-gray-400"};return e.jsx("div",{className:"relative inline-flex rounded-md focus:outline-none hover:cursor-pointer",...n,children:e.jsx("span",{className:`inline-flex items-center gap-x-1.5 rounded-md px-1.5 py-0.5 text-sm/5 font-regular sm:text-xs/5 forced-colors:outline ${r[t]}`,children:s})})},Ra=t=>{if(t.type==="operation")return!t.left||!t.right?!1:Ra(t.left)&&Ra(t.right);if(t.type==="variable"){if(!t.key)return!1}else return!1;return!0},i3=[{operation:"+",Icon:Ix},{operation:"-",Icon:P4},{operation:"*",Icon:z4},{operation:"/",Icon:F4}],c3=[{operation:"(",Icon:()=>e.jsx(e.Fragment,{children:"("})},{operation:")",Icon:()=>e.jsx(e.Fragment,{children:")"})}],d3=({open:t,setOpen:s,columns:n,addFormulaColumn:r})=>{if(!t)return null;const[a,l]=st({formulaAST:{},formulaDisplay:[],astStack:[],variables:[],isValidFormula:!1}),i=u=>{l(m=>{m.formulaDisplay.push(u.type==="variable"?Cn(u):u.operation||u.group);let{formulaAST:p,astStack:x}=m;if(u.type==="grouping"){if(u.group==="("){x.push(JSON.parse(JSON.stringify(p))),m.formulaAST={type:"operation",left:null,operation:null,right:null};return}if(u.group===")"){if(x.length===0||!p.left)return;const h=x.pop();if(!h)return;h.type==="operation"&&!h.right&&(h.right=p,m.formulaAST=h);return}}if(u.type==="variable"){if(!p.left){m.formulaAST=u,m.variables.push(u);return}if(p.type==="operation"&&!p.right){p.right=u,m.variables.push(u);return}}if(u.type==="operation"){if(!p||Object.keys(p).length===0||p.type==="operation"&&!p.right)return;m.formulaAST={type:"operation",operation:u.operation,left:p};return}})},c=()=>{r({name:`${tn()}`,display_name:a.display_name,type:"formula",formula:a.formulaAST,variables:a.variables}),s(!1)},d=Ra(a.formulaAST);return console.log("Formula AST:",Ra(a.formulaAST),a.formulaAST),e.jsx("div",{className:"fixed inset-0 h-full w-full z-[100] content-center bg-black/40",onClick:()=>s(!1),children:e.jsxs("div",{className:"w-3/4 h-1/2 overflow-auto flex flex-col gap-3 p-4 bg-white place-self-center rounded-md",onClick:u=>u.stopPropagation(),children:[e.jsx("div",{className:"w-full flex justify-end",children:e.jsx("div",{className:"p-2 text-[#37576B] border border-[#E0EBF0] rounded-full cursor-pointer",onClick:()=>s(!1),children:e.jsx(Pr,{height:12,width:12})})}),e.jsx("div",{className:"text-lg font-semibold",children:"Add Formula Column"}),e.jsxs("div",{className:"flex w-full h-full px-2",children:[e.jsxs("div",{className:"w-1/4 h-full flex flex-col gap-1",children:[e.jsxs("div",{className:"flex gap-2 h-fit",children:[i3.map(({operation:u,Icon:m})=>e.jsx("div",{className:"cursor-pointer px-1 py-0.5 bg-gray-200 hover:bg-gray-300 rounded place-content-center",onClick:()=>i({type:"operation",operation:u}),children:e.jsx(m,{height:12,width:12})},u)),c3.map(({operation:u,Icon:m})=>e.jsx("div",{className:"cursor-pointer p-1 bg-gray-300 hover:bg-gray-400 rounded",onClick:()=>i({type:"grouping",group:u}),children:e.jsx(m,{})},u))]}),e.jsx("div",{className:"h-1/2 overflow-auto border-r pr-2",children:n.map(u=>e.jsx("div",{className:"cursor-pointer p-1 hover:bg-blue-100 rounded-md",onClick:()=>i({...u,type:"variable",key:u.normalName||u.name,display_name:Cn(u)}),children:Cn(u)},`${u.name}-${u.copyNum}`))})]}),e.jsxs("div",{className:"w-3/4 h-full px-2 flex flex-col gap-1",children:[e.jsx("input",{className:"p-1 text-gray-400",placeholder:"Please enter Formula Name...",value:a.display_name,onChange:u=>l(m=>{m.display_name=u.target.value})}),e.jsx("div",{className:"w-full min-h-[50px] p-2 border border-gray-400 flex gap-2 flex-wrap bg-gray-50 rounded-md",children:a.formulaDisplay.length>0?a.formulaDisplay.join(" "):e.jsx("span",{className:"text-gray-400",children:"Click on columns and operations to build formula..."})}),e.jsxs("div",{className:"flex gap-1 place-self-end",children:[e.jsx("button",{className:"px-3 py-1 bg-orange-500/15 text-orange-700 hover:bg-orange-500/25 rounded",onClick:()=>{l(u=>{u.formulaAST=[],u.formulaDisplay=[]})},children:"Clear"}),e.jsx("button",{disabled:!d,className:`px-3 py-1 ${d?"bg-blue-500/15 hover:bg-blue-500/25":"bg-gray-200"} text-blue-700 rounded`,onClick:c,children:"Add"})]})]})]})]})})},u3=({columns:t=[],addFormulaColumn:s})=>{const[n,r]=b.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Kl,{text:"+ Formula column",color:"blue",onClick:()=>r(!0)}),e.jsx(d3,{open:n,setOpen:r,columns:t,addFormulaColumn:s})]})},m3={2:{gridClass:"grid grid-cols-2",gridTemplateColumns:"10rem 3rem",width:"13rem"},3:{gridClass:"grid grid-cols-3",gridTemplateColumns:"10rem 5rem 3rem",width:"18rem"},4:{gridClass:"grid grid-cols-4",gridTemplateColumns:"10rem 5rem 5rem 3rem",width:"23rem"},5:{gridClass:"grid grid-cols-5",gridTemplateColumns:"10rem 5rem 5rem 5rem 3rem",width:"28rem"},6:{gridClass:"grid grid-cols-6",gridTemplateColumns:"10rem 5rem 5rem 5rem 5rem 3rem",width:"33rem"},7:{gridClass:"grid grid-cols-7",gridTemplateColumns:"10rem 5rem 5rem 5rem 5rem 5rem 3rem",width:"38rem"},8:{gridClass:"grid grid-cols-8",gridTemplateColumns:"10rem 5rem 5rem 5rem 5rem 5rem 5rem 3rem",width:"43rem"},9:{gridClass:"grid grid-cols-9",gridTemplateColumns:"10rem 5rem 5rem 5rem 5rem 5rem 5rem 5rem 3rem",width:"48rem"},10:{gridClass:"grid grid-cols-10",gridTemplateColumns:"10rem 5rem 5rem 5rem 5rem 5rem 5rem 5rem 5rem 3rem",width:"53rem"},11:{gridClass:"grid grid-cols-11",gridTemplateColumns:"10rem 5rem 5rem 5rem 5rem 5rem 5rem 5rem 5rem 5rem 3rem",width:"58rem"}};function p3({context:t}){var D;const{state:{columns:s=[],sourceInfo:n},setState:r,controls:a={}}=b.useContext(t||xt);if(!((D=a.columns)!=null&&D.length))return;const l=b.useRef(),i=b.useRef(),c=b.useRef(null),[d,u]=b.useState(),[m,p]=b.useState(!1),x="menu-btn-column-controls";Kt(c,x,()=>p(!1));const h=((n==null?void 0:n.columns)||[]).reduce((A,T)=>{const O=s.filter(B=>B.name===T.name);return[...A,...O.length?O:[T]]},[]).filter(A=>!d||Cn(A).toLowerCase().includes(d.toLowerCase()));s.some(A=>A.type==="formula")&&h.push(...s.filter(A=>A.type==="formula"));const f=(A,T)=>{l.current=T,A.dataTransfer.effectAllowed="move"},g=(A,T)=>{i.current=T},y=A=>{A.preventDefault(),A.dataTransfer.dropEffect="move"},v=A=>{const T=pe(n.columns),O=T[l.current];T.splice(l.current,1),T.splice(i.current,0,O),l.current=null,i.current=null,r(B=>{B.columns=T.map(F=>s.find(z=>z.name===F.name)).filter(F=>F),B.sourceInfo.columns=T})},j=b.useCallback((A,T,O,B)=>{r(F=>{var P,U;let z=F.columns.findIndex(R=>at(R,A));z===-1?(F.columns.push({...A,[T]:O}),z=F.columns.length-1):F.columns[z][T]=O,T==="show"&&O===!1?(F.columns[z].sort=void 0,F.columns[z].fn=void 0):T==="show"&&O===!0&&!F.columns[z].group&&F.columns.some(R=>!at(R,A)&&R.group)&&(F.columns[z].fn=((P=F.columns[z].defaultFn)==null?void 0:P.toLowerCase())||"list"),T==="group"&&O===!0&&(F.columns[z].fn=void 0,F.columns.filter(R=>!at(R,A)&&R.show&&!R.group&&!R.fn).forEach(R=>{var W;R.fn=((W=R.defaultFn)==null?void 0:W.toLowerCase())||"list"})),T==="group"&&O===!1&&F.columns.some(R=>!at(R,A)&&R.group)&&(F.columns[z].fn=((U=F.columns[z].defaultFn)==null?void 0:U.toLowerCase())||"list"),B&&B({key:T,value:O,attribute:A,state:F,columnIdx:z})})},[r,s]),N=b.useCallback((A=!0)=>{r(T=>{const O=T.columns.some(({group:B})=>B);(T.sourceInfo.columns||[]).forEach(B=>{var z;let F=T.columns.findIndex(P=>at(P,B));F===-1?(T.columns.push({...B,show:A}),F=T.columns.length-1):T.columns[F].show=A,A&&O&&!T.columns[F].group&&!T.columns[F].fn?T.columns[F].fn=((z=T.columns[F].defaultFn)==null?void 0:z.toLowerCase())||"list":A||(T.columns[F].sort=void 0,T.columns[F].fn=void 0)})})},[r]),S=b.useCallback(A=>r(T=>{const O=s.findIndex(B=>at(B,A));O!==-1&&T.columns.splice(O,1)}),[s]),w=b.useCallback(A=>r(T=>{var O;A.name&&A.formula&&T.columns.push(A),(O=A.variables)!=null&&O.length&&A.variables.forEach(B=>{var z;const F=T.columns.findIndex(P=>at(P,B));F!==-1&&!T.columns[F].group&&T.columns.some(P=>!at(P,B)&&P.group)&&!T.columns[F].fn&&(T.columns[F].fn=((z=T.columns[F].defaultFn)==null?void 0:z.toLowerCase())||"list")})}),[s]),k=b.useCallback(()=>r(A=>{A.columns=[],A.dataRequest={}}),[s]),$=2+a.columns.length,{gridClass:E,gridTemplateColumns:M,width:_}=m3[$],L=(n.columns||[]).map(({name:A})=>s.find(T=>T.name===A)).every(A=>A==null?void 0:A.show);return e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsxs("button",{id:x,className:`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular 
                 text-gray-900 shadow-sm ring-1 ring-inset ${s!=null&&s.length?"ring-blue-300":"ring-gray-300"} 
                 ${m?"bg-gray-50":"bg-white hover:bg-gray-50"} cursor-pointer`,onClick:()=>{p(!m),u(void 0)},children:["Columns ",e.jsx(rn,{id:x,height:18,width:18,className:"mt-1"})]}),e.jsxs("div",{ref:c,role:"menu",className:`${m?"visible transition ease-in duration-200":"hidden transition ease-in duration-200"} absolute left-0 z-10 w-[${_}] origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition focus:outline-none`,children:[e.jsx("input",{className:"px-4 py-1 w-full text-xs rounded-md",placeholder:"search...",onChange:A=>{u(A.target.value)}}),e.jsx("div",{className:"py-1 select-none",children:e.jsxs("div",{className:"flex items-center px-2 py-1 text-xs text-gray-700 hover:bg-gray-100 hover:text-gray-900",children:[e.jsx("div",{className:"h-4 w-4 m-1 text-gray-800",children:e.jsx("svg",{"data-v-4e778f45":"",className:"nc-icon cursor-move !h-3.75 text-gray-600 mr-1",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",children:e.jsx("path",{fill:"currentColor",d:"M8.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m0 6.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0M15.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1.5 8a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"})})}),e.jsxs("div",{className:`${E} gap-0.5 m-1 w-full`,style:{gridTemplateColumns:M},children:[e.jsx("div",{className:"place-self-stretch",children:"Column"}),a.columns.map(A=>e.jsx("div",{className:A.type==="toggle"?"justify-self-stretch":"px-1 w-fit rounded-md text-center",children:A.label},A.label)),e.jsx("div",{className:"justify-self-stretch",children:"Reset"})]})]},"header")}),e.jsx("div",{className:"py-1 select-none",children:e.jsxs("div",{className:"flex items-center px-2 py-1",children:[e.jsx("div",{className:"h-4 w-4 m-1 text-gray-800",children:e.jsx("svg",{"data-v-4e778f45":"",className:"nc-icon cursor-move !h-3.75 text-gray-600 mr-1",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",children:e.jsx("path",{fill:"currentColor",d:"M8.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m0 6.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0M15.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1.5 8a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"})})}),e.jsxs("div",{className:"flex gap-1 m-1 w-full",children:[a.columns.find(({key:A})=>A==="show")?e.jsx(Kl,{text:L?"Hide all":"Show all",color:"blue",onClick:()=>N(!L)}):null,e.jsx(u3,{columns:h,addFormulaColumn:w}),e.jsx(Kl,{text:"Reset all",color:"orange",onClick:()=>k()})]})]},"global-controls")}),e.jsx("div",{className:"py-1 max-h-[500px] overflow-auto scrollbar-sm",children:h.map((A,T)=>e.jsxs("div",{className:`flex items-center px-2 py-1 text-xs text-gray-700 ${Zl(A.name,h)?"bg-gray-50":""} hover:bg-gray-100 hover:text-gray-900`,onDragStart:O=>f(O,T),onDragEnter:O=>g(O,T),onDragOver:y,onDragEnd:v,draggable:A.show,children:[e.jsx("div",{className:"h-4 w-4 m-1 text-gray-800",children:e.jsx("svg",{"data-v-4e778f45":"",className:"nc-icon cursor-move !h-3.75 text-gray-600 mr-1",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",children:e.jsx("path",{fill:"currentColor",d:"M8.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m0 6.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0M15.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1.5 8a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"})})}),e.jsxs("div",{className:`${E} gap-0.5 m-1 w-full`,style:{gridTemplateColumns:M},children:[e.jsx("input",{className:"place-self-stretch",value:Cn(A),onChange:O=>j(A,"customName",O.target.value)},`${A.name}-${A.copyNum}`),a.columns.map((O,B)=>{const F=typeof O.disabled=="function"?O.disabled({attribute:A}):O.disabled;return e.jsx("div",{children:O.type==="select"?e.jsx("select",{className:`px-0.5 appearance-none w-fit rounded-md ${A[O.key]?"bg-blue-500/15 text-blue-700 hover:bg-blue-500/25":"bg-gray-100"} h-fit text-center cursor-pointer`,value:A[O.key],disabled:F,onChange:z=>j(A,O.key,z.target.value,O.onChange),children:O.options.map(({label:z,value:P})=>e.jsx("option",{value:P,children:z},P))},A[O.key]):O.type==="toggle"?e.jsx("div",{className:"justify-self-stretch",children:e.jsx(Zs,{size:"small",id:A[O.key],enabled:!!A[O.key],setEnabled:z=>F?null:j(A,O.key,z&&O.trueValue?O.trueValue:z,O.onChange)},A[O.key])},A[O.key]):typeof O.type=="function"?O.type({attribute:A,value:A[O.key],setValue:z=>j(A,O.key,z,O.onChange),setState:r}):`${O.type} not available`},`${O.key}-${B}`)}),e.jsx("button",{className:"w-fit place-self-end",onClick:()=>S(A),children:e.jsx(Vl,{className:"text-orange-500 hover:text-orange-700"})},"restore-btn")]})]},`${A.name}-${T}`))})]})]})}const Ls=({type:t,placeHolder:s,value:n,setValue:r,title:a,className:l,inputClassName:i,displayCdn:c=!0})=>r&&c?e.jsx("div",{children:e.jsxs("div",{className:l||`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular 
            text-gray-900 bg-white hover:bg-gray-50 cursor-pointer`,children:[e.jsx("span",{className:"flex-1 select-none mr-1",children:a}),e.jsx("input",{className:i||"p-0.5",type:t,placeholder:s,value:n,onChange:d=>r(t==="number"?+d.target.value:d.target.value),onWheel:d=>d.target.blur()})]})}):null;function x3({context:t}){var u;const{state:{display:s},setState:n,controls:r}=b.useContext(t||xt);if(!((u=r.more)!=null&&u.length))return;const a=b.useRef(null),[l,i]=b.useState(!1),c="menu-btn-more-controls";Kt(a,c,()=>i(!1));const d=b.useCallback((m,p,x)=>{n(h=>{h.display[m]=p,x&&x({key:m,value:p,state:h})})},[]);return e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsx("div",{children:e.jsxs("div",{id:c,className:`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 ${l?"bg-gray-50":"bg-white hover:bg-gray-50"} cursor-pointer`,onClick:m=>i(!l),children:["More ",e.jsx(rn,{id:c,height:18,width:18,className:"mt-1"})]})}),e.jsx("div",{ref:a,className:`${l?"visible transition ease-in duration-200":"hidden transition ease-in duration-200"} absolute left-0 z-10 w-72 origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition focus:outline-none`,children:e.jsx("div",{className:"py-1 text-sm max-h-[500px] overflow-auto scrollbar-sm",children:r.more.filter(({displayCdn:m})=>typeof m=="function"?m({display:s}):typeof m=="boolean"?m:!0).map(({type:m,inputType:p,label:x,key:h,options:f,onChange:g})=>m==="toggle"?e.jsx(it,{title:x,value:s[h],setValue:y=>d(h,y,g)},h):m==="input"?e.jsx(Ls,{type:p,title:x,value:s[h],setValue:y=>d(h,y)},h):m==="select"?e.jsxs("div",{className:"group inline-flex w-full justify-between items-center rounded-md px-1.5 py-1 text-sm font-regular text-gray-900 bg-white hover:bg-gray-50 cursor-pointer",children:[e.jsx("span",{className:"flex-0 select-none mr-1",children:x}),e.jsx("select",{className:"flex-1 p-1 w-full rounded-md bg-white group-hover:bg-gray-50 cursor-pointer",value:s[h],onChange:y=>d(h,y.target.value,g),children:f.map(({label:y,value:v})=>e.jsx("option",{value:v,children:y},v))})]},h):typeof m=="function"?m({value:s[h],setValue:y=>d(h,y)}):`${m} not available`)},"more")})]})}const h3={columns:p3,more:x3},xh=({context:t=xt})=>{const{controls:s={}}=b.useContext(t);return e.jsx("div",{className:"flex items-center",children:Object.keys(s).map(n=>{var a;const r=((a=s[n])==null?void 0:a.Comp)||h3[n];return r?e.jsx(r,{context:t},n):null})})},ei=(t,s)=>{var u,m,p,x,h,f,g,y,v,j,N,S,w,k,$,E,M,_;const n=Jt(t)?JSON.parse(t):{},r=(n==null?void 0:n.dataRequest)&&(n.columns||[]).filter(L=>Array.isArray(L.internalFilter)||Array.isArray(L.externalFilter)||Array.isArray(L.internalExclude)).map(L=>L.name);if(r!=null&&r.length)return n.columns=n.columns.map(L=>{var D,A,T;return{...L,internalFilter:void 0,externalFilter:void 0,...r.includes(L.name)&&{filters:[Array.isArray(L.internalFilter)?{type:"internal",operation:"filter",values:L.internalFilter,allowSearchParams:(D=n.display)==null?void 0:D.allowSearchParams,searchParamKey:L.name}:null,Array.isArray(L.externalFilter)?{type:"external",operation:"filter",values:L.externalFilter,allowSearchParams:(A=n.display)==null?void 0:A.allowSearchParams,searchParamKey:L.name}:null,Array.isArray(L.internalExclude)?{type:"internal",operation:"exclude",values:L.internalExclude,allowSearchParams:(T=n.display)==null?void 0:T.allowSearchParams,searchParamKey:L.name}:null].filter(O=>O)}}}),n.columns.find(L=>{var D;return Array.isArray(L.filters)&&((D=L.filters)==null?void 0:D.find(A=>A.allowSearchParams))})&&(n.data=[]),n;if(n!=null&&n.dataRequest)return n.columns.find(L=>{var D;return Array.isArray(L.filters)&&((D=L.filters)==null?void 0:D.find(A=>A.allowSearchParams))})&&(n.data=[]),n;if(!Array.isArray(n==null?void 0:n.attributes))return console.log("oldState",n),s;const a=(n.attributes||[]).map(L=>{var D,A,T,O,B,F,z,P;return{...L,show:(n.visibleAttributes||[]).includes(L.name),group:(n.groupBy||[]).includes(L.name),sort:(D=n.orderBy)==null?void 0:D[L.name],size:(A=n.colSizes)==null?void 0:A[L.name],customName:(T=n.customColNames)==null?void 0:T[L.name],fn:(O=n.fn)==null?void 0:O[L.name],excludeNA:(n.notNull||[]).includes(L.name),justify:(B=n.colJustify)==null?void 0:B[L.name],formatFn:(F=n.formatFn)==null?void 0:F[L.name],fontSize:(z=n.fontSize)==null?void 0:z[L.name],openOut:(n.openOutCols||[]).includes(L.name),hideHeader:(n.hideHeader||[]).includes(L.name),cardSpan:(P=n.cardSpan)==null?void 0:P[L.name]}}).filter(({show:L,group:D})=>L||D),l={pageSize:n.pageSize,allowSearchParams:n.allowSearchParams,loadMoreId:n.loadMoreId,showTotal:n.showTotal,striped:n.striped,usePagination:n.usePagination,allowEditInView:n.allowEditInView,allowDownload:n.allowDownload},i={app:(u=n.format)==null?void 0:u.app,type:(m=n.format)==null?void 0:m.type,isDms:(p=n.format)==null?void 0:p.isDms,env:(x=n.format)==null?void 0:x.env,srcEnv:(h=n.format)==null?void 0:h.srcEnv,source_id:(f=n.format)==null?void 0:f.id,view_id:typeof((g=n.format)==null?void 0:g.view_id)=="object"?(v=(y=n.format)==null?void 0:y.view_id)==null?void 0:v.id:(j=n.format)==null?void 0:j.view_id,view_name:((N=n.format)==null?void 0:N.version)||((S=n.format)==null?void 0:S.name),updated_at:((w=n.format)==null?void 0:w._modified_timestamp)||((k=n.format)==null?void 0:k.updated_at),columns:((E=($=n.format)==null?void 0:$.metadata)==null?void 0:E.columns)||((_=JSON.parse(((M=n==null?void 0:n.format)==null?void 0:M.config)||"{}"))==null?void 0:_.attributes)||[]},d={...a.reduce((L,D)=>((D.filters||[]).forEach(({type:A,operation:T,values:O})=>{L[T]={...L[T]||{},[D.name]:O}}),D.excludeNA&&(L.exclude=L.exclude&&L.exclude[D.name]?{...L.exclude,[D.name]:[...L.exclude[D.name],"null"]}:{...L.exclude||[],[D.name]:["null"]}),L),{}),groupBy:a.filter(L=>L.group).map(L=>L.name),orderBy:a.filter(L=>L.sort).reduce((L,D)=>({...L,[D.name]:D.sort}),{}),fn:a.filter(L=>L.fn).reduce((L,D)=>({...L,[D.name]:D.fn}),{}),meta:a.filter(L=>L.show&&["meta-variable","geoid-variable","meta"].includes(L.display)&&L.meta_lookup).reduce((L,D)=>({...L,[D.name]:D.meta_lookup}),{})};return{columns:a,display:l,sourceInfo:i,dataRequest:d,data:n.data||[]}},f3=()=>{const t={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};return new Date().toLocaleDateString(void 0,t)},xt=b.createContext({}),hh=t=>t||{columns:[],display:{allowSearchParams:!1,usePagination:!0,pageSize:5,totalLength:0,showGutters:!1,transform:"",loadMoreId:`id${tn()}`,showAttribution:!0},dataRequest:{},data:[],sourceInfo:{columns:[]}},Wd=async({state:t,apiLoad:s,loadAllColumns:n,setLoading:r})=>{var u;r(!0);const a=n?{...t,columns:[...t.columns,...t.sourceInfo.columns.filter(m=>!t.columns.find(p=>p.name===m.name))].map(m=>({...m,show:!0}))}:t,{data:l}=await br({state:a,apiLoad:s,fullDataLoad:!0}),i=a.columns.map(({name:m,display_name:p,customName:x})=>({column:x||p||m,value:h=>h==null?void 0:h[m]})),c=Object.keys(((u=t.dataRequest)==null?void 0:u.filter)||{}).length?JSON.stringify(t.dataRequest.filter):"",d=`${t.sourceInfo.view_name} - ${c} - ${f3()}`;await sp(l,{schema:i,fileName:`${d}.xlsx`}),r(!1)},fh=({state:t,apiLoad:s})=>{var m,p;const[n,r]=C.useState(!1),[a,l]=C.useState(!1),i=b.useRef(null),c=a?"loading":"download-btn",d=a?"LoadingHourGlass":"Download",u=(p=(m=t.dataRequest)==null?void 0:m.groupBy)==null?void 0:p.length;if(Kt(i,c,()=>r(!1)),!!t.display.allowDownload)return e.jsx("div",{className:"",children:e.jsxs("div",{className:"relative flex flex-col",children:[e.jsx("div",{className:"w-fit p-2 border rounded-full ",children:e.jsx(qe,{id:c,icon:d,className:`text-slate-400 hover:text-blue-500 size-4 ${a?"hover:cursor-wait":"hover:cursor-pointer"} transition ease-in-out duration-200`,onClick:()=>{!a&&r(!n)},title:a?"Processing...":"Excel Download"})}),e.jsxs("div",{ref:i,className:n?"absolute right-0 mt-4 p-0.5 text-xs text-nowrap select-none bg-white shadow-lg rounded-md z-[10]":"hidden",children:[e.jsx("div",{className:`px-1 py-0.5 hover:bg-blue-50 ${a?"hover:cursor-wait":"hover:cursor-pointer"} rounded-md`,onClick:()=>(r(!1),Wd({state:t,apiLoad:s,setLoading:l})),children:"Visible Columns"}),u?null:e.jsx("div",{className:`px-1 py-0.5 hover:bg-blue-50 ${a?"hover:cursor-wait":"hover:cursor-pointer"} rounded-md`,onClick:()=>(r(!1),Wd({state:t,apiLoad:s,setLoading:l,loadAllColumns:!0})),children:"All Columns"})]})]})})},g3=({value:t,onChange:s,pageFormat:n,apiLoad:r,apiUpdate:a,component:l,hideSourceSelector:i})=>{var $,E,M,_,L;const c=!!s,[d,u]=st(ei(t,hh(l.defaultState))),[m,p]=b.useState(!1),[x,h]=b.useState({}),[f,g]=b.useState(0),y=!!(d!=null&&d.dataRequest),v=b.useMemo(()=>l.EditComp,[l]);console.time("datawrapper edit render time"),b.useEffect(()=>{if(!y)return;let D=!1;const T={...d.columns.reduce((O,B)=>{const F=d.columns.filter(z=>{var P;return z.name===B.name&&((P=z.filters)==null?void 0:P.length)}).length>1;return(B.filters||[]).filter(({values:z})=>Array.isArray(z)&&z.every(P=>typeof P=="string"?P.length:typeof P!="object")).forEach(({type:z,operation:P,values:U,fn:R})=>{F?(O.normalFilter??(O.normalFilter=[])).push({column:B.name,values:U,operation:P,fn:R}):O[P]={...O[P]||{},[B.name]:U}}),B.excludeNA&&(O.exclude=O.exclude&&O.exclude[B.name]?{...O.exclude,[B.name]:[...O.exclude[B.name],"null"]}:{...O.exclude||[],[B.name]:["null"]}),O},{}),groupBy:d.columns.filter(O=>O.group).map(O=>O.name),orderBy:d.columns.filter(O=>O.sort).reduce((O,B)=>({...O,[B.name]:B.sort}),{}),fn:d.columns.filter(O=>O.fn).reduce((O,B)=>({...O,[B.name]:B.fn}),{}),meta:d.columns.filter(O=>O.show&&["meta-variable","geoid-variable","meta"].includes(O.display)&&O.meta_lookup).reduce((O,B)=>({...O,[B.name]:B.meta_lookup}),{})};if(!(D||Qe(T,d.dataRequest)))return u(O=>{O.dataRequest=T}),()=>{D=!0}},[d.columns,y]),b.useEffect(()=>{if(!y)return;let D=!1;async function A(){p(!0);const T=0,{length:O,data:B,invalidState:F}=await br({state:d,apiLoad:r,fullDataLoad:l.fullDataLoad});if(D){p(!1);return}u(z=>{z.data=B,z.display.totalLength=O,z.display.invalidState=F}),g(T),p(!1)}return A(),()=>{D=!0}},[d.columns.length,d.dataRequest,d.sourceInfo.source_id,d.sourceInfo.view_id,d.display.pageSize,y]);const j=D=>{if(!y||!l.useGetDataOnPageChange)return;async function A(){p(!0);const{length:T,data:O}=await br({state:d,currentPage:D,apiLoad:r});u(B=>{B.data=d.display.usePagination?O:[...B.data.filter(F=>!F.totalRow),...O],B.display.totalLength=T}),p(!1)}return A()};b.useEffect(()=>{if(!y||!l.useInfiniteScroll)return;const D=new IntersectionObserver(async T=>{const O=f*d.display.pageSize+d.display.pageSize<d.display.totalLength;d.data.length&&T[0].isIntersecting&&O&&(g(B=>B+1),await j(f+1))},{threshold:0}),A=document.querySelector(`#${d.display.loadMoreId}`);A&&!d.display.usePagination&&D.observe(A),A&&d.display.usePagination&&D.unobserve(A)},[($=d.display)==null?void 0:$.loadMoreId,(E=d.display)==null?void 0:E.totalLength,(M=d.data)==null?void 0:M.length,(_=d.display)==null?void 0:_.usePagination]),b.useEffect(()=>{!c||!y||s(JSON.stringify(d))},[d]);const N=(D,A,T)=>{var O;if((O=d.sourceInfo)!=null&&O.isDms){if(A!=null&&A.name)return u(B=>{const F=B.data.findIndex(z=>z.id===T.id);F!==-1&&(B.data[F]={...B.data[F]||{},...T,[A.name]:D})}),a({data:{...T,[A.name]:D},config:{format:d.sourceInfo}});{let B=Array.isArray(T)?T:[T],F=[...d.data];return B.map(z=>{const P=d.data.findIndex(U=>U.id===z.id);F[P]=z}),u(z=>{z.data=F}),Promise.all(B.map(z=>a({data:z,config:{format:d.sourceInfo}})))}}},S=()=>{var D;if((D=d.sourceInfo)!=null&&D.isDms)return u(A=>{A.data.push(x)}),a({data:x,config:{format:d.sourceInfo}})&&h({})},w=D=>{var A;if((A=d.sourceInfo)!=null&&A.isDms)return u(T=>{T.data=T.data.filter(O=>O.id!==D.id)}),a({data:D,config:{format:d.sourceInfo},requestType:"delete"})},k=b.useMemo(()=>{var D;return(D=d==null?void 0:d.columns)==null?void 0:D.filter(({group:A})=>A).length},[d==null?void 0:d.columns]);return e.jsx(xt.Provider,{value:{state:d,setState:u,apiLoad:r,compType:l.name.toLowerCase(),controls:l.controls},children:e.jsxs("div",{className:"w-full h-full",children:[i?null:e.jsx(Lo,{apiLoad:r,app:n==null?void 0:n.app,state:d,setState:u}),c?e.jsx(xh,{}):null,e.jsx(Io,{state:d,setState:u,apiLoad:r,isEdit:c,defaultOpen:!0}),e.jsxs("div",{className:"w-full flex items-center place-content-end",children:[m?e.jsx(qe,{id:"loading",icon:"LoadingHourGlass",className:"text-slate-400 hover:text-blue-500 size-4 transition ease-in-out duration-200"}):d.display.invalidState?e.jsx("span",{className:"text-red-500",children:d.display.invalidState}):null,e.jsx(fh,{state:d,apiLoad:r})]}),e.jsx(v,{isEdit:c,...["Spreadsheet","Card"].includes(l.name)&&{newItem:x,setNewItem:h,updateItem:N,removeItem:w,addItem:S,currentPage:f,loading:m,isEdit:c,allowEdit:((L=d.sourceInfo)==null?void 0:L.isDms)&&!k}}),e.jsxs("div",{children:[e.jsx(ch,{currentPage:f,setCurrentPage:D=>(g(D),j(D)),showPagination:l.showPagination}),d.display.showAttribution?e.jsx(uh,{}):null]})]})})},b3=({value:t,onChange:s,size:n,apiLoad:r,apiUpdate:a,component:l,...i})=>{var L,D,A,T,O,B;const[d,u]=st(ei(t,hh(l.defaultState))),[m,p]=b.useState({}),[x,h]=b.useState(!1),[f,g]=b.useState(0),y=b.useMemo(()=>{var F;return(F=d==null?void 0:d.columns)==null?void 0:F.filter(({group:z})=>z).length},[d==null?void 0:d.columns]),v=!((L=d==null?void 0:d.sourceInfo)!=null&&L.columns),j=d==null?void 0:d.dataRequest,N=b.useMemo(()=>l.ViewComp,[l]),S=b.useCallback(()=>u(F=>{F.display.readyToLoad=!0}),[u]);b.useEffect(()=>{const F=ei(t);u(F)},[t]);const w=b.useMemo(()=>d.columns.reduce((F,z)=>{const P=d.columns.filter(U=>{var R;return U.name===z.name&&((R=U.filters)==null?void 0:R.length)}).length>1;return(z.filters||[]).filter(({values:U})=>Array.isArray(U)&&U.every(R=>typeof R=="string"?R.length:typeof R!="object")).forEach(({type:U,operation:R,values:W,fn:V})=>{P?(F.normalFilter??(F.normalFilter=[])).push({column:z.name,values:W,operation:R,fn:V}):F[R]={...F[R]||{},[z.name]:W}}),z.excludeNA&&(F.exclude=F.exclude&&F.exclude[z.name]?{...F.exclude,[z.name]:[...F.exclude[z.name],"null"]}:{...F.exclude||[],[z.name]:["null"]}),F},{}),[d.columns]),k=b.useMemo(()=>d.columns.filter(F=>F.sort).reduce((F,z)=>({...F,[z.name]:z.sort}),{}),[d.columns]);b.useEffect(()=>{if(!j||!d.display.readyToLoad&&!d.display.allowEditInView)return;let F=!1;const z={...d.dataRequest||{},...w,orderBy:k,meta:d.columns.filter(P=>P.show&&["meta-variable","geoid-variable","meta"].includes(P.display)&&P.meta_lookup).reduce((P,U)=>({...P,[U.name]:U.meta_lookup}),{})};if(!(F||Qe(z,d.dataRequest)))return u(P=>{P.dataRequest=z}),()=>{F=!0}},[w,k,j,d.display.readyToLoad,d.display.allowEditInView]),b.useEffect(()=>{if(!j||!d.display.readyToLoad&&!d.display.allowEditInView)return;let F=!1;async function z(){h(!0);const P=0,{length:U,data:R}=await br({state:d,apiLoad:r,fullDataLoad:l.fullDataLoad});if(F){h(!1);return}u(W=>{W.data=R,W.display.totalLength=U}),g(P),h(!1)}return z(),()=>{F=!0}},[d==null?void 0:d.dataRequest,j,d.display.readyToLoad,d.display.allowEditInView]);const $=F=>{if(!j||!l.useGetDataOnPageChange||!d.display.readyToLoad&&!d.display.allowEditInView)return;async function z(){h(!0);const{length:P,data:U}=await br({state:d,currentPage:F,apiLoad:r});u(R=>{R.data=d.display.usePagination?U:[...R.data.filter(W=>!W.totalRow),...U],R.display.totalLength=P}),h(!1)}return z()};b.useEffect(()=>{if(!j||!l.useInfiniteScroll)return;const F=new IntersectionObserver(async P=>{const U=f*d.display.pageSize+d.display.pageSize<d.display.totalLength;d.data.length&&P[0].isIntersecting&&U&&(g(R=>R+1),await $(f+1))},{threshold:0}),z=document.querySelector(`#${d.display.loadMoreId}`);z&&!d.display.usePagination&&F.observe(z),z&&d.display.usePagination&&F.unobserve(z)},[(D=d==null?void 0:d.display)==null?void 0:D.loadMoreId,(A=d==null?void 0:d.display)==null?void 0:A.totalLength,(T=d==null?void 0:d.data)==null?void 0:T.length,(O=d==null?void 0:d.display)==null?void 0:O.usePagination,j]);const E=(F,z,P)=>{var U;if(!(!((U=d.sourceInfo)!=null&&U.isDms)||!a)){if(z!=null&&z.name)return u(R=>{const W=R.data.findIndex(V=>V.id===P.id);W!==-1&&(R.data[W]={...R.data[W]||{},...P,[z.name]:F})}),a({data:{...P,[z.name]:F},config:{format:d.sourceInfo}});{let R=Array.isArray(P)?P:[P],W=[...d.data];return R.map(V=>{const X=d.data.findIndex(q=>q.id===V.id);W[X]=V}),u(V=>{V.data=W}),Promise.all(R.map(V=>a({data:V,config:{format:d.sourceInfo}})))}}},M=()=>{var F;if(!(!((F=d.sourceInfo)!=null&&F.isDms)||!a))return u(z=>{z.data.push(m)}),a({data:m,config:{format:d.sourceInfo}})&&p({})},_=F=>{var z;if(!(!((z=d.sourceInfo)!=null&&z.isDms)||!a))return u(P=>{P.data=P.data.filter(U=>U.id!==F.id)}),a({data:F,config:{format:d.sourceInfo},requestType:"delete"})};return v||!j?e.jsx("div",{className:"p-1 text-center",children:"Form data not available."}):e.jsx(xt.Provider,{value:{state:d,setState:u,apiLoad:r,controls:l.controls},children:e.jsx("div",{className:"w-full h-full",children:e.jsxs("div",{className:"w-full",children:[e.jsx(Io,{state:d,setState:u,apiLoad:r,isEdit:!1,defaultOpen:!0}),e.jsxs("div",{className:"w-full flex items-center place-content-end",children:[x?e.jsx(qe,{id:"loading",icon:"LoadingHourGlass",className:"text-slate-400 hover:text-blue-500 size-4 transition ease-in-out duration-200"}):null,e.jsx(fh,{state:d,apiLoad:r})]}),e.jsx(N,{isEdit:!1,...["Spreadsheet","Card"].includes(l.name)&&{newItem:m,setNewItem:p,updateItem:E,removeItem:_,addItem:M,currentPage:f,loading:x,isEdit:!1,allowEdit:y?!1:((B=d.sourceInfo)==null?void 0:B.isDms)&&d.display.allowEditInView&&!!a}}),e.jsxs("div",{children:[e.jsx(ch,{currentPage:f,setCurrentPage:F=>(g(F),$(F)),setReadyToLoad:S,showPagination:l.showPagination}),d.display.showAttribution?e.jsx(uh,{}):null]})]})})})},Eo={EditComp:g3,ViewComp:b3},Vd="group px-2 py-1 w-full flex items-center cursor-pointer hover:bg-gray-100",ml="w-fit font-regular text-gray-500 cursor-default",Ud="w-full rounded-md bg-white group-hover:bg-gray-100 cursor-pointer",Vt=t=>t.normalName||t.name;function ac({isEdit:t,attribute:s,context:n}){var g,y;const{state:{columns:r=[],display:a},setState:l,controls:i={}}=b.useContext(n||xt);if(!((g=i.inHeader)!=null&&g.length))return;const c=b.useRef(null),[d,u]=b.useState(!1),m=`menu-btn-${Vt(s)}-in-header-column-controls`;Kt(c,m,()=>u(!1)),a.gridSize||r.filter(({show:v,cardSpan:j})=>v).length;const p=b.useCallback((v,j,N,S)=>l(w=>{const k=r.findIndex($=>Vt($)===Vt(s));k!==-1&&(w.columns[k][v]=j),N&&N({attribute:s,key:v,value:j,columnIdx:k}),S&&!w.display.readyToLoad&&(w.display.readyToLoad=!0)}),[r,s]),x="text-gray-400",h={width:14,height:14},f={count:e.jsx(Tx,{className:x,...h},"count-icon"),list:e.jsx(Ox,{className:x,...h},"list-icon"),sum:e.jsx(Dx,{className:x,...h},"sum-icon")};return e.jsxs("div",{className:"relative w-full",children:[e.jsxs("div",{id:m,className:"group inline-flex items-center w-full justify-between gap-x-1.5 rounded-md cursor-pointer",onClick:v=>u(!d),children:[(y=i.header)!=null&&y.displayFn?i.header.displayFn(s):e.jsx("span",{className:"truncate select-none",title:s.customName||s.display_name||Vt(s),children:s.customName||s.display_name||Vt(s)},`${Vt(s)}-name`),e.jsxs("div",{id:m,className:"flex items-center",children:[s.group?e.jsx(Bx,{className:x,...h},`group-${Vt(s)}`):s.fn?f[s.fn]||s.fn:null,s.sort==="asc nulls last"?e.jsx(Fx,{className:x,...h},"sort-asc-icon"):s.sort==="desc nulls last"?e.jsx(zx,{className:x,...h},"sort-desc-icon"):null,e.jsx(ds,{id:m,className:"text-gray-400 group-hover:text-gray-600 transition ease-in-out duration-200"},`arrow-down-${Vt(s)}`)]})]},"menu-btn"),e.jsx("div",{ref:c,className:`min-w-[180px]
                 ${d?"visible transition ease-in duration-200":"hidden transition ease-in duration-200"} 
                 absolute right-0 z-[10] divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition`,children:e.jsx("div",{className:"py-0.5 min-w-fit max-h-[500px] overflow-auto scrollbar-sm",children:e.jsx("div",{className:"flex flex-col gap-0.5 items-center px-1 py-1 text-xs text-gray-600 font-regular",children:i.inHeader.filter(({displayCdn:v})=>typeof v=="function"?v({attribute:s,display:a,isEdit:t}):typeof v=="boolean"?v:!0).map(({type:v,inputType:j,label:N,key:S,dataFetch:w,options:k,onChange:$})=>v==="select"?e.jsxs("div",{className:Vd,children:[e.jsx("label",{className:ml,children:N}),e.jsx("select",{className:Ud,value:s[S],onChange:E=>p(S,E.target.value,$,w),children:k.map(({label:E,value:M})=>e.jsx("option",{value:M,children:E},M))})]},`${Vt(s)}-${S}`):v==="toggle"?e.jsx("div",{className:"px-2 py-1 w-full rounded-md bg-white hover:bg-gray-100 cursor-pointer",children:e.jsx(it,{className:`inline-flex w-full justify-center items-center rounded-md cursor-pointer ${ml}`,title:N,value:s[S],setValue:E=>p(S,E,$,w)})}):v==="input"?e.jsxs("div",{className:Vd,children:[e.jsx("label",{className:ml,children:N}),e.jsx("input",{className:Ud,type:j,value:s[S],onChange:E=>p(S,E.target.value,$,w)})]}):typeof v=="function"?v({value:s[S],setValue:E=>p(S,E,$,w)}):`${v} not available`)})})},"menu")]},Vt(s))}function y3(t,s){b.useEffect(()=>{if(!s)return;function n(r){const a=r.clipboardData.getData("Text");a&&t(a,r)}return s.addEventListener("paste",n),()=>{s.removeEventListener("paste",n)}},[t,s])}function v3(t,s){b.useEffect(()=>{if(!s)return;function n(r){const a=t();return navigator.clipboard.writeText(a)}return s.addEventListener("copy",n),()=>{s.removeEventListener("copy",n)}},[t,s])}const w3=({e:t,dataLen:s,selection:n,setSelection:r,setIsSelecting:a,editing:l,setEditing:i,setTriggerSelectionDelete:c,visibleAttributes:d,pageSize:u,setIsDragging:m})=>{if(t.shiftKey){m(!0);let p=n[n.length-1],x=n.map(f=>f.attrI).filter(f=>f!==void 0).sort((f,g)=>f-g);x!=null&&x.length||(x=d.map((f,g)=>g)),x=[...new Set(x)].sort((f,g)=>f-g);let h=[...new Set(n.map(f=>f.index!==void 0?f.index:f))].sort((f,g)=>f-g);switch(typeof p=="number"&&(p={index:p,attrI:void 0}),t.key){case"ArrowUp":p.index>0&&r(f=>{const g=p.index-1,y=x.map(v=>({index:g,attrI:v}));return f.find(v=>v.index<=g)?f.filter(v=>!(v.index>g)):[...f,...y]});break;case"ArrowDown":p.index<s-1&&r(f=>{const g=p.index+1,y=x.map(v=>({index:g,attrI:v}));return f.find(v=>v.index>=g)?f.filter(v=>!(v.index<g)):[...f,...y]});break;case"ArrowLeft":p.attrI>0&&r(f=>{const g=p.attrI-1,y=h.map(v=>({index:v,attrI:g}));return f.find(v=>v.attrI<=g)?f.filter(v=>!(v.attrI>g)):[...f,...y]});break;case"ArrowRight":p.attrI<d.length-1&&r(f=>{const g=p.attrI+1,y=h.map(v=>({index:v,attrI:g}));return f.find(v=>v.attrI>=g)?f.filter(v=>!(v.attrI<g)):[...f,...y]});break}}else if(t.ctrlKey)a(!0);else if(t.key==="Delete")c(!0);else if(t.key==="Escape")r([]);else if(t.key.includes("Arrow")){let{index:p,attrI:x}=typeof n[n.length-1]=="number"?{index:n[n.length-1],attrI:void 0}:n[n.length-1];switch(t.key){case"ArrowUp":p>0&&r([{index:p-1,attrI:x||0}]),i({});break;case"ArrowDown":p<Math.min(u,s)-1&&r([{index:p+1,attrI:x||0}]),i({});break;case"ArrowLeft":x>0&&r([{index:p,attrI:x-1}]),i({});break;case"ArrowRight":x<d.length-1&&r([{index:p,attrI:x+1}]),i({});break}}else if(t.key==="Enter"){let{index:p,attrI:x}=typeof n[n.length-1]=="number"?{index:n[n.length-1],attrI:void 0}:n[n.length-1];p===l.index&&x===l.attrI?(i({}),r([{index:p+1,attrI:x}])):i({index:p,attrI:x})}},j3=({e:t,index:s,attrI:n,setSelection:r,setIsDragging:a,startCellCol:l,startCellRow:i,selection:c})=>{if(n!==void 0){r([{index:s,attrI:n}]),a(!0),i.current=s,l.current=n;return}n===void 0&&(t.ctrlKey?(t.preventDefault(),r(c.includes(s)?c.filter(d=>d!==s):[...c,s]),a(!0),i.current=s):(r([s]),a(!0),i.current=s))},C3=({e:t,index:s,attrI:n,isDragging:r,startCellCol:a,startCellRow:l,setSelection:i})=>{if(n!==void 0&&r){const c=[l.current,s].sort((m,p)=>m-p),d=[a.current,n].sort((m,p)=>m-p),u=[];for(let m=c[0];m<=c[1];m++)for(let p=d[0];p<=d[1];p++)u.push({index:m,attrI:p});i(u);return}if(r){const c=s,d=[l.current,c].sort((m,p)=>m-p),u=[];for(let m=d[0];m<=d[1];m++)u.push(m);i(u)}},qd=({setIsDragging:t})=>{t(!1)},N3=30,gh=20,bh=20,k3=150,$3=150,S3=({icon:t,name:s})=>t?zs[t]:()=>s,_3=({newItem:t={},removeItem:s=()=>{},columns:n=[],action:r={}})=>{const a=n.filter(({name:d,group:u})=>u&&t[d]).map(({name:d})=>({column:d,values:[t[d]]})),l=n.filter(({internalFilter:d,externalFilter:u})=>Array.isArray(d)||Array.isArray(u)).map(({name:d,internalFilter:u=[],externalFilter:m=[]})=>({column:d,values:bs([...u,...m])})),i=a.length?QC([...a,...l],"|||"):`id=${t.id}`,c=S3({name:r.name,icon:r.icon||r.type==="delete"&&"TrashCan"});return r.actionType==="url"?e.jsx(ue,{title:r.name,className:"flex items-center w-fit p-0.5 mx-0.5 bg-blue-300 hover:bg-blue-500 text-white rounded-lg",to:`${r.url}?${i}`,children:e.jsx(c,{className:"text-white"})},`${r.name}`):a.length?null:e.jsx("button",{title:"delete",className:"w-fit p-0.5 mx-0.5 bg-red-300 hover:bg-red-500 text-white rounded-lg",onClick:d=>{s(t)},children:e.jsx(c,{className:"text-white"})},"delete")},I3=({value:t,className:s})=>e.jsx("div",{className:s,children:t}),L3=({className:t})=>e.jsx("div",{className:t,children:"loading..."}),E3=({attribute:t,columns:s,newItem:n,removeItem:r,value:a,Comp:l})=>{const{actionType:i,location:c,linkText:d,isLink:u,useId:m}=t;if(u){const p=t.searchParams==="id"?encodeURIComponent(n.id):t.searchParams==="value"?encodeURIComponent(a):"",x=`${c||a}${p}`;return h=>e.jsx(ue,{...h,to:x,children:d||a})}return i?p=>e.jsx(_3,{...p,action:t,newItem:n,removeItem:r,columns:s}):l},M3=({value:t,required:s,options:n,name:r})=>{const a=!s||s&&t&&t!=="",l=!n||!(n!=null&&n.length)||(Array.isArray(n)&&!t&&!s?!0:Array.isArray(n)&&(typeof t=="string"||typeof t=="boolean")?n.map(i=>i.value||i).includes(t.toString()):Array.isArray(n)&&Array.isArray(t)?t.reduce((i,c)=>i&&n.map(d=>d.value||d).includes(c.value||c),!0):!1);return a&&l},pl=({showOpenOutCaret:t,showOpenOut:s,setShowOpenOut:n,attribute:r,colSpan:a,openOutTitle:l,i,item:c,updateItem:d,removeItem:u,onPaste:m,isFrozen:p,isSelected:x,isSelecting:h,editing:f,edge:g,loading:y,allowEdit:v,onClick:j,onDoubleClick:N,onMouseDown:S,onMouseMove:w,onMouseUp:k})=>{var Q,Y,H,J,G,se;const{state:{columns:$,display:E},setState:M}=b.useContext(xt),{theme:_={table:Hr}}=C.useContext(me)||{},[L,D]=b.useState(c),A=L[r.normalName]||L[r.name],T=r.type==="calculated"&&Array.isArray(A)?"multiselect":r.type,O=r.type==="calculated"&&Array.isArray(A)?"ViewComp":f&&v?"EditComp":"ViewComp",B=y?L3:((Q=Ue[T])==null?void 0:Q[O])||I3,F=E3({attribute:r,columns:$,newItem:L,removeItem:u,value:A,Comp:B}),z=r.formatFn&&At[r.formatFn.toLowerCase()]?At[r.formatFn.toLowerCase()](A,r.isDollar):A,P={left:"justify-start",right:"justify-end",center:"justify-center"},U=r.formatFn==="title"?"capitalize":"",R="#2100f8",W={top:{borderTopColor:R},bottom:{borderBottomColor:R},left:{borderLeftColor:R},right:{borderRightColor:R},"top-left":{borderTopColor:R,borderLeftColor:R},"top-right":{borderTopColor:R,borderRightColor:R},"bottom-left":{borderBottomColor:R,borderLeftColor:R},"bottom-right":{borderBottomColor:R,borderRightColor:R},ltr:{borderTopColor:R,borderLeftColor:R,borderRightColor:R},lbr:{borderBottomColor:R,borderLeftColor:R,borderRightColor:R},tlb:{borderTopColor:R,borderLeftColor:R,borderBottomColor:R},trb:{borderTopColor:R,borderRightColor:R,borderBottomColor:R},x:{borderLeftColor:R,borderRightColor:R},y:{borderTopColor:R,borderBottomColor:R},all:{borderColor:R}};b.useEffect(()=>D(c),[c]),b.useEffect(()=>{f&&v&&(Qe(A,c[r.name])||d(void 0,void 0,L))},[A]);const V=["multiselect","select","radio"].includes(r.type)||r.required==="yes"?M3({value:A,options:r.options,required:r.required==="yes"}):!0,X=L.totalRow,q=l||r.openOut?"":V?X?"bg-gray-100":E.striped&&i%2!==0?"bg-gray-50 hover:bg-gray-100":x?"bg-blue-50 hover:bg-blue-100":"bg-white bg-blue-50":"bg-red-50 hover:bg-red-100";return e.jsxs("div",{className:r.openOut||l?"":`
                ${_==null?void 0:_.table.cell} 
                ${p?(Y=_==null?void 0:_.table)==null?void 0:Y.cellFrozenCol:""} 
                ${h?"select-none":""}
                ${V?x?_==null?void 0:_.table.cellBgSelected:_==null?void 0:_.table.cellBg:q}
            `,style:{...!(r.openOut||l)&&{width:r.size},...x&&{borderWidth:"1px",...W[g]}},onClick:r.isLink||r.actionType?void 0:j,onMouseDown:r.isLink||r.actionType?void 0:S,onMouseMove:r.isLink||r.actionType?void 0:w,onMouseUp:r.isLink||r.actionType?void 0:k,onDoubleClick:r.isLink||r.actionType?void 0:N,onPaste:m,children:[t?e.jsx("div",{className:"px-2 cursor-pointer",onClick:()=>{n(!s)},children:e.jsx(vx,{className:"bg-transparent text-gray-500 group-hover:text-gray-600",title:"Hide Open Out",width:18,height:18})}):null,r.openOut?e.jsx("span",{className:(H=_==null?void 0:_.table)==null?void 0:H.openOutHeader,children:r.customName||r.display_name||r.name}):null,e.jsx(F,{onClick:j,autoFocus:f,className:`
                    ${l?(J=_==null?void 0:_.table)==null?void 0:J.openOutTitle:r.openOut?(G=_==null?void 0:_.table)==null?void 0:G.openOutValue:(se=_==null?void 0:_.table)==null?void 0:se.cellInner} 
                    ${P[r.justify]} 
                    ${q}
                    ${l?"":(r.type==="multiselect"&&(A!=null&&A.length)||r.type==="multiselect"&&!(A!=null&&A.length),"p-0.5")} 
                  ${U}
                  `,...r,value:z,onChange:le=>X?null:D({...L,[r.name]:le})},`${r.name}-${i}`)]})},A3=({startI:t,endI:s,startCol:n,endCol:r},a,l)=>t===s&&n===r?"all":n===r&&t===a?"ltr":n===r&&s===a?"lbr":n===r&&t!==a&&s!==a?"x":t===s&&l===n?"tlb":t===s&&l===r?"trb":t===s&&n!==l&&r!==l?"y":t===a&&n===l?"top-left":t===a&&r===l?"top-right":t===a&&n!==l&&r!==l?"top":s===a&&n===l?"bottom-left":s===a&&r===l?"bottom-right":s===a&&n!==l&&r!==l?"bottom":n===l&&t!==a&&s!==a?"left":r===l&&t!==a&&s!==a?"right":"",T3=({frozenCols:t,i:s,d:n,allowEdit:r,isDragging:a,isSelecting:l,editing:i,setEditing:c,loading:d,selection:u,setSelection:m,selectionRange:p,triggerSelectionDelete:x,handleMouseDown:h,handleMouseMove:f,handleMouseUp:g,setIsDragging:y,startCellCol:v,startCellRow:j,updateItem:N,removeItem:S})=>{var F;const{state:{columns:w,display:k},setState:$}=b.useContext(xt),{theme:E={table:Hr}}=C.useContext(me)||{},[M,_]=b.useState(!1),L=b.useMemo(()=>w.filter(({show:z})=>z),[w]),D=L.filter(({openOut:z,actionType:P})=>!z||P),A=D.length,T=L.filter(({openOut:z})=>z),O=k.showGutters?gh:0,B=k.showGutters?bh:0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`${n.totalRow?"sticky bottom-0 z-[1]":""} grid
                             ${a?"select-none":""} 
                            ${k.striped?"odd:bg-gray-50":""} ${n.totalRow?"bg-gray-100":""}`,style:{gridTemplateColumns:`${O}px ${D.map(z=>`${z.size}px`||"auto").join(" ")} ${B}px`,gridColumn:`span ${D.length+2} / ${D.length+2}`},children:[e.jsx("div",{className:` flex text-xs items-center justify-center cursor-pointer sticky left-0 z-[1]
                             ${u.find(z=>(z.index!==void 0?z.index:z)===s)?"bg-blue-100 text-gray-900":"bg-gray-50 text-gray-500"}`,style:{width:O},onClick:z=>{z.ctrlKey?m(u.includes(s)?u.filter(P=>P!==s):[...u,s]):m([s])},onMouseDown:z=>h({e:z,index:s,setSelection:m,setIsDragging:y,startCellCol:v,startCellRow:j,selection:u}),onMouseMove:z=>f({e:z,index:s,isDragging:a,startCellCol:v,startCellRow:j,setSelection:m}),onMouseUp:z=>g({setIsDragging:y}),children:k.showGutters&&(n.totalRow?"T":s+1)},"#"),D.map((z,P)=>e.jsx(pl,{showOpenOutCaret:T.length&&P===0,showOpenOut:M,setShowOpenOut:_,isSelecting:l,isSelected:u.find(U=>U.index===s&&U.attrI===P)||u.includes(s),isFrozen:t.includes(P),edge:u.find(U=>U.index===s&&U.attrI===P)||u.includes(s)?A3(p,s,P):null,editing:i.index===s&&i.attrI===P,triggerDelete:x,attribute:z,loading:d,updateItem:N,removeItem:S,i:s,item:n,onMouseDown:U=>h({e:U,index:s,attrI:P,setSelection:m,setIsDragging:y,startCellCol:v,startCellRow:j,selection:u}),onMouseMove:U=>f({e:U,index:s,attrI:P,isDragging:a,startCellCol:v,startCellRow:j,setSelection:m}),onMouseUp:U=>g({setIsDragging:y}),onClick:()=>{m([{index:s,attrI:P}]),c({index:s,attrI:P})},onDoubleClick:()=>{},allowEdit:r},`cell-${s}-${P}`)),e.jsx("div",{className:"flex items-center border",children:e.jsxs("div",{className:"bg-gray-50 h-full flex shrink-0 justify-between",style:{width:O},children:[" "," "]},"##")})]},`data-${s}`),M?e.jsx("div",{className:(F=E==null?void 0:E.table)==null?void 0:F.openOutContainerWrapper,style:{backgroundColor:"#00000066"},onClick:()=>_(!1),children:e.jsxs("div",{className:"w-[330px] overflow-auto scrollbar-sm flex flex-col gap-[12px] p-[16px] bg-white h-full float-right",onClick:z=>z.stopPropagation(),children:[e.jsx("div",{className:"w-full flex justify-end",children:e.jsx("div",{className:"w-fit h-fit p-[8px] text-[#37576B] border border-[#E0EBF0] rounded-full cursor-pointer",onClick:()=>_(!1),children:e.jsx(Pr,{height:16,width:16})})}),e.jsx(pl,{attribute:D[0],openOut:!0,loading:d,i:s,item:n,openOutTitle:!0},"open-out-title"),T.map((z,P)=>{const U=A+1+P;return e.jsx("div",{className:"",children:e.jsx(pl,{editing:i.index===s&&i.attrI===U,attribute:z,openOut:!0,loading:d,updateItem:N,removeItem:S,i:s,item:n,allowEdit:r},`cell-${s}-${U}`)},`data-open-out-${s}`)})]})}):null]})},yh=({onClick:t,icon:s})=>{const[n,r]=b.useState(!1),[a,l]=b.useState(""),i=s?zs[s]:()=>e.jsx("span",{children:"icon"});return e.jsxs("div",{className:"p-1 bg-white border rounded-md",children:[e.jsxs("button",{type:"button",className:"flex w-full justify-between items-center bg-white rounded-md shadow-sm",id:"dropdown-button",onClick:()=>r(!n),children:[e.jsx(i,{}),e.jsx(rn,{width:15,height:15})]}),e.jsxs("div",{className:n?"grid grid-cols-5 gap-2 absolute z-10 mt-2 w-full bg-white border border-gray-300 rounded-md shadow-lg":"hidden",role:"menu",children:[e.jsx("input",{className:"p-1 mx-1 text-sm rounded-md col-span-5",placeholder:"search...",value:a,onChange:c=>l(c.target.value)},"search"),Object.keys(zs).filter(c=>c.toLowerCase().includes(a.toLowerCase())).sort((c,d)=>c.localeCompare(d)).map(c=>{const d=zs[c];return e.jsx("button",{className:"flex items-center justify-center w-full px-1 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md",role:"menuitem",onClick:()=>t(c),children:e.jsx(d,{height:16,width:16})},c)})]})]})},O3=({actions:t,updateAction:s,deleteAction:n,action:r={}})=>{const[a,l]=b.useState(!1),[i,c]=b.useState(r);return e.jsx("div",{className:"w-full",children:a?e.jsxs("div",{className:"flex flex-col w-full px-2 py-1 text-gray-500",children:[e.jsx("input",{className:"px-1 my-0.5 border w-full rounded-md cursor-disabled",disabled:!0,placeholder:"name",value:i.name||""}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(yh,{icon:i.icon,onClick:d=>c({...i,icon:d})}),e.jsx("select",{className:"p-1 bg-white border rounded-md",value:i.display,onChange:d=>c({...i,display:d.target.value}),children:[void 0,"edit only","view only","both"].map(d=>e.jsx("option",{value:d,children:d||"display"},d||"default"))}),e.jsx("select",{className:"p-1 bg-white border rounded-md",value:i.actionType,onChange:d=>c({...i,actionType:d.target.value}),children:[void 0,"delete","url"].map(d=>e.jsx("option",{value:d,children:d||"type"},d||"default"))})]}),e.jsxs("div",{className:"my-0.5 flex w-full justify-end",children:[i.type==="url"?e.jsx("input",{className:"px-1 border w-full rounded-md",placeholder:"url",value:i.url||"",onChange:d=>c({...i,url:d.target.value})}):null,e.jsxs("div",{children:[e.jsx("button",{className:"px-1 border rounded-md place-self-end",onClick:()=>{s(i),l(!1)},children:"save"}),e.jsx("button",{className:"px-1 border rounded-md place-self-end",onClick:()=>{l(!1)},children:"cancel"})]})]})]}):e.jsxs("div",{className:"flex items-center cursor-pointer px-2 mx-1 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 rounded-md",children:[e.jsx("div",{className:"h-4 w-4 m-0.5 cursor-pointer text-gray-800",children:e.jsx(lx,{height:14,width:14})},"icon"),e.jsxs("div",{className:"grid grid-cols-3 m-1 w-full",children:[r.name,e.jsx("button",{className:"p-0.5 m-0.5 text-gray-500 text-sm border rounded-md ",onClick:()=>l(!a),children:a?"cancel":"edit"},"action-edit"),e.jsx("button",{className:"p-0.5 m-0.5 text-gray-500 text-sm border rounded-md ",onClick:()=>n(r),children:"delete"},"action-delete")]},`${r.name}`)]})})},D3=({addAction:t})=>{const s={show:!0,actionType:"",name:"",url:""},[n,r]=b.useState(!1),[a,l]=b.useState(s);return e.jsxs("div",{className:"w-full flex flex-col justify-end",children:[e.jsx("button",{className:"w-fit p-0.5 m-0.5 text-gray-500 text-sm border place-self-end rounded-md",onClick:()=>r(!n),children:"+ add new"}),n?e.jsxs("div",{className:"flex flex-col w-full px-2 py-1 text-gray-500",children:[e.jsx("input",{className:"px-1 my-0.5 border w-full rounded-md",placeholder:"name",value:a.name,onChange:i=>l({...a,name:i.target.value})}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(yh,{icon:a.icon,onClick:i=>l({...a,icon:i})}),e.jsx("select",{className:"p-1 bg-white border rounded-md",value:a.display,onChange:i=>l({...a,display:i.target.value}),children:[void 0,"edit only","view only","both"].map(i=>e.jsx("option",{value:i,children:i||"display"},i||"default"))}),e.jsx("select",{className:"p-1 bg-white border rounded-md",value:a.actionType,onChange:i=>l({...a,actionType:i.target.value}),children:[void 0,"delete","url"].map(i=>e.jsx("option",{value:i,children:i||"type"},i||"default"))})]}),e.jsxs("div",{className:"my-0.5 flex w-full justify-end",children:[["url"].includes(a.actionType)?e.jsx("input",{className:"px-1 border w-full rounded-md",placeholder:"url",value:a.url,onChange:i=>l({...a,url:i.target.value})}):null,e.jsx("button",{className:"px-1 border rounded-md place-self-end",onClick:()=>{t(a),l(s)},children:"add"}),e.jsx("button",{className:"px-1 border rounded-md place-self-end",onClick:()=>{r(!1),l(s)},children:"cancel"})]})]}):null]})};function B3({context:t}){const{state:{columns:s},setState:n}=b.useContext(t||xt),r=b.useRef(null),[a,l]=b.useState(),[i,c]=b.useState(!1),d="menu-btn-action-controls",u=s.filter(h=>h.actionType);Kt(r,d,()=>c(!1));const m=b.useCallback((h={})=>{n(f=>{const g=f.columns.findIndex(y=>y.name===h.name&&y.actionType);g!==-1?f.columns[g]=h:f.columns.push(h)})},[s]),p=b.useCallback((h={})=>{n(f=>{const g=f.columns.findIndex(y=>y.actionType&&y.name===h.name);g!==-1&&f.columns.splice(g,1)})},[s]),x=b.useCallback((h={})=>{n(f=>{f.columns.push(h)})},[s]);return e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsx("div",{children:e.jsxs("div",{id:d,className:`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular 
                    text-gray-900 shadow-sm ring-1 ring-inset ${u.length?"ring-blue-300":"ring-gray-300"} 
                    ${i?"bg-gray-50":"bg-white hover:bg-gray-50"} cursor-pointer`,onClick:h=>c(!i),children:["Action ",e.jsx(rn,{id:d,height:18,width:18,className:"mt-1"})]})}),e.jsxs("div",{ref:r,className:`${i?"visible transition ease-in duration-200":"hidden transition ease-in duration-200"} absolute left-0 z-10 w-72 origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition focus:outline-none`,children:[e.jsx("input",{className:"px-3 py-1 w-full rounded-md",placeholder:"search...",onChange:h=>l(h.target.value)},"search"),e.jsx(D3,{ket:"add-action",actions:u,addAction:x}),e.jsx("div",{className:"py-1 max-h-[500px] overflow-auto scrollbar-sm",children:u.filter(h=>h&&(!a||h.name.toLowerCase().includes(a.toLowerCase()))).map((h,f)=>e.jsx(O3,{action:h,actions:u,updateAction:m,deleteAction:p},f))},"actions")]})]})}const xl=t=>{let{index:s,attrI:n}=typeof t=="number"?{index:t,attrI:void 0}:t;return{index:s,attrI:n}},F3=({pastedContent:t,e:s,index:n,attrI:r,data:a,visibleAttributes:l,updateItem:i})=>{const c=t==null?void 0:t.split(`
`).filter(p=>p.length).map(p=>p.split("	"));if(!c)return;const d=[...new Array(c.length).keys()].map(p=>n+p).filter(p=>p<a.length),u=[...new Array(c[0].length).keys()].map(p=>l[r+p]).filter(p=>p),m=d.map((p,x)=>({...a[p],...u.reduce((h,f,g)=>({...h,[f]:c[x][g]}),{})}));i(void 0,void 0,m)},Gd=[0,1],z3="",Hr={tableContainer:"flex flex-col overflow-x-auto",tableContainerNoPagination:"",tableContainer1:"flex flex-col no-wrap min-h-[40px] max-h-[calc(78vh_-_10px)] overflow-y-auto",headerContainer:"sticky top-0 grid",thead:"flex justify-between",theadfrozen:"",thContainer:"w-full font-semibold px-3 py-1 text-sm font-semibold text-gray-600 border",thContainerBgSelected:"bg-blue-100 text-gray-900",thContainerBg:"bg-gray-50 text-gray-500",cell:"relative flex items-center min-h-[35px]  border border-slate-50",cellInner:`
        w-full min-h-full flex flex-wrap items-center truncate py-0.5 px-1
        font-[400] text-[14px]  leading-[18px] text-slate-600
    `,cellBg:"bg-white",cellBgSelected:"bg-blue-50",cellFrozenCol:"",paginationInfoContainer:"",paginationPagesInfo:"font-[500] text-[12px] uppercase text-[#2d3e4c] leading-[18px]",paginationRowsInfo:"text-xs",paginationContainer:"w-full p-2 flex items-center justify-between",paginationControlsContainer:"flex flex-row items-center overflow-hidden gap-0.5",pageRangeItem:"cursor-pointer px-3  text-[#2D3E4C] py-1  text-[12px] hover:bg-slate-50 font-[500] rounded  uppercase leading-[18px]",pageRangeItemInactive:"",pageRangeItemActive:"bg-slate-100 ",openOutContainerWrapper:"fixed inset-0 right-0 h-full w-full z-[100]",openOutHeader:"font-semibold text-gray-600"},Jd=({isEdit:t,updateItem:s,removeItem:n,addItem:r,newItem:a,setNewItem:l,loading:i,allowEdit:c})=>{var W,V,X,q,Q,Y;const{theme:d={table:Hr}}=C.useContext(me)||{},{state:{columns:u,sourceInfo:m,display:p,data:x},setState:h}=b.useContext(xt),f=b.useRef(null),[g,y]=b.useState(!1),[v,j]=b.useState({}),[N,S]=b.useState([]),[w,k]=b.useState(!1),[$,E]=b.useState(!1),M=b.useRef(null),_=b.useRef(null),L=b.useMemo(()=>{const H=[...new Set(N.map(G=>(G==null?void 0:G.index)!==void 0?G.index:G))].sort((G,se)=>G-se),J=[...new Set(N.map(G=>G.attrI).sort((G,se)=>G-se)||u.filter(({show:G})=>G).map((G,se)=>se))];return{startI:H[0],endI:H[H.length-1],startCol:J[0],endCol:J[J.length-1]}},[N]),D=b.useMemo(()=>u.filter(({show:H})=>H),[u]),A=b.useMemo(()=>u.filter(({show:H})=>H).length,[u]);b.useMemo(()=>u.filter(({openOut:H})=>H),[u]);const T=b.useMemo(()=>u.filter(({openOut:H})=>H).length,[u]),O=b.useMemo(()=>u.filter(({show:H,openOut:J})=>H&&!J),[u]),B=b.useMemo(()=>u.filter(({show:H,openOut:J})=>H&&!J).length,[u]),F=b.useMemo(()=>u.filter(({actionType:H})=>H),[u]),z=p.usePagination&&Math.ceil(p.totalLength/p.pageSize)>1,P=p.showGutters?gh:0,U=p.showGutters?bh:0;y3((H,J)=>{let{index:G,attrI:se}=typeof N[N.length-1]=="number"?{index:N[N.length-1],attrI:void 0}:N[N.length-1];F3({pastedContent:H,e:J,index:G,attrI:se,data:x,visibleAttributes:D,updateItem:s})},f.current),v3(()=>Object.values(N.sort((H,J)=>{const{index:G,attrI:se}=xl(H),{index:le,attrI:ce}=xl(J);return G-le||se-ce}).reduce((H,J)=>{const{index:G,attrI:se}=xl(J);return H[G]=H[G]?`${H[G]}	${x[G][D[se]]}`:x[G][D[se]],H},{})).join(`
`),f.current),b.useEffect(()=>{if(!f.current)return;const H=O.filter(({size:se})=>se).length,J=f.current.offsetWidth-P-U-(c?F.length*N3:0),G=O.reduce((se,{size:le})=>se+ +(le||0),0);if(!H||H!==B||G<J){const se=O.filter(ce=>ce.actionType||ce.type==="formula"||m.columns.find(je=>je.name===ce.name)),le=Math.max($3,J/se.length);h(ce=>{se.forEach(je=>{const Ce=ce.columns.findIndex(oe=>at(oe,je));Ce!==-1&&(ce.columns[Ce].size=le)})})}},[A,B,T,m.columns]);const R=H=>J=>{const G=f.current;if(!G)return;const se=D.find(oe=>at(oe,H)),le=J.clientX,ce=se.size||0,je=oe=>{const ve=Math.max(k3,ce+oe.clientX-le);h(ae=>{const de=ae.columns.findIndex(te=>at(te,H));ae.columns[de].size=ve})},Ce=()=>{G.removeEventListener("mousemove",je),G.removeEventListener("mouseup",Ce)};G.addEventListener("mousemove",je),G.addEventListener("mouseup",Ce)};return b.useEffect(()=>{const H=f.current;if(!H)return;const J=()=>{y(!1),E(!1),k(!1)},G=se=>w3({e:se,dataLen:x.length,selection:N,setSelection:S,setIsSelecting:y,editing:v,setEditing:j,setTriggerSelectionDelete:k,visibleAttributes:D,pageSize:p.pageSize,setIsDragging:E});return H.addEventListener("keydown",G),H.addEventListener("keyup",J),()=>{H.removeEventListener("keydown",G),H.removeEventListener("keyup",J)}},[N,v,x==null?void 0:x.length]),b.useEffect(()=>{async function H(){if(w){const J=x.filter((se,le)=>N.find(ce=>(ce.index||ce)===le)),G=D.filter((se,le)=>N.map(ce=>ce.attrI).includes(le));G.length?s(void 0,void 0,J.map(se=>({...se,...G.reduce((le,ce)=>({...le,[ce]:""}),{})}))):s(void 0,void 0,J.map(se=>({...se,...D.reduce((le,ce)=>({...le,[ce]:""}),{})})))}}H()},[w]),D.length?e.jsx("div",{className:`${(W=d==null?void 0:d.table)==null?void 0:W.tableContainer} ${!z&&((V=d==null?void 0:d.table)==null?void 0:V.tableContainerNoPagination)}`,ref:f,children:e.jsxs("div",{className:(X=d==null?void 0:d.table)==null?void 0:X.tableContainer1,onMouseLeave:H=>qd({setIsDragging:E}),children:[e.jsxs("div",{className:(q=d==null?void 0:d.table)==null?void 0:q.headerContainer,style:{zIndex:5,gridTemplateColumns:`${P}px ${O.map(H=>`${H.size}px`||"auto").join(" ")} ${U}px`,gridColumn:`span ${O.length+2} / ${O.length+2}`},children:[e.jsx("div",{className:"flex justify-between sticky left-0 z-[1]",style:{width:P},children:e.jsx("div",{className:`w-full ${(Q=d==null?void 0:d.table)==null?void 0:Q.thContainerBg} ${z3}`},"#")}),O.map((H,J)=>{var G,se,le,ce,je;return e.jsxs("div",{className:`${(G=d==null?void 0:d.table)==null?void 0:G.thead} ${Gd.includes(J)?(se=d==null?void 0:d.table)==null?void 0:se.theadfrozen:""}`,style:{width:H.size},children:[e.jsx("div",{className:`
                                        ${(le=d==null?void 0:d.table)==null?void 0:le.thContainer}  
                                        ${N.find(Ce=>Ce.attrI===J)?(ce=d==null?void 0:d.table)==null?void 0:ce.thContainerBgSelected:(je=d==null?void 0:d.table)==null?void 0:je.thContainerBg}`,children:e.jsx(ac,{attribute:H,isEdit:t})},`controls-${J}`),e.jsx("div",{className:"z-5 -ml-2 w-[1px] hover:w-[2px] bg-gray-200 hover:bg-gray-400",style:{height:"100%",cursor:"col-resize",position:"relative",right:0,top:0},onMouseDown:R(H)},`resizer-${J}`)]},J)}),e.jsxs("div",{className:`${(Y=d==null?void 0:d.table)==null?void 0:Y.thContainerBg} z-[1] flex shrink-0 justify-between`,children:[" "," "]},"##")]}),x.filter(H=>!H.totalRow).map((H,J)=>e.jsx(T3,{i:J,d:H,isEdit:t,frozenCols:Gd,allowEdit:c,isDragging:$,isSelecting:g,editing:v,setEditing:j,loading:!1,selection:N,setSelection:S,selectionRange:L,triggerSelectionDelete:w,handleMouseDown:j3,handleMouseMove:C3,handleMouseUp:qd,setIsDragging:E,startCellCol:_,startCellRow:M,updateItem:s,removeItem:n},J)),e.jsx("div",{id:p.loadMoreId,className:`${z?"hidden":""} min-h-2 w-full text-center`,children:i?"loading...":""})]})}):e.jsx("div",{className:"p-2",children:"No columns selected."})},oc={name:"Spreadsheet",type:"table",useDataSource:!0,useGetDataOnPageChange:!0,useInfiniteScroll:!0,showPagination:!0,controls:{columns:[{type:"select",label:"Fn",key:"fn",options:[{label:"fn",value:" "},{label:"list",value:"list"},{label:"sum",value:"sum"},{label:"count",value:"count"}]},{type:"toggle",label:"show",key:"show"},{type:"toggle",label:"Exclude N/A",key:"excludeNA"},{type:"toggle",label:"Open Out",key:"openOut"},{type:"toggle",label:"Filter",key:"filters",trueValue:[{type:"internal",operation:"filter",values:[]}]},{type:"toggle",label:"Group",key:"group"},{type:"toggle",label:"Value column",key:"valueColumn",onChange:({key:t,value:s,attribute:n,state:r,columnIdx:a})=>{n.yAxis||n.categorize||r.columns.forEach(l=>{l.valueColumn=s&&l.name===n.name})}},nc],actions:{Comp:B3},more:[{type:"toggle",label:"Attribution",key:"showAttribution"},{type:"toggle",label:"Allow Edit",key:"allowEditInView"},{type:"toggle",label:"Use Search Params",key:"allowSearchParams"},{type:"toggle",label:"Show Total",key:"showTotal"},{type:"toggle",label:"Striped",key:"striped"},{type:"toggle",label:"Allow Download",key:"allowDownload"},{type:"toggle",label:"Always Fetch Data",key:"readyToLoad"},{type:"toggle",label:"Use Pagination",key:"usePagination"},{type:"input",inputType:"number",label:"Page Size",key:"pageSize",displayCdn:({display:t})=>t.usePagination===!0}],inHeader:[{type:"select",label:"Sort",key:"sort",dataFetch:!0,options:[{label:"Not Sorted",value:""},{label:"A->Z",value:"asc nulls last"},{label:"Z->A",value:"desc nulls last"}]},{type:"select",label:"Justify",key:"justify",options:[{label:"Not Justified",value:""},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]},{type:"select",label:"Format",key:"formatFn",options:[{label:"No Format Applied",value:" "},{label:"Comma Seperated",value:"comma"},{label:"Comma Seperated ($)",value:"comma_dollar"},{label:"Abbreviated",value:"abbreviate"},{label:"Abbreviated ($)",value:"abbreviate_dollar"},{label:"Date",value:"date"},{label:"Title",value:"title"}]},{type:"toggle",label:"Is Link",key:"isLink",displayCdn:({isEdit:t})=>t},{type:"input",inputType:"text",label:"Link Text",key:"linkText",displayCdn:({attribute:t,isEdit:s})=>s&&t.isLink},{type:"input",inputType:"text",label:"Location",key:"location",displayCdn:({attribute:t,isEdit:s})=>s&&t.isLink},{type:"select",label:"Search Params",key:"searchParams",displayCdn:({attribute:t,isEdit:s})=>s&&t.isLink,options:[{label:"None",value:void 0},{label:"ID",value:"id"},{label:"Value",value:"value"}]}]},EditComp:Jd,ViewComp:Jd},yr={contentEditable:"border-none relative [tab-size:1] outline-0",editorScroller:"min-h-[150px] border-0 flex relative outline-0 z-0 resize-y",viewScroller:"border-0 flex relative outline-0 z-0 resize-none",editorContainer:"relative block rounded-[10px] min-h-[50px]",editorShell:"font-['Proxima_Nova'] font-[400] text-[16px] text-[#37576B] leading-[22.4px]",card:"p-[12px] shadow-[0px_0px_6px_0px_rgba(0,0,0,0.02),0px_2px_4px_0px_rgba(0,0,0,0.08)]",heading:{h1:"font-[500]  text-[#2D3E4C] text-[36px] leading-[140%] tracking-[-.02em] font-[500] underline-offset-8 underline decoration-4 decoration-[#EAAD43] uppercase font-['Oswald'] pb-[12px]",h2:"font-[500]  text-[#2D3E4C] text-[24px] leading-[24px] scroll-mt-36 font-['Oswald'] pb-[12x]",h3:"font-[500]  text-[#2D3E4C] text-[16px] leading-[16px] scroll-mt-36 font-['Oswald'] pb-[12x]",h4:"font-medium text-[#2D3E4C] scroll-mt-36 font-display",h5:"scroll-mt-36 font-display",h6:"scroll-mt-36 font-display"},paragraph:"m-0 relative",quote:"m-0 mb-2 py-6 font-['Oswald'] text-[30px] leading-[36px] text-[#2D3E4C] border-l-4 border-[#37576B] pl-4",link:"text-[#37576B] font-[500] no-underline inline-block hover:underline hover:cursor-pointer",text:{bold:"font-[700]",code:"bg-gray-200 px-1 py-0.5 font-mono text-[94%]",italic:"italic",strikethrough:"line-through",subscript:"align-sub text-[0.8em]",superscript:"align-super text-[0.8em]",underline:"underline",underlineStrikethrough:"underline line-through"},blockCursor:"block pointer-events-none absolute content-['']  after:absolute after:-top-[2px] after:w-[20px] after:border-t-[1px_solid_black]",characterLimit:"inline !bg-[#ffbbbb]",layoutContainer:"grid gap-[10px]",layoutItem:"px-2 py-4 min-w-0 max-w-full",layoutItemEditable:"border border-dashed border-slate-300 rounded-lg",code:"bg-[rgb(240,_242,_245)] font-[Menlo,_Consolas,_Monaco,_monospace] block pl-[52px] pr-[8px] py-[8px] leading-[1.53] text-[13px] m-0 mt-[8px] mb-[8px] [tab-size:2] relative after:content-[attr(data-gutter)] after:absolute after:bg-[#eee] after:left-[0] after:top-[0] after:border-r-[1px_solid_#ccc] after:p-[8px] after:text-[#777] after:whitespace-pre-wrap after:text-right after:min-w-[25px]",codeHighlight:{atrule:"text-[#07a]",attr:"text-[#07a]",boolean:"text-[#905]",builtin:"text-[#690]",cdata:"text-[slategray]",char:"text-[#690]",class:"text-[#dd4a68]","class-name":"text-[#dd4a68]",comment:"text-[slategray]",constant:"text-[#905]",deleted:"text-[#905]",doctype:"text-[slategray]",entity:"text-[#9a6e3a]",function:"text-[#dd4a68]",important:"text-[#e90]",inserted:"text-[#690]",keyword:"text-[#07a]",namespace:"text-[#e90]",number:"text-[#905]",operator:"text-[#9a6e3a]",prolog:"text-[slategray]",property:"text-[#905]",punctuation:"text-[#999]",regex:"text-[#e90]",selector:"text-[#690]",string:"text-[#690]",symbol:"text-[#905]",tag:"text-[#905]",url:"text-[#9a6e3a]",variable:"text-[#e90]"},embedBlock:{base:"select-none",focus:"outline-[2px_solid_rgb(60,_132,_244)]"},hashtag:"bg-[rgba(88,_144,_255,_0.15)] border-b-[1px_solid_rgba(88,_144,_255,_0.3)]",image:"editor-image",indent:"PlaygroundEditorTheme__indent",list:{listitem:"mx-[32px]",listitemChecked:"PlaygroundEditorTheme__listItemChecked",listitemUnchecked:"PlaygroundEditorTheme__listItemUnchecked",nested:{listitem:"list-none before:hidden after:hidden"},olDepth:["list-inside list-decimal m-0 p-0 ","m-0 p-0 list-inside list-alpha","m-0 p-0 list-inside list-lower-alpha","m-0 p-0 list-inside list-upper-roman","m-0 p-0 list-inside list-lower-roman"],ul:"m-0 p-0 list-inside list-disc"},token:{comment:"text-slate-500",punctuation:"text-gray-400",property:"text-[#905]",selector:"text-[#690]",operator:"text-[#9a6e3a]",attr:"text-[#07a]",variable:"text-[#e90]",function:"text-[#dd4a68]"},ltr:"text-left",mark:{base:"bg-[rgba(255, 212, 0, 0.14)] border-b-2 border-[rgba(255, 212, 0, 0.3)] pb-0.5",selected:"bg-[rgba(255, 212, 0, 0.5)] border-b-2 border-[rgba(255, 212, 0, 1)]"},markOverlap:{base:"bg-[rgba(255,212,0,0.3)] border-b-2 border-b-[rgba(255,212,0,0.7)]",selected:"bg-[rgba(255,212,0,0.7)] border-b-2 border-b-[rgba(255,212,0,0.7)]"},rtl:"text-right",table:"border-collapse border-spacing-0 max-w-full overflow-y-scroll table-fixed w-[calc(100%-25px)] my-7",tableAddColumns:"relative top-0 w-[20px] bg-gray-200 h-full right-0 animate-[table-controls_0.2s_ease] border-0 cursor-pointer hover:bg-[#c9dbf0] after:content-[''] after:absolute after:top-0 after:left-0 after:w-full after:h-full after:bg-[url(/images/icons/plus.svg)] after:bg-center after:bg-no-repeat after:bg-contain after:opacity-40",tableAddRows:"absolute bottom-[-25px] w-[calc(100%-25px)] bg-gray-200 h-[20px] left-0 animate-[table-controls_0.2s_ease] border-0 cursor-pointer hover:bg-[#c9dbf0] after:content-[''] after:absolute after:top-0 after:left-0 after:w-full after:h-full after:bg-[url(/images/icons/plus.svg)] after:bg-center after:bg-no-repeat after:bg-contain after:opacity-40",tableCell:"border border-gray-400 min-w-[75px] align-top text-left px-2 py-[6px] relative cursor-default outline-none",tableCellActionButton:"bg-gray-200 block border-0 rounded-full w-5 h-5 text-gray-900 cursor-pointer hover:bg-gray-300",tableCellActionButtonContainer:"block absolute right-1 top-1.5 z-40 w-5 h-5",tableCellEditing:"shadow-[0_0_5px_rgba(0,0,0,0.4)] rounded-[3px]",tableCellHeader:"bg-[#f2f3f5] text-left",tableCellPrimarySelected:"border-2 border-[rgb(60,132,244)] absolute h-[calc(100%-2px)] w-[calc(100%-2px)] left-[-1px] top-[-1px] z-2",tableCellResizer:"absolute right-[-4px] h-full w-[8px] cursor-ew-resize z-10 top-0",tableCellSelected:"bg-[#c9dbf0]",tableCellSortedIndicator:"block opacity-50 absolute bottom-0 left-0 w-full h-[4px] bg-[#999]",tableResizeRuler:"block absolute w-[1px] bg-[rgb(60,132,244)] h-full top-0",tableSelected:"outline outline-2 outline-[rgb(60,132,244)]",charLimit:"inline bg-[#ffbbbb] !important",editorEditTreeView:"rounded-none",editorViewContainer:"relative block rounded-[10px]",editorViewTreeView:"rounded-none",editorPlanText:"rounded-t-[10px]",testRecorderOutput:"my-5 mx-auto w-full",treeViewOutput:"block bg-gray-900 text-white p-0 text-xs my-[1px] mx-auto mb-[10px] relative overflow-hidden rounded-lg",editorDevButton:{base:"relative block w-10 h-10 text-xs rounded-[20px] border-none cursor-pointer outline-none shadow-[0px_1px_10px_rgba(0,0,0,0.3)] bg-gray-700 hover:bg-gray-600 after:content-[''] after:absolute after:top-[10px] after:right-[10px] after:bottom-[10px] after:left-[10px] after:block after:bg-contain after:filter invert",active:"bg-red-600"},testRecorderToolbar:"flex",testRecorderButton:{base:"relative block w-8 h-8 text-xs p-[6px] rounded-md border-none cursor-pointer outline-none shadow-md bg-gray-800 transition-shadow duration-75 ease-out after:content-[''] after:absolute after:top-2 after:right-2 after:bottom-2 after:left-2 after:block after:bg-contain after:filter-invert",active:"shadow-lg"},componentPickerMenu:"w-[200px]",mentionsMenu:"w-[250px]",autoEmbedMenu:"w-[150px]",emojiMenu:"w-[200px]",icon:{plus:"bg-[url(/images/icons/plus.svg)]",caretRight:"bg-[url(/images/icons/caret-right-fill.svg)]",columns:"bg-[url(/images/icons/3-columns.svg)]",dropdownMore:"bg-[url(/images/icons/dropdown-more.svg)]",fontColor:"bg-[url(/images/icons/font-color.svg)]",fontFamily:"bg-[url(/images/icons/font-family.svg)]",bgColor:"bg-[url(/images/icons/bg-color.svg)]",table:"bg-[#6c757d] bg-[url(/images/icons/table.svg)]  mask-[url(/images/icons/table.svg)] mask-no-repeat mask-size-contain",paragraph:"bg-[url(/images/icons/text-paragraph.svg)]",h1:"bg-[url(/images/icons/type-h1.svg)]",h2:"bg-[url(/images/icons/type-h2.svg)]",h3:"bg-[url(/images/icons/type-h3.svg)]",h4:"bg-[url(/images/icons/type-h4.svg)]",h5:"bg-[url(/images/icons/type-h5.svg)]",h6:"bg-[url(/images/icons/type-h6.svg)]",bulletList:"bg-[url(/images/icons/list-ul.svg)]",bullet:"bg-[url(/images/icons/list-ul.svg)]",checkList:"bg-[url(/images/icons/square-check.svg)]",check:"bg-[url(/images/icons/square-check.svg)]",numberedList:"bg-[url(/images/icons/list-ol.svg)]",number:"bg-[url(/images/icons/list-ol.svg)]",quote:"bg-[url(/images/icons/chat-square-quote.svg)]",code:"bg-[url(/images/icons/code.svg)]",strikethrough:"bg-[url(/images/icons/type-strikethrough.svg)]",subscript:"bg-[url(/images/icons/type-subscript.svg)]",superscript:"bg-[url(/images/icons/type-superscript.svg)]",palette:"bg-[url(/images/icons/palette.svg)]",bucket:"bg-[url(/images/icons/paint-bucket.svg)]",bold:"bg-[url(/images/icons/type-bold.svg)]",italic:"bg-[url(/images/icons/type-italic.svg)]",clear:"bg-[url(/images/icons/trash.svg)]",underline:"bg-[url(/images/icons/type-underline.svg)]",link:"bg-[url(/images/icons/link.svg)]",horizontalRule:"bg-[url(/images/icons/horizontal-rule.svg)]",centerAlign:"bg-[url(/images/icons/text-center.svg)]",rightAlign:"bg-[url(/images/icons/text-right.svg)]",justifyAlign:"bg-[url(/images/icons/justify.svg)]",indent:"bg-[url(/images/icons/indent.svg)]",markdown:"bg-[url(/images/icons/markdown.svg)]",outdent:"bg-[url(/images/icons/outdent.svg)]",undo:"bg-[url(/images/icons/arrow-counterclockwise.svg)]",redo:"bg-[url(/images/icons/arrow-clockwise.svg)]",sticky:"bg-[url(/images/icons/sticky.svg)]",mic:"bg-[url(/images/icons/mic.svg)]",import:"bg-[url(/images/icons/upload.svg)]",export:"bg-[url(/images/icons/download.svg)]",diagram2:"bg-[url(/images/icons/diagram-2.svg)]",user:"bg-[url(/images/icons/user.svg)]",equation:"bg-[url(/images/icons/plus-slash-minus.svg)]",gif:"bg-[url(/images/icons/filetype-gif.svg)]",copy:"bg-[url(/images/icons/copy.svg)]",success:"bg-[url(/images/icons/success.svg)]",prettier:"bg-[url(/images/icons/prettier.svg)]",prettierError:"bg-[url(/images/icons/prettier-error.svg)]",image:"bg-[url(/images/icons/file-image.svg)]",close:"bg-[url(/images/icons/close.svg)]",figma:"bg-[url(/images/icons/figma.svg)]",poll:"bg-[url(/images/icons/card-checklist.svg)]",tweet:"bg-[url(/images/icons/tweet.svg)]",youtube:"bg-[url(/images/icons/youtube.svg)]",leftAlign:"bg-[url(/images/icons/text-left.svg)]"},iconChevronDown:"bg-transparent bg-contain inline-block h-[8px] w-[8px] bg-[url(/images/icons/chevron-down.svg)]",switch:{base:"block text-gray-700 my-[5px] bg-gray-200 bg-opacity-70 py-[5px] px-[10px] rounded-lg",richTextSwitch:"absolute right-0",characterCountSwitch:"absolute right-[130px]",label:"mr-1 line-height-[24px] w-[100px] text-[14px] inline-block align-middle",button:"bg-[rgb(206,208,212)] h-[24px] box-border rounded-[12px] w-[44px] inline-block align-middle relative outline-none cursor-pointer transition-colors duration-[100ms] border-[2px] border-transparent focus-visible:border-blue-500",buttonSpan:"absolute top-0 left-0 block w-[20px] h-[20px] rounded-[12px] bg-white transition-transform duration-[200ms]",buttonChecked:"bg-[rgb(24,119,242)]",buttonCheckedSpan:"translate-x-[20px]"},linkEditor:{base:"flex absolute top-0 left-0 z-10 max-w-[400px] w-full opacity-0 bg-white shadow-lg rounded-b-lg transition-opacity duration-500 will-change-transform",button:{active:"bg-[rgb(223,232,250)]",base:"w-[20px] h-[20px] inline-block p-[6px] rounded-lg cursor-pointer mx-[2px]",hovered:"w-[20px] h-[20px] inline-block bg-gray-200",i:"bg-contain inline-block h-[20px] w-[20px] align-middle"},linkInput:{base:"block w-[calc(100%-75px)] box-border m-3 p-2 rounded-[15px] bg-[#eee] text-[15px] text-[rgb(5,5,5)] border-0 outline-0 relative font-inherit",a:"text-[rgb(33,111,219)] underline whitespace-nowrap overflow-hidden mr-[30px] overflow-ellipsis hover:underline"},linkView:{base:"block w-[calc(100%-24px)] m-2 p-2 rounded-[15px] text-[15px] text-[rgb(5,5,5)] border-0 outline-0 relative font-inherit",a:"block break-words w-[calc(100%-33px)]"},div:{linkEdit:"bg-[url(/images/icons/pencil-fill.svg)] bg-[length:16px] bg-center bg-no-repeat w-[35px] align-middle absolute right-[30px] top-0 bottom-0 cursor-pointer",linkTrash:"bg-[url(/images/icons/trash.svg)] bg-[length:16px] bg-center bg-no-repeat w-[35px] align-middle absolute right-0 top-0 bottom-0 cursor-pointer",linkCancel:"bg-[url(/images/icons/close.svg)] bg-[length:16px] bg-center bg-no-repeat w-[35px] align-middle absolute right-0 top-0 bottom-0 cursor-pointer mr-[28px]",linkConfirm:"bg-[url(/images/icons/success-alt.svg)] bg-[length:16px] bg-center bg-no-repeat w-[35px] align-middle absolute right-0 top-0 bottom-0 cursor-pointer mr-[2px]"},fontSizeWrapper:"flex mx-[4px]",fontFamilyWrapper:"flex mx-[4px]",select:"p-[6px] border-0 bg-[rgba(0,0,0,0.075)] rounded-[4px]",buttonHovered:"w-5 h-5 inline-block bg-gray-200",icon:"bg-contain inline-block h-5 w-5 align-middle"},mention:{focus:"shadow-[0_0_0_2px_rgb(180,213,255)] outline-none"},blockControls:{base:"absolute right-2 top-4 w-8 h-8 box-border shadow-md z-10 rounded-lg border border-gray-300 overflow-hidden",button:{base:"border border-white bg-white block transition-colors duration-100 ease-in cursor-pointer outline-none rounded-lg p-1 hover:bg-gray-200",focusVisible:"focus-visible:border-blue-500"},span:{base:"block w-[18px] h-[18px] m-[2px] bg-contain",paragraph:"bg-[url(/images/icons/text-paragraph.svg)]",h1:"bg-[url(/images/icons/type-h1.svg)]",h2:"bg-[url(/images/icons/type-h2.svg)]",quote:"bg-[url(/images/icons/chat-square-quote.svg)]",ul:"bg-[url(/images/icons/list-ul.svg)]",ol:"bg-[url(/images/icons/list-ol.svg)]",code:"bg-[url(/images/icons/code.svg)]"}},charactersLimit:{base:"text-gray-400 text-xs text-right block absolute left-3 bottom-1",exceeded:"text-red-500"},dropdown:{base:"z-10 block fixed shadow-lg rounded-[8px] min-h-[40px] bg-white",item:{base:"m-0 mx-2 p-2 text-[#050505] cursor-pointer leading-4 text-[15px] flex items-center flex-row flex-shrink-0 justify-between bg-white rounded-lg border-0 max-w-[250px] min-w-[100px] hover:bg-gray-200",fontSizeItem:"min-w-unset",fontSizeText:"min-w-unset",active:"flex w-5 h-5 bg-contain",firstChild:"mt-2",lastChild:"mb-2",text:"flex leading-5 flex-grow min-w-[150px]",icon:"flex w-5 h-5 select-none mr-3 leading-4 bg-contain bg-center bg-no-repeat"},divider:"w-auto bg-gray-200 my-1 h-[1px] mx-2"},switchbase:"block text-gray-700 my-1 bg-[rgba(238,_238,_238,_0.7)] p-1 px-[10px] rounded-lg",switchlabel:"mr-1 leading-6 w-[100px] text-sm inline-block align-middle",switchbutton:"bg-gray-300 h-[24px] box-border rounded-full w-[44px] inline-block align-middle relative outline-none cursor-pointer transition-colors duration-100 border-2 border-transparent",switchbuttonFocus:"focus-visible:border-blue-500",switchbuttonSpan:"absolute top-0 left-0 block w-[20px] h-[20px] rounded-full bg-white transition-transform duration-200",switchbuttonChecked:"bg-blue-600",switchbuttonCheckedSpan:"translate-x-[20px]",editor:{base:"flex-auto relative resize-y z-negative",image:{base:"inline-block relative cursor-default select-none",img:{base:"max-w-full cursor-default",focused:"outline outline-2 outline-blue-600",draggable:{base:"cursor-grab",active:"cursor-grabbing"}},captionContainer:"block absolute bottom-1 left-0 right-0 p-0 m-0 border-t border-white bg-opacity-90 bg-white min-w-[100px] text-black overflow-hidden",captionButton:"block absolute bottom-5 left-0 right-0 w-[30%] mx-auto p-2 border border-white/30 rounded bg-black bg-opacity-50 min-w-[100px] text-white cursor-pointer select-none hover:bg-blue-500",resizer:{base:"block w-[7px] h-[7px] absolute bg-blue-600 border border-white",n:"top-[-6px] left-[48%] cursor-n-resize",ne:"top-[-6px] right-[-6px] cursor-ne-resize",e:"bottom-[48%] right-[-6px] cursor-e-resize",se:"bottom-[-2px] right-[-6px] cursor-nwse-resize",s:"bottom-[-2px] left-[48%] cursor-s-resize",sw:"bottom-[-2px] left-[-6px] cursor-sw-resize",w:"bottom-[48%] left-[-6px] cursor-w-resize",nw:"top-[-6px] left-[-6px] cursor-nw-resize"}},inlineImage:{base:"inline-block relative z-10 cursor-default select-none",img:{base:"cursor-default",focused:"outline outline-2 outline-blue-600",draggable:{base:"cursor-grab",active:"cursor-grabbing"}},captionContainer:"block bg-gray-200 min-w-full text-black overflow-hidden",editButton:{base:"block absolute top-3 right-3 py-[6px] px-[8px] border border-white/30 rounded-md bg-black/50 min-w-[60px] text-white cursor-pointer select-none hover:bg-blue-500",hide:"hidden"},position:{full:"my-4",left:"float-left w-fit mx-1 mb-0",right:"float-right w-fit mb-0 mx-1"},resizer:{base:"block w-[7px] h-[7px] absolute bg-blue-600 border border-white",n:"top-[-6px] left-[48%] cursor-n-resize",ne:"top-[-6px] right-[-6px] cursor-ne-resize",e:"bottom-[48%] right-[-6px] cursor-e-resize",se:"bottom-[-2px] right-[-6px] cursor-nwse-resize",s:"bottom-[-2px] left-[48%] cursor-s-resize",sw:"bottom-[-2px] left-[-6px] cursor-sw-resize",w:"bottom-[48%] left-[-6px] cursor-w-resize",nw:"top-[-6px] left-[-6px] cursor-nw-resize"}}},keyword:"text-[#f1765e] font-bold",tableDisableCell:{disableSelection:{base:"",selectedSpan:"bg-transparent",selectedBr:"bg-transparent"}},cellActionButtonContainer:"absolute top-0 left-0 will-change-transform",cellActionButton:"bg-none flex justify-center items-center border-0 relative rounded-[15px] text-[#222] inline-block cursor-pointer",actionButton:{base:"bg-[#eee] border-0 px-3 py-2 relative ml-[5px] rounded-[15px] text-[#222] inline-block cursor-pointer hover:bg-[#ddd] hover:text-black",disabled:"g-gray-200 cursor-not-allowed opacity-60"},typeaheadPopover:{base:"bg-white shadow-[0_5px_10px_rgba(0,0,0,0.3)] rounded-[8px] mt-[25px]",ul:{base:"p-0 list-none m-0 rounded-[8px] max-h-[200px] overflow-y-scroll scrollbar-none",li:{base:"m-0 min-w-[180px] text-[14px] outline-none cursor-pointer rounded-[8px] hover:bg-gray-200",selected:"bg-gray-200",item:"p-[8px] text-[#050505] cursor-pointer leading-[16px] text-[15px] flex items-center shrink-0 rounded-[8px] border-0",active:"flex w-[20px] h-[20px] bg-contain",firstChild:"rounded-t-[8px]",lastChild:"rounded-b-[8px]",hover:"bg-gray-200",text:"flex items-center leading-[20px] grow min-w-[150px]",icon:"flex w-[20px] h-[20px] select-none mr-[8px] leading-[16px] bg-contain bg-no-repeat bg-center"}},li:"m-0 mx-2 p-2 text-[#050505] cursor-pointer leading-4 text-[15px] flex items-center flex-row flex-shrink-0 bg-white rounded-lg border-0"},debugTimetravelPanel:{base:"overflow-hidden p-0 pb-2.5 m-auto flex",slider:"p-0 flex-[8]",button:"p-0 border-0 bg-none flex-[1] text-white text-xs hover:underline"},debugTimetravelButton:"absolute top-2.5 right-3 border-0 p-0 text-xs text-white bg-transparent hover:underline",debugTreetypeButton:"absolute top-2.5 right-[85px] border-0 p-0 text-xs text-white bg-transparent hover:underline",connecting:"absolute top-2.5 left-2.5 text-[15px] text-gray-400 overflow-hidden text-ellipsis whitespace-nowrap pointer-events-none",toolbar:{base:"flex flex-wrap h-fit overflow-hidden mb[1px] p-1 rounded-tl-lg rounded-tr-lg sticky top-0 z-20 items-center",toolbarItem:{base:"border-0 flex bg-none rounded-lg p-2 cursor-pointer align-middle flex-shrink-0 items-center justify-between hover:bg-gray-200",disabled:{base:"cursor-not-allowed",icon:"opacity-20",text:"opacity-20",iconFormat:"opacity-60",chevronDown:"opacity-20"},spaced:"mr-2",iconFormat:"flex h-[18px] w-[18px] opacity-60 custom-vertical-align",active:{base:"bg-[rgba(223,232,250,0.3)]",i:"opacity-100"},fontFamilyText:"block max-w-[10rem]",text:"flex leading-[20px] custom-vertical-align text-[14px] text-gray-500 truncate overflow-hidden h-[20px] text-left pr-[10px]",icon:"flex w-5 h-5 select-none mr-2 leading-4 bg-contain"},codeLanguage:"w-[150px]",chevronDownIcon:"mt-1 w-4 h-4 flex select-none",chevronDownIconInside:"w-4 h-4 flex ml-6 mt-2.5 mr-2 pointer-events-none",divider:"w-[1px] bg-[#eee] mx-[4px] h-[35px]"},stickyNoteContainer:{base:"absolute z-9 w-[120px] inline-block",dragging:"transition-none"},stickyNote:{base:"relative block cursor-move text-left w-[120px] m-6 p-[20px] border border-[#e8e8e8] font-[Reenie_Beanie] text-[24px] rounded-br-[60px]",contentEditable:"min-h-[20px] border-0 resize-none cursor-text text-[24px] caret-black block relative tab-[1] outline-none p-[10px] select-text whitespace-pre-wrap break-words",placeholder:"text-[24px] text-gray-500 overflow-hidden absolute truncate top-[30px] left-[20px] w-[120px] select-none whitespace-nowrap inline-block pointer-events-none",after:"absolute z-[-1] right-0 bottom-[20px] w-[120px] h-[25px] bg-black/20 shadow-[2px_15px_5px_rgba(0,0,0,0.4)] transform -scale-x-100",yellow:"border-t border-[#fdfd86] bg-gradient-to-br from-[#ffff88] to-[#ffffc6]",pink:"border-t border-[#e7d1e4] bg-gradient-to-br from-[#f7cbe8] to-[#e7bfe1]",div:"cursor-text",delete:"absolute top-[8px] right-[10px] text-[10px] border-0 bg-none cursor-pointer opacity-50 hover:font-bold hover:opacity-100",color:"absolute top-[8px] right-[25px] border-0 bg-none opacity-50 hover:opacity-100",colorIcon:"block w-[12px] h-[12px] bg-contain"},excalidrawButton:{base:"border-0 p-0 m-0 bg-transparent",selected:"outline outline-2 outline-[rgb(60,132,244)] user-select-none"},hr:{base:"p-[2px] border-none my-4 cursor-pointer relative",after:"absolute left-0 right-0 h-[2px] bg-[#ccc] leading-[2px]",selected:"outline-[2px] outline-solid outline-[#3c84f4] select-none"},spacer:"tracking[-2px]",editorEquation:{base:"cursor-default select-none",focused:"outline-2 outline-solid outline-[#3c84f4]"},buttonItemIcon:"opacity-60",dropdownItemActive:"bg-[#dfe8fa4d]",dropdownItemActiveIcon:"opacity-100",tableNodeContentEditable:"min-h-[20px] border-0 resize-none cursor-text block relative tab-size-1 outline-0 p-0 select-text text-[15px] whitespace-pre-wrap break-words z-3",nestable:{base:"relative",list:"p-0 list-none",listDirectChild:"p-0",item:"m-0",itemFirstChild:"mt-0",itemList:"mt-0",isDragging:{list:"pointer-events-none",allElements:"opacity-0",before:"absolute inset-0 rounded-md"},itemIcon:"mr-1 cursor-pointer",dragLayer:"fixed top-0 left-0 z-[100] pointer-events-none",dragLayerList:"absolute top-0 left-0 p-0",icon:{base:"relative inline-block w-5 h-5 bg-transparent bg-center bg-no-repeat",before:"hidden"},iconPlusGray:'w-5 h-5 bg-[url("./icon-plus-gray.svg")]',iconMinusGray:'w-5 h-5 bg-[url("./icon-minus-gray.svg")]'},draggableBlockMenu:{base:"rounded-md p-0.5 cursor-grab opacity-0 absolute -left-0 top-0 will-change-transform hover:bg-gray-200",icon:"w-4 h-4 opacity-30 bg-[url(/images/icons/draggable-block-menu.svg)]",active:"cursor-grabbing"},draggableBlockTargetLine:{base:"pointer-events-none bg-blue-500 h-1 absolute left-0 top-0 opacity-0 will-change-transform"},floatingTextFormatPopup:{base:"flex bg-white p-1 align-middle absolute top-0 left-0 z-10 opacity-0 shadow-md rounded-lg transition-opacity duration-500 h-11 will-change-transform",popupItem:{base:"border-0 flex bg-transparent rounded-lg p-2 cursor-pointer align-middle",disabled:"cursor-not-allowed",spaced:"mr-[2px]",icon:"bg-contain inline-block h-[18px] w-[18px] mt-[2px] flex opacity-60",disabledIcon:"opacity-20",active:"bg-[rgba(223,232,250,0.3)]",activeIcon:"opacity-100",hover:"hover:bg-gray-200"},select:{base:"border-0 flex bg-transparent rounded-lg p-2 w-18 text-sm text-gray-500 truncate appearance-none",codeLanguage:"capitalize w-32"},text:"flex items-center text-[14px] text-gray-500 leading-[20px] w-[70px] h-[20px] overflow-hidden text-left truncate",icon:"flex w-5 h-5 select-none mr-2 leading-4 bg-contain",chevronDown:"mt-0.75 w-4 h-4 flex select-none",chevronInside:"w-4 h-4 flex ml-[-6.25rem] mt-[11px] mr-[10px] pointer-events-none",divider:"w-px bg-gray-200 mx-1",insertComment:"hidden md:block"},collapsible:{container:"bg-[#fcfcfc] border border-gray-200 rounded-lg mb-2",containerOpen:"bg-transparent border-none",title:"scroll-mt-24 cursor-pointer p-1.25 pl-5 relative font-bold list-none outline-none",titleBefore:"absolute left-1.75 top-1/2 transform -translate-y-1/2 border border-solid border-transparent border-l-black border-t-[4px] border-b-[4px] border-l-[6px] border-r-[6px]",titleBeforeClosed:"border-[0.25rem_0.375rem_0.25rem_0.375rem]",titleBeforeOpen:"border-[0.375rem_0.25rem_0_0.25rem] border-t-black bg-transparent",content:"p-0 pl-5 pb-[5px]",collapsedContent:"hidden select-none"},tableOfContents:{container:"fixed top-52 right-[-35px] p-[10px] w-[250px] flex flex-row justify-start z-10 h-[300px] text-[#65676b]",headings:"list-none mt-0 ml-[10px] p-0 overflow-scroll w-[200px] h-[220px] overflow-x-hidden overflow-y-auto scrollbar-hide",heading1:"text-black font-bold cursor-pointer",heading2:"ml-[10px]",heading3:"ml-5",normalHeading:"cursor-pointer leading-5 text-base",selectedHeading:"text-[#3578e5] relative",selectedHeadingWrapper:"relative",selectedHeadingBefore:"absolute inline-block left-[-30px] top-1 z-10 h-1 w-1 bg-[#3578e5] border-4 border-white rounded-full",normalHeadingWrapper:"ml-8 relative"},imageNode:{contentEditable:"min-h-[20px] border-0 resize-none cursor-text caret-[#050505] block relative tab-[1] outline-0 p-[10px] select-text text-[12px] w-[calc(100%-20px)] whitespace-pre-wrap break-words",placeholder:"text-[12px] text-gray-500 overflow-hidden absolute text-ellipsis top-[10px] left-[10px] select-none whitespace-nowrap inline-block pointer-events-none"},imageControlWrapperResizing:"touch-none",actions:{base:"absolute text-right m-[10px] bottom-0 right-0",treeView:"rounded-bl-none rounded-br-none",i:{base:"bg-contain inline-block h-[15px] w-[15px] align-[-0.25em]",indent:"bg-[url(/images/icons/indent.svg)]",outdent:"bg-[url(/images/icons/outdent.svg)]",lock:"bg-[url(/images/icons/lock-fill.svg)]",unlock:"bg-[url(/images/icons/lock.svg)]",image:"bg-[url(/images/icons/file-image.svg)]",table:"bg-[url(/images/icons/table.svg)]",leftAlign:"bg-[url(/images/icons/text-left.svg)]",centerAlign:"bg-[url(/images/icons/text-center.svg)]",rightAlign:"bg-[url(/images/icons/text-right.svg)]",justifyAlign:"bg-[url(/images/icons/justify.svg)]",disconnect:"bg-[url(/images/icons/plug.svg)]",connect:"bg-[url(/images/icons/plug-fill.svg)]"}}},P3=["#FFFFFF","#F3F8F9","#FCF6EC"],Xd=({value:t="#FFFFFF",setValue:s,title:n,className:r,colors:a})=>{if(!s)return;const[l,i]=b.useState(!1),c=b.useMemo(()=>a||P3,[a]);return e.jsxs("div",{className:"px-1.5 py-1 w-full inline-flex justify-between items-center bg-white hover:bg-gray-50 cursor-pointer",children:[e.jsx("label",{className:"shrink-0",children:n}),e.jsxs("div",{className:"",children:[e.jsx("div",{id:"background",className:"shrink w-[30px] h-[30px] border rounded-md",style:{backgroundColor:t},onClick:()=>i(!l)}),l?e.jsx("div",{className:"absolute z-[25] shadow",children:e.jsx(Sh,{color:t,onChange:s,colors:c,showColorPicker:!1})}):null]})]})},na={left:"justifyTextLeft",right:"justifyTextRight",center:"justifyTextCenter",full:{header:"justifyTextLeft",value:"justifyTextRight"}},Zd=[{label:"X-Small",value:"textXS"},{label:"X-Small Regular",value:"textXSReg"},{label:"Small",value:"textSM"},{label:"Small Regular",value:"textSMReg"},{label:"Small Bold",value:"textSMBold"},{label:"Small SemiBold",value:"textSMSemiBold"},{label:"Base",value:"textMD"},{label:"Base Regular",value:"textMDReg"},{label:"Base Bold",value:"textMDBold"},{label:"Base SemiBold",value:"textMDSemiBold"},{label:"XL",value:"textXL"},{label:"XL SemiBold",value:"textXLSemiBold"},{label:"2XL",value:"text2XL"},{label:"2XL Regular",value:"text2XLReg"},{label:"3XL",value:"text3XL"},{label:"3XL Regular",value:"text3XLReg"},{label:"4XL",value:"text4XL"},{label:"5XL",value:"text5XL"},{label:"6XL",value:"text6XL"},{label:"7XL",value:"text7XL"},{label:"8XL",value:"text8XL"}],vh={columnControlWrapper:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-4 gap-x-1 gap-y-0.5",columnControlHeaderWrapper:"px-1 font-semibold border bg-gray-50 text-gray-500",mainWrapperCompactView:"grid",mainWrapperSimpleView:"flex flex-col",subWrapper:"w-full",subWrapperCompactView:"flex flex-col rounded-[12px]",subWrapperSimpleView:"grid",headerValueWrapper:"w-full rounded-[12px] flex items-center justify-center p-2",headerValueWrapperCompactView:"py-0",headerValueWrapperSimpleView:"",justifyTextLeft:"text-start justify-items-start",justifyTextRight:"text-end justify-items-end",justifyTextCenter:"text-center justify-items-center",textXS:"text-xs font-medium",textXSReg:"text-xs font-normal",textSM:"text-sm font-medium",textSMReg:"text-sm font-normal",textSMBold:"text-sm font-normal",textSMSemiBold:"text-sm font-semibold",textMD:"ftext-md ont-medium",textMDReg:"text-md font-normal",textMDBold:"text-md font-bold",textMDSemiBold:"text-md font-semibold",textXL:"text-xl font-medium",textXLSemiBold:"text-xl font-semibold",text2XL:"text-2xl font-medium",text2XLReg:"text-2xl font-regular",text3XL:"text-3xl font-medium",text3XLReg:"text-3xl font-normal",text4XL:"text-4xl font-medium",text5XL:"text-5xl font-medium",text6XL:"text-6xl font-medium",text7XL:"text-7xl font-medium",text8XL:"text-8xl font-medium",imgXS:"max-w-16 max-h-16",imgSM:"max-w-24 max-h-24",imgMD:"max-w-32 max-h-32",imgXL:"max-w-40 max-h-40",img2XL:"max-w-48 max-h-48",img3XL:"max-w-56 max-h-56",img4XL:"max-w-64 max-h-64",img5XL:"max-w-72 max-h-72",img6XL:"max-w-80 max-h-80",img7XL:"max-w-96 max-h-96",img8XL:"max-w-128 max-h-128",header:"w-full capitalize",value:"w-full"},R3=({value:t,className:s})=>e.jsx("div",{className:s,children:t}),Yd=({attribute:t,value:s,rawValue:n,isValueFormatted:r,id:a,updateItem:l,allowEdit:i})=>{var h;const[c,d]=b.useState(!1),u=b.useRef(null),m=`${t.name}-${a}-${JSON.stringify(n)}`,p=`${t.name}-${a}`,x=((h=Ue[t.type])==null?void 0:h[i?"EditComp":"ViewComp"])||R3;return Kt(u,m,()=>c&&d(!1)),!i&&(t.isImg||t.isLink||["icon","color"].includes(t.formatFn)&&At[t.formatFn])?s:e.jsx("div",{ref:u,onClick:()=>!c&&d(!0),className:i&&c||i&&!s?"w-full":"",children:e.jsx(x,{value:i&&r?n:s,placeholder:"please enter value...",id:i&&c?p:m,onChange:f=>l(f,t,{id:a,[t.name]:f}),className:i&&!s?"border":" ",...t})})},Qd=({isEdit:t,updateItem:s,allowEdit:n})=>{const{theme:r={}}=C.useContext(me)||{},a=r.dataCard||vh,{state:{columns:l,data:i,display:{compactView:c,gridSize:d,gridGap:u,padding:m,colGap:p,headerValueLayout:x,reverse:h,hideIfNull:f,removeBorder:g,bgColor:y="#FFFFFF"}},setState:v}=b.useContext(xt),[j,N]=b.useState(null),S=b.useMemo(()=>l.filter(({show:L})=>L),[l]),w=b.useMemo(()=>l.filter(({show:L,cardSpan:D})=>L&&!D).length,[l]),k=Math.max(...S.map(L=>L.isImg&&!isNaN(L.imageMargin)?Math.abs(L.imageMargin):void 0).filter(L=>L)),$=L=>window.innerWidth<640?1:L,E=d&&c?{gridTemplateColumns:`repeat(${Math.min($(d),i.length)}, minmax(0, 1fr))`,gap:u,paddingTop:`${k}px`}:{gap:u,paddingTop:`${k}px`},M=c?{backgroundColor:y,padding:m,gap:p}:{gridTemplateColumns:`repeat(${$(d)||w}, minmax(0, 1fr))`,gap:u||2};b.useEffect(()=>{if(t)if(!f)v(L=>{L.hideSection=!1});else{const L=i.length===0||i.every(D=>l.filter(({show:A})=>A).every(A=>{const T=D[A.normalName||A.name];return T==null||T===""}));v(D=>{D.hideSection=L})}},[i,f]);function _(L){!j||at(j,L)||v(D=>{const A=[...D.columns],T=A.findIndex(F=>at(F,j)),O=A.findIndex(F=>at(F,L)),[B]=A.splice(T,1);A.splice(O,0,B),D.columns=A})}return e.jsxs(e.Fragment,{children:[t?e.jsx("div",{className:a.columnControlWrapper,children:S.map((L,D)=>e.jsx("div",{className:a.columnControlHeaderWrapper,draggable:!0,onDragStart:()=>N(L),onDragOver:A=>A.preventDefault(),onDrop:()=>_(L),children:e.jsx(ac,{isEdit:t,attribute:L})},`controls-${D}`))}):null,e.jsx("div",{className:d&&c?a.mainWrapperCompactView:a.mainWrapperSimpleView,style:E,children:i.map((L,D)=>e.jsx("div",{className:`${a.subWrapper} ${c?`${a.subWrapperCompactView} ${g?"":"border shadow"}`:a.subWrapperSimpleView} `,style:M,children:S.map(A=>{var le,ce;const{isLink:T,location:O,linkText:B,useId:F,isImg:z,imageSrc:P,imageLocation:U,imageExtension:R,imageSize:W,imageMargin:V}=A||{},X=c?"span 1":`span ${A.cardSpan||1}`,q=L[A.normalName]||L[A.name],Q=L==null?void 0:L.id,Y=z?e.jsx("img",{className:a[W]||"max-w-[50px] max-h-[50px]",alt:" ",src:U?`${U}/${q}${R?`.${R}`:""}`:P||q}):["icon","color"].includes(A.formatFn)&&At[A.formatFn]?e.jsx("div",{className:"flex items-center gap-1.5 uppercase",children:At[A.formatFn](q,A.isDollar)}):A.formatFn&&At[A.formatFn]?At[A.formatFn](q,A.isDollar).replaceAll(" ",""):q,H=A.formatFn==="title"?"capitalize":"",J=z||T||!!At[A.formatFn],G=((le=na[A.justify||"center"])==null?void 0:le.header)||na[A.justify||"center"],se=((ce=na[A.justify||"center"])==null?void 0:ce.value)||na[A.justify||"center"];return e.jsxs("div",{className:`
                                                 ${a.headerValueWrapper}
                                                 flex-${x} ${h&&x==="col"?"flex-col-reverse":h?"flex-row-reverse":""}
                                                 ${c?a.headerValueWrapperCompactView:`${a.headerValueWrapperSimpleView} ${g?"":"border shadow"}`}
                                                 ${c&&A.borderBelow?`border-b rounded-none ${a.headerValueWrapperBorderBColor}`:""}
                                                 ${c&&A.pb?`pb-[${A.pb}px]`:""}
                                                 `,style:{gridColumn:X,padding:c?void 0:m,marginTop:`${V}px`,backgroundColor:c?void 0:A.bgColor},children:[A.hideHeader?null:e.jsx("div",{className:`
                                                        ${a.header} ${c?a.headerCompactView:a.headerSimpleView}
                                                         ${a[G]}
                                                          ${a[A.headerFontStyle||"textXS"]}
                                                          
                                                          `,children:A.customName||A.display_name||A.normalName||A.name}),e.jsx("div",{className:`
                                                ${a.value} ${c?a.valueCompactView:a.valueSimpleView}
                                                ${a[se]}
                                                 ${a[A.valueFontStyle||"textXS"]}
                                                 ${H}
                                                 `,children:T&&!n?e.jsx(ue,{className:a.linkColValue,to:`${O||Y}${A.searchParams==="id"?encodeURIComponent(Q):A.searchParams==="value"?encodeURIComponent(Y):""}`,children:e.jsx(Yd,{attribute:A,value:B||Y,rawValue:q,isValueFormatted:J,updateItem:s,id:Q,allowEdit:n})}):e.jsx(Yd,{attribute:A,value:Y,rawValue:q,isValueFormatted:J,updateItem:s,id:Q,allowEdit:n})})]},A.normalName||A.name)})},D))})]})},H3={name:"Card",type:"card",useDataSource:!0,useGetDataOnPageChange:!0,useInfiniteScroll:!1,showPagination:!0,controls:{columns:[{type:"select",label:"Fn",key:"fn",options:[{label:"fn",value:" "},{label:"list",value:"list"},{label:"sum",value:"sum"},{label:"count",value:"count"}]},{type:"select",label:"Exclude N/A",key:"excludeNA",options:[{label:"include n/a",value:!1},{label:"exclude n/a",value:!0}]},{type:"toggle",label:"show",key:"show"},{type:"toggle",label:"Filter",key:"filters",trueValue:[{type:"internal",operation:"filter",values:[]}]},{type:"toggle",label:"Group",key:"group"},nc],more:[{type:"toggle",label:"Attribution",key:"showAttribution"},{type:"toggle",label:"Allow Edit",key:"allowEditInView"},{type:"toggle",label:"Use Search Params",key:"allowSearchParams"},{type:"toggle",label:"Compact View",key:"compactView"},{type:"input",inputType:"number",label:"Grid Size",key:"gridSize"},{type:"input",inputType:"number",label:"Grid Gap",key:"gridGap"},{type:"input",inputType:"number",label:"Padding",key:"padding"},{type:"input",inputType:"number",label:"Column Gap",key:"colGap",displayCdn:({display:t})=>t.compactView},{type:"toggle",label:"Always Fetch Data",key:"readyToLoad"},{type:"toggle",label:"Use Pagination",key:"usePagination"},{type:"input",inputType:"number",label:"Page Size",key:"pageSize",displayCdn:({display:t})=>t.usePagination===!0},{type:"select",label:"Value Placement",key:"headerValueLayout",options:[{label:"Inline",value:"row"},{label:"Stacked",value:"col"}]},{type:"toggle",label:"Reverse",key:"reverse"},{type:"toggle",label:"Hide if No Data",key:"hideIfNull"},{type:"toggle",label:"Remove Border",key:"removeBorder"},{type:({value:t,setValue:s})=>e.jsx(Xd,{value:t,setValue:s,title:"Background Color"}),key:"bgColor",displayCdn:({display:t})=>t.compactView}],inHeader:[{type:"select",label:"Sort",key:"sort",options:[{label:"Not Sorted",value:""},{label:"A->Z",value:"asc nulls last"},{label:"Z->A",value:"desc nulls last"}]},{type:"select",label:"Justify",key:"justify",options:[{label:"Not Justified",value:""},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"},{label:"Full Justified",value:"full"}]},{type:"select",label:"Format",key:"formatFn",options:[{label:"No Format Applied",value:" "},{label:"Comma Seperated",value:"comma"},{label:"Comma Seperated ($)",value:"comma_dollar"},{label:"Abbreviated",value:"abbreviate"},{label:"Abbreviated ($)",value:"abbreviate_dollar"},{label:"Date",value:"date"},{label:"Title",value:"title"},{label:"Icon",value:"icon"},{label:"Color",value:"color"}]},{type:"toggle",label:"Border Below",key:"borderBelow",displayCdn:({display:t})=>t.compactView},{type:"input",inputType:"number",label:"Padding Below",key:"pb",displayCdn:({display:t})=>t.compactView},{type:"toggle",label:"Hide Header",key:"hideHeader"},{type:"select",label:"Header",key:"headerFontStyle",options:Zd,displayCdn:({attribute:t})=>!t.hideHeader},{type:"select",label:"Value",key:"valueFontStyle",options:Zd},{type:"input",inputType:"number",label:"Span",key:"cardSpan",displayCdn:({display:t})=>!t.compactView},{type:"toggle",label:"Is Link",key:"isLink",displayCdn:({isEdit:t})=>t},{type:"input",inputType:"text",label:"Link Text",key:"linkText",displayCdn:({attribute:t,isEdit:s})=>s&&t.isLink},{type:"input",inputType:"text",label:"Location",key:"location",displayCdn:({attribute:t,isEdit:s})=>s&&t.isLink},{type:"select",label:"Search Params",key:"searchParams",displayCdn:({attribute:t,isEdit:s})=>s&&t.isLink,options:[{label:"None",value:void 0},{label:"ID",value:"id"},{label:"Value",value:"value"}]},{type:"toggle",label:"Is Image",key:"isImg",displayCdn:({isEdit:t})=>t},{type:"input",inputType:"text",label:"Image Url",key:"imageSrc",displayCdn:({attribute:t,isEdit:s})=>s&&t.isImg},{type:"input",inputType:"text",label:"Image Location",key:"imageLocation",displayCdn:({attribute:t,isEdit:s})=>s&&t.isImg},{type:"input",inputType:"text",label:"Image Extension",key:"imageExtension",displayCdn:({attribute:t,isEdit:s})=>s&&t.isImg&&t.imageLocation},{type:"select",label:"Image Size",key:"imageSize",options:[{label:"X-Small",value:"imgXS"},{label:"Small",value:"imgSM"},{label:"Base",value:"imgMD"},{label:"XL",value:"imgXL"},{label:"2XL",value:"img2XL"},{label:"3XL",value:"img3XL"},{label:"4XL",value:"img4XL"},{label:"5XL",value:"img5XL"},{label:"6XL",value:"img6XL"},{label:"7XL",value:"img7XL"},{label:"8XL",value:"img8XL"}],displayCdn:({attribute:t,isEdit:s})=>s&&t.isImg},{type:"input",inputType:"number",label:"Image Top Margin",key:"imageMargin",displayCdn:({attribute:t,isEdit:s})=>s&&t.isImg},{type:({value:t,setValue:s})=>e.jsx(Xd,{value:t,setValue:s,title:"Background Color"}),key:"bgColor",displayCdn:({display:t})=>!t.compactView}]},EditComp:Qd,ViewComp:Qd},W3={sideNavContainer1:"w-[302px] hidden xl:block",sideNavContainer2:"w-[302px] sticky top-[120px] hidden xl:block h-[calc(100vh_-_128px)] pr-2",sideNavContainer3:"shadow-md rounded-lg overflow-hidden h-full",default:{wrapper1:"w-full h-full flex-1 flex flex-row pt-2",wrapper2:"flex flex-1 w-full  flex-col  shadow-md bg-white rounded-lg relative text-md font-light leading-7 p-4 h-full min-h-[200px]",iconWrapper:"z-5 absolute right-[10px] top-[5px]",icon:"text-slate-400 hover:text-blue-500"},content:{wrapper1:"w-full h-full flex-1 flex flex-row p-2",wrapper2:"flex flex-1 w-full  flex-col  shadow-md bg-white rounded-lg relative text-md font-light leading-7 p-4 h-full min-h-[calc(100vh_-_102px)]",iconWrapper:"z-5 absolute right-[10px] top-[5px]",icon:"text-slate-400 hover:text-blue-500",viewIcon:"ViewPage",editIcon:"EditPage"},header:{wrapper1:"w-full h-full flex-1 flex flex-row",wrapper2:"flex flex-1 w-full  flex-col  relative min-h-[200px]",iconWrapper:"z-5 absolute right-[10px] top-[5px]",icon:"text-slate-400 hover:text-blue-500",sideNavContainer1:"hidden",sideNavContainer2:"hidden"}};function wh({group:t,attributes:s,edit:n}){var f,g,y,v,j;const{baseUrl:r,user:a,theme:l}=C.useContext(me)||{},{apiUpdate:i,format:c,item:d,updateAttribute:u}=C.useContext(dt)||{},m=hr(d),p=((f=l==null?void 0:l.sectionGroup)==null?void 0:f[t.theme||"default"])||{};c==null||c.registerFormats.find(N=>{var S;return(S=N==null?void 0:N.type)==null?void 0:S.includes("|cms-section")});const x=(g=s==null?void 0:s.sections)==null?void 0:g.attributes,h=C.useMemo(()=>n?s.sections.EditComp:s.sections.ViewComp,[]);return e.jsxs("div",{className:`${p==null?void 0:p.wrapper1}`,children:[(d==null?void 0:d.sidebar)&&t.name==="default"&&e.jsx("div",{className:`${(y=l==null?void 0:l.sectionGroup)==null?void 0:y.sideNavContainer1} ${(d==null?void 0:d.sidebar)==="left"?"":"order-2"}`,children:e.jsx("div",{className:(v=l==null?void 0:l.sectionGroup)==null?void 0:v.sideNavContainer2,children:e.jsx("div",{className:(j=l==null?void 0:l.sectionGroup)==null?void 0:j.sideNavContainer3,children:e.jsx(Ki,{...m})})})}),e.jsx("div",{className:p==null?void 0:p.wrapper2,children:e.jsxs("div",{className:p==null?void 0:p.wrapper3,children:[t.name==="default"&&(a==null?void 0:a.authLevel)>=5&&e.jsx(ue,{className:p==null?void 0:p.iconWrapper,to:`${r}/${n?"":"edit/"}${(d==null?void 0:d.url_slug)||""}${window.location.search}`,children:e.jsx(qe,{icon:n?p==null?void 0:p.viewIcon:p==null?void 0:p.editIcon,className:p==null?void 0:p.icon})}),e.jsx(h,{group:t,value:(d==null?void 0:d[n?"draft_sections":"sections"])||[],attr:x,onChange:(N,S)=>V3({update:N,action:S,item:d,user:a,apiUpdate:i,updateAttribute:u})})]})})]})}const V3=async({update:t,action:s,item:n,user:r,apiUpdate:a,updateAttribute:l})=>{let i={type:s,user:(r==null?void 0:r.email)||"user",time:new Date().toString()},c=n.history?pe(n.history):[];s&&c.push(i),l&&l("","",{has_changes:!0,history:c,draft_sections:t.filter(u=>u)});const d={id:n==null?void 0:n.id,draft_sections:t.filter(u=>u),has_changes:!0,history:c};await a({data:d})},jh={menuItems:"absolute z-40 -mr-1 mt-1 w-64 p-1 origin-top-left rounded-md bg-white shadow-lg ring-1 ring-black/5 transition focus:outline-none data-[closed]:scale-95 data-[closed]:transform data-[closed]:opacity-0 data-[enter]:duration-50 data-[leave]:duration-75 data-[enter]:ease-out data-[leave]:ease-in"},U3=[{name:"Save and schedule",onClick:"#"},{name:"Save and publish",onClick:"#"},{name:"Export PDF",onClick:"#"}],q3=b.forwardRef(({item:t},s)=>e.jsxs("div",{onClick:t==null?void 0:t.onClick,className:"cursor-pointer flex items-center rounded-lg py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:text-gray-900 data-[focus]:outline-none hover:bg-gray-100",children:[e.jsx("div",{className:"px-2",children:e.jsx(qe,{icon:(t==null?void 0:t.icon)||"Blank",className:"size-5"})}),e.jsx("div",{className:"",children:t==null?void 0:t.name})]})),G3=b.forwardRef(({item:t},s)=>e.jsxs("div",{onClick:t.onClick,className:"cursor-pointer flex items-center rounded-lg py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:text-gray-900 data-[focus]:outline-none hover:bg-gray-100",children:[e.jsx("div",{className:"px-2",children:e.jsx(qe,{icon:t.icon,className:"size-5"})}),e.jsx("div",{className:"flex-1",children:t.name}),e.jsx(Mo,{items:t.items,zIndex:"z-50",origin:"right-0",children:e.jsxs("div",{className:"px-4 text-sm text-slate-300 flex items-center",children:[e.jsx("div",{children:t.value}),e.jsx("div",{children:e.jsx(qe,{icon:"ArrowRight"})})]})})]})),J3=b.forwardRef(({item:t},s)=>e.jsxs("div",{onClick:t.onClick,className:"cursor-pointer flex items-center rounded-lg py-2 text-sm text-gray-700 data-[focus]:bg-gray-100 data-[focus]:text-gray-900 data-[focus]:outline-none",children:[e.jsx("div",{className:"px-2",children:e.jsx(qe,{icon:t.icon,className:"size-5"})}),e.jsx("div",{className:"flex-1",children:t.name}),e.jsx("div",{className:"w-20",children:e.jsx(tc,{...t.inputProps})})]})),X3=b.forwardRef(({item:t},s)=>e.jsx(Rb,{className:"my-1 h-px bg-slate-200"})),ra={simple:q3,menu:G3,seperator:X3,input:J3};function Mo({children:t,items:s=U3,zIndex:n=40,origin:r="right-0"}){const[a,l]=C.useState(!1),{theme:i={menu:jh}}=C.useContext(me)||{};return e.jsxs("div",{className:"relative block ",children:[e.jsxs("div",{className:"",onClick:()=>l(!a),children:[e.jsx("span",{className:"sr-only",children:"Open options"}),t]}),e.jsx("div",{className:a?`${i.menu.menuItems} ${r} ${n}`:"hidden pointer-events-none",children:e.jsx("div",{className:"py-1",children:s.filter(c=>c).map((c,d)=>{const u=(ra==null?void 0:ra[c==null?void 0:c.type])||ra.simple;return e.jsx(u,{item:c},d)})})})]})}const Ch={labelWrapper:"px-[12px] pt-[9px] pb-[7px] rounded-md",label:"inline-flex items-center rounded-md px-1.5 py-0.5 text-sm/5 font-medium sm:text-xs/5 forced-colors:outline"};function ti({text:t,children:s}){const{theme:n={label:Ch}}=C.useContext(me)||{};return e.jsx("div",{className:`${n.label.labelWrapper}`,children:e.jsx("span",{className:`${n.label.label}`,children:t||s})})}const Nh=(t,s,n="index")=>C.useMemo(()=>Hb(t.map(a=>a[n])).reduce((a,l,i)=>(i%s===0&&a.push(l),a),[]),[t,s]),kh=t=>{const{data:s,margins:n,height:r,width:a,xAxis:l,yAxis:i,colors:c,legend:d}=t,u=Nh(s,l.tickSpacing),m=C.useMemo(()=>{const{marginTop:p,marginBottom:x}=n;return p+x>r?p+x+100:r},[r,n]);return C.useMemo(()=>({x:{type:"point",label:l.label||l.name,grid:l.showGridLines,textAnchor:l.rotateLabels?"start":"middle",tickRotate:l.rotateLabels?45:0,axis:"bottom",ticks:u},y:{axis:"left",grid:i.showGridLines,tickFormat:At[i.tickFormat],label:i.label},color:{legend:d.show,width:d.width,height:d.height,label:d.label,range:c.value},height:m,width:a,...n}),[n,m,a,l,i,c,d])},Z3={seq1:{2:["#f7e76e","#ce141f"],3:["#f7e76e","#ec962a","#ce141f"],4:["#f7e76e","#f1b33d","#e5751d","#ce141f"],5:["#f7e76e","#f3c048","#ec962a","#e1631a","#ce141f"],6:["#f7e76e","#f4c94f","#efa835","#e88321","#de581a","#ce141f"],7:["#f7e76e","#f4ce54","#f1b33d","#ec962a","#e5751d","#dc501a","#ce141f"],8:["#f7e76e","#f5d157","#f2bb43","#eea331","#e98823","#e36b1b","#da491b","#ce141f"],9:["#f7e76e","#f5d45a","#f3c048","#f0ac38","#ec962a","#e77e1f","#e1631a","#d9451b","#ce141f"]},seq2:{2:["#fde89b","#4d53b3"],3:["#fde89b","#f37b8a","#4d53b3"],4:["#fde89b","#ff9e81","#d4629b","#4d53b3"],5:["#fde89b","#ffb080","#f37b8a","#bd5aa4","#4d53b3"],6:["#fde89b","#ffbc82","#fe8f83","#e36a94","#ad57a9","#4d53b3"],7:["#fde89b","#ffc385","#ff9e81","#f37b8a","#d4629b","#a056ac","#4d53b3"],8:["#fde89b","#ffc887","#ffa880","#fb8985","#e86f91","#c85da0","#9755ad","#4d53b3"],9:["#fde89b","#ffcc88","#ffb080","#ff9582","#f37b8a","#de6797","#bd5aa4","#9055af","#4d53b3"]},seq3:{2:["#f2e68c","#035d6d"],3:["#f2e68c","#59a884","#035d6d"],4:["#f2e68c","#87bf84","#319082","#035d6d"],5:["#f2e68c","#a0ca84","#59a884","#1f837f","#035d6d"],6:["#f2e68c","#afd084","#74b684","#409984","#147b7d","#035d6d"],7:["#f2e68c","#bad485","#87bf84","#59a884","#319082","#0e767b","#035d6d"],8:["#f2e68c","#c2d785","#95c584","#6cb284","#479e84","#268881","#097379","#035d6d"],9:["#f2e68c","#c8d986","#a0ca84","#7bb984","#59a884","#3a9683","#1f837f","#077078","#035d6d"]},seq4:{2:["#e8e873","#4b5899"],3:["#e8e873","#2cbaa8","#4b5899"],4:["#e8e873","#62d198","#209eb0","#4b5899"],5:["#e8e873","#84d98c","#2cbaa8","#2d8eaf","#4b5899"],6:["#e8e873","#98dd85","#4ac9a0","#1caaae","#3483ad","#4b5899"],7:["#e8e873","#a5e081","#62d198","#2cbaa8","#209eb0","#397cab","#4b5899"],8:["#e8e873","#afe17e","#75d691","#41c5a2","#1eafad","#2795af","#3d77a9","#4b5899"],9:["#e8e873","#b6e27c","#84d98c","#53cc9d","#2cbaa8","#1ca5af","#2d8eaf","#3f74a8","#4b5899"]},seq5:{2:["#f3cdb4","#c33c3c"],3:["#f3cdb4","#dd8a6c","#c33c3c"],4:["#f3cdb4","#e5a182","#d57259","#c33c3c"],5:["#f3cdb4","#e8ac8d","#dd8a6c","#d16651","#c33c3c"],6:["#f3cdb4","#eab395","#e29879","#d87c61","#ce5e4c","#c33c3c"],7:["#f3cdb4","#ecb79a","#e5a182","#dd8a6c","#d57259","#cc5949","#c33c3c"],8:["#f3cdb4","#edba9d","#e7a788","#e09475","#da8064","#d36b54","#cb5547","#c33c3c"],9:["#f3cdb4","#eebda0","#e8ac8d","#e39b7c","#dd8a6c","#d7785e","#d16651","#ca5246","#c33c3c"]},seq6:{2:["#f6e389","#cd4c71"],3:["#f6e389","#f49566","#cd4c71"],4:["#f6e389","#f7af6b","#ec7b66","#cd4c71"],5:["#f6e389","#f8bc70","#f49566","#e66e68","#cd4c71"],6:["#f6e389","#f8c474","#f6a568","#ef8566","#e26769","#cd4c71"],7:["#f6e389","#f8c976","#f7af6b","#f49566","#ec7b66","#df626b","#cd4c71"],8:["#f6e389","#f8cd79","#f8b76d","#f6a067","#f18a66","#e87467","#dd5f6b","#cd4c71"],9:["#f6e389","#f8d07a","#f8bc70","#f7a869","#f49566","#ee8166","#e66e68","#db5c6c","#cd4c71"]},seq7:{2:["#f2e9a6","#344e31"],3:["#f2e9a6","#8a9968","#344e31"],4:["#f2e9a6","#abb47c","#6b8055","#344e31"],5:["#f2e9a6","#bcc186","#8a9968","#5d734c","#344e31"],6:["#f2e9a6","#c6c98c","#9da974","#778a5c","#546b46","#344e31"],7:["#f2e9a6","#cdce90","#abb47c","#8a9968","#6b8055","#4e6643","#344e31"],8:["#f2e9a6","#d3d293","#b4bb81","#98a570","#7c8e60","#637850","#4b6340","#344e31"],9:["#f2e9a6","#d6d596","#bcc186","#a2ad77","#8a9968","#73865a","#5d734c","#48603e","#344e31"]},seq8:{2:["#d2e2a6","#096b6d"],3:["#d2e2a6","#6ba888","#096b6d"],4:["#d2e2a6","#8cbc91","#4d9480","#096b6d"],5:["#d2e2a6","#9dc596","#6ba888","#3e897b","#096b6d"],6:["#d2e2a6","#a7cb98","#7fb48d","#599c83","#358379","#096b6d"],7:["#d2e2a6","#aecf9b","#8cbc91","#6ba888","#4d9480","#2f7f77","#096b6d"],8:["#d2e2a6","#b3d29c","#95c193","#79b08c","#5e9f85","#448e7d","#2a7c76","#096b6d"],9:["#d2e2a6","#b7d49d","#9dc596","#84b78f","#6ba888","#549982","#3e897b","#277a75","#096b6d"]},seq9:{2:["#ebdbad","#27859c"],3:["#ebdbad","#7eb699","#27859c"],4:["#ebdbad","#a2c39a","#5ba79b","#27859c"],5:["#ebdbad","#b4ca9c","#7eb699","#4b9f9c","#27859c"],6:["#ebdbad","#c0cd9e","#93be99","#68ad9a","#429a9c","#27859c"],7:["#ebdbad","#c7d0a0","#a2c39a","#7eb699","#5ba79b","#3c979d","#27859c"],8:["#ebdbad","#ccd1a1","#adc79b","#8dbc99","#6eb099","#51a29b","#38949d","#27859c"],9:["#ebdbad","#d0d2a3","#b4ca9c","#99c099","#7eb699","#63ab9a","#4b9f9c","#35929d","#27859c"]},seq10:{2:["#d0f0da","#274c72"],3:["#d0f0da","#609fa8","#274c72"],4:["#d0f0da","#82bab7","#438398","#274c72"],5:["#d0f0da","#95c8bf","#609fa8","#387590","#274c72"],6:["#d0f0da","#a0d0c4","#74afb1","#4e8e9f","#336d8b","#274c72"],7:["#d0f0da","#a8d5c7","#82bab7","#609fa8","#438398","#306887","#274c72"],8:["#d0f0da","#aed9ca","#8dc2bb","#6eabae","#5393a1","#3d7b94","#2e6484","#274c72"],9:["#d0f0da","#b2dccc","#95c8bf","#79b3b3","#609fa8","#4a8a9c","#387590","#2c6182","#274c72"]},seq11:{2:["#ffcdc6","#513a8d"],3:["#f3c0b9","#bd6f95","#513a8d"],4:["#f3c0b9","#d3899c","#a15991","#513a8d"],5:["#f3c0b9","#dc96a1","#bd6f95","#915090","#513a8d"],6:["#f3c0b9","#e19ea5","#cb7e99","#ad6293","#864a90","#513a8d"],7:["#f3c0b9","#e5a4a8","#d3899c","#bd6f95","#a15991","#7f478f","#513a8d"],8:["#f3c0b9","#e7a8aa","#d8909f","#c77a98","#b26593","#985491","#79458f","#513a8d"],9:["#f3c0b9","#e8abac","#dc96a1","#ce829a","#bd6f95","#a95e92","#915090","#75438f","#513a8d"]},seq12:{2:["#e9c5ed","#663b91"],3:["#e9c5ed","#aa7dbd","#663b91"],4:["#e9c5ed","#bf94cc","#9466ae","#663b91"],5:["#e9c5ed","#caa0d4","#aa7dbd","#895ba7","#663b91"],6:["#e9c5ed","#d0a7d9","#b78bc6","#9d6fb4","#8255a2","#663b91"],7:["#e9c5ed","#d4acdc","#bf94cc","#aa7dbd","#9466ae","#7d509f","#663b91"],8:["#e9c5ed","#d7b0df","#c59bd1","#b387c4","#a173b6","#8e60aa","#7a4d9d","#663b91"],9:["#e9c5ed","#dab2e1","#caa0d4","#ba8ec9","#aa7dbd","#996cb2","#895ba7","#784b9c","#663b91"]},div1:{2:["#2b8bab","#dc565f"],3:["#2b8bab","#eff4c8","#dc565f"],4:["#2b8bab","#a4d5b5","#e8c68b","#dc565f"],5:["#2b8bab","#7fc4b2","#eff4c8","#e7ac74","#dc565f"],6:["#2b8bab","#69bab1","#c2e2ba","#e9d9a2","#e79c6a","#dc565f"],7:["#2b8bab","#5cb2b1","#a4d5b5","#eff4c8","#e8c68b","#e69165","#dc565f"],8:["#2b8bab","#52adb0","#8fccb3","#cfe7bd","#eae1ac","#e7b87d","#e58962","#dc565f"],9:["#2b8bab","#4ca9b0","#7fc4b2","#b7ddb8","#eff4c8","#e9d299","#e7ac74","#e58360","#dc565f"]},div2:{2:["#448480","#c54b3e"],3:["#448480","#f9dd35","#c54b3e"],4:["#448480","#a0b169","#e9932f","#c54b3e"],5:["#448480","#a0b169","#f9dd35","#e9932f","#c54b3e"],6:["#448480","#82a373","#bec05c","#f0ac30","#e07b31","#c54b3e"],7:["#448480","#82a373","#bec05c","#f9dd35","#f0ac30","#e07b31","#c54b3e"],8:["#448480","#729b77","#a0b169","#cdc755","#f2b830","#e9932f","#db6e32","#c54b3e"],9:["#448480","#729b77","#a0b169","#cdc755","#f9dd35","#f2b830","#e9932f","#db6e32","#c54b3e"]},div3:{3:["#3166aa","#efefef","#c73d4b"],4:["#3166aa","#b6bfd9","#eab7b5","#c73d4b"],5:["#3166aa","#98a8cd","#efefef","#e49a99","#c73d4b"],6:["#3166aa","#869ac6","#cdd2e2","#edcdcc","#e08989","#c73d4b"],7:["#3166aa","#7a91c1","#b6bfd9","#efefef","#eab7b5","#dc7d7e","#c73d4b"],8:["#3166aa","#718bbe","#a5b2d2","#d7dbe6","#eed7d6","#e7a6a5","#da7576","#c73d4b"],9:["#3166aa","#6a86bc","#98a8cd","#c4cbde","#efefef","#ecc5c4","#e49a99","#d86e71","#c73d4b"]},div4:{2:["#518646","#d74528"],3:["#518646","#f8dea0","#d74528"],4:["#518646","#a6b26e","#e8995b","#d74528"],5:["#518646","#a6b26e","#f8dea0","#e8995b","#d74528"],6:["#518646","#8ba35d","#c1c07e","#eeb072","#e38042","#d74528"],7:["#518646","#8ba35d","#c1c07e","#f8dea0","#eeb072","#e38042","#d74528"],8:["#518646","#7d9c56","#a6b26e","#cfc887","#f0bc7e","#e8995b","#e07339","#d74528"],9:["#518646","#7d9c56","#a6b26e","#cfc887","#f8dea0","#f0bc7e","#e8995b","#e07339","#d74528"]},div5:{2:["#59a1a6","#a67b30"],3:["#59a1a6","#f5f5a3","#a67b30"],4:["#59a1a6","#a8cba4","#cdb769","#a67b30"],5:["#59a1a6","#a8cba4","#f5f5a3","#cdb769","#a67b30"],6:["#59a1a6","#8ebda5","#c2d9a4","#dacb7c","#c0a356","#a67b30"],7:["#59a1a6","#8ebda5","#c2d9a4","#f5f5a3","#dacb7c","#c0a356","#a67b30"],8:["#59a1a6","#81b6a5","#a8cba4","#cee0a4","#e1d685","#cdb769","#b9994c","#a67b30"],9:["#59a1a6","#81b6a5","#a8cba4","#cee0a4","#f5f5a3","#e1d685","#cdb769","#b9994c","#a67b30"]},div6:{2:["#8b4583","#4a6147"],3:["#8b4583","#f9f2bf","#4a6147"],4:["#8b4583","#c29ba1","#9ea781","#4a6147"],5:["#8b4583","#c29ba1","#f9f2bf","#9ea781","#4a6147"],6:["#8b4583","#b07e97","#d4b8ab","#bcbf95","#818f6d","#4a6147"],7:["#8b4583","#b07e97","#d4b8ab","#f9f2bf","#bcbf95","#818f6d","#4a6147"],8:["#8b4583","#a77092","#c29ba1","#ddc6b0","#cbcc9f","#9ea781","#738363","#4a6147"],9:["#8b4583","#a77092","#c29ba1","#ddc6b0","#f9f2bf","#cbcc9f","#9ea781","#738363","#4a6147"]},div7:{1:["#2D3E4C"],2:["#2D3E4C","#C5D7E0"],3:["#2D3E4C","#6D96AE","#C5D7E0"],4:["#2D3E4C","#EAAD43","#6D96AE","#C5D7E0"],5:["#2D3E4C","#EAAD43","#6D96AE","#F1CA87","#C5D7E0"],6:["#2D3E4C","#EAAD43","#6D96AE","#F1CA87","#C5D7E0","#FCF6EC"],7:["#2D3E4C","#EAAD43","#AA2E26","#6D96AE","#F1CA87","#C5D7E0","#FCF6EC"],8:["#2D3E4C","#EAAD43","#AA2E26","#6D96AE","#F1CA87","#DD524C","#C5D7E0","#FCF6EC"],9:["#2D3E4C","#EAAD43","#AA2E26","#6D96AE","#F1CA87","#DD524C","#C5D7E0","#FCF6EC","#EA8954"],10:["#2D3E4C","#EAAD43","#AA2E26","#6D96AE","#F1CA87","#DD524C","#C5D7E0","#FCF6EC","#EA8954","#54B99B"],11:["#D72638","#007F5F","#F8A100","#38BFA7","#8F2D56","#E2C044","#6A4C93","#A8C686","#FF5D73","#5296A5","#CC5803"],12:["#D72638","#007F5F","#F8A100","#38BFA7","#8F2D56","#E2C044","#6A4C93","#A8C686","#FF5D73","#5296A5","#CC5803","#F4B6C2"],13:["#D72638","#007F5F","#F8A100","#38BFA7","#8F2D56","#E2C044","#6A4C93","#A8C686","#FF5D73","#5296A5","#CC5803","#F4B6C2","#6D597A"],14:["#D72638","#007F5F","#F8A100","#38BFA7","#8F2D56","#E2C044","#6A4C93","#A8C686","#FF5D73","#5296A5","#CC5803","#F4B6C2","#6D597A","#2E294E"],15:["#D72638","#007F5F","#F8A100","#38BFA7","#8F2D56","#E2C044","#6A4C93","#A8C686","#FF5D73","#5296A5","#CC5803","#F4B6C2","#6D597A","#2E294E","#D4A373"],16:["#D72638","#007F5F","#F8A100","#38BFA7","#8F2D56","#E2C044","#6A4C93","#A8C686","#FF5D73","#5296A5","#CC5803","#F4B6C2","#6D597A","#2E294E","#D4A373","#73C2FB"],17:["#D72638","#007F5F","#F8A100","#38BFA7","#8F2D56","#E2C044","#6A4C93","#A8C686","#FF5D73","#5296A5","#CC5803","#F4B6C2","#6D597A","#2E294E","#D4A373","#73C2FB","#FFDD67"],18:["#D72638","#007F5F","#F8A100","#38BFA7","#8F2D56","#E2C044","#6A4C93","#A8C686","#FF5D73","#5296A5","#CC5803","#F4B6C2","#6D597A","#2E294E","#D4A373","#73C2FB","#FFDD67","#845EC2"],19:["#D72638","#007F5F","#F8A100","#38BFA7","#8F2D56","#E2C044","#6A4C93","#A8C686","#FF5D73","#5296A5","#CC5803","#F4B6C2","#6D597A","#2E294E","#D4A373","#73C2FB","#FFDD67","#845EC2","#F96167"],20:["#D72638","#007F5F","#F8A100","#38BFA7","#8F2D56","#E2C044","#6A4C93","#A8C686","#FF5D73","#5296A5","#CC5803","#F4B6C2","#6D597A","#2E294E","#D4A373","#73C2FB","#FFDD67","#845EC2","#F96167","#4B88A2"]},schemeGroups:{sequential:["seq1","seq2","seq3","seq4","seq5","seq6","seq7","seq8","seq9","seq10","seq11","seq12"],singlehue:[],diverging:["div1","div2","div3","div4","div5","div6","div7"]}},Y3=t=>{const{data:s,margins:n,height:r,width:a,xAxis:l,yAxis:i,colors:c,bgColor:d,legend:u,tooltip:m,groupMode:p="stacked",orientation:x="vertical",showCategories:h,xAxisColumn:f,isLog:g,upperLimit:y}=t,v=c.type==="palette"||c.type==="custom",j=[...new Set(s.map(B=>B.value))].sort((B,F)=>B-F),N=j[j.length-1],S=p==="stacked",w=x==="vertical",[k,$]=C.useState(null),E=Nh(s,l.tickSpacing),M=C.useMemo(()=>{const{marginTop:B,marginBottom:F}=n;return B+F>r?B+F+100:r},[r,n]),[_,L]=C.useMemo(()=>w?[Wb,$i]:[Vb,Ub],[w]),D=C.useMemo(()=>w?{type:"band",axis:"bottom",label:S?l.label:null,grid:l.showGridLines,textAnchor:l.rotateLabels?"start":"middle",tickRotate:l.rotateLabels?45:0,ticks:S?E:void 0}:{axis:"bottom",type:g?"log":void 0,domain:g?[Math.min(...j),y||N]:y?[0,y]:void 0,clamp:g?!0:void 0,grid:i.showGridLines,tickFormat:At[i.tickFormat],textAnchor:i.rotateLabels?"start":"middle",tickRotate:i.rotateLabels?45:0,label:S?i.label:null},[w,S,l,i,E,g]),A=C.useMemo(()=>w?{axis:"left",constant:1,type:g?"log":void 0,domain:g?[Math.min(...j),y||N]:y?[0,y]:void 0,clamp:g?!0:void 0,grid:i.showGridLines,textAnchor:i.rotateLabels?"start":"middle",tickRotate:i.rotateLabels?45:0,tickFormat:At[i.tickFormat],label:S?i.label:null}:{type:"band",axis:"left",label:S?l.label:null,grid:l.showGridLines,textAnchor:l.rotateLabels?"start":"middle",tickRotate:l.rotateLabels?45:0,ticks:S?E:void 0},[w,S,l,i,E,g]),T=C.useMemo(()=>S||!w?void 0:{axis:"top",ticks:E,label:l.label},[S,w,E,l]),O=C.useMemo(()=>S||w?void 0:{axis:"left",ticks:E,label:i.label},[S,w,E,i]);return C.useEffect(()=>{if(!k||!s.length)return;const B=l.showXAxisBar?[L([0])]:[];B.push(_(s,S?{x:w?"index":g?void 0:"value",x1:g?w?void 0:1:void 0,x2:g?w?"index":"value":void 0,y:w?g?void 0:"value":"index",y1:g&&w?1:void 0,y2:g?w?"value":"index":void 0,fill:v?"type":"value",sort:w?{x:"x",order:null}:{y:"y",order:null}}:{x:w?"type":"value",fx:w?"index":void 0,y:w?"value":"type",fy:w?void 0:"index",fill:v?"type":"value",sort:w?{fx:"x",order:null}:{fy:"y",order:null}})),m.show&&w?B.push(La(s,np(qb({x:"index",y:"value",className:"leading-[140%] tracking-[0px] text-[#37576B]",channels:{index:{value:"index",label:f.display_name||f.name},Type:"type",Value:"value"},format:{x:!1,y:!1,index:!0,Type:h,Value:!0},fill:d,fontSize:m.fontSize})))):m.show&&!w&&B.push(La(s,Gb(Jb({x:"value",y:"index",channels:{index:{value:"index",label:f.display_name||f.name},Type:"type",Value:"value"},format:{x:!1,y:!1,index:!0,Type:h,Value:!0},fill:d,fontSize:m.fontSize}))));const F=Si({x:D,fx:T,y:A,fy:O,color:{legend:u.show,width:u.width,height:u.height,label:u.label,domain:c.value.domain||void 0,range:v?c.value:c.value.range,type:v?void 0:c.value.type,tickFormat:v?void 0:At[i.tickFormat]},height:M,width:a,...n,marks:B});try{F.className=`${F==null?void 0:F.className} flex flex-col-reverse`}catch{}return k.append(F),()=>F.remove()},[k,s,n,M,a,i,m,g,c,u,v,S,w,f,l.showXAxisBar,D,A,T,O,h]),e.jsx("div",{ref:$})},Q3={type:"Bar Graph",GraphComp:"BarGraph",Component:Y3,EditorOptions:[{label:"Orientation",type:"select",path:["orientation"],options:["vertical","horizontal"],defaultValue:"vertical"},{label:"Group Mode",type:"select",path:["groupMode"],options:["stacked","grouped"],defaultValue:"stacked"}]},K3=t=>{const{data:s,bgColor:n,tooltip:r,xAxis:a}=t,[l,i]=C.useState(null),c=kh(t);return C.useEffect(()=>{if(!l||!s.length)return;const d=a.showXAxisBar?[$i([0])]:[];d.push(Xb(s,{x:"index",y:"value",stroke:"type",sort:{x:"x",order:null}})),r.show&&d.push(La(s,np({fill:n,fontSize:r.fontSize,x:"index",y:"value"})));const u=Si({...c,marks:d});return l.append(u),()=>u.remove()},[l,s,c,r,n,a.showXAxisBar]),e.jsx("div",{ref:i})},eN={type:"Line Graph",GraphComp:"LineGraph",Component:K3},tN=t=>{const{data:s,bgColor:n,tooltip:r,xAxis:a}=t,[l,i]=C.useState(null),c=kh(t);return C.useEffect(()=>{if(!l||!s.length)return;const d=a.showXAxisBar?[$i([0])]:[];d.push(Zb(s,{x:"index",y:"value",stroke:"type",sort:{x:"x",order:null}}),Yb(s,Rc({x:"index",y:"value",textFill:n}))),r.show&&d.push(La(s,Rc({fill:n,fontSize:r.fontSize,x:"index",y:"value"})));const u=Si({...c,marks:d});return l.append(u),()=>u.remove()},[l,s,c,n,r,a.showXAxisBar]),e.jsx("div",{ref:i})},sN={type:"Scatter Plot",GraphComp:"ScatterPlot",Component:tN},nN=[Q3,eN,sN],[sT,rN,nT]=nN.reduce((t,s)=>{const{type:n,GraphComp:r,Component:a,EditorOptions:l}=s;return t[0].push({type:n,GraphComp:r}),t[1][r]=a,t[2][r]=l||[],t},[[],{},{}]),aN=t=>rN[t],Ao=(t,s,n=!1)=>{let r=ne(Z3,[s,t],[]).slice();return n&&r.reverse(),r};Ao(12,"Set3");Ao(7,"RdYlGn");const oN=({title:t,position:s,fontSize:n,fontWeight:r})=>{const a=C.useMemo(()=>`justify-${s}`,[s]);return t?e.jsx("div",{className:`w-full flex ${a} mb-4`,children:e.jsx("div",{style:{fontSize:`${n}px`,fontWeight:r},children:t})}):null},lN={sum:Hc,avg:Kb,count:Hc},iN=t=>lN[t],cN=t=>{const{graphFormat:s,activeGraphType:n,viewData:r,showCategories:a,xAxisColumn:l,yAxisColumns:i}=t,{theme:c={graph:lc}}=C.useContext(me)||{},d=C.useMemo(()=>aN(n.GraphComp),[n]),[u,m]=C.useState(null),[p,x]=C.useState(640);C.useEffect(()=>{if(!u)return;const{width:f}=u.getBoundingClientRect();x(f)},[u]);const h=C.useMemo(()=>Qb(r,g=>g.index,g=>g.type,g=>g.aggMethod).reduce((g,y)=>{const[v,j]=y;return j.reduce((N,S)=>{const[w,k]=S;return k.reduce(($,E)=>{const[M,_]=E,L=iN(M);return $.push({index:v,type:w,value:L(_,D=>D.value)}),$},N)},g)},[]),[r,i]);return e.jsxs("div",{ref:m,className:"w-full h-fit",style:{backgroundColor:s.darkMode?void 0:ne(s,"bgColor","#ffffff"),color:s.darkMode?void 0:ne(s,"textColor","#000000"),paddingTop:`${ne(s,"padding",.5)}rem`},children:[e.jsx(oN,{...s.title}),e.jsx("div",{className:`h-fit ${s.darkMode?c.graph.darkModeText:c.graph.text}`,children:!n||!d?null:e.jsx(d,{data:h,title:ne(s,"title",""),height:ne(s,"height",300),width:ne(s,"width",p),bgColor:ne(s,"bgColor","#ffffff"),colors:ne(s,"colors"),upperLimit:ne(s,"upperLimit"),showCategories:a,xAxisColumn:l,orientation:ne(s,"orientation","vertical"),groupMode:ne(s,"groupMode","stacked"),isLog:ne(s,"isLog",!1),xAxis:{label:ne(s,["xAxis","label"]),rotateLabels:ne(s,["xAxis","rotateLabels"],!1),tickSpacing:ne(s,["xAxis","tickSpacing"],!0),showGridLines:ne(s,["xAxis","showGridLines"],!0),showXAxisBar:ne(s,["xAxis","showXAxisBar"],!1)},yAxis:{label:ne(s,["yAxis","label"]),rotateLabels:ne(s,["yAxis","rotateLabels"],!1),showGridLines:ne(s,["yAxis","showGridLines"],!0),tickFormat:ne(s,["yAxis","tickFormat"],void 0)},margins:ne(s,"margins",{}),legend:ne(s,"legend",{}),tooltip:ne(s,"tooltip",{})})})]})};function dN({context:t}){var d,u,m,p,x,h,f,g,y,v,j,N,S;const{state:{display:s},setState:n}=b.useContext(t||xt),r=b.useRef(null),[a,l]=b.useState(!1),i="menu-btn-appearance-controls";Kt(r,i,()=>l(!1));const c=b.useCallback((w,k,$)=>{n(E=>{w?E.display[w]?E.display[w][k]=$:E.display[w]={[k]:$}:E.display[k]=$})},[]);return e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsx("div",{children:e.jsxs("div",{id:i,className:`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 ${a?"bg-gray-50":"bg-white hover:bg-gray-50"} cursor-pointer`,onClick:w=>l(!a),children:["Appearance ",e.jsx(rn,{id:i,height:18,width:18,className:"mt-1"})]})}),e.jsx("div",{ref:r,className:`${a?"visible transition ease-in duration-200":"hidden transition ease-in duration-200"} absolute left-0 z-10 w-72 origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition focus:outline-none`,children:e.jsxs("div",{className:"py-1 max-h-[500px] overflow-auto scrollbar-sm",children:[e.jsxs("div",{className:"group inline-flex w-full justify-between items-center rounded-md px-1.5 py-1 text-sm font-regular text-gray-900 bg-white hover:bg-gray-50 cursor-pointer",children:[e.jsx("span",{className:"flex-0 select-none mr-1",children:"Type"}),e.jsx("select",{className:"flex-1 p-1 text-end w-full rounded-md bg-white group-hover:bg-gray-50 cursor-pointer",value:s.graphType,onChange:w=>c(null,"graphType",w.target.value),children:[{label:"Bar",value:"BarGraph"},{label:"Line",value:"LineGraph"},{label:"Scatter",value:"ScatterPlot"}].map(({label:w,value:k})=>e.jsx("option",{value:k,children:w},k))})]}),e.jsx("div",{className:"border-t mt-2 mx-4",children:e.jsx("div",{className:"-mt-2 -ml-4 px-2 text-xs font-medium font-gray-800 w-fit bg-white",children:"X Axis"})}),e.jsx(Ls,{title:"Label",type:"text",value:(d=s.xAxis)==null?void 0:d.label,setValue:w=>c("xAxis","label",w)}),e.jsx(Ls,{title:"Tick Spacing",type:"number",value:(u=s.xAxis)==null?void 0:u.tickSpacing,setValue:w=>c("xAxis","tickSpacing",+w)}),e.jsx(it,{title:"Show Gridlines",value:(m=s.xAxis)==null?void 0:m.showGridLines,setValue:w=>c("xAxis","showGridLines",w)}),e.jsx(it,{title:"Rotate Labels",value:(p=s.xAxis)==null?void 0:p.rotateLabels,setValue:w=>c("xAxis","rotateLabels",w)}),e.jsx(it,{title:"Show Axis Bar",value:(x=s.xAxis)==null?void 0:x.showXAxisBar,setValue:w=>c("xAxis","showXAxisBar",w)}),e.jsx("div",{className:"border-t mt-2 mx-4",children:e.jsx("div",{className:"-mt-2 -ml-4 px-2 text-xs font-medium font-gray-800 w-fit bg-white",children:"Y Axis"})}),e.jsx(Ls,{title:"Label",type:"text",value:(h=s.yAxis)==null?void 0:h.label,setValue:w=>c("yAxis","label",w)}),e.jsx(Ls,{title:"Tick Spacing",type:"number",value:(f=s.yAxis)==null?void 0:f.tickSpacing,setValue:w=>c("yAxis","tickSpacing",+w)}),e.jsxs("div",{className:"group inline-flex w-full justify-between items-center rounded-md px-1.5 py-1 text-sm font-regular text-gray-900 bg-white hover:bg-gray-50 cursor-pointer",children:[e.jsx("span",{className:"flex-0 select-none mr-1",children:"Tick Format"}),e.jsx("select",{className:"flex-1 p-1 text-end w-full rounded-md bg-white group-hover:bg-gray-50 cursor-pointer",value:(g=s.yAxis)==null?void 0:g.tickFormat,onChange:w=>c("yAxis","tickFormat",w.target.value),children:[{label:"Default",value:""},{label:"Abbreviate",value:"abbreviate"},{label:"Comma Separated",value:"comma"}].map(({label:w,value:k})=>e.jsx("option",{value:k,children:w},k))})]}),e.jsx(it,{title:"Show Gridlines",value:(y=s.yAxis)==null?void 0:y.showGridLines,setValue:w=>c("yAxis","showGridLines",w)}),e.jsx(it,{title:"Rotate Labels",value:(v=s.yAxis)==null?void 0:v.rotateLabels,setValue:w=>c("yAxis","rotateLabels",w)}),e.jsx("div",{className:"border-t mt-2 mx-4",children:e.jsx("div",{className:"-mt-2 -ml-4 px-2 text-xs font-medium font-gray-800 w-fit bg-white",children:"Graph"})}),e.jsx(Ls,{title:"Title",type:"text",value:(j=s.title)==null?void 0:j.title,setValue:w=>c("title","title",w)}),e.jsx(it,{title:"Legend",value:(N=s.legend)==null?void 0:N.show,setValue:w=>c("legend","show",w)}),e.jsx(it,{title:"Tooltip",value:(S=s.tooltip)==null?void 0:S.show,setValue:w=>c("tooltip","show",w)}),e.jsx(it,{title:"Attribution",value:s.showAttribution,setValue:w=>c(null,"showAttribution",w)}),e.jsx(it,{title:"Scale Filter",value:s.showScaleFilter,setValue:w=>c(null,"showScaleFilter",w)}),e.jsx(Ls,{title:"Height",type:"number",value:s.height,setValue:w=>c(null,"height",+w)}),e.jsx(it,{title:"Always Fetch Data",value:s.readyToLoad,setValue:w=>c(null,"readyToLoad",w)}),e.jsx(it,{title:"Dark Mode",value:s.darkMode,setValue:w=>c(null,"darkMode",w)}),s.graphType==="BarGraph"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t mt-2 mx-4",children:e.jsx("div",{className:"-mt-2 -ml-4 px-2 text-xs font-medium font-gray-800 w-fit bg-white",children:"Layout"})}),e.jsx(it,{title:"Vertical",value:s.orientation==="vertical",setValue:w=>c(null,"orientation",w?"vertical":"horizontal")}),e.jsx(it,{title:"Stacked",value:s.groupMode==="stacked",setValue:w=>c(null,"groupMode",w?"stacked":"grouped")}),e.jsx(it,{title:"Log Scale",value:s.isLog,setValue:w=>c(null,"isLog",w)})]}):null]},"appearance")})]})}const uN=["",null],mN=t=>uN.includes(t)?!0:isNaN(t),lc={text:"font-regular text-[12px]",darkModeText:"bg-transparent text-white",headerWrapper:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-4 gap-x-1 gap-y-0.5",columnControlWrapper:"px-1 font-semibold border bg-gray-50 text-gray-500",scaleWrapper:"flex rounded-md p-1 divide-x border w-fit",scaleItem:"font-semibold text-gray-500 hover:text-gray-700 px-2 py-1"},Kd=({isEdit:t})=>{const{state:{columns:s,data:n,display:r},setState:a}=b.useContext(xt),{theme:l={graph:lc}}=C.useContext(me)||{},i=b.useMemo(()=>s.find(({xAxis:y})=>y)||{},[s]),c=b.useMemo(()=>s.filter(({yAxis:y})=>y)||[],[s]),d=b.useMemo(()=>s.find(({categorize:y})=>y)||{},[s]),u=b.useMemo(()=>{const y=[];return n.forEach(v=>{const j=v[i.name]&&typeof v[i.name]!="object"&&typeof v[i.name]!="string"?v[i.name].toString():v[i.name];c.forEach(N=>{const S=v[N.normalName||N.name],w=d.name?v[d.name]:N.customName||N.display_name||N.name;!mN(S)&&w&&(!r.isLog||S>0)&&y.push({index:j,type:w,value:S,aggMethod:N.fn})})}),y},[i,c.length,d,n]),m=d.name?new Set(n.map(y=>y[d.name])).size:c.length,p=b.useMemo(()=>({type:"palette",value:[...Ao(m<20?m:20,"div7")]}),[m]),x=u.reduce((y,v)=>(y[v.index]=(y[v.index]||0)+(+v.value||0),y),{}),h=Math.max(...Object.values(x)),g=[.75,.5,.05].map(y=>h*y);return e.jsxs(e.Fragment,{children:[t?e.jsx("div",{className:l.graph.headerWrapper,children:[i,...c].filter(y=>y.name).map((y,v)=>e.jsx("div",{className:l.graph.columnControlWrapper,children:e.jsx(ac,{isEdit:t,attribute:y})},`controls-${v}`))}):null,r.showScaleFilter?e.jsxs("div",{className:l.graph.scaleWrapper,children:[e.jsx("div",{className:`${l.graph.scaleItem} ${r!=null&&r.upperLimit?l.graph.scaleItemInActive:l.graph.scaleItemActive}`,onClick:()=>a(y=>{y.display.upperLimit=void 0}),children:"Max"}),g.map(y=>e.jsx("div",{className:`${l.graph.scaleItem} ${(r==null?void 0:r.upperLimit)===y?l.graph.scaleItemActive:l.graph.scaleItemInActive}`,onClick:()=>a(v=>{v.display.upperLimit=y}),children:Yl(y,0)},y))]}):null,e.jsx(cN,{graphFormat:{...r,colors:p},activeGraphType:{GraphComp:r.graphType},viewData:u,showCategories:!!d.name||c.length>1,xAxisColumn:i,yAxisColumns:c})]})},pN=Ao(20,"div7"),xN={graphType:"BarGraph",groupMode:"stacked",orientation:"vertical",showAttribution:!0,title:{title:"",position:"start",fontSize:32,fontWeight:"bold"},description:"",bgColor:"#ffffff",textColor:"#000000",colors:{type:"palette",value:[...pN]},height:300,width:void 0,margins:{marginTop:20,marginRight:20,marginBottom:50,marginLeft:100},xAxis:{label:"",rotateLabels:!1,showGridLines:!1,tickSpacing:1},yAxis:{label:"",showGridLines:!0,tickFormat:"Integer"},legend:{show:!0,label:""},tooltip:{show:!0,fontSize:12}},hN={dataRequest:{},columns:[],data:[],display:xN,sourceInfo:{columns:[]}},fN={name:"Graph",type:"Graph",variables:[],useDataSource:!0,fullDataLoad:!0,useGetDataOnPageChange:!1,showPagination:!1,defaultState:hN,controls:{columns:[{type:"select",label:"Fn",key:"fn",disabled:({attribute:t})=>!t.yAxis||!t.show,options:[{label:"fn",value:" "},{label:"list",value:"list"},{label:"sum",value:"sum"},{label:"count",value:"count"}]},{type:"select",label:"Exclude N/A",key:"excludeNA",options:[{label:"include n/a",value:!1},{label:"exclude n/a",value:!0}]},{type:"toggle",label:"X Axis",key:"xAxis",onChange:({key:t,value:s,attribute:n,state:r,columnIdx:a})=>{n.yAxis||n.categorize||r.columns.forEach(l=>{l.xAxis=s&&l.name===n.name,l.group=l.name===n.name?s:l.categorize,l.show=l.name===n.name?s:l.yAxis||l.categorize})}},{type:"toggle",label:"Y Axis",key:"yAxis",onChange:({key:t,value:s,attribute:n,state:r,columnIdx:a})=>{var i;if(n.xAxis||n.categorize)return;const l=(i=r.columns[a].defaultFn)==null?void 0:i.toLowerCase();r.columns[a].fn=s?["sum","count"].includes(l)?l:"count":"",r.columns[a].show=s}},{type:"toggle",label:"Categorize",key:"categorize",onChange:({key:t,value:s,attribute:n,state:r,columnIdx:a})=>{n.xAxis||n.yAxis||r.columns.forEach(l=>{l.categorize=s&&l.name===n.name,l.group=l.name===n.name?s:l.xAxis,l.show=l.name===n.name?s:l.yAxis||l.xAxis})}},{type:"toggle",label:"Filter",key:"filters",trueValue:[{type:"internal",operation:"filter",values:[]}]},nc],appearance:{Comp:dN},inHeader:[{type:"select",label:"Sort",key:"sort",options:[{label:"Not Sorted",value:""},{label:"A->Z",value:"asc nulls last"},{label:"Z->A",value:"desc nulls last"}]},{type:"select",label:"Format",key:"formatFn",options:[{label:"No Format Applied",value:" "},{label:"Comma Seperated",value:"comma"},{label:"Abbreviated",value:"abbreviate"}]}]},EditComp:Kd,ViewComp:Kd},$h={navOptions:{logo:"",sideNav:{size:"none",search:"none",logo:"none",dropdown:"none",fixedMargin:"lg:ml-44",position:"fixed",nav:"none"},topNav:{size:"compact",dropdown:"right",search:"right",logo:"left",position:"sticky",nav:"main"}},heading:{base:"p-2 w-full font-sans font-medium text-md bg-transparent",1:"text-blue-500 font-bold text-xl tracking-wider py-1 pl-1",2:"text-lg tracking-wider",3:"text-md tracking-wide",default:""},levelClasses:{1:" pt-2 pb-1 uppercase text-sm text-blue-400 hover:underline cursor-pointer border-r-2 mr-4",2:"pl-2 pt-2 pb-1 uppercase text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4",3:"pl-4 pt-2 pb-1 text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4",4:"pl-6 pt-2 pb-1 text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4"},navPadding:{1:"pt-0 ",2:"md:pt-12 pt-0",3:"md:pt-32 pt-0"},navLabel:"px-6 pb-1 pt-6 uppercase text-xs text-blue-400",page:{container:"bg-slate-100",wrapper1:"w-full h-full flex-1 flex flex-col",wrapper2:"w-full h-full flex-1 flex flex-row px-1 md:px-6 py-6",wrapper3:"flex flex-1 w-full  flex-col border shadow bg-white relative text-md font-light leading-7 p-4 min-h-[calc(100vh_-_102px)]",iconWrapper:"z-5 absolute right-[10px] top-[5px]",icon:"text-slate-400 hover:text-blue-500"},sectionGroup:W3,sectionArray:ah,layout:rC,sidenav:J4,topnav:U4,tabs:qx,button:Gx,menu:jh,input:ec,icon:Jx,field:sc,nestable:So,dialog:Yx,popover:Kx,label:Ch,select:eh,listbox:jC,table:Hr,lexical:yr,dataCard:vh,attribution:dh,filters:rc,graph:lc,Icons:Gl},Ss={settings:{theme:{label:"Theme",defaultOpen:!0,controls:{theme:{label:"Theme",type:"select",options:["default","catalyst","mny","mny_admin"]}}}},navOptions:{topNav:{label:"Top Nav",defaultOpen:!0,controls:{size:{label:"Size",type:"select",options:["none","compact"]},logo:{label:"Logo",type:"select",options:["none","left","right"]},search:{label:"Search",type:"select",options:["none","left","right"]},dropdown:{label:"Menu",type:"select",options:["none","left","right"]},nav:{label:"Navigation",type:"select",options:["none","main","secondary"]}}},sideNav:{label:"Side Nav",defaultOpen:!1,controls:{size:{label:"Size",type:"select",options:["none","micro","mini","compact","full"]},depth:{label:"Depth",type:"select",options:[1,2,3]},logo:{label:"Logo",type:"select",options:["none","top","bottom"]},search:{label:"Search",type:"select",options:["none","top","bottom"]},dropdown:{label:"Menu",type:"select",options:["none","top","bottom"]},nav:{label:"Navigation",type:"select",options:["none","main","secondary"]}}},secondaryNav:{label:"Secondary Nav",defaultOpen:!1,controls:{navItems:{label:"Nav Items",type:"menu"}}},authMenu:{label:"Auth Menu",defaultOpen:!1,controls:{navItems:{label:"Nav Items",type:"menu"}}}}};function gN({open:t,setOpen:s,CloseIcon:n=Pr,width:r="max-w-64",children:a,closeOnClick:l=!0}){return e.jsx(Oe.Root,{as:b.Fragment,show:t,children:e.jsx(Oe.Child,{as:b.Fragment,enter:"transform transition ease-in-out duration-500 sm:duration-700",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-500 sm:duration-700",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsxs("div",{className:`${t?"fixed":"hidden"} findmeclass right-0 top-0 bottom-0 z-50 ${r} translate-x-0 bg-white shadow-lg `,children:[e.jsx("div",{className:"",children:e.jsx("div",{className:"fixed right-2 top-2",children:e.jsxs("button",{type:"button",className:"relative rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>s(!1),children:[e.jsx("span",{className:"absolute -inset-2.5"}),e.jsx("span",{className:"sr-only",children:"Close panel"}),e.jsx(n,{className:"size-6","aria-hidden":"true"})]})})}),a]})})})}const bN=["#d0021b","#f5a623","#f8e71c","#8b572a","#7ed321","#417505","#bd10e0","#9013fe","#4a90e2","#50e3c2","#b8e986","#000000","#4a4a4a","#9b9b9b","#ffffff"],Jn=214,eu=150,ts={"color-picker-wrapper":"p-[20px] bg-white","color-picker-basic-color":"flex flex-wrap gap-[10px] m-0 p-0","color-picker-basic-color-button":"border-[1px] border-[solid] border-[#ccc] rounded-[4px] h-[16px] w-[16px] cursor-pointer list-none","color-picker-basic-color-button.active":"[box-shadow:0px_0px_2px_2px_rgba(0,_0,_0,_0.3)]","color-picker-saturation":"w-full relative mt-[15px] h-[150px] bg-[linear-gradient(transparent,_black),_linear-gradient(to_right,_white,_transparent)] select-none","color-picker-saturation_cursor":"absolute w-[20px] h-[20px] border-[2px] border-[solid] border-[#ffffff] rounded-[50%] [box-shadow:0_0_15px_#00000026] box-border -translate-x-[10px] -translate-y-[10px]","color-picker-hue":"w-full relative mt-[15px] h-[12px] bg-[linear-gradient(_to_right,_rgb(255,_0,_0),_rgb(255,_255,_0),_rgb(0,_255,_0),_rgb(0,_255,_255),_rgb(0,_0,_255),_rgb(255,_0,_255),_rgb(255,_0,_0)_)] select-none rounded-[12px]","color-picker-hue_cursor":"absolute w-[20px] h-[20px] border-[2px] border-[solid] border-[#ffffff] rounded-full [box-shadow:#0003_0_0_0_0.5px] box-border -translate-x-[10px] -translate-y-[4px]","color-picker-color":"border-[1px] border-[solid] border-[#ccc] mt-[15px] w-full h-[20px]"};function Sh({color:t,onChange:s,colors:n,showColorPicker:r=!0}){const[a,l]=b.useState(Xn("hex",t)),[i,c]=b.useState(t),d=b.useRef(null),u=b.useMemo(()=>({x:a.hsv.s/100*Jn,y:(100-a.hsv.v)/100*eu}),[a.hsv.s,a.hsv.v]),m=b.useMemo(()=>({x:a.hsv.h/360*Jn}),[a.hsv]),p=({x:f,y:g})=>{const y={...a.hsv,s:f/Jn*100,v:100-g/eu*100},v=Xn("hsv",y);l(v),c(v.hex)},x=({x:f})=>{const g={...a.hsv,h:f/Jn*360},y=Xn("hsv",g);l(y),c(y.hex)};b.useEffect(()=>{d.current!==null&&s&&(s(a.hex),c(a.hex))},[a,s]),b.useEffect(()=>{if(t===void 0)return;const f=Xn("hex",t);l(f),c(f.hex)},[t]);const h=b.useMemo(()=>n||bN,[n]);return e.jsxs("div",{className:`${ts["color-picker-wrapper"]}`,style:{width:Jn},ref:d,children:[e.jsx("div",{className:`${ts["color-picker-basic-color"]}`,children:h.map(f=>e.jsx("button",{className:`${ts["color-picker-basic-color-button"]} ${f===a.hex?ts["color-picker-basic-color-button.active"]:""}`,style:{backgroundColor:f},onClick:()=>{c(f),l(Xn("hex",f))}},f))}),r?e.jsxs(e.Fragment,{children:[e.jsx(tu,{className:`${ts["color-picker-saturation"]}`,style:{backgroundColor:`hsl(${a.hsv.h}, 100%, 50%)`},onChange:p,children:e.jsx("div",{className:`${ts["color-picker-saturation_cursor"]}`,style:{backgroundColor:a.hex,left:u.x,top:u.y}})}),e.jsx(tu,{className:`${ts["color-picker-hue"]}`,onChange:x,children:e.jsx("div",{className:`${ts["color-picker-hue_cursor"]}`,style:{backgroundColor:`hsl(${a.hsv.h}, 100%, 50%)`,left:m.x}})}),e.jsx("div",{className:`${ts["color-picker-color"]}`,style:{backgroundColor:a.hex}})]}):null]})}function tu({className:t,style:s,onChange:n,children:r}){const a=b.useRef(null),l=c=>{if(a.current){const{current:d}=a,{width:u,height:m,left:p,top:x}=d.getBoundingClientRect(),h=su(c.clientX-p,u,0),f=su(c.clientY-x,m,0);n({x:h,y:f})}},i=c=>{if(c.button!==0)return;l(c);const d=m=>{l(m)},u=m=>{document.removeEventListener("mousemove",d,!1),document.removeEventListener("mouseup",u,!1),l(m)};document.addEventListener("mousemove",d,!1),document.addEventListener("mouseup",u,!1)};return e.jsx("div",{ref:a,className:t,style:s,onMouseDown:i,children:r})}function su(t,s,n){return t>s?s:t<n?n:t}function nu(t){if(t.startsWith("#")){if(t.length===4||t.length===5)return t=t.split("").map((s,n)=>n?s+s:"#").join(""),t;if(t.length===7||t.length===9)return t}else{const s=document.createElement("canvas").getContext("2d");if(!s)throw new Error("2d context not supported or canvas already initialized");return s.fillStyle=t,s.fillStyle}return"#000000"}function ru(t){const s=(t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(n,r,a,l)=>"#"+r+r+a+a+l+l).substring(1).match(/.{2}/g)||[]).map(n=>parseInt(n,16));return{b:s[2],g:s[1],r:s[0]}}function hl({r:t,g:s,b:n}){t/=255,s/=255,n/=255;const r=Math.max(t,s,n),a=r-Math.min(t,s,n),l=a?(r===t?(s-n)/a+(s<n?6:0):r===s?2+(n-t)/a:4+(t-s)/a)*60:0,i=r?a/r*100:0,c=r*100;return{h:l,s:i,v:c}}function yN({h:t,s,v:n}){s/=100,n/=100;const r=~~(t/60),a=t/60-r,l=n*(1-s),i=n*(1-s*a),c=n*(1-s*(1-a)),d=r%6,u=Math.round([n,i,l,l,c,n][d]*255),m=Math.round([c,n,n,i,l,l][d]*255);return{b:Math.round([l,l,c,n,n,i][d]*255),g:m,r:u}}function au({b:t,g:s,r:n}){return"#"+[n,s,t].map(r=>r.toString(16).padStart(2,"0")).join("")}function Xn(t,s){let n=nu("#121212"),r=ru(n),a=hl(r);return t==="hex"?(n=nu(s),r=ru(n),a=hl(r)):t==="rgb"?(r=s,n=au(r),a=hl(r)):t==="hsv"&&(a=s,r=yN(a),n=au(r)),{hex:n,hsv:a,rgb:r}}const vN=t=>{const[s,n]=C.useState(null);return C.useEffect(()=>{const r=a=>{s.contains(a.target)||typeof t=="function"&&t(a)};return s&&document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[s,t]),[n,s]};function wN({control:t,children:s,className:n,width:r="w-full min-w-[200px] max-w-[200px]",openType:a="hover"}){const[l,i]=C.useState(!1),c=C.useCallback(()=>i(!1),[]),[d]=vN(c);return e.jsxs("div",{ref:d,className:`relative cursor-pointer ${n}`,onMouseEnter:u=>{a==="hover"&&i(!0)},onMouseLeave:u=>i(!1),onClick:u=>{i(!l)},children:[t,l?e.jsx("div",{className:`shadow absolute ${r} rounded-b-lg ${l?"block":"hidden"} z-10 right-0`,children:s}):""]})}function _h({children:t,width:s="w-64",custom:n="top-20"}){return e.jsx("div",{className:`${s} hidden xl:block`,children:e.jsx("div",{className:`${s} sticky ${n}  hidden xl:block`,children:t})})}function Wr({title:t,prompt:s,item:n={},open:r,setOpen:a,onDelete:l}){const i=b.useRef(null),{baseUrl:c}=C.useContext(me)||{},[d,u]=b.useState(!1);return e.jsxs(Vr,{open:r,setOpen:a,initialFocus:i,children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fa fa-danger h-6 w-6 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[e.jsx(rp,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:t||`Delete ${n.title||""} ${n.id}`}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:s||`Are you sure you want to delete this page? All of the page data will be permanently removed
              from our servers forever. This action cannot be undone.`})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{type:"button",disabled:d,className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",onClick:l,children:["Delet",d?"ing...":"e"]}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>a(!1),ref:i,children:"Cancel"})]})]})}function Vr({open:t,setOpen:s,initialFocus:n,children:r}){return e.jsx(Oe.Root,{show:t,as:b.Fragment,children:e.jsxs(Je,{as:"div",className:"relative z-30",initialFocus:n,onClose:s,children:[e.jsx(Oe.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),e.jsx("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:e.jsx("div",{onClick:()=>{s(!1)},className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:e.jsx(Oe.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:e.jsx(mo,{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6",children:r})})})})]})})}const dt=C.createContext(void 0);function jN({item:t,dataItems:s,attributes:n,logo:r,rightMenu:a,siteType:l,apiLoad:i,apiUpdate:c,format:d,busy:u}){var v,j,N;const m=bt();t||(t={}),C.useEffect(()=>{d4(t,p,m)},[]),b.useRef();let{baseUrl:p,theme:x,user:h,API_HOST:f}=C.useContext(me)||{};x=Ze(pe(x),(t==null?void 0:t.theme)||{}),C.useMemo(()=>n.sections.ViewComp,[]);const g=C.useMemo(()=>Co(s,p,!1),[s]);t!=null&&t.sections;const y=S=>((t==null?void 0:t.section_groups)||[]).filter((w,k)=>w.position===S).sort((w,k)=>(w==null?void 0:w.index)-(k==null?void 0:k.index)).map((w,k)=>e.jsx(wh,{group:w,attributes:n},(w==null?void 0:w.name)||k));return e.jsx(dt.Provider,{value:{item:t,dataItems:s,apiLoad:i,apiUpdate:c,format:d,busy:u},children:e.jsxs("div",{className:`${(v=x==null?void 0:x.page)==null?void 0:v.container}`,children:[y("top"),e.jsx(Rr,{navItems:g,secondNav:((N=(j=x==null?void 0:x.navOptions)==null?void 0:j.secondaryNav)==null?void 0:N.navItems)||[],pageTheme:{navOptions:t.navOptions||{}},children:y("content")}),y("bottom")]})})}const CN=async(t,s,n="",r,a)=>{if(t.id&&n!==t.title){let l=t.history?pe(t.history):[],i={type:`changed page title to ${n}`,user:r.email,time:new Date().toString()};l.push(i);const c={id:t.id,title:n,parent:(t==null?void 0:t.parent)||"",history:l};c.url_slug=vs(c,s),a({data:c,newPath:`/edit/${c.url_slug}`})}},NN=async(t,s="",n,r)=>{if(!t.id)return;let a=t.history?pe(t.history):[],l={type:s,user:n.email,time:new Date().toString()};a.push(l);const i={...pe(t),history:a};r({data:i})},kN=async(t,s,n)=>{if(!s.id)return;let r={type:"published changes.",user:t.email,time:new Date().toString()},a=s!=null&&s.history?pe(s.history):[];a.push(r);const l={id:s.id,has_changes:!1,published:"",history:a};let i=pe(s.sections||[]).reduce((c,d)=>(d.draft_id&&(c[d.draft_id]=d),c),{});l.sections=pe(s.draft_sections||[]).reduce((c,d)=>(i[d.id]?d.id=i[d.id].id:delete d.id,c.push(d),c),[]),l.section_groups=pe(s.draft_section_groups),n({data:l})},$N=async(t,s,n)=>{if(!s.id)return;let r={type:"discarded changes.",user:t.email,time:new Date().toString()},a=s!=null&&s.history?pe(s.history):[];a.push(r);const l={...pe(s),has_changes:!1,published:"",history:a};l.draft_sections=s.sections.map(i=>(delete i.id,i)),n({data:l})};function SN(){var c,d,u;const{baseUrl:t,user:s,theme:n}=C.useContext(me)||{},{item:r,dataItems:a,apiUpdate:l}=C.useContext(dt)||{},i=C.useMemo(()=>{var m;return(((m=n==null?void 0:n.pageOptions)==null?void 0:m.settingsPane)||[]).map(p=>(p.value=ne(r,p.location,p.default||""),p.onChange=x=>{cn(r,p.location,x.target.value,l)},p)).filter(p=>p)},[(c=n==null?void 0:n.pageOptions)==null?void 0:c.settingsPane,r]);return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"px-4 sm:px-6 py-2",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsx("h1",{className:"text-base font-semibold leading-6 text-gray-900",children:"Settings"})})}),e.jsx("div",{className:"relative mt-6 flex-1 px-4 sm:px-6 w-full   max-h-[calc(100vh_-_135px)] overflow-y-auto",children:e.jsx($C,{components:[{type:"ConfirmInput",label:"Page Name",value:r.title,onChange:m=>{console.log("Change page Name",m),CN(r,a,m,s,l)}},{type:"Select",label:"Hide in Nav",value:r.hide_in_nav||"",options:[{label:"Show",value:""},{label:"Hide",value:"hide"}],onChange:m=>{cn(r,"hide_in_nav",m.target.value,l)}},{type:"Select",label:"Show Content Sidebar",value:r.sidebar||"",options:[{label:"None",value:""},{label:"Left",value:"left"},{label:"Right",value:"right"}],onChange:m=>{cn(r,"sidebar",m.target.value,l)}},{type:"Select",label:"Show SideNav",value:((u=(d=r==null?void 0:r.navOptions)==null?void 0:d.sideNav)==null?void 0:u.size)||"",options:[{label:"Show",value:"compact"},{label:"Hide",value:"none"}],onChange:m=>{cn(r,"navOptions.sideNav.size",m.target.value,l)}},{type:"Listbox",label:"Icon",value:r==null?void 0:r.icon,options:[...Object.keys(n.Icons).map(m=>({label:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"px-2",children:e.jsx(qe,{icon:m,className:"size-6"})}),e.jsx("div",{children:m})]}),value:m})),{label:"No Icon",value:"none"}],onChange:m=>{cn(r,"icon",m,l)}},{type:"Input",label:"Page Description",value:(r==null?void 0:r.description)||"",onChange:m=>{cn(r,"description",m.target.value,l)}},...i]})})]})}const cn=async(t,s,n="",r)=>{var i,c;const a={id:t.id};ap(a,s,n),console.log("update",s,a);let l="draft_sections";s==="header"&&!((c=(i=t==null?void 0:t[l])==null?void 0:i.filter(d=>d.is_header))!=null&&c[0])&&(a[l]=pe(t[l]||[]),a[l].unshift({is_header:!0,size:2,element:{"element-type":"Header: Default Header","element-data":{}}})),r({data:a})};function _N(){const{item:t,dataItems:s}=C.useContext(dt)||{};return e.jsxs("div",{className:"flex h-full flex-col flex-1",children:[e.jsx("div",{className:"px-4 sm:px-6 py-2",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsx("h1",{className:"text-base font-semibold leading-6 text-slate-900",children:"Pages"})})}),e.jsx("div",{className:"relative flex-1 w-full ",children:e.jsx(bC,{item:t,dataItems:s,NavComp:IN})})]})}function IN({activeItem:t,item:s,dataItems:n,handleCollapseIconClick:r,isCollapsed:a,edit:l}){var v,j,N,S,w,k;const{baseUrl:i,user:c,theme:d}=C.useContext(me),{apiUpdate:u}=C.useContext(dt)||{},{pathname:m="/edit"}=Ge(),p=bt(),[x,h]=C.useState(!1),[f,g]=C.useState(!1);if(!n.find($=>(s==null?void 0:s.id)===$.id))return;const y=m.includes(s.url_slug);return e.jsxs("div",{className:"group max-w-full",children:[e.jsxs("div",{className:`${y?(v=d==null?void 0:d.nestable)==null?void 0:v.navItemContainerActive:(j=d==null?void 0:d.nestable)==null?void 0:j.navItemContainer} `,children:[e.jsx(Ym,{className:(N=d==null?void 0:d.nestable)==null?void 0:N.navLink,to:`${l?`${i}/edit`:i}/${s.url_slug||s.id}`,children:s.title||s.id}),e.jsx("div",{className:"flex gap-0.5 items-center",children:e.jsx(Mo,{items:[{name:e.jsx("span",{className:"",children:"Rename"}),onClick:()=>g(!0)},{name:e.jsx("span",{className:"text-red-400",children:"Delete"}),onClick:()=>h(!0)}],children:e.jsx("div",{className:"flex items-center text-slate-300 hover:text-slate-600 rounded-full hover:bg-blue-300",children:e.jsx(Ax,{className:"size-5"})})})}),(S=s.children)!=null&&S.length?a?e.jsx(Pn,{className:(w=d==null?void 0:d.nestable)==null?void 0:w.collapsIcon,onClick:()=>r()}):e.jsx(ds,{className:(k=d==null?void 0:d.nestable)==null?void 0:k.collapsIcon,onClick:()=>r()}):e.jsx("div",{className:"size-6"})]}),e.jsx(LN,{item:s,open:x,setOpen:()=>h(!x),onDelete:()=>{async function $(){await p(mt(s,"delete"),{method:"post",action:m}),h(!x)}$()}}),e.jsx(EN,{activeItem:t,item:s,dataItems:n,open:f,setOpen:()=>g(!f)})]},s.id)}function LN({title:t,prompt:s,item:n={},open:r,setOpen:a,onDelete:l}){const i=b.useRef(null),[c,d]=b.useState(!1);return e.jsxs(Qx,{open:r,onClose:a,initialFocus:i,children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fa fa-danger h-6 w-6 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[e.jsx("h3",{className:"text-base font-semibold leading-6 text-gray-900",children:t||`Delete ${n.title||""} ${n.id}`}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:s||`Are you sure you want to delete this page? All of the page data will be permanently removed
              from our servers forever. This action cannot be undone.`})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsxs(qt,{disabled:c,onClick:l,children:["Delet",c?"ing...":"e"]}),e.jsx(qt,{type:"plain",className:"mr-1",onClick:()=>a(),forwardref:i,children:"Cancel"})]})]})}function EN({title:t,prompt:s,item:n={},dataItems:r,open:a,setOpen:l}){const i=b.useRef(null),{user:c}=C.useContext(me)||{},d=bt(),{pathname:u="/edit"}=Ge(),[m,p]=b.useState(!1),[x,h]=b.useState(n.title),f=()=>{(async()=>{var v;let y=((v=r.filter(j=>j.id===n.id))==null?void 0:v[0])||n;if(x!==y.title){const j={id:y.id,title:x,parent:y==null?void 0:y.parent};j.url_slug=vs(j,r);const N=u.endsWith(n.url_slug)?u.replace(new RegExp(n.url_slug+"$"),j.url_slug):u;p(!0),await d(mt(j),{method:"post",action:N}),p(!1),l()}})()};return e.jsxs(Qx,{open:a,onClose:()=>{},initialFocus:i,children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fa fa-danger h-6 w-6 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:[e.jsxs("h3",{className:"text-base font-semibold leading-6 text-gray-900",children:["Rename ",n.title]}),e.jsx("div",{className:"mt-2 w-full",children:e.jsx("input",{value:x,onChange:g=>h(g.target.value)})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx(qt,{disabled:m,onClick:f,children:m?"Saving...":"Submit"}),e.jsx(qt,{type:"plain",className:"mr-1",onClick:()=>l(),ref:i,children:"Cancel"})]})]})}function MN(){const{item:t,apiUpdate:s}=C.useContext(dt)||{},n=t.published==="draft"||t.has_changes,{user:r}=C.useContext(me)||{};return e.jsxs("div",{className:"w-full flex justify-center h-[40px]",children:[n&&e.jsx(qt,{padding:"flex items-center h-[40px] mr-1 cursor-pointer",type:"inactive",onClick:()=>$N(r,t,s),children:e.jsx("span",{className:"text-nowrap",children:" Discard "})}),e.jsx(qt,{padding:" flex items-center h-[40px]",disabled:!n,type:n?"active":"inactive",onClick:()=>kN(r,t,s),children:e.jsxs("span",{className:"text-nowrap",children:[" ",n?"Publish":"No Changes"," "]})})]})}function AN(){const{baseUrl:t,user:s}=C.useContext(me)||{},{item:n,dataItems:r,apiUpdate:a}=C.useContext(dt)||{};return console.log("edit History",n),e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"px-4 sm:px-6 py-2",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsx("h1",{className:"text-base font-semibold leading-6 text-gray-900",children:"History"})})}),e.jsx("div",{className:"relative flex-1 px-4 sm:px-6 w-full max-h-[calc(100vh_-_135px)] overflow-y-auto",children:e.jsx(TN,{history:(n==null?void 0:n.history)||[],onChange:l=>NN(n,l,s,a)})})]})}function ou(...t){return t.filter(Boolean).join(" ")}function TN({history:t,onChange:s}){const[n,r]=b.useState("");return e.jsx(e.Fragment,{children:e.jsxs("ul",{role:"list",className:"space-y-6",children:[e.jsxs("li",{className:"relative flex gap-x-4",children:[e.jsx("div",{className:ou(t.length?"-bottom-6":"h-6","absolute left-0 top-0 flex w-6 justify-center"),children:e.jsx("div",{className:"w-px bg-gray-200"})}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative flex h-6 w-6 flex-none items-center justify-center bg-white",children:e.jsx(Ix,{width:10,height:10,className:"text-gray-400 hover:text-gray-500 cursor-pointer"})}),e.jsx("input",{className:"flex-auto py-0.5 text-xs leading-5 text-gray-500 rounded-md",type:"text",placeholder:"add a comment",value:n,onChange:a=>r(a.target.value)}),n!=null&&n.length?e.jsx("button",{className:"p-1 rounded-md bg-blue-300 hover:bg-blue-600 text-white",onClick:()=>{s(`commented: ${n}`),r("")},children:"add"}):null]})]},"add-new"),t.sort((a,l)=>new Date(l.time)-new Date(a.time)).map((a,l)=>{const i=a.type.startsWith("commented:"),c=i?a.type.split("commented:")[1]:null;return e.jsxs("li",{className:"relative flex gap-x-4",children:[e.jsx("div",{className:ou(l===t.length-1?"h-6":"-bottom-6","absolute left-0 top-0 flex w-6 justify-center"),children:e.jsx("div",{className:"w-px bg-gray-200"})}),e.jsx("div",{className:"relative flex h-6 w-6 flex-none items-center justify-center bg-white",children:e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-gray-100 ring-1 ring-gray-300"})}),e.jsx("div",{className:`${i?"border p-2 rounded-md":""} w-full`,children:e.jsxs("p",{className:"flex-auto py-0.5 text-xs leading-5 text-gray-500",children:[e.jsx("span",{className:"font-medium text-gray-900",children:a.user}),e.jsx("span",{className:"ml-0.5",children:i?"commented":a.type}),e.jsx("time",{dateTime:a.time,className:"float-right flex-none py-0.5 text-xs leading-5 text-gray-500",children:a4(a.time)}),i?e.jsx("div",{className:"text-sm/6 text-gray-500",children:c}):null]})})]},a.id)})]})})}function ON({group:t}){const{theme:s}=C.useContext(me)||{},{item:n,apiUpdate:r}=C.useContext(dt)||{},a=(c,d)=>{let u=pe(n.draft_section_groups);const m=u.findIndex(x=>x.name===t.name);ap(u,`[${m}][${c}]`,d);let p={id:n.id,draft_section_groups:u};r({data:p})},l=()=>{const c={id:n.id,draft_section_groups:pe(n.draft_section_groups).filter(d=>d.name!==t.name)};r({data:c})},i=[{type:"seperator"},{icon:"Width",name:"Full Width",type:"menu",value:(t==null?void 0:t.full_width)||"off",items:["off","show"].map((c,d)=>({icon:c==((t==null?void 0:t.full_width)||"off")?"CircleCheck":"Blank",name:c,onClick:()=>{a("full_width",c)}}))},{icon:"Theme",name:"Theme",type:"menu",value:(t==null?void 0:t.theme)||"default",items:Object.keys((s==null?void 0:s.sectionGroup)||{}).map((c,d)=>({icon:c==((t==null?void 0:t.theme)||"None")?"CircleCheck":"Blank",name:c,onClick:()=>{a("theme",c)}}))},{type:"seperator"},{icon:"TrashCan",name:"Delete",onClick:()=>l()}];return e.jsxs("div",{className:"border p-4 flex justify-between items-center",children:[e.jsx("div",{children:(t==null?void 0:t.displayName)||(t==null?void 0:t.name)}),e.jsx("div",{children:e.jsx(Mo,{items:i,children:e.jsx("div",{className:"p-1 hover:bg-slate-100/75 rounded-lg",children:e.jsx(qe,{icon:"Menu",className:"text-slate-500 hover:text-slate-900 size-6"})})})})]})}function DN(){const{baseUrl:t,user:s,theme:n}=C.useContext(me)||{},{item:r,dataItems:a,apiUpdate:l}=C.useContext(dt)||{},i=["top","content","bottom"],c=d=>{let u={id:r.id,draft_section_groups:[...r.draft_section_groups,{name:tn(),displayName:`Group ${r.draft_section_groups.length+1}`,position:d,theme:"default"}]};l({data:u})};return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"px-4 sm:px-6 py-2",children:e.jsx("div",{className:"flex items-start",children:e.jsx("h1",{className:"text-base font-semibold leading-6 text-gray-900",children:"Section Groups"})})}),e.jsx("div",{className:"relative mt-6 flex-1 px-4 sm:px-6 w-full h-screen overflow-y-auto",children:i.map((d,u)=>e.jsxs("div",{className:"h-full",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("h1",{className:"text-base font-semibold uppercase leading-6 text-gray-900",children:d}),e.jsx("div",{onClick:()=>c(d),children:" Add "})]}),r==null?void 0:r.draft_section_groups.filter((m,p)=>m.position===d).sort((m,p)=>(m==null?void 0:m.index)-(p==null?void 0:p.index)).map((m,p)=>e.jsx(ON,{group:m},p))]},u))})]})}const Ih=[{icon:"Settings",Component:SN},{icon:"Sections",Component:DN},{icon:"Pages",Component:_N},{icon:"History",Component:AN}];function BN(){const{baseUrl:t,user:s}=C.useContext(me)||{},{item:n,dataItems:r,apiUpdate:a,editPane:l,setEditPane:i}=C.useContext(dt)||{};return n.published==="draft"||n.has_changes,e.jsx("div",{className:"fixed bottom-[12px] left-0 right-0 z-50 pointer-events-none",children:e.jsxs("div",{className:"flex items-cemter p-1 justify-between bg-neutral-900 w-[500px] mx-auto rounded-[12px] shadow pointer-events-auto",children:[Ih.map((c,d)=>e.jsx("div",{className:"flex items-cemter  px-2 py-2 cursor-pointer rounded-[12px] hover:bg-slate-700 group",onClick:()=>i({...l,index:d,open:!l.openX}),children:e.jsx(qe,{icon:c==null?void 0:c.icon,className:"size-6 group-hover:text-blue-500 text-slate-400"})},(c==null?void 0:c.icon)||d)),e.jsx("div",{className:"h-9 mt-0.5 w-[1px] mx-1  bg-slate-600"}),e.jsx("div",{className:"flex items-cemter  px-2 py-2 cursor-pointer rounded-[12px] hover:bg-slate-700 group",onClick:()=>i({...l,showGrid:!l.showGrid}),children:e.jsx(qe,{icon:"Grid",className:"size-6 group-hover:text-blue-500 text-slate-400"})}),e.jsx("div",{className:"flex-1",children:" "}),e.jsx("div",{className:"",children:e.jsx(MN,{})})]})})}function FN(){const{busy:t}=C.useContext(dt)||{};return e.jsxs("div",{className:`fixed bottom-4 right-4 p-6 border rounded bg-white shadow ${(t==null?void 0:t.loading)>0||(t==null?void 0:t.updating)>0?"block":"hidden"} `,children:[e.jsx("div",{children:(t==null?void 0:t.updating)>0&&`Updating... ${t==null?void 0:t.updating}`}),e.jsx("div",{children:(t==null?void 0:t.loading)>0&&`Loading... ${t==null?void 0:t.loading}`})]})}function zN(){const{baseUrl:t,user:s}=C.useContext(me)||{},{item:n={},dataItems:r=[],apiUpdate:a,editPane:l,setEditPane:i}=C.useContext(dt)||{},[c,d]=C.useState({deleteId:-1});return n.published==="draft"||n.has_changes,e.jsx(gN,{width:"w-[350px]",open:l.open,setOpen:u=>i({...l,open:u}),closeOnClick:!1,children:e.jsx(lC,{selectedIndex:l.index,setSelectedIndex:u=>i({...l,index:u}),tabs:Ih.map(u=>({name:e.jsx(qe,{icon:u.icon,className:"size-6 hover:text-blue-500 text-slate-400"}),Component:u.Component}))})})}function PN(){return e.jsxs(e.Fragment,{children:[e.jsx(BN,{}),e.jsx(zN,{}),e.jsx(FN,{})]})}const lu=()=>{const{dataItems:t,item:s}=C.useContext(dt),n=t.filter(({parent:r,hide_in_nav:a,navOptions:l,title:i})=>!r&(l==null?void 0:l.show_in_footer)==="show").map(r=>({root:r,children:t.filter(({parent:a})=>a===r.id)}));return e.jsxs("div",{className:"my-2 flex flex-col gap-[8px] max-w-[1362px] mx-auto text-[#37576B]  overflow-hidden",children:[e.jsx("div",{className:"p-[56px] md:h-[386px] md:max-h-[386px] md:min-h-[386px] bg-white flex flex-col md:flex-row flex-1 px-4 xl:px-[64px] rounded-[12px] shadow-md divide-x divide-[#E0EBF0] justify-center",children:n.map(r=>e.jsxs("div",{className:"flex flex-col p-4 pl-[24px] gap-[12px] w-[282px] overflow-hidden",children:[e.jsx(ue,{to:r.root.url_slug,className:"text-[#2D3E4C] font-[Oswald] font-medium text-[14px] leading-[14px] uppercase tracking-normal",children:r.root.title}),r.children.filter((a,l)=>l<=5).map(a=>e.jsx(ue,{to:a.url_slug,className:"text-[#37576B] font-normal text-[16px] leading-[22.4px] tracking-normal",children:a.title},a.url_slug))]},r.root.url_slug))}),e.jsxs("div",{className:"p-[16px] md:px-[25px] md:px-[56px] flex flex-col md:flex-row items-center justify-between md:h-[70px] md:max-h-[70px] md:min-h-[70px] bg-white flex flex-1 px-4 xl:px-[64px] rounded-[12px] shadow-md",children:[e.jsx("div",{children:" 2024 MitigateNY, All Rights Reserved."}),e.jsxs("div",{className:"flex gap-[24px] ",children:[e.jsx(ue,{to:"#",children:"Privacy Policy"}),e.jsx(ue,{to:"#",children:"Terms and Conditions"})]})]})]})},RN={name:"Footer: MNY",type:"Footer",useDataSource:!1,defaultState:{},controls:{},EditComp:lu,ViewComp:lu};function Lh({format:t,item:s,dataItems:n,updateAttribute:r,attributes:a,setItem:l,apiLoad:i,apiUpdate:c,status:d,navOptions:u,busy:m}){var w,k,$,E,M,_;const p=Le(),x=bt(),{pathname:h="/edit"}=Ge();let{baseUrl:f,user:g,theme:y}=C.useContext(me)||{};const[v,j]=C.useState({open:!1,index:1,showGrid:!1}),N=C.useMemo(()=>Co(n,f,!0),[n]);y=Ze(pe(y),(s==null?void 0:s.theme)||{}),(s==null?void 0:s.index)=="999"||((k=(w=y==null?void 0:y.navOptions)==null?void 0:w.topNav)==null?void 0:k.nav)!=="main"||l4(n,f),hr(s),($=a==null?void 0:a.sections)!=null&&$.attributes,C.useEffect(()=>{if(!(s!=null&&s.url_slug)){let L=n.sort((A,T)=>A.index-T.index).find(A=>!A.parent&&A.url_slug);if(!L)return;const D=`${f}/edit/${L==null?void 0:L.url_slug}`;D&&h!==D&&p(D)}},[]),C.useEffect(()=>{!s.draft_section_groups&&(s!=null&&s.id)&&(console.log("backfill------------------"),c4(s,f,x))},[]);const S=L=>((s==null?void 0:s.draft_section_groups)||[]).filter((D,A)=>D.position===L).sort((D,A)=>(D==null?void 0:D.index)-(A==null?void 0:A.index)).map((D,A)=>e.jsx(wh,{group:D,attributes:a,edit:!0},(D==null?void 0:D.name)||A));if(s)return e.jsx(dt.Provider,{value:{item:s,dataItems:n,apiLoad:i,apiUpdate:c,updateAttribute:r,editPane:v,setEditPane:j,format:t,busy:m},children:e.jsxs("div",{className:`${(E=y==null?void 0:y.page)==null?void 0:E.container}`,children:[e.jsx(PN,{}),C.useMemo(()=>S("top"),[s==null?void 0:s.draft_section_groups]),e.jsx(Rr,{navItems:N,secondNav:((_=(M=y==null?void 0:y.navOptions)==null?void 0:M.secondaryNav)==null?void 0:_.navItems)||[],pageTheme:{navOptions:s.navOptions||{}},children:C.useMemo(()=>S("content"),[s==null?void 0:s.draft_section_groups])}),C.useMemo(()=>S("bottom"),[s==null?void 0:s.draft_section_groups])]})})}function HN({item:t={}}){const{baseUrl:s}=C.useContext(me),[n,r]=b.useState(!1);return e.jsxs("div",{className:"grid grid-cols-4 px-2 py-3 border-b hover:bg-blue-50",children:[e.jsx("div",{children:e.jsxs(ue,{to:`${s}/manage/templates/edit/${t.id}`,children:[e.jsx("div",{className:"px-2 font-medium text-lg text-slate-700",children:t.title}),e.jsx("div",{className:"px-2 text-xs text-slate-400",children:t.id})]})}),e.jsx("div",{}),e.jsx("div",{}),e.jsxs("div",{className:"text-right flex items-center flex-row justify-end px-2 ",children:[e.jsx(ue,{to:`${s}/manage/templates/pages/${t.id}`,className:"fa-thin fa-memo px-2 py-1 mx-2 text-bold cursor-pointer",title:"pages"}),e.jsx("i",{className:"fa fa-trash text-red-300 hover:text-red-500 cursor-pointer",onClick:()=>r(!n)}),e.jsx(UN,{item:t,open:n,setOpen:r})]})]})}function WN({children:t,dataItems:s,edit:n,...r}){var u,m;const{path:a}=Ge(),[l,i]=b.useState(!1),{baseUrl:c,theme:d}=C.useContext(me);return e.jsx("div",{className:(u=d==null?void 0:d.page)==null?void 0:u.wrapper2,children:e.jsxs("div",{className:(m=d==null?void 0:d.page)==null?void 0:m.wrapper3,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-2xl p-3 font-thin flex-1",children:"Templates"}),a===`${c}/manage/templates`?e.jsx("div",{className:"px-1",children:e.jsx(ue,{to:`${c}`,className:"inline-flex w-36 justify-center rounded-lg cursor-pointer text-sm font-semibold py-1 px-4 bg-blue-600 text-white hover:bg-blue-500 shadow-lg border border-b-4 border-blue-800 hover:border-blue-700 active:border-b-2 active:mb-[2px] active:shadow-none",children:" Templates "})}):e.jsx("div",{className:"px-1",children:e.jsx("div",{onClick:()=>i(!l),className:"inline-flex w-36 justify-center rounded-lg cursor-pointer text-sm font-semibold py-1 px-4 bg-blue-600 text-white hover:bg-blue-500 shadow-lg border border-b-4 border-blue-800 hover:border-blue-700 active:border-b-2 active:mb-[2px] active:shadow-none",children:" New Template"})})]}),e.jsx("div",{className:"px-6 pt-8 w-full mx-auto max-w-10xl",children:e.jsx("div",{children:s.filter(p=>p.template_id=="-99").map(p=>e.jsx(HN,{item:p},p.id))})}),e.jsx(VN,{open:l,setOpen:i})]})})}function VN({open:t,setOpen:s}){const n=b.useRef(null),r=bt(),{pathname:a="/edit"}=Ge(),[l,i]=b.useState(!1),[c,d]=b.useState("");return e.jsxs(Vr,{open:t,setOpen:s,initialFocus:n,children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fa fa-plus text-blue-400"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full px-2",children:[e.jsx(Je.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"New Template"}),e.jsx("div",{className:"mt-2 w-full",children:e.jsx("input",{className:"w-full px-2 py-1 text font-medium text-slate-500 focus:outline-none border-slate-300 border-b-2 focus:border-blue-500",value:c,onChange:u=>d(u.target.value),placeholder:"Template Title"})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{type:"button",disabled:l||c.length<3,className:"inline-flex w-full justify-center rounded-md disabled:bg-slate-300 bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 sm:ml-3 sm:w-auto",onClick:async()=>{const u={title:c,url_slug:gx(c),template_id:-99,hide_in_nav:!0,index:999};i(!0),await r(mt(u),{method:"post",action:a}),i(!1),s(!1)},children:["Creat",l?"ing...":"e"]}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>s(!1),ref:n,children:"Cancel"})]})]})}function UN({item:t,open:s,setOpen:n}){const r=b.useRef(null),a=bt(),{pathname:l="/edit"}=Ge(),[i,c]=b.useState(!1);return e.jsxs(Vr,{open:s,setOpen:n,initialFocus:r,children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fa fa-exlamation-triangle"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[e.jsxs(Je.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:["Delete Page ",t.title," ",t.id]}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this Template? All of the page data will be permanently removed from our servers forever. This action cannot be undone."})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{type:"button",disabled:i,className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",onClick:async()=>{c(!0),await a(mt(t,"delete"),{method:"post",action:l}),c(!1),n(!1)},children:["Delet",i?"ing...":"e"]}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>n(!1),ref:r,children:"Cancel"})]})]})}const qN=({column:t})=>{const{filterValue:s="",setFilter:n}=t,r={};return e.jsx("div",{className:"w-3/4",children:e.jsx("input",{className:r.inputSmall,value:s,onChange:a=>n(a.target.value),onClick:a=>a.stopPropagation(),placeholder:"Search..."})})},GN=({column:{filterValue:t,setFilter:s,preFilteredRows:n,id:r,filterMeta:a,filterDomain:l,onFilterChange:i,customValue:c,filterThemeOptions:d,filterClassName:u,filterMulti:m,filterRemovable:p=!0}})=>{const x=C.useMemo(()=>{const f=new Set;return a||(n.forEach(g=>{f.add(g.values[r])}),[...f.values()])},[a,r,n]).filter(f=>f),h=n.length;return e.jsx("div",{className:"",children:e.jsx("select",{domain:l||x,value:t||c||[],onChange:f=>{s(f||void 0),i(f||void 0)},placeHolder:`Search ${h} records...`,removable:p,multi:m,themeOptions:d,className:`${u}`})})};function JN(t,s,n){return gi(t,n,{keys:[r=>r.values[s]]})}function XN(t,s,n){return t.filter(r=>{const a=r.values[s];return a!==void 0&&Array.isArray(n)&&n.length?n.includes(a):a!==void 0&&n.length?a===n:!0})}const ZN=(t,s)=>{let n=t-2,r=t+2;n<0&&(r+=-n,n=0),r>s&&(n-=r-s,r=s);const a=[];for(let l=Math.max(0,n);l<=Math.min(s,r);++l)a.push(l);return a},YN=({values:t,theme:s})=>e.jsx("div",{className:"flex flex-col divide-y",children:t.map(({key:n,value:r},a)=>e.jsxs("div",{className:"flex-1 p-2",children:[n?e.jsxs("div",{className:"font-semibold",children:[n,":"]}):null,e.jsx("span",{className:!0,children:r})]},n||`key-${a}`))}),QN=({fetchData:t,manualPagination:s,theme:n,pageValue:r,pageCount:a,pageSize:l,pageIndex:i,statePageSize:c,totalRecords:d,rows:u,canNextPage:m,onPageSelect:p,onPrevPage:x,onNextPage:h,previousPage:f,gotoPage:g,nextPage:y})=>a<=1?null:e.jsxs("div",{className:`flex items-center flex-wrap ${n.textInfo}`,children:[e.jsxs("div",{className:"flex-0",children:["Page ",r+1," of ",a,e.jsx("br",{}),"Rows ",r*l+1," -",!t&&!s?Math.min(u.length,i*c+c):Math.min(d,r*l+l)," of ",!t&&!s?u.length:d]}),e.jsxs("div",{className:"flex-1 flex justify-end items-center",children:[e.jsx("button",{disabled:r===0,themeOptions:{size:"sm"},onClick:v=>!t&&!s?g(0):p(0),children:"<<"}),e.jsx("button",{disabled:r===0,themeOptions:{size:"sm"},onClick:v=>!t&&!s?f():x(),children:"<"}),ZN(r,a-1).map(v=>{const j=v===r;return e.jsx("button",{themeOptions:{size:"sm",color:j?"primary":"white"},onClick:j?null:N=>!t&&!s?g(v):p(v),children:v+1},v)}),e.jsx("button",{disabled:!t&&!s?!m:r===a-1,themeOptions:{size:"sm"},onClick:v=>!t&&!s?y(0):h(v),children:">"}),e.jsx("button",{disabled:r===a-1,themeOptions:{size:"sm"},onClick:v=>!t&&!s?g(a-1):p(a-1),children:">>"})]})]}),KN=({row:t,expand:s,visibleColumns:n,ExpandRow:r,theme:a})=>!t.isExpanded||!s.length?null:e.jsx("tr",{className:a.tableRow,children:e.jsx("td",{colSpan:n.length,className:a.tableCell,children:e.jsx(r,{values:s})})}),e6=({ii:t,cell:s,row:n,columns:r,expand:a,expanded:l,toggleRowExpanded:i,theme:c})=>e.jsx("td",{...s.getCellProps({style:{minWidth:s.column.minWidth,maxWidth:s.column.maxWidth,width:s.column.width}}),className:`text-${ne(r.find(d=>d.Header===s.column.Header),"align")||"center"} ${c.tableCell}`,children:t>0||n.subRows.length===0&&a.length===0?s.render("Cell"):e.jsxs("div",{className:"flex items-center ",children:[e.jsx("div",{onClick:d=>{d.stopPropagation(),d.preventDefault(),Object.keys(l).filter(u=>u!==n.id).forEach(i),n.toggleRowExpanded(!n.isExpanded)},className:`
                          flex item-center justify-center
                          rounded cursor-pointer py-1 px-2
                        h-full hover:text-blue-500
                           ${c.transition}
                        `,children:n.isExpanded?e.jsx("i",{className:"fal fa-chevron-down"}):e.jsx("i",{className:"fal fa-chevron-right"})}),e.jsx("div",{className:"flex-1",children:s.render("Cell")})]})},t),iu=[],t6=()=>e.jsx("div",{children:"Loading..."}),si=({columns:t=iu,data:s=iu,sortBy:n,sortOrder:r="",initialPageSize:a=10,manualPagination:l,fetchData:i,onPageChange:c,numRecords:d,manualCurrentPage:u,pageSize:m=5,onRowClick:p,onRowEnter:x,onRowLeave:h,ExpandRow:f=YN,disableFilters:g=!1,disableSortBy:y=!1,csvDownload:v=!1,onCsvDownload:j,themeOptions:N={},theme:S={},...w})=>{const[k,$]=C.useState(s||[]),[E,M]=C.useState(d||0),[_,L]=b.useState(u||0),[D,A]=b.useState(0),[T,O]=b.useState(!1),B=C.useMemo(()=>({fuzzyText:JN,dropdown:XN}),[]),F=C.useMemo(()=>({dropdown:GN,text:qN}),[]),z=C.useMemo(()=>({Filter:!1}),[]),{getTableProps:P,getTableBodyProps:U,headerGroups:R,page:W,rows:V,preFilteredRows:X,prepareRow:q,canPreviousPage:Q,canNextPage:Y,gotoPage:H,previousPage:J,nextPage:G,pageCount:se,visibleColumns:le,toggleRowExpanded:ce,setPageSize:je,state:{pageSize:Ce,pageIndex:oe,expanded:ve}}=Et.useTable({columns:t,data:k,manualPagination:!!l||!!i,...(!!i||!!l)&&{pageCount:Math.ceil(E/m)},defaultColumn:z,filterTypes:B,disableFilters:g,disableSortBy:y,initialState:{pageSize:+m||+a,...n&&{sortBy:[{id:n,desc:r.toLowerCase()==="desc"}]}}},Et.useFilters,Et.useGlobalFilter,Et.useSortBy,Et.useExpanded,Et.usePagination);C.useEffect(()=>{m!==null&&m!==Ce&&je(+m)},[m,Ce,je]),C.useEffect(()=>{i&&(async()=>{O(!0);const{data:ee,length:xe}=await i({currentPage:_,pageSize:m});return{data:ee,length:xe}})().then(ee=>{$((ee==null?void 0:ee.data)||[]),M((ee==null?void 0:ee.length)||0),O(!1)})},[i,m,_]),C.useEffect(()=>{i||$(s)},[s,se,i]),C.useEffect(()=>{!i&&E!==d&&M(d)},[d]),C.useEffect(()=>{A(i||l?_:oe)},[oe,_]);const ae=b.useCallback(()=>{L(re=>re+1),c(_+1)},[]),de=b.useCallback(()=>{L(re=>re-1),c(_-1)},[]),te=b.useCallback(re=>{_!==re&&L(re),c(re)},[_]);return!(t.length&&k.length)||!X.length?null:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"overflow-auto scrollbar-sm",children:[T&&e.jsx("div",{className:"z-10 absolute float-center text-center align-middle items-center w-full",style:{backgroundColor:"rgba(255,255,255,0.38)",width:"100%"},children:e.jsx(t6,{width:"100%",height:"100%"})}),v?e.jsx("div",{className:"w-full text-right",children:e.jsxs(gm,{data:k,headers:t.map(re=>({label:re.Header,key:re.accessor})),filename:"data.csv",className:S.downloadWrapper,children:[e.jsx("i",{className:S.downloadIcon||"fa fa-download"})," ",e.jsx("label",{children:"csv"})]})}):null,e.jsxs("table",{...P(),className:"w-full",children:[e.jsx("thead",{children:R.map(re=>e.jsx("tr",{...re.getHeaderGroupProps(),children:re.headers.map(ee=>e.jsx("th",{...ee.getHeaderProps({...ee.getSortByToggleProps(),style:{minWidth:ee.minWidth,width:ee.width,maxWidth:ee.maxWidth}}),className:S.tableHeader,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex-1 pr-1",children:ee.render("Header")}),e.jsxs(e.Fragment,{children:[ee.info&&e.jsx("i",{className:`${S.infoIcon}`,title:ee.info}),ee.canSort?ee.isSorted?ee.isSortedDesc?e.jsx("i",{className:`ml-2 pt-1 ${S.sortIconDown}`}):e.jsx("i",{className:`ml-2 pt-1 ${S.sortIconUp}`}):e.jsx("i",{className:`ml-2 pt-1 ${S.sortIconIdeal}`}):null]})]}),e.jsx("div",{children:ee.canFilter?e.jsx("div",{children:ee.render(F[ee.filter]||"Filter")}):null})]})}))}))}),e.jsx("tbody",{...U(),children:W.map(re=>{const{onClick:ee,expand:xe=[]}=re.original;return q(re),e.jsxs(C.Fragment,{children:[e.jsx("tr",{...re.getRowProps(),onMouseEnter:typeof x=="function"?ke=>x(ke,re):null,onMouseLeave:typeof h=="function"?ke=>h(ke,re):null,className:`
                                        ${w.striped?S.tableRowStriped:S.tableRow}
                                        ${ee||p?"cursor-pointer":""}
                                    `,onClick:ke=>{typeof p=="function"&&p(ke,re),typeof ee=="function"&&ee(ke,re)},children:re.cells.map((ke,he)=>e.jsx(e6,{ii:he,cell:ke,row:re,columns:t,expand:xe,expanded:ve,toggleRowExpanded:ce,theme:S},he))}),e.jsx(KN,{row:re,expand:xe,visibleColumns:le,ExpandRow:f,theme:S})]},re.getRowProps().key)})})]})]}),e.jsx("div",{className:"w-full p-2",children:e.jsx(QN,{fetchData:i,manualPagination:l,theme:S,pageValue:D,pageCount:se,pageSize:m,pageIndex:oe,statePageSize:Ce,totalRecords:E,rows:V,canNextPage:Y,onPageSelect:te,onPrevPage:de,onNextPage:ae,previousPage:J,gotoPage:H,nextPage:G,onPageChange:c})})]})},s6={"docs-play":"Playground","docs-page":"Live","docs-draft":"Draft","docs-ctp":"CTP Live"},Ha=({app:t,type:s,filter:n,action:r="load",tags:a,attributes:l=[{key:"id",label:"id"},{key:"app",label:"app"},{key:"type",label:"type"},{key:"data",label:"data"},{key:"updated_at",label:"updated_at"}]})=>({format:{app:t,type:s,attributes:l},children:[{type:()=>{},action:r,filter:{options:JSON.stringify({filter:n}),tags:a,attributes:l.map(i=>i.key)},path:"/"}]}),n6={view:"fa-thin fa-eye",edit:"fa-thin fa-pencil"},cu={success:{textColor:"text-green-400",icon:"fa-thin fa-check"},error:{textColor:"text-red-400",icon:"fa-thin fa-warning"}},r6={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},a6=t=>Object.keys(t).find(s=>s.toLowerCase().includes("name")||s.toLowerCase().includes("title")),o6=(t,s,n)=>t==="geoid"?(n==null?void 0:n.county)||(n==null?void 0:n.name)||s:(n==null?void 0:n[a6(n)])||s,l6=({item:t,params:s,logo:n,rightMenu:r})=>{var E,M,_,L,D,A;const[a,l]=b.useState(100),{baseUrl:i,falcor:c,falcorCache:d,pgEnv:u,theme:m,app:p,type:x}=C.useContext(me),{id:h}=s,f=(M=(E=t.data_controls)==null?void 0:E.view)==null?void 0:M.view_id,g=(L=(_=t.data_controls)==null?void 0:_.id_column)==null?void 0:L.name;if(!h)return null;const[y,v]=b.useState([]);b.useEffect(()=>{(async function(){const T=await St(c,Ha({app:p,type:x,filter:{"data->>'template_id'":[h]}}),"/");v(T)})()},[h]),b.useEffect(()=>{f&&async function(){c.get(["dama",u,"viewsbyId",f,"data","length"])}()},[h,f]);const j=C.useMemo(()=>ne(d,["dama",u,"viewsbyId",f,"data","length"],0),[h,u,f,d]);b.useEffect(()=>{f&&async function(){c.get(["dama",u,"viewsbyId",f,"databyIndex",{from:0,to:j-1},Object.keys(t.data_controls.active_row||{})])}()},[h,u,f,d]);const N=C.useMemo(()=>Object.values(ne(d,["dama",u,"viewsbyId",f,"databyIndex"],{})).map(T=>ne(d,[...T.value],"")),[h,g,f,d]),S=["view","edit"],w=["status"],k=["title","location","updated","status",...S].map(T=>({Header:S.includes(T)?"":T,accessor:T,...S.includes(T)&&{Cell:O=>e.jsx(ue,{to:O.value,className:` ${n6[T]} px-2 py-1 mx-2 text-bold cursor-pointer`,title:T})},...w.includes(T)&&{Cell:O=>e.jsx("i",{className:`${cu[O.value].icon} ${cu[O.value].textColor} font-bold`,title:O.value})},...["updated"].includes(T)&&{Cell:O=>new Date(O.value).toLocaleDateString(void 0,r6)},filter:S.includes(T)||w.includes(T)?void 0:"text",disableSortBy:S.includes(T),align:S.includes(T)||w.includes(T)?"center":"left",width:S.includes(T)||w.includes(T)?"5%":"20%"})),$=y.map(({type:T,data:O,updated_at:B})=>{var z,P,U;const F=N.find(R=>R[g]===O.value.id_column_value);return{title:o6(g,O.value.id_column_value,F)||O.value.title,location:s6[T],view:`${i}/${(z=O==null?void 0:O.value)==null?void 0:z.url_slug}`,edit:`${i}/edit/${(P=O==null?void 0:O.value)==null?void 0:P.url_slug}`,updated:bx(B),status:((U=O==null?void 0:O.value)==null?void 0:U.num_errors)>0?"error":"success"}});return e.jsx("div",{className:(D=m==null?void 0:m.page)==null?void 0:D.wrapper2,children:e.jsx("div",{className:(A=m==null?void 0:m.page)==null?void 0:A.wrapper3,children:e.jsx("div",{className:" h-full",children:e.jsxs("div",{className:"bg-white h-full max-w-6xl mx-auto px-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-2xl pt-3 font-thin flex-1",children:[e.jsx("span",{className:"font-semibold",children:t.title})," / Generated Pages"]}),e.jsxs("label",{className:"text-sm font-thin flex-1 italic",children:["Showing ",y==null?void 0:y.length," generated / ",j," available items"]})]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("label",{children:"show"}),e.jsx("select",{className:"p-2 m-2 h-fit",value:a,onChange:T=>l(T.target.value),children:[10,25,50,75,100].map(T=>e.jsx("option",{value:T,children:T},T))}),e.jsx("label",{children:"rows"})]})]}),e.jsx("div",{className:"pt-8",children:e.jsx("div",{className:"rounded border",children:e.jsx(si,{data:$,columns:k,pageSize:a,sortBy:"updated",sortOrder:"desc"})})})]})})})})},i6=({label:t,types:s,type:n,setType:r,multi:a=!1,size:l="small",disabled:i,disabledTitle:c,autoSelect:d=!0})=>(b.useEffect(()=>{var p,x;const u=((p=s[0])==null?void 0:p.value)||s[0];if(!u||!d||i)return;const m=a?[u]:u;(!n||Array.isArray(n)&&!((x=n.filter(h=>h))!=null&&x.length))&&r(m)},[s]),e.jsxs("div",{className:"my-1 flex flex-rows flex-wrap",title:i?c:null,children:[t&&e.jsx("div",{className:"p-2 pl-0 w-1/4",children:t}),e.jsx("span",{className:`
              
                space-x-1 rounded-lg bg-slate-100 py-0.5
                flex flex-row flex-wrap
                shadow-sm 
                ${l==="large"?"w-full":"w-fit"}`,children:s.map((u,m)=>{const p=(u==null?void 0:u.value)||u,x=a&&Array.isArray(n)?n:a&&!Array.isArray(n)?[n]:!a&&Array.isArray(n)?n[0]:n,h=a&&(x==null?void 0:x.includes(p))||!a&&x===p;return e.jsx("button",{type:"button",className:`
                            ${m!==0&&"-ml-px"} 
                            ${i&&"pointer-events-none"}
                            rounded-lg py-[0.4375rem] break-none
                            ${h?"text-gray-900 bg-white shadow":"text-gray-700"} hover:text-blue-500
                            min-w-[60px] min-h-[30px] uppercase
                            relative items-center px-2 text-xs items-center justify-center text-center 
                            focus:z-10`,onClick:()=>{const f=a&&(x!=null&&x.includes(p))?x.filter(g=>g!==p):a&&!(x!=null&&x.includes(p))?[...x,p]:p;r(f)},children:(u==null?void 0:u.label)||u},m)})})]}));function Nn({options:t=[],onChange:s,value:n,nameAccessor:r=i=>(i==null?void 0:i.name)||i,valueAccessor:a,className:l}){const[i,c]=b.useState(""),d=i===""?t:t.filter(u=>(r(u)+"").toLowerCase().replace(/\s+/g,"").startsWith(i.toLowerCase().replace(/\s+/g,"")));return e.jsx("div",{className:"w-full",children:e.jsx(rs,{value:n,onChange:s,children:e.jsxs("div",{className:"relative mt-1",children:[e.jsxs("div",{className:l||"relative w-full cursor-default overflow-hidden rounded-lg bg-white text-left shadow-md focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 focus-visible:ring-offset-2 focus-visible:ring-offset-blue-300 sm:text-sm",children:[e.jsx(rs.Input,{className:"w-full border-none py-2 pl-3 pr-10 text-sm leading-5 text-gray-900 focus:ring-0",displayValue:u=>r(u)||u,onChange:u=>c(u.target.value)}),e.jsx(rs.Button,{className:"absolute inset-y-0 right-0 flex items-center pr-2",children:e.jsx("div",{className:"h-5 w-5 text-gray-400 flex items-center justify-center","aria-hidden":"true",children:e.jsx("div",{class:"fa fa-chevron-down"})})})]}),e.jsx(Oe,{as:b.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",afterLeave:()=>c(""),children:e.jsx(rs.Options,{className:"z-50 absolute mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:d.length===0&&i!==""?e.jsx("div",{className:"relative cursor-default select-none py-2 px-4 text-gray-700",children:"Nothing found."}):d.filter((u,m)=>m<60).map((u,m)=>e.jsx(rs.Option,{className:({active:p})=>`relative cursor-default select-none py-2 pl-10 pr-4 ${p?"bg-blue-600 text-white":"text-gray-900"}`,value:u,children:({selected:p,active:x})=>e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`block truncate ${p?"font-medium":"font-normal"}`,children:r(u)||u}),p?e.jsx("span",{className:`absolute inset-y-0 left-0 flex items-center pl-3 ${x?"text-white":"text-blue-600"}`,children:e.jsx("div",{className:"h-5 w-5 flex items-center justify-center","aria-hidden":"true",children:e.jsx("div",{className:"fa fa-check"})})}):null]})},m))})})]})})})}const c6=({value:t,onChange:s})=>{const{falcor:n,falcorCache:r,pgEnv:a}=C.useContext(me),[l,i]=b.useState([]);return b.useEffect(()=>{async function c(){const d=["dama",a,"sources","length"],u=await n.get(d);await n.get(["dama",a,"sources","byIndex",{from:0,to:ne(u.json,d,0)-1},"attributes",["source_id","name","metadata"]]);const m=n.getCache(),p=Object.values(ne(m,["dama",a,"sources","byIndex"],{})).map(x=>{var h;return(h=ne(m,x.value))==null?void 0:h.attributes});i(p)}c()},[n,a]),e.jsx(Nn,{options:["",...l],value:t,onChange:c=>s(c)})},d6=({source_id:t,value:s,onChange:n})=>{const{falcor:r,falcorCache:a,pgEnv:l}=C.useContext(me),[i,c]=b.useState([]);return b.useEffect(()=>{async function d(){const u=["dama",l,"sources","byId",t,"views","length"],m=await r.get(u);await r.get(["dama",l,"sources","byId",t,"views","byIndex",{from:0,to:ne(m.json,u,0)-1},"attributes",["view_id","version"]]);const p=r.getCache(),x=Object.values(ne(p,["dama",l,"sources","byId",t,"views","byIndex"],{})).map(h=>{var f;return(f=ne(p,h.value))==null?void 0:f.attributes});c(x)}d()},[r,l]),b.useEffect(()=>{var d;!s&&((d=i==null?void 0:i[0])!=null&&d.view_id)&&n(i==null?void 0:i[0])},[i]),e.jsx(Nn,{options:["",...i],value:s,nameAccessor:d=>d==null?void 0:d.version,onChange:d=>n(d)})},u6=[{label:"Set 2 - climate change",value:"/themes/mny_pack_1/climate_change.png"},{label:"Set 2 - extreme heat",value:"/themes/mny_pack_1/extreme_heat.png"},{label:"Set 2 - funding",value:"/themes/mny_pack_1/funding.png"},{label:"Set 2 - hail",value:"/themes/mny_pack_1/hail.png"},{label:"Set 2 - hurricane",value:"/themes/mny_pack_1/hurricane.png"},{label:"Set 2 - local planning",value:"/themes/mny_pack_1/local_planning.png"},{label:"Set 2 - planning",value:"/themes/mny_pack_1/planning.png"},{label:"Set 2 - snowstorm",value:"/themes/mny_pack_1/snowstorm.png"},{label:"Set 2 - state planning",value:"/themes/mny_pack_1/state_planning.png"},{label:"Set 2 - tornado",value:"/themes/mny_pack_1/tornado.png"},{label:"Set 2 - ny built environment",value:"/themes/mny_pack_1/mny-built-environment_01_webp.webp"},{label:"Set 2 - extreme cold",value:"/themes/mny_pack_1/mny-extreme-cold_01_webp.webp"},{label:"Set 2 - flood",value:"/themes/mny_pack_1/mny-flood_01_webp.webp"},{label:"Set 2 - hazards",value:"/themes/mny_pack_1/mny-hazards_01_webp.webp"},{label:"Set 2 - ice strom",value:"/themes/mny_pack_1/mny-ice-strom_01_webp.webp"},{label:"Set 2 - people",value:"/themes/mny_pack_1/mny-people_02_webp.webp"},{label:"Set 2 - strategies",value:"/themes/mny_pack_1/mny-strategies_01_webp.webp"},{label:"Set 2 - whats at risk",value:"/themes/mny_pack_1/mny-whats-at-risk_01_webp.webp"},{label:"Fusion Header 1",value:"/themes/mny/fusion_header_1.png"},{label:"Fusion Header 2",value:"/themes/mny/fusion_header_2.png"},{label:"Fusion Header 3",value:"/themes/mny/fusion_header_3.png"},{label:"Planetary Home",value:"/themes/mny/header_home.png"},{label:"Planetary Buildings",value:"/themes/mny/header_image1.png"},{label:"Hazards - Coastal",value:"/themes/mny/hazards_coastal_2tp.png"},{label:"Hazards - Flood",value:"/themes/mny/hazards_flood_2tp.png"},{label:"Hazards - Landslide",value:"/themes/mny/hazards_landslide_1tp.png"},{label:"Hazards - Wildfire",value:"/themes/mny/hazards_wildfire_1tp.png"},{label:"Take Action - Capabilities",value:"/themes/mny/takeaction_capab_2tp.png"},{label:"Take Action - Landuse",value:"/themes/mny/takeaction_landuse_2tp.png"},{label:"Transportation",value:"/themes/mny/transportation.png"},{label:"Set2 - Test 1",value:"/themes/mny/set2_test_01.webp"},{label:"Set2 - Test 2",value:"/themes/mny/set2_test_02.webp"},{label:"Set2 - Test 3",value:"/themes/mny/set2_test_03.webp"},{label:"Set2 - Test 4",value:"/themes/mny/set2_test_04.webp"},{label:"Set2 - Test 5",value:"/themes/mny/set2_test_05.webp"},{label:"Set2 - Test 5",value:"/themes/mny/set2_test_06.webp"},{label:"Set1 - Avalanche",value:"/themes/mny/Avalanche - transparent.webp"},{label:"Set1 - Built Environment",value:"/themes/mny/Built Environment - transparent.webp"},{label:"Set1 - Capabilities and Resources",value:"/themes/mny/Capabilities and Resources - transparent.webp"},{label:"Set1 - Coastal Hazards",value:"/themes/mny/Coastal Hazards - transparent.webp"},{label:"Set1 - Drought",value:"/themes/mny/Drought - transparent.webp"},{label:"Set1 - Earthquake",value:"/themes/mny/Earthquake - transparent.webp"},{label:"Set1 - Extreme Cold",value:"/themes/mny/Extreme Cold - transparent.webp"},{label:"Set1 - Extreme Heat",value:"/themes/mny/Extreme Heat - transparent.webp"},{label:"Set1 - Flooding",value:"/themes/mny/Flooding - transparent.webp"},{label:"Set1 - Funding",value:"/themes/mny/Funding - transparent.webp"},{label:"Set1 - Hail",value:"/themes/mny/Hail - transparent.webp"},{label:"Set1 - Hazards & Disasters",value:"/themes/mny/Hazards & Disasters - transparent.webp"},{label:"Set1 - Hurricane",value:"/themes/mny/Hurricane - transparent.webp"},{label:"Set1 - Ice Storm",value:"/themes/mny/Ice Storm - transparent.webp"},{label:"Set1 - Landslide",value:"/themes/mny/Landslide - transparent.webp"},{label:"Set1 - Lightning",value:"/themes/mny/Lightning - transparent.webp"},{label:"Set1 - Natural Environment",value:"/themes/mny/Natural Environment - transparent.webp"},{label:"Set1 - People and Communities",value:"/themes/mny/People and Communities - transparent.webp"},{label:"Set1 - Planning",value:"/themes/mny/Planning - transparent.webp"},{label:"Set1 - Snowstorm",value:"/themes/mny/Snowstorm - transparent.webp"},{label:"Set1 - Strategies",value:"/themes/mny/Strategies - transparent.webp"},{label:"Set1 - Take Action",value:"/themes/mny/Take Action - transparent.webp"},{label:"Set1 - Tornado",value:"/themes/mny/Tornado - transparent.webp"},{label:"Set1 - Whats At Risk",value:"/themes/mny/Whats At Risk - transparent.webp"},{label:"Set1 - Wildfire",value:"/themes/mny/Wildfire - transparent.webp"},{label:"Set1 - Wind",value:"/themes/mny/Wind - transparent.webp"}],m6=[{label:"Planetary Hazard",value:"/themes/mny/inset_hazard.png"},{label:"Planetary County",value:"/themes/mny/inset_county.jpeg"}],fl=({chain:t,show:s})=>s&&Array.isArray(t)?e.jsx("div",{className:"px-1 z-[5]",children:e.jsx("div",{className:"flex items-center gap-[4px] text-[#37576B] text-[14px] sm:text-[16px] leading-[100%] tracking-normal",children:t.map((n,r)=>e.jsxs("div",{className:"flex items-center shrink-0",children:[e.jsx(ue,{to:n.url_slug,className:`w-fit shrink-0 wrap-none ${r===t.length-1?"font-regular":"font-semibold"}`,children:n.title}),r<t.length-1&&e.jsx(Pn,{height:12,width:12,className:"ml-1 -mt-1"})]},r))})}):null,gl=({app:t,type:s,show:n})=>{const[r,a]=b.useState(!1),[l,i]=b.useState(""),c=["Hurricane Sandy","Climate Change","Flood Risk"];return n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"py-2",children:e.jsxs("div",{className:`
                                bg-white flex justify-between items-center
                                h-[56px] w-full py-[16px] px-[24px]
                                rounded-[1000px]
                                shadow-[0px_2px_4px_0px_rgba(0,0,0,0.08)]
                                focus-within:ring-2 focus-within:ring-[#6D96AE]
                                shadow-sm transition ease-in
                              `,children:[e.jsx("input",{className:"w-full focus:outline-none focus:ring-0 text-[#37576B] font-normal text-[16px] leading-[140%]",placeholder:"Search for anything...",onChange:d=>i(d.target.value),onKeyDown:d=>{d.key==="Enter"&&a(!0)}}),e.jsx($o,{height:24,width:24,className:"text-[#2D3E4C] p-0.5",onClick:()=>a(!0)})]})}),e.jsxs("div",{children:[e.jsx("div",{className:"pt-[8px] font-[500] text-[16px] text-[#2D3E4C] font-['Oswald'] text-left",children:"FEATURED SEARCHES"}),e.jsx("div",{className:"flex w-full flex-wrap",children:c.map(d=>e.jsx("div",{className:"pr-1 py-0.5 cursor-pointer",onClick:()=>{i(d),a(!0)},children:e.jsxs(ti,{children:[" ",e.jsx("div",{className:"uppercase",children:d})]})},d))})]}),e.jsx(Ux,{open:r,setOpen:a,app:t,type:s,searchStr:l})]}):null},bl=({title:t,titleSize:s,logo:n})=>{if(t)return e.jsxs("div",{className:`flex gap-1 text-[36px] ${s} items-center font-medium font-['Oswald'] text-[#2D3E4C] sm:leading-[100%] uppercase`,children:[n&&e.jsx("img",{className:"max-w-[150px] max-h-[150px]",alt:" ",src:n}),t]})};function p6({app:t,type:s,title:n,note:r,logo:a,overlay:l="overlay",bgImg:i,chain:c,showBreadcrumbs:d,showSearchBar:u,titleSize:m="sm:text-[72px] tracking-[0px]"}){return l==="full"?e.jsxs("div",{className:"relative w-full h-auto lg:h-[808px] lg:-mb-[185px] flex flex-col lg:flex-row justify-center",style:{background:`url('${i}') center/cover`},children:[e.jsx("div",{className:"lg:order-last w-full lg:flex-1 lg:h-[699px]",children:e.jsx("div",{className:"relative top-[90px] mx-auto"})}),e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"mx-auto px-[15px] xl:px-[64px] lg:pt-[80px] pt-[120px] pb-[40px] lg:w-[1440px] h-full flex items-center ",children:e.jsxs("div",{className:" w-full lg:w-[481px] px-[32px] py-[37px] gap-[16px] bg-white shadow-md rounded-[12px]",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(fl,{chain:c,show:d}),e.jsx(bl,{title:n,titleSize:m,logo:a})]}),e.jsx("div",{className:"text-[16px] leading-[24px] text-[#37576B] w-full p-1 pt-2",children:r&&e.jsx("div",{children:r})}),e.jsx(gl,{app:t,type:s,show:u})]})})})]}):l==="none"?e.jsxs("div",{className:"relative w-full lg:-mb-[128px] ",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[758px] h-[499px] flex-1 rounded-bl-[395px] bg-[#1A2732] sm:bg-gradient-to-r from-[#213440] to-[#213440] via-[#213440]/70"}),e.jsx("div",{className:"relative max-w-[1440px] w-full mx-auto px-4 xl:px-[64px] pb-4 pt-[100px] sm:pt-[118px] items-center ",children:e.jsxs("div",{className:"p-[56px] h-full bg-white z-[100] rounded-lg shadow-md z-20",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-3/4",children:[e.jsx(fl,{chain:c,show:d}),e.jsx(bl,{title:n,titleSize:m,logo:a})]}),e.jsx("div",{className:"text-[16px] leading-[24px] text-[#37576B] w-3/4 p-1 pt-2",children:r&&e.jsx("div",{children:r})}),e.jsx(gl,{app:t,type:s,show:u})]})})]}):e.jsxs("div",{className:`relative w-full lg:h-[743px] lg:-mb-[85px]  
            flex flex-col lg:flex-row bg-fit bg-center justify-center`,children:[e.jsx("div",{className:`
                   lg:order-last flex-1 rounded-bl-[395px]
                   flex-1 bg-[#1A2732] bg-gradient-to-r from-[#213440] to-[#213440] via-[#213440]/70
                `,style:l==="inset"?{background:`url('${i}')`}:{},children:l==="overlay"&&e.jsx("img",{className:"relative top-[70px] w-[758px] ",src:i,alt:"overlay image"})}),e.jsx("div",{className:"lg:flex-1 top-[150px] sm:top-0 ",children:e.jsx("div",{className:"w-full lg:max-w-[656px] h-full lg:ml-auto flex items-center pt-12 lg:pt-0",children:e.jsxs("div",{className:"pr-[64px] xl:pl-0 px-[15px]",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(fl,{chain:c,show:d}),e.jsx(bl,{title:n,titleSize:m,logo:a})]}),e.jsx("div",{className:"text-[16px] leading-[24px] text-[#37576B] w-full p-1 pt-2",children:r&&e.jsx("div",{children:r})}),e.jsx(gl,{app:t,type:s,show:u})]})})})]})}const Eh=(t,s)=>{const{id:n,parent:r,title:a,url_slug:l}=s;return r?[...Eh(t,t.find(c=>c.id===r)),{id:n,parent:r,title:a,url_slug:l}]:[{id:n,parent:r,title:a,url_slug:l}]},du=({isEdit:t})=>{const{dataItems:s,item:n}=b.useContext(dt),{app:r,type:a}=b.useContext(me),{state:{display:l,data:i,columns:c}}=b.useContext(xt),d=b.useMemo(()=>c.find(({title:v})=>v),[c]),u=b.useMemo(()=>c.find(({note:v})=>v),[c]),m=b.useMemo(()=>c.find(({bgImg:v})=>v),[c]),p=b.useMemo(()=>c.find(({logo:v})=>v),[c]),x=b.useMemo(()=>{var v;return(v=i==null?void 0:i[0])==null?void 0:v[d==null?void 0:d.name]},[i,d]),h=b.useMemo(()=>{var v;return(v=i==null?void 0:i[0])==null?void 0:v[u==null?void 0:u.name]},[i,u]),f=b.useMemo(()=>{var v;return(v=i==null?void 0:i[0])==null?void 0:v[m==null?void 0:m.name]},[i,m]),g=b.useMemo(()=>{var v;return(v=i==null?void 0:i[0])==null?void 0:v[p==null?void 0:p.name]},[i,m]),y=Eh(s,n);return e.jsx(p6,{title:x||l.defaultTitle,note:h||l.defaultNote,logo:g,bgImg:f||l.defaultBgImg,...l,chain:y,app:r,type:a})},x6={name:"Header: MNY",type:"Header",useDataSource:!0,defaultState:{columns:[],display:{allowSearchParams:!1,usePagination:!0,pageSize:5,totalLength:0,overlay:"overlay",showBreadcrumbs:!0,titleSize:"sm:text-[72px] tracking-[0px]"},dataRequest:{},data:[],sourceInfo:{columns:[]}},controls:{columns:[{type:"toggle",label:"Title",key:"title",onChange:({key:t,value:s,attribute:n,state:r,columnIdx:a})=>{r.columns.forEach(l=>{l.title=s&&l.name===n.name,l.show=l.name===n.name?s:l.note||l.bgImg||l.logo})}},{type:"toggle",label:"Note",key:"note",onChange:({key:t,value:s,attribute:n,state:r,columnIdx:a})=>{r.columns.forEach(l=>{l.note=s&&l.name===n.name,l.show=l.name===n.name?s:l.title||l.bgImg||l.logo})}},{type:"toggle",label:"Image",key:"bgImg",onChange:({key:t,value:s,attribute:n,state:r,columnIdx:a})=>{r.columns.forEach(l=>{l.bgImg=s&&l.name===n.name,l.show=l.name===n.name?s:l.title||l.note||l.logo})}},{type:"toggle",label:"Logo",key:"logo",onChange:({key:t,value:s,attribute:n,state:r,columnIdx:a})=>{r.columns.forEach(l=>{l.logo=s&&l.name===n.name,l.show=l.name===n.name?s:l.title||l.note||l.bgImg})}},{type:"toggle",label:"Filter",key:"filters",trueValue:[{type:"internal",operation:"filter",values:[]}]}],more:[{type:"toggle",label:"Attribution",key:"showAttribution"},{type:"toggle",label:"Breadcrumbs",key:"showBreadcrumbs"},{type:"toggle",label:"Search",key:"showSearchBar"},{type:"select",label:"Overlay",key:"overlay",options:[{label:"Overlay",value:"overlay"},{label:"Inset",value:"inset"},{label:"Full Width",value:"full"},{label:"No Image",value:"none"}]},{type:"select",label:"Title Size",key:"titleSize",options:[{label:"Regular",value:"sm:text-[48px] tracking-[-2px]"},{label:"Large",value:"sm:text-[72px] tracking-[0px]"}]},{type:"input",inputType:"text",label:"Default Title",key:"defaultTitle"},{type:"input",inputType:"text",label:"Default Note",key:"defaultNote"},{type:"select",label:"Default Image",key:"defaultBgImg",options:[{label:"",value:void 0},...u6,...m6]}]},EditComp:du,ViewComp:du};function Mh({position:t="above",bgImg:s="",logo:n="",title:r="Title",bgClass:a="",subTitle:l="subTitle",note:i="note",height:c=300}){return e.jsxs("div",{className:` bg-fit bg-center w-full flex ${a}`,style:{backgroundImage:`url("${s}")`,height:c},children:[e.jsx("div",{className:"p-2",children:n&&e.jsx("img",{src:n,alt:"NYS Logo"})}),e.jsxs("div",{className:"flex-1 flex flex-col  items-center p-4",children:[e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"text-3xl sm:text-7xl font-bold text-[#f2a91a] text-right w-full text-display",children:r&&e.jsx("div",{children:r})}),e.jsx("div",{className:"text-lg tracking-wider pt-2 sm:text-3xl font-bold text-slate-200 text-right w-full uppercase",children:l&&e.jsx("div",{children:l})}),e.jsx("div",{className:"text-lg tracking-wider sm:text-xl font-bold text-slate-200 text-right w-full uppercase",children:i&&e.jsx("div",{children:i})}),e.jsx("div",{className:"flex-1"})]})]})}const h6=({position:t="above",bgImg:s="/img/header.png",logo:n="/img/nygov-logo.png",bgClass:r="",title:a="MitigateNY",subTitle:l="New York State Hazard Mitigation Plan",note:i="2023 Update"})=>new Promise((c,d)=>{c({position:t,bgImg:s,bgClass:r,logo:n,title:a,subTitle:l,note:i})}),Ah=({value:t,onChange:s,size:n})=>{let r=b.useMemo(()=>t&&m9(t)?JSON.parse(t):{},[t]);const[a,l]=b.useState(!0),[i,c]=b.useState(""),[d,u]=b.useState({bgImg:r.bgImg||"",logo:r.logo||"",title:r.title||"Title",subTitle:r.subTitle||"subTitle",note:r.note||"note",bgClass:r.bgClass||"",height:300});return b.useEffect(()=>{t!==JSON.stringify(d)&&s(JSON.stringify(d))},[d]),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"border rounded-md border-blue-500 bg-blue-50 p-2 m-1",children:[e.jsxs("div",{className:"flex flex-row flex-wrap justify-between",children:[e.jsx("label",{className:"shrink-0 pr-2 py-1 my-1 w-1/4",children:"Title:"}),e.jsx("div",{className:"flex flex row w-3/4 shrink my-1",children:e.jsx("input",{type:"text",value:d.title,onChange:m=>u({...d,title:m.target.value})})})]}),e.jsxs("div",{className:"flex flex-row flex-wrap justify-between",children:[e.jsx("label",{className:"shrink-0 pr-2 py-1 my-1 w-1/4",children:"subTitle:"}),e.jsx("div",{className:"flex flex row w-3/4 shrink my-1",children:e.jsx("input",{type:"text",value:d.subTitle,onChange:m=>u({...d,subTitle:m.target.value})})})]}),e.jsxs("div",{className:"flex flex-row flex-wrap justify-between",children:[e.jsx("label",{className:"shrink-0 pr-2 py-1 my-1 w-1/4",children:"Note:"}),e.jsx("div",{className:"flex flex row w-3/4 shrink my-1",children:e.jsx("input",{type:"text",value:d.note,onChange:m=>u({...d,note:m.target.value})})})]}),e.jsxs("div",{className:"flex flex-row flex-wrap justify-between",children:[e.jsx("label",{className:"shrink-0 pr-2 py-1 my-1 w-1/4",children:"Bg Class:"}),e.jsx("div",{className:"flex flex row w-3/4 shrink my-1",children:e.jsx("input",{type:"text",value:d.bgClass,onChange:m=>u({...d,bgClass:m.target.value})})})]}),e.jsxs("div",{className:"flex flex-row flex-wrap justify-between",children:[e.jsx("label",{className:"shrink-0 pr-2 py-1 my-1 w-1/4",children:"bgImg:"}),e.jsx("div",{className:"flex flex row w-3/4 shrink my-1",children:e.jsx("input",{type:"text",value:d.bgImg,onChange:m=>u({...d,bgImg:m.target.value})})})]}),e.jsxs("div",{className:"flex flex-row flex-wrap justify-between",children:[e.jsx("label",{className:"shrink-0 pr-2 py-1 my-1 w-1/4",children:"logo:"}),e.jsx("div",{className:"flex flex row w-3/4 shrink my-1",children:e.jsx("input",{type:"text",value:d.logo,onChange:m=>u({...d,logo:m.target.value})})})]}),e.jsxs("div",{className:"flex flex-row flex-wrap justify-between",children:[e.jsx("label",{className:"shrink-0 pr-2 py-1 my-1 w-1/4",children:"height:"}),e.jsx("div",{className:"flex flex row w-3/4 shrink my-1",children:e.jsx("input",{type:"text",value:d.logo,onChange:m=>u({...d,height:m.target.value})})})]})]}),e.jsx(Mh,{...d})]})})},f6=({value:t})=>{if(!t)return"";let s=typeof t=="object"?t["element-data"]:JSON.parse(t);return e.jsx(Mh,{...s})};Ah.settings={hasControls:!0,name:"ElementEdit"};const g6={name:"Header: Default",type:"Header",variables:[{name:"bgImg",default:"/img/header.png"},{name:"logo",default:"/img/nygov-logo.png"},{name:"title",default:"MitigateNY"},{name:"subTitle",default:"New York State Hazard Mitigation Plan"},{name:"bgClass",default:""},{name:"note",default:"2023 Update"}],getData:h6,EditComp:Ah,ViewComp:f6},b6=["#FFFFFF","#F3F8F9","#FCF6EC"],y6=({title:t,className:s,color:n,colors:r,setColor:a})=>{const[l,i]=b.useState(!1),c=b.useMemo(()=>r||b6,[r]);return e.jsxs("div",{className:s,children:[e.jsx("label",{className:"shrink-0 pr-2 w-1/4",children:t}),e.jsxs("div",{className:"",children:[e.jsx("div",{id:"background",className:"shrink w-[30px] h-[30px] border rounded-md",style:{backgroundColor:n},onClick:()=>i(!l)}),l?e.jsx("div",{className:"absolute z-[25]",children:e.jsx(Sh,{color:n,onChange:a,colors:c,showColorPicker:!1})}):null]})]})},v6=t=>{try{JSON.parse(t)}catch{return!1}return!0},Mt={Dark:{contentEditable:"border-none relative [tab-size:1] outline-none ",editorScroller:"min-h-[150px] border-0 flex relative outline-0 z-0bh resize-y",viewScroller:"border-0 flex relative outline-0 z-0 resize-none",editorContainer:"relative block rounded-[10px] min-h-[50px]",editorShell:"font-['Proxima_Nova'] font-[400] text-[16px] text-white leading-[22.4px]",heading:{h1:"pt-[8px] font-[500] text-[64px] text-white leading-[40px]  font-[500]  uppercase font-['Oswald'] pb-[12px]",h2:"pt-[8px] font-[500] text-[24px] text-white leading-[24px] scroll-mt-36 font-['Oswald']",h3:"pt-[8px] font-[500] text-[16px]  text-white font-['Oswald']",h4:"pt-[8px] font-medium scroll-mt-36 text-white font-display",h5:"scroll-mt-36 font-display",h6:"scroll-mt-36 font-display"}},Annotation:{contentEditable:"border-none relative [tab-size:1] outline-none ",editorContainer:"relative block rounded-[12px] min-h-[50px] shadow-[0px_0px_6px_0px_rgba(0,0,0,0.02),0px_2px_4px_0px_rgba(0,0,0,0.08)] overflow-hidden",editorViewContainer:"relative block rounded-[12px] shadow-[0px_0px_6px_0px_rgba(0,0,0,0.02),0px_2px_4px_0px_rgba(0,0,0,0.08)] overflow-hidden",paragraph:"m-0 relative px-[12px]",layoutContainer:"grid",layoutItem:"border-b border-slate-300 min-w-0 max-w-full",editor:{inlineImage:{base:"inline-block relative z-10 cursor-default select-none -mx-[12px]"}},heading:{h1:"pl-[16px] pt-[8px] font-[500] text-[34px] text-[#2D3E4C] leading-[40px]  font-[500]  uppercase font-['Oswald'] pb-[12px]",h2:"pl-[16px] pt-[8px] font-[500] text-[24px] text-[#2D3E4C] leading-[24px] scroll-mt-36 font-['Oswald']",h3:"pl-[16px] pt-[8px] font-[500] text-[16px]  text-[#2D3E4C] font-['Oswald']",h4:"pl-[16px] pt-[8px] font-medium scroll-mt-36 text-[#2D3E4C] font-display",h5:"pl-[16px] scroll-mt-36 font-display",h6:"pl-[16px] scroll-mt-36 font-display"}},"Annotation Image Card":{editorShell:"font-['Proxima_Nova'] font-[400] text-[16px] text-[#37576B] leading-[22.4px] pt-[120px]",contentEditable:"border-none relative [tab-size:1] outline-none ",editorContainer:"relative block rounded-[12px] min-h-[50px] shadow-[0px_0px_6px_0px_rgba(0,0,0,0.02),0px_2px_4px_0px_rgba(0,0,0,0.08)]",editorViewContainer:"relative block rounded-[12px] shadow-[0px_0px_6px_0px_rgba(0,0,0,0.02),0px_2px_4px_0px_rgba(0,0,0,0.08)]",paragraph:"m-0 relative px-[12px]",layoutContainer:"grid",layoutItem:"border-b border-slate-300 min-w-0 max-w-full",editor:{inlineImage:{base:"inline-block relative z-10 cursor-default select-none -mx-[12px]"}},heading:{h1:"pl-[16px] pt-[8px] font-[500] text-[34px] text-[#2D3E4C] leading-[40px]  font-[500]  uppercase font-['Oswald'] pb-[12px]",h2:"pl-[16px] pt-[8px] font-[500] text-[24px] text-[#2D3E4C] leading-[24px] scroll-mt-36 font-['Oswald']",h3:"pl-[16px] pt-[8px] font-[500] text-[16px]  text-[#2D3E4C] font-['Oswald']",h4:"pl-[16px] pt-[8px] font-medium scroll-mt-36 text-[#2D3E4C] font-display",h5:"pl-[16px] scroll-mt-36 font-display",h6:"pl-[16px] scroll-mt-36 font-display"},inlineImage:"inline-block relative z-10 cursor-default select-none mt-[-120px]"},Handwritten_2:{contentEditable:"border-none relative [tab-size:1] outline-none ",editorScroller:"min-h-[150px] border-0 flex relative outline-0 z-0bh resize-y",viewScroller:"border-0 flex relative outline-0 z-0 resize-none",editorContainer:"relative block rounded-[10px] min-h-[50px]",editorShell:"font-['Caveat'] font-[600] text-[20px] text-[#37576B] leading-[22.4px]"}},Th=({value:t,onChange:s})=>{var p,x;const n=b.useContext(me),r=t&&v6(t)?JSON.parse(t):{},a={text:"",size:"4xl",color:"000000"},[l,i]=b.useState((r==null?void 0:r.bgColor)||"rgba(0,0,0,0)"),[c,d]=b.useState((r==null?void 0:r.isCard)||""),[u,m]=b.useState((r==null?void 0:r.text)||t||a);return b.useEffect(()=>{s(JSON.stringify({bgColor:l,text:u,isCard:c}))},[l,u,c]),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex w-full px-2 py-1 flex flex-row text-sm items-center",children:[e.jsx("label",{className:"shrink-0 pr-2 w-1/4",children:"Style"}),e.jsx("div",{className:"",children:e.jsx(th,{options:[{label:"Default Text",value:""},{label:"Dark Text",value:"Dark"},{label:"Annotation Card",value:"Annotation"},{label:"Annotation Image Card",value:"Annotation Image Card"},{label:"Handwritten (Caveat)",value:"Handwritten_2"}],value:c,onChange:h=>{h.target.value!=="Annotation"&&i("rgba(0,0,0,0)"),d(h.target.value)}})})]}),c?e.jsx(y6,{className:"w-full px-2 py-1 flex flex-row text-sm items-center",color:l,setColor:i,title:"Background"}):null,e.jsxs("div",{className:"flex",children:[c==="Handwritten"&&e.jsxs("div",{className:"w-[50px]",children:[" ","<---"," "]}),e.jsx("div",{className:"flex-1",children:e.jsx(jo.EditComp,{value:u,onChange:m,bgColor:l,theme:{lexical:c?Ze(pe(yr),pe((Mt==null?void 0:Mt[c])||(Mt==null?void 0:Mt.Annotation)),{Icons:((p=n==null?void 0:n.theme)==null?void 0:p.Icons)||{}}):Ze(yr,{Icons:((x=n==null?void 0:n.theme)==null?void 0:x.Icons)||{}})}})})]})]})})};Th.settings={hasControls:!0,name:"ElementEdit"};const w6=({value:t})=>{var l,i,c,d,u,m,p,x,h,f;const s=b.useContext(me);if(!t)return e.jsx("div",{className:"h-6"});let n=typeof t=="object"?t["element-data"]:JSON.parse(t);const r=(n==null?void 0:n.text)||t,a=n==null?void 0:n.isCard;return!r||((i=(l=r==null?void 0:r.root)==null?void 0:l.children)==null?void 0:i.length)===1&&((m=(u=(d=(c=r==null?void 0:r.root)==null?void 0:c.children)==null?void 0:d[0])==null?void 0:u.children)==null?void 0:m.length)===0||((x=(p=r==null?void 0:r.root)==null?void 0:p.children)==null?void 0:x.length)===0?e.jsx("div",{className:"h-6"}):e.jsxs("div",{className:"flex",children:[["Handwritten","Handwritten_1","Handwritten_2","Handwritten_3"].includes(a)&&e.jsx("div",{className:"pt-2 pr-2",children:e.jsx("img",{src:"/themes/mny/handwritten_arrow.svg"})}),e.jsx("div",{className:"flex-1",children:e.jsx(jo.ViewComp,{value:r,bgColor:n==null?void 0:n.bgColor,theme:{lexical:a?Ze(pe(yr),pe((Mt==null?void 0:Mt[a])||(Mt==null?void 0:Mt.Annotation)),{Icons:((h=s==null?void 0:s.theme)==null?void 0:h.Icons)||{}}):Ze(yr,{Icons:((f=s==null?void 0:s.theme)==null?void 0:f.Icons)||{}})}})})]})},j6={name:"Rich Text",EditComp:Th,ViewComp:w6};function C6({context:t}){const{state:{columns:s=[],sourceInfo:n},setState:r}=b.useContext(t),a=b.useRef(),l=b.useRef(),i=b.useRef(null),[c,d]=b.useState(),[u,m]=b.useState(!1),p="menu-btn-column-controls";Kt(i,p,()=>m(!1));const x=((n==null?void 0:n.columns)||[]).map(M=>s.find(_=>_.name===M.name)||M).sort((M,_)=>{const L=s.findIndex(A=>A.name===M.Name),D=s.findIndex(A=>A.name===_.Name);return L-D}).filter(M=>!c||(M.customName||M.display_name||M.name).toLowerCase().includes(c.toLowerCase())),h=(M,_)=>{a.current=_,M.dataTransfer.effectAllowed="move"},f=(M,_)=>{l.current=_},g=M=>{M.preventDefault(),M.dataTransfer.dropEffect="move"},y=M=>{const _=pe(n.columns),L=_[a.current];_.splice(a.current,1),_.splice(l.current,0,L),a.current=null,l.current=null,r(D=>{D.columns=_.map(A=>s.find(T=>T.name===A.name)).filter(A=>A),D.sourceInfo.columns=_})},v=b.useCallback((M,_,L,D)=>{r(A=>{var O;let T=A.columns.findIndex(B=>B.name===M.name);T===-1?(A.columns.push({...M,[_]:L}),T=A.columns.length-1):A.columns[T][_]=L,_==="show"&&L===!1?(A.columns[T].sort=void 0,A.columns[T].fn=void 0):_==="show"&&L===!0&&A.columns.some(B=>B.name!==M.name&&B.group)&&(A.columns[T].fn=((O=A.columns[T].defaultFn)==null?void 0:O.toLowerCase())||"list")})},[r]),j=b.useCallback((M=!0)=>{r(_=>{const L=_.columns.some(({group:D})=>D);(_.sourceInfo.columns||[]).forEach(D=>{var T;let A=_.columns.findIndex(({name:O})=>O===D.name);A===-1?(_.columns.push({...D,show:M}),A=_.columns.length-1):_.columns[A].show=M,M&&L&&!_.columns[A].group&&!_.columns[A].fn?_.columns[A].fn=((T=_.columns[A].defaultFn)==null?void 0:T.toLowerCase())||"list":M||(_.columns[A].sort=void 0,_.columns[A].fn=void 0)})})},[r]),N=b.useCallback(M=>r(_=>{const L=s.findIndex(D=>D.name===M.name);L!==-1&&_.columns.splice(L,1)}),[s]),S=b.useCallback(()=>r(M=>{M.columns=[],M.dataRequest={}}),[s]),{gridClass:w,gridTemplateColumns:k,width:$}={gridClass:"grid grid-cols-4",gridTemplateColumns:"10rem 5rem 5rem 3rem",width:"23rem"},E=(n.columns||[]).map(({name:M})=>s.find(_=>_.name===M)).every(M=>M==null?void 0:M.show);return e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsxs("button",{id:p,className:`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular 
                 text-gray-900 shadow-sm ring-1 ring-inset ${s!=null&&s.length?"ring-blue-300":"ring-gray-300"} 
                 ${u?"bg-gray-50":"bg-white hover:bg-gray-50"} cursor-pointer`,onClick:()=>{m(!u),d(void 0)},children:["Columns ",e.jsx(ds,{id:p,height:18,width:18,className:"mt-1"})]}),e.jsxs("div",{ref:i,role:"menu",className:`${u?"visible transition ease-in duration-200":"hidden transition ease-in duration-200"} absolute left-0 z-10 w-[${$}] origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition focus:outline-none`,children:[e.jsx("input",{className:"px-4 py-1 w-full text-xs rounded-md",placeholder:"search...",onChange:M=>{d(M.target.value)}}),e.jsx("div",{className:"py-1 select-none",children:e.jsxs("div",{className:"flex items-center px-2 py-1 text-xs text-gray-700 hover:bg-gray-100 hover:text-gray-900",children:[e.jsx("div",{className:"h-4 w-4 m-1 text-gray-800",children:e.jsx("svg",{"data-v-4e778f45":"",className:"nc-icon cursor-move !h-3.75 text-gray-600 mr-1",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",children:e.jsx("path",{fill:"currentColor",d:"M8.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m0 6.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0M15.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1.5 8a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"})})}),e.jsxs("div",{className:`${w} gap-0.5 m-1 w-full`,style:{gridTemplateColumns:k},children:[e.jsx("div",{className:"place-self-stretch",children:"Column"}),e.jsx("div",{className:"justify-self-end",children:"Show"}),e.jsx("div",{className:"justify-self-end",children:"Reset"})]})]},"header")}),e.jsx("div",{className:"py-1 select-none",children:e.jsxs("div",{className:"flex items-center px-2 py-1 text-xs text-gray-700 hover:bg-gray-100 hover:text-gray-900",children:[e.jsx("div",{className:"h-4 w-4 m-1 text-gray-800",children:e.jsx("svg",{"data-v-4e778f45":"",className:"nc-icon cursor-move !h-3.75 text-gray-600 mr-1",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",children:e.jsx("path",{fill:"currentColor",d:"M8.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m0 6.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0M15.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1.5 8a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"})})}),e.jsxs("div",{className:`${w} gap-0.5 m-1 w-full`,style:{gridTemplateColumns:k},children:[e.jsx("div",{className:"place-self-stretch",children:"Apply to All"}),e.jsx("div",{className:"justify-self-end",children:e.jsx("div",{className:"justify-self-end",children:e.jsx(Zs,{size:"small",id:"all",enabled:E,setEnabled:()=>j(!E)})})}),e.jsx("button",{className:"w-fit place-self-end",onClick:()=>S(),children:e.jsx(Vl,{className:"text-orange-500 hover:text-orange-700"})})]})]},"global-controls")}),e.jsx("div",{className:"py-1 max-h-[500px] overflow-auto scrollbar-sm",children:x.map((M,_)=>e.jsxs("div",{className:"flex items-center px-2 py-1 text-xs text-gray-700 hover:bg-gray-100 hover:text-gray-900",onDragStart:L=>h(L,_),onDragEnter:L=>f(L,_),onDragOver:g,onDragEnd:y,draggable:M.show,children:[e.jsx("div",{className:"h-4 w-4 m-1 text-gray-800",children:e.jsx("svg",{"data-v-4e778f45":"",className:"nc-icon cursor-move !h-3.75 text-gray-600 mr-1",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",children:e.jsx("path",{fill:"currentColor",d:"M8.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m0 6.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0M15.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1.5 8a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"})})}),e.jsxs("div",{className:`${w} gap-0.5 m-1 w-full`,style:{gridTemplateColumns:k},children:[e.jsx("input",{className:"place-self-stretch",value:M.customName||M.display_name||M.name,onChange:L=>v(M,"customName",L.target.value)}),e.jsx("div",{className:"justify-self-end",children:e.jsx(Zs,{size:"small",id:M.name,enabled:M.show,setEnabled:L=>v(M,"show",L)})}),e.jsx("button",{className:"w-fit place-self-end",onClick:()=>N(M),children:e.jsx(Vl,{className:"text-orange-500 hover:text-orange-700"})})]})]},`${M.name}-${_}`))})]})]})}function N6({context:t}){const{state:{display:s},setState:n,compType:r}=b.useContext(t),a=b.useRef(null),[l,i]=b.useState(!1),c="menu-btn-more-controls";Kt(a,c,()=>i(!1));const d=b.useCallback((u,m)=>{n(p=>{p.display[u]=m})},[]);if(r!=="graph")return e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsx("div",{children:e.jsxs("div",{id:c,className:`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 ${l?"bg-gray-50":"bg-white hover:bg-gray-50"} cursor-pointer`,onClick:u=>i(!l),children:["More ",e.jsx(ds,{id:c,height:18,width:18,className:"mt-1"})]})}),e.jsx("div",{ref:a,className:`${l?"visible transition ease-in duration-200":"hidden transition ease-in duration-200"} absolute left-0 z-10 w-72 origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition focus:outline-none`,children:e.jsx("div",{className:"py-1 text-sm max-h-[500px] overflow-auto scrollbar-sm",children:e.jsx(it,{title:"Allow Edit",value:s.allowEditInView,setValue:u=>d("allowEditInView",u)})},"more")})]})}const Oh=(t,s)=>{var c,d,u,m,p,x,h,f,g,y,v,j,N,S,w,k,$,E;const n=$6(t)?JSON.parse(t):{};if(n!=null&&n.sourceInfo)return n;if(!Array.isArray(n==null?void 0:n.orderedAttributes))return s;const r=n.visibleAttributes.filter(M=>n.orderedAttributes.find(_=>_.name===M)).map(M=>{var _;return{...n.orderedAttributes.find(L=>L.name===M),customName:(_=n.customColNames)==null?void 0:_[M.name],show:!0}}),a={allowEditInView:n.allowEditInView};typeof((c=n.format)==null?void 0:c.view_id)=="object"?(u=(d=n.format)==null?void 0:d.view_id)==null||u.id:(m=n.format)==null||m.view_id;const l={app:(p=n.format)==null?void 0:p.app,type:(x=n.format)==null?void 0:x.type,isDms:(h=n.format)==null?void 0:h.isDms,env:(f=n.format)==null?void 0:f.env,srcEnv:(g=n.format)==null?void 0:g.srcEnv,source_id:(y=n.format)==null?void 0:y.id,view_id:typeof((v=n.format)==null?void 0:v.view_id)=="object"?(N=(j=n.format)==null?void 0:j.view_id)==null?void 0:N.id:(S=n.format)==null?void 0:S.view_id,view_name:((w=n.format)==null?void 0:w.version)||((k=n.format)==null?void 0:k.name),updated_at:(($=n.format)==null?void 0:$._modified_timestamp)||((E=n.format)==null?void 0:E.updated_at),columns:n.orderedAttributes||[]};return{columns:r,display:a,sourceInfo:l,dataRequest:{},data:n.data||[]}},k6={data:{},columns:[],display:{allowEditInView:!1},sourceInfo:{}},yl=b.createContext({}),$6=t=>{try{JSON.parse(t)}catch{return!1}return!0},ic=async({state:t,apiLoad:s,itemId:n})=>{var i,c,d,u;const r=[{type:()=>{},action:"edit",path:"view/:id",params:{id:n},filter:{attributes:(i=t==null?void 0:t.columns)==null?void 0:i.filter(({show:m})=>m).map(({name:m})=>m),stopFullDataLoad:!0}}],a={params:{id:n},format:{...t.sourceInfo,attributes:(c=t==null?void 0:t.columns)==null?void 0:c.filter(({show:m})=>m).map(m=>({...m,type:m.type==="multiselect"?"json":m.type,key:m.name})),type:(u=(d=t.sourceInfo)==null?void 0:d.type)!=null&&u.includes(`-${t.sourceInfo.view_id}`)?t.sourceInfo.type:`${t.sourceInfo.type}-${t.sourceInfo.view_id}`},children:r};return{data:(await s(a,`/view/${n}`)).find(m=>m.id===n)}},Dh=({value:t,onChange:s,size:n,format:r,pageFormat:a,apiLoad:l,apiUpdate:i,...c})=>{const[d,u]=st(Oh(t,k6)),[m]=Rt(),[p,x]=b.useState(),h=m.get("id");b.useEffect(()=>{async function g(){if(!h)return;const{data:y}=await ic({state:d,apiLoad:l,itemId:h});x(y),u(v=>{v.data=y})}g()},[h,d.columns]),b.useEffect(()=>{s(JSON.stringify(d))},[d]);const f=(g,y,v)=>(console.log("update item",g,y,v),i({data:{...v,[y.name]:g},config:{format:d.sourceInfo}}));return console.log("state",d),e.jsx(yl.Provider,{value:{state:d,setState:u,compType:"item"},children:e.jsxs("div",{children:[e.jsx(Lo,{apiLoad:l,app:a==null?void 0:a.app,state:d,setState:u}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(C6,{context:yl}),e.jsx(N6,{context:yl})]}),e.jsx("div",{className:"divide-y",children:d.columns.filter(({show:g})=>g).map((g,y)=>{var j;const v=((j=Ue[g.type])==null?void 0:j.EditComp)||Ue.text.EditComp;return e.jsxs("div",{className:"grid grid-cols-3 divide-x rounded-sm",style:{gridTemplateColumns:"15px 1fr 2fr"},children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"h-4 w-4 cursor-pointer text-gray-800",children:e.jsx("svg",{"data-v-4e778f45":"",className:"nc-icon cursor-move !h-3.75 text-gray-600",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M8.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m0 6.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0M15.5 7a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m1.5 5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1.5 8a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"})})})}),e.jsxs("div",{className:"w-5/6  flex items-center p-2 font-semibold text-gray-500",children:[g.display_name||g.name,g.prompt&&e.jsx(sx,{className:"text-xs px-1 hover:text-gray-700",title:g.prompt})]}),p?e.jsx("div",{className:"relative p-2 text-gray-700 max-w-11/12",children:e.jsx(v,{className:"border flex flex-wrap w-full p-2 bg-white hover:bg-blue-50 h-fit",...g,value:p[g.name],onChange:N=>{x({...p,[g.name]:N}),f(N,g,{...p,[g.name]:N})}},`${g.name}`)}):null]},y)})})]})})},S6=({value:t,format:s,apiLoad:n,apiUpdate:r,...a})=>{var f,g;const[l,i]=st(Oh(t)),[c,d]=Rt(),[u,m]=b.useState({}),p=(f=l.display)!=null&&f.allowEditInView?"EditComp":"ViewComp",x=c.get("id");b.useEffect(()=>{async function y(){if(x==="add-new-item"||!x)return;const{data:v}=await ic({state:l,apiLoad:n,itemId:x});i(j=>{j.data=v}),m(v)}y()},[x]);const h=async()=>{const y=await r({data:u,config:{format:{...l.sourceInfo,type:`${l.sourceInfo.type}-${l.sourceInfo.view_id}`}}});y!=null&&y.id&&x==="add-new-item"&&(window.location=window.location.href.replace(x,y.id)),y!=null&&y.id&&!x&&(window.location=`${window.location.href}?id=${y.id}`)};return e.jsx("div",{children:e.jsxs("div",{className:"divide-y w-full",children:[l.columns.filter(({show:y})=>y).map((y,v)=>{var N;const j=((N=Ue[y.type])==null?void 0:N[p])||Ue.text[p];return e.jsxs("div",{className:"group w-full flex flex-row items-center hover:bg-blue-50 rounded-md",children:[e.jsx("div",{className:"p-2 w-2/5 truncate text-sm font-bold text-gray-500",title:y.display_name||y.name,children:y.display_name||y.name}),e.jsx("div",{className:"relative w-3/5 p-2 text-gray-700",children:e.jsx(j,{className:"flex flex-wrap w-full p-2 bg-white group-hover:bg-blue-50 h-fit",...y,value:u==null?void 0:u[y.name],onChange:S=>{m({...u,[y.name]:S})}},`${y.name}`)})]},v)}),(g=l.display)!=null&&g.allowEditInView?e.jsxs("div",{className:"w-full flex justify-end gap-1",children:[e.jsx("button",{className:"px-2 py-0.5 bg-blue-300 hover:bg-blue-600 text-white rounded-md",onClick:()=>h(),children:"save"}),e.jsx("button",{className:"px-2 py-0.5 bg-red-300 hover:bg-red-600 text-white rounded-md",onClick:()=>m(l.data),children:"cancel"})]}):null]})})};Dh.settings={hasControls:!0,name:"ElementEdit"};const _6={name:"Item",type:"table",variables:[],getData:ic,EditComp:Dh,ViewComp:S6},Bh=(t,s)=>Array.from({length:s+1-t},(n,r)=>r+t),I6=t=>{if(typeof t=="object")return t;try{return JSON.parse(t)}catch{return t}},L6={"data->>'base_url' as base_url":{label:"Base Url",name:"base_url"},"data->>'doc_type' as doc_type":{label:"Doc Type",name:"doc_type"},"data->>'subdomain' as subdomain":{label:"Subdomain",name:"subdomain"},"data->>'authLevel' as authLevel":{label:"Auth Level",name:"authLevel"}},Wa=[{name:"tracking_id",display_name:"id"},{name:"parent",display_name:"Parent"},{name:"page_title",display_name:"Page Title"},{name:"section_title",display_name:"Section Title"},{name:"element_type",display_name:"Type"},{name:"tags",display_name:"Tags"},{name:"url",display_name:"URL"},{name:"attribution",display_name:"Current Version"}],E6=async({envs:t,falcor:s,setLoading:n})=>{const r=await s.get(["uda",Object.keys(t),"sources","length"]);return n(!0),(await Promise.all(Object.keys(t).map(async l=>{const i=ne(r,["json","uda",l,"sources","length"]);if(!i)return[];const c=await s.get(["uda",l,"sources","byIndex",{from:0,to:i-1},t[l].srcAttributes]),d=(u,m)=>ne(c,["json","uda",l,"sources","byIndex",u,m]);return Bh(0,i-1).map(u=>{const m=d(u,"doc_type"),p=d(u,"app"),x=m?`${p}+${m}`:l;return{...t[l].srcAttributes.reduce((h,f)=>({...h,[f]:d(u,f)}),{}),id:ne(c,["json","uda",l,"sources","byIndex",u,"$__path",4]),env:x,srcEnv:l,isDms:t[l].isDms}})}))).reduce((l,i)=>[...l,...i],[])},M6=async({envs:t,source:s,falcor:n})=>{if(!s||!s.srcEnv||!s.id)return[];const{srcEnv:r,id:a}=s,l=await n.get(["uda",r,"sources","byId",a,"views","length"]),i=ne(l,["json","uda",r,"sources","byId",a,"views","length"]);if(!i)return[];const c=await n.get(["uda",r,"sources","byId",a,"views","byIndex",{from:0,to:i-1},t[r].viewAttributes]);return Bh(0,i-1).map(d=>({id:ne(c,["json","uda",r,"sources","byId",a,"views","byIndex",d,"$__path",4]),...t[r].viewAttributes.reduce((u,m)=>({...u,[m]:ne(c,["json","uda",r,"sources","byId",a,"views","byIndex",d,m])}),{})}))},A6=({sections:t,pattern:s,fileName:n="sections"})=>{const r=async()=>{const a=(t||[]).map(i=>Wa.reduce((c,{name:d})=>{let u;return d==="attribution"?u=(cc({section:i})||[]).map(p=>`${p.version} (${p.source})`).join(", "):d==="url"?u=Fh({name:d,section:i,pattern:s}):u=i[d],c[d]=typeof u!="object"?u.toString():u,c},{})),l=Wa.map(({name:i,display_name:c})=>({column:c,type:String,value:d=>d==null?void 0:d[i],...i==="url"&&{hyperlink:d=>d==null?void 0:d[i]}}));await sp(a,{schema:l,fileName:`${n}.xlsx`})};return e.jsx("button",{className:"p-1 border rounded-md group",onClick:r,children:e.jsx(_x,{className:"text-blue-500 group-hover:text-blue-700",height:20,width:20})})},Fh=({name:t,section:s={},pattern:n={}})=>{var u;const r=t==="page_title"?s.url_slug:`${s.url_slug}#${s.section_id}`,a=(u=n.base_url)==null?void 0:u.replace("/",""),{protocol:l,host:i}=window.location,c=i.split(".").length>2?i.split(".").slice(1).join("."):i,d=typeof n.subdomain=="string"?`${n.subdomain}.${c}`:c;return a!=null&&a.length?`${l}//${d}/${a}/edit/${r}`:`${l}//${d}/edit/${r}`},zh=(t,s,n)=>{if(!(s!=null&&s.length))return[];if(!t.page_parent)return[t];const r=s.find(a=>+a.page_id==+t.page_parent);return r?r.page_parent?[...zh(r,s),t]:[r,t]:[]},cc=({section:t})=>t.attribution?(Array.isArray(t.attribution)?t.attribution:[t.attribution]).map(n=>({version:n.version,source:n.source_id,view:n.view_id,url:`/cenrep/source/${n.source_id}/versions/${n.view_id}`})):null,T6=({value:t})=>t?e.jsx("div",{className:"flex flex-wrap items-center",children:t.split(",").map((s,n)=>e.jsx("div",{className:"text-sm font-semibold text-white m-0.5 py-0.5 px-1 rounded-lg bg-red-300 h-fit w-fit",children:s},`${s}-${n}`))}):e.jsx("div",{className:"p-1",children:"N/A"}),O6=({value:t,section:s})=>{const r=(cc({section:s})||[]).map((a,l)=>e.jsx(ue,{to:a.url,className:"p-1",children:a.version},l));return e.jsx("div",{children:r||"N/A"})},D6=({value:t})=>e.jsx("div",{className:"p-1 overflow-hidden",children:t||"N/A"}),B6=({value:t,section:s,name:n,pattern:r})=>{const a=Fh({name:n,section:s,pattern:r});return e.jsx(ue,{className:"p-1 overflow-hidden",to:a,children:n==="url"?"link":t||"N/A"})},F6=({value:t=""})=>e.jsx("div",{className:"flex flex-wrap text-gray-900 text-sm items-center",children:t==null?void 0:t.split("/").map((s,n)=>e.jsx("span",{className:"bg-blue-300 font-semibold text-white m-0.5 py-0.5 px-1 w-fit h-fit rounded-lg",children:s},n)).reduce((s,n,r)=>r===0?[n]:[...s,e.jsx("span",{children:"/"},`${r}_`),n],[])}),z6=({value:t,name:s,section:n,sections:r,pattern:a})=>s==="tags"?e.jsx(T6,{value:t}):s==="attribution"?e.jsx(O6,{value:t,section:n}):["page_title","section_title","url"].includes(s)?e.jsx(B6,{name:s,value:t,section:n,pattern:a}):s==="parent"?e.jsx(F6,{value:t}):e.jsx(D6,{value:t});async function P6({app:t,falcor:s}){const n=JSON.stringify({filter:{"data->>'pattern_type'":["page"]}}),r=["data->>'base_url' as base_url","data->>'doc_type' as doc_type","data->>'subdomain' as subdomain","data->>'authLevel' as authLevel"],a=["dms","data",`${t}+pattern`,"options",n,"length"],l=await s.get(a),i=ne(l,["json",...a],0);if(!i)return;const c=["dms","data",`${t}+pattern`,"options",n,"byIndex"];await s.get([...c,{from:0,to:i-1},r]);const d=ne(s.getCache(),c,{});return Object.values(d).map(u=>Object.keys(u).reduce((m,p)=>({...m,[L6[p].name]:u[p]}),{}))}async function R6({app:t,pattern:s,falcor:n,setLoading:r}){r(!0);const a=["dms","data",`${t}+${s}`,"sections"];return await n.get(a),ne(n.getCache(),[...a,"value"],{})}const H6=t=>t.map(s=>{const n=zh(s,t),r=n.map(l=>l.page_title||l.url_slug).join("/"),a=n.map(l=>l.page_index).join("-");return{...s,parent:r,sortBy:a}}).filter(s=>s.parent&&s.sortBy).sort((s,n)=>s.sortBy.localeCompare(n.sortBy)),W6=async({sections:t,newView:s,falcor:n,user:r,setUpdating:a})=>{a(!0);const l=t.map(async d=>{var u;try{const m=d.section_id,p=d.page_id,x=tt[d.element_type],h=await n.get(["dms","data","byId",[m],["app","type","data"]]),f=ne(h,["json","dms","data","byId",m,"data"],{}),g=ne(h,["json","dms","data","byId",m,"app"],{}),y=ne(h,["json","dms","data","byId",m,"type"],{}),v={format:{app:g,type:y}},j=(u=f==null?void 0:f.element)!=null&&u["element-data"]?JSON.parse(f.element["element-data"]):{};let N=j.additionalVariables;const w={...((x==null?void 0:x.variables)||[]).reduce((k,$)=>(k[$.name]=j[$.name],k),{}),version:s,additionalVariables:N};return x!=null&&x.getData?x.getData(w,n).then(async k=>(f.element["element-data"]=JSON.stringify(k),f.id=m,await ys(n,v,f),{page_id:p,section_id:m,sectionTitle:f.title})):{err:"no getData"}}catch(m){return console.error("<Update-Section> Error: ",m),{err:m}}}),c=(await Promise.allSettled(l)).reduce((d,{value:{err:u,page_id:m,...p}})=>{if(u)return d;const x=d.findIndex(f=>f.page_id===m),h=p;return x>=0?d[x].sections.push(h):d.push({page_id:m,sections:[h]}),d},[]).map(async({page_id:d,sections:u})=>{try{const m=await n.get(["dms","data","byId",[d],["app","type","data"]]),p=ne(m,["json","dms","data","byId",d,"data"],{}),x=ne(m,["json","dms","data","byId",d,"app"],{}),h=ne(m,["json","dms","data","byId",d,"type"],{}),f={format:{app:x,type:h}};let g=u.map(({section_id:j,sectionTitle:N})=>({type:`Updated Section remotely ${N||p.draft_sections.findIndex(S=>+S.id==+j)+1}`,user:r.email,time:new Date().toString()})),y=p!=null&&p.history?pe(p.history):[];y.push(...g);const v={...p,has_changes:!0,history:y};await ys(n,f,v)}catch(m){return console.error("<Update-Page> Error:",m),{err:m}}});await Promise.allSettled(c).then(()=>{a(!1),window.location=window.location})},ni=({value:t,onChange:s})=>{const{app:n,siteType:r,baseUrl:a,falcor:l,falcorCache:i,pgEnv:c,user:d,...u}=b.useContext(me)||{},m=I6(t)?JSON.parse(t):{},[p,x]=b.useState(!1),[h,f]=b.useState([]),[g,y]=b.useState(m.pattern||[]),[v,j]=b.useState(m.sections||[]),[N,S]=b.useState(!1),[w,k]=b.useState([]),[$,E]=b.useState({}),[M,_]=b.useState([]),[L,D]=b.useState(),[A,T]=b.useState(),[O,B]=b.useState(),[F,z]=b.useState(!1),P=b.useMemo(()=>({[c]:{label:"external",srcAttributes:["name","metadata"],viewAttributes:["version"]},[`${n}+${r}`]:{label:"managed",isDms:!0,srcAttributes:["app","name","doc_type","config"],viewAttributes:["name"]}}),[c,n,r]);b.useEffect(()=>{x(!0),P6({app:n,falcor:l}).then(V=>{f(V),x(!1)})},[]),b.useEffect(()=>{g&&(R6({app:n,pattern:g,falcor:l,setLoading:x}).then(V=>{j(H6(V)),x(!1)}),E6({envs:P,falcor:l,setLoading:x}).then(V=>{k(V),x(!0)}))},[n,g,P]),b.useEffect(()=>{g&&M6({envs:P,source:$,falcor:l}).then(V=>{_(V)})},[$,n,g,P]);const U=b.useMemo(()=>v.reduce((V,X)=>(V[X.element_type]=(V[X.element_type]||0)+1,V),{}),[v]);b.useEffect(()=>{s&&s(JSON.stringify({...m,pattern:g}))},[g]);const R="0.2fr 2fr 1fr 1fr 0.5fr 0.7fr 0.2fr 1fr",W=V=>{const X=cc({section:V}),q=!($!=null&&$.id)||(X==null?void 0:X.some(Y=>+Y.source==+($==null?void 0:$.id)&&(!L||+Y.view==+L))),Q=!O||O===(V==null?void 0:V.element_type);return q&&Q};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex w-full",children:[e.jsx("label",{htmlFor:"pattern-selector",children:"Site: "}),e.jsxs("select",{id:"pattern-selector",className:"flex-0 w-full p-1 bg-blue-100 hover:bg-blue-300 border rounded-md",value:g,onChange:V=>y(V.target.value),children:[e.jsx("option",{children:"please select a pattern"}),(h||[]).map(V=>e.jsx("option",{value:V.doc_type,children:V.doc_type},V.doc_type))]})]}),!p&&e.jsx(A6,{sections:v,pattern:h.find(V=>V.doc_type===g),fileName:`${g}_sections`})]}),e.jsxs("div",{className:"flex items-center p-1 text-sm rounded-md my-1 w-fit bg-gray-100 hover:bg-gray-200 cursor-pointer",onClick:()=>S(!N),children:[e.jsx("span",{className:"mr-1",children:"Filter Empty Tags"}),e.jsx(Zs,{enabled:N,setEnabled:V=>S(V),label:"filter null tags",size:"small"})]}),e.jsxs("div",{className:"flex w-full bg-white items-center",children:[e.jsx("label",{className:"p-1",children:"Type: "}),e.jsx("div",{className:"w-1/6",children:e.jsx(Ms,{className:"flex-row-reverse",placeholder:"Search...",options:Object.keys(tt).filter(V=>!tt[V].hideInSelector).sort((V,X)=>(U[V]||0)-(U[X]||0)).map(V=>({key:V,label:`${tt[V].name} (${U[V]||0})`||tt[V].name||V})),value:O,onChange:V=>B(V)})}),e.jsx("label",{className:"p-1",children:"Source: "}),e.jsx("div",{className:"w-1/4",children:e.jsx(Ms,{className:"flex-row-reverse",placeholder:"Search...",options:w.map(({id:V,name:X,srcEnv:q})=>({key:V,label:`${X} (${P[q].label})`})),value:$==null?void 0:$.id,onChange:V=>{E(w.find(X=>+X.id==+V))}})}),e.jsx("label",{className:"p-1",children:"Current Version: "}),e.jsx("div",{className:"w-1/4",children:e.jsx(Ms,{className:"flex-row-reverse",placeholder:"Search...",options:M.map(({id:V,name:X,version:q})=>({key:V,label:X||q})),value:L,onChange:V=>D(V)})}),L?e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"p-1",children:"Update to Version: "}),e.jsx("div",{className:"w-1/4",children:e.jsx(Ms,{className:"flex-row-reverse",placeholder:"Search...",options:M.filter(V=>V.id!==L).map(({id:V,name:X,version:q})=>({key:V,label:X||q})),value:A,onChange:V=>T(V)})})]}):null,A?e.jsx("button",{disabled:F,className:"p-1 bg-blue-300 hover:bg-blue-600 text-white rounded-md",onClick:()=>W6({user:d,newView:A,sections:v.filter((V,X)=>{var q;return(!N||((q=V.tags)==null?void 0:q.length))&&W(V)}),falcor:l,setUpdating:z}),children:F?"updating...":"update"}):null]}),e.jsx("div",{className:"grid grid-cols-8 divide-x font-semibold text-sm border-x border-t",style:{gridTemplateColumns:R},children:Wa.map(V=>e.jsx("div",{className:"p-1",children:V.display_name},V.name))}),p?e.jsx("div",{className:"w-full text-center",children:"loading..."}):e.jsx("div",{className:"max-h-[700px] overflow-auto scrollbar-sm border rounded-md",children:(v||[]).filter((V,X)=>{var q;return(!N||((q=V.tags)==null?void 0:q.length))&&W(V)}).map((V,X)=>e.jsx("div",{className:"grid grid-cols-8 font-light text-sm even:bg-blue-50 hover:bg-blue-100",style:{gridTemplateColumns:R},children:Wa.map(({name:q})=>e.jsx(z6,{value:V[q],name:q,section:V,sections:v,pattern:h.find(Q=>Q.doc_type===g)},`${V.section_id}_${X}_${q}`))},`${V.section_id}-${X}`))})]})};ni.settings={hasControls:!0,name:"ElementEdit"};const V6={name:"Table: Components Index",type:"table",variables:[],EditComp:ni,ViewComp:ni},uu=C.createContext({}),ri={columns:[],display:{allowSearchParams:!1},sourceInfo:{columns:[]}},Ph=({value:t,onChange:s,pageFormat:n,apiLoad:r,apiUpdate:a,renderCard:l})=>{const i=!!s,[c,d]=st(Jt(t)?JSON.parse(t):ri);return b.useEffect(()=>{i&&s(JSON.stringify(c))},[c]),e.jsx(uu.Provider,{value:{state:c,setState:d,controls:{columns:[{type:"toggle",label:"Filter",key:"filters",trueValue:[{type:"internal",operation:"filter",values:[]}]}]}},children:e.jsxs("div",{className:"w-full h-full min-h-[50px]",children:[e.jsx(Lo,{apiLoad:r,app:n==null?void 0:n.app,state:c,setState:d}),i?e.jsx(xh,{context:uu}):null,e.jsx("div",{className:"w-full pt-2 flex justify-end gap-2",children:e.jsx(Io,{state:c,setState:d,apiLoad:r,isEdit:i,defaultOpen:!0})})]})})},U6=({value:t,onChange:s,size:n,apiLoad:r,apiUpdate:a,renderCard:l,...i})=>{const[d,u]=st(Jt(t)?JSON.parse(t):ri);return b.useEffect(()=>{u(Jt(t)?JSON.parse(t):ri)},[t]),e.jsx("div",{className:"w-full h-full min-h-[50px]",children:e.jsx("div",{className:"w-full pt-2 flex justify-end gap-2",children:e.jsx(Io,{state:d,setState:u,apiLoad:r,isEdit:!1,defaultOpen:!0,showNavigate:!0})})})};Ph.settings={hasControls:!0,name:"ElementEdit"};const q6={name:"Filter",type:"filter",variables:[],EditComp:Ph,ViewComp:U6},G6={app:"forms",type:"view",attributes:[{key:"name",placeholder:"Name",type:"text",required:!1}]},Rh={app:"forms",type:"source",registerFormats:[G6],attributes:[{key:"name",placeholder:"Name",type:"text",required:!1},{key:"doc_type",placeholder:"Doc Type",type:"text",required:!0},{key:"authLevel",placeholder:"-1",type:"text",required:!0},{key:"config",placeholder:"please select a type",type:"config"},{key:"description",placeholder:"Description",type:"lexical",required:!0},{key:"categories",placeholder:"Categories",type:"text",required:!0},{key:"views",type:"dms-format",isArray:!0,format:"forms+view"}]},J6={app:"forms",type:"form-manager",registerFormats:[Rh],attributes:[{key:"name",placeholder:"Name",type:"text",hidden:!0},{key:"sources",type:"dms-format",isArray:!0,format:"forms+source"}]};let{color:xs="white",size:Lt="compact",subMenuStyle:X6="inline",responsive:Z6="top"}={},mu={top:"hidden md:block",side:"hidden md:block",none:""},ss={white:{contentBg:"bg-white border-r",sideItemActive:"",contentBgAccent:"bg-neutral-100",accentColor:"blue-600",accentBg:"",borderColor:"border-slate-200",textColor:"text-slate-600",textColorAccent:"text-slate-800",highlightColor:"text-blue-800"},transparent:{contentBg:"border-r",contentBgAccent:"bg-slate-100",accentColor:"blue-600",accentBg:"hover:bg-blue-400",borderColor:"border-slate-100",textColor:"text-slate-600",textColorAccent:"text-slate-800",highlightColor:"text-slate-800"},dark:{contentBg:"bg-neutral-800",contentBgAccent:"bg-neutral-900",accentColor:"white",accentBg:"",borderColor:"border-neutral-700",textColor:"text-slate-300",textColorAccent:"text-slate-100",highlightColor:"text-slate-100",sideItem:"text-slate-300 hover:text-white",sideItemActive:"text-slate-300 hover:text-white"},bright:{contentBg:"bg-blue-700",accentColor:"blue-400",accentBg:"hover:bg-blue-400",borderColor:"border-blue-600",textColor:"text-white",highlightColor:"text-white-500"}},It={none:{wrapper:"w-0 overflow-hidden",sideItem:"flex mx-2 pr-4 py-2 text-base ",topItem:"flex items-center text-sm px-4 border-r h-12",icon:"mr-3 text-lg"},compact:{fixed:"ml-0 md:ml-44",wrapper:"w-44",itemWrapper:"pt-5",sideItem:"group flex px-3 py-1.5 text-[14px] font-light hover:bg-blue-50 text-slate-700 mx-2 ",sideItemActive:"group flex px-3 py-1.5 text-[14px] font-light hover:bg-blue-50 text-slate-700  mx-2 ",topItem:"flex items-center text-sm px-4 border-r h-12",icon:"group w-6 mr-2 text-blue-500 ",iconActive:"group w-6 mr-2 text-blue-500 ",sideItemContent:"transition-transform duration-300 ease-in-out"},full:{fixed:"",wrapper:"w-full",sideItem:"group flex px-3 py-2 text-[14px] font-light hover:bg-blue-50 text-slate-700 mx-2 border-r-4 border-white",sideItemActive:"group flex px-3 py-2 text-[14px] font-light hover:bg-blue-50 text-slate-700 mx-2 border-r-4  border-white",topItem:"flex pr-4 py-2  font-",icon:"group w-6 mr-2 text-blue-500  ",iconActive:"group w-6 mr-2 text-blue-500",sideItemContent:"group-hover:translate-x-1.5 transition-transform duration-300 ease-in-out"},mini:{fixed:"ml-0 md:ml-20",wrapper:"w-20 overflow-x-hidden",sideItem:"text-white hover:bg-blue-100 hover:text-blue-100",sideItemActive:"text-blue-500 bg-blue-500  ",topItem:"flex px-4 items-center text-sm font-light ",icon:"w-20 h-10 text-xl text-blue-500",iconActive:"w-20 h-10 text-xl text-white",sideItemContent:"w-0"},micro:{fixed:"ml-0 md:ml-14",wrapper:"w-14 overflow-x-hidden",itemWrapper:"p-1",sideItem:"flex text-base font-base ",topItem:"flex mx-6 pr-4 py-2 text-sm font-light",icon:"w-12 text-2xl hover:bg-neutral-900 px-1 py-3 my-2 rounded-lg mr-4 hover:text-blue-500",sideItemContent:"hidden"}};It[Lt]||(Lt="none");let Y6={inline:{indicatorIcon:"fa fa-angle-right pt-2.5",indicatorIconOpen:"fal fa-angle-down pt-2.5",subMenuWrapper:"pl-2 w-full",subMenuParentWrapper:"flex flex-col w-full"},flyout:{indicatorIcon:"fal fa-angle-down",indicatorIconOpen:"fa fa-angle-right",subMenuWrapper:`absolute ml-${It[Lt].width-8}`,subMenuParentWrapper:"flex flex-row",subMenuWrapperTop:"absolute top-full"}};const Q6={fixed:`md:${It[Lt].fixed}`,logoWrapper:`${It[Lt].wrapper} ${ss[xs].contentBgAccent} ${ss[xs].textColorAccent}`,sidenavWrapper:`${mu[Z6]} ${ss[xs].contentBg} ${It[Lt].wrapper} h-full z-20`,menuItemWrapper:"flex flex-col",menuIconSide:`${It[Lt].icon} group-hover:${ss[xs].highlightColor}`,menuIconSideActive:`${It[Lt].iconActive} group-hover:${ss[xs].highlightColor}`,itemsWrapper:`${ss[xs].borderColor} ${It[Lt].itemWrapper}  `,navItemContent:`${It[Lt].sideItemContent}`,navitemSide:`
        group  flex flex-col

        ${It[Lt].sideItem} ${ss[xs].sideItem}
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
        transition-all cursor-pointer
     `,navitemSideActive:`
        group  flex flex-col
         ${It[Lt].sideItemActive} ${ss[xs].sideItemActive} 
        
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
        transition-all cursor-pointer

      `,...Y6[X6],vars:{colors:ss,sizes:It,mobile:mu}},rt="white",hs="compact",K6="row";let nt={white:{contentBg:"bg-slate-100",accentColor:"blue-500",accentBg:"hover:bg-white",borderColor:"border-slate-100",textColor:"text-slate-700",highlightColor:"text-blue-500"},bright:{contentBg:"bg-blue-700",accentColor:"blue-400",accentBg:"hover:bg-blue-400",borderColor:"border-blue-600",textColor:"text-white",highlightColor:"text-white"}},ns={compact:{menu:"hidden uppercase md:flex flex-1  divide-x-2",sideItem:"flex  mx-6 pr-4 py-2 text-sm font-light hover:pl-4",topItem:`flex font-medium tracking-widest items-center text-[14px] px-4 h-12 ${nt[rt].textColor} ${nt[rt].borderColor}
        ${nt[rt].accentBg} hover:${nt[rt].highlightColor}`,activeItem:`flex font-medium  tracking-widest bg-white items-center text-[14px] px-4 h-12 ${nt[rt].highlightColor} ${nt[rt].borderColor}
        ${nt[rt].accentBg} hover:${nt[rt].highlightColor}`,icon:"mr-3 text-lg",responsive:"md:hidden"},inline:{menu:"flex flex-1",sideItem:"flex mx-4 pr-4 py-4 text-base font-base border-b hover:pl-4",topItem:`flex px-4 py-2 mx-2 font-medium text-gray-400 border-b-2 ${nt[rt].textColor} ${nt[rt].borderColor}
      hover:border-gray-300 hover:text-gray-700 border-gray-100 `,activeItem:`flex px-4 py-2 mx-2 font-medium text-blue-600 border-b-2 ${nt[rt].textColor} ${nt[rt].borderColor} border-blue-600 `,icon:"mr-4 text-2xl",responsive:"hidden"}},e8={inline:{subMenuWrapperChild:"",subMenuWrapper:"pl-2 w-full ",subMenuParentWrapper:"flex flex-col w-full  "},flyout:{indicatorIcon:"fal fa-angle-down pl-2 pt-1",indicatorIconOpen:"fal fa-angle-down pl-2",subMenuWrapper:`absolute ml-${ns[hs].width-8} `,subMenuParentWrapper:"flex flex-row  ",subMenuWrapperTop:"absolute top-full  "},row:{indicatorIcon:"fal fa-angle-down pl-2 pt-1",indicatorIconOpen:"fal fa-angle-down pl-2 pt-1",subMenuWrapper:`absolute bg-white ml-${ns[hs].width-8}`,subMenuParentWrapper:"flex flex-row  ",subMenuWrapperChild:"divide-x overflow-x-auto flex",subMenuWrapperTop:"absolute top-full left-0 border-y border-gray-200 w-full bg-white normal-case",subMenuWrapperInactiveFlyout:"absolute  mt-8 normal-case bg-white shadow-lg z-10 p-2",subMenuWrapperInactiveFlyoutBelow:" absolute ml-40 normal-case bg-white shadow-lg z-10 p-2",subMenuWrapperInactiveFlyoutDirection:"flex flex-col divide-y-2"}},t8={topnavWrapper:`w-full ${nt[rt].contentBg} border-b border-gray-200`,topnavContent:"flex w-full h-full",topnavMenu:`${ns[hs].menu} h-full overflow-x-auto overflow-y-hidden scrollbar-sm`,menuItemWrapper:"flex",menuIconTop:`text-${nt[rt].accentColor} ${ns[hs].icon} group-hover:${nt[rt].highlightColor}`,menuIconTopActive:`text-${nt[rt].accentColor} ${ns[hs].icon} group-hover:${nt[rt].highlightColor}`,menuOpenIcon:"fa-light fa-bars fa-fw",menuCloseIcon:'fa-light fa-xmark fa-fw"',navitemTop:`
        w-fit group font-display whitespace-nowrap
        ${ns[hs].topItem}
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
        transition cursor-pointer
    `,topmenuRightNavContainer:"hidden md:flex h-full items-center",topnavMobileContainer:"bg-slate-50",navitemTopActive:` w-fit group font-display whitespace-nowrap
        ${ns[hs].activeItem}
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
        transition cursor-pointer 
      `,mobileButton:`${ns[hs].responsive} ${nt[rt].contentBg} inline-flex items-center justify-center pt-[12px] px-2 hover:text-blue-400  text-gray-400 hover:bg-gray-100 `,...e8[K6],vars:{colors:nt,sizes:ns}};const Hh={navOptions:{logo:"",sideNav:{size:"none",search:"none",logo:"top",dropdown:"none",nav:"none"},topNav:{size:"compact",dropdown:"right",search:"right",logo:"left",position:"fixed",nav:"main"}},heading:{base:"p-2 w-full font-sans font-medium text-md bg-transparent",1:"text-blue-500 font-bold text-xl tracking-wider py-1 pl-1",2:"text-lg tracking-wider",3:"text-md tracking-wide",default:""},levelClasses:{1:" pt-2 pb-1 uppercase text-sm text-blue-400 hover:underline cursor-pointer border-r-2 mr-4",2:"pl-2 pt-2 pb-1 uppercase text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4",3:"pl-4 pt-2 pb-1 text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4",4:"pl-6 pt-2 pb-1 text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4"},layout:{wrapper:"",topnavContainer1:"",topnavContainer2:"sticky top-0 z-20 w-full max-w-[100vw]",sidenavContainer1:"mr-44",sidenavContainer2:"fixed h-[calc(100vh_-_52px)]"},page:{wrapper1:"w-full h-full flex-1 flex flex-col bg-slate-100",wrapper2:"w-full h-full flex-1 flex flex-row px-1 md:px-6 py-6",wrapper3:"flex flex-1 w-full  flex-col border shadow bg-white relative text-md font-light leading-7 p-4 min-h-[calc(100vh_-_102px)]",iconWrapper:"z-5 absolute right-[10px] top-[5px]",icon:"text-slate-400 hover:text-blue-500"},pageControls:{controlItem:"pl-6 py-0.5 text-md cursor-pointer hover:text-blue-500 text-slate-400 flex items-center",select:"bg-transparent border-none rounded-sm focus:ring-0 focus:border-0 pl-1",selectOption:"p-4 text-md cursor-pointer hover:text-blue-500 text-slate-400 hover:bg-blue-600"},navPadding:{1:"pt-0 ",2:"md:pt-12 pt-0",3:"md:pt-24 pt-0"},navLabel:"px-6 pb-1 pt-6 uppercase text-xs text-blue-400",bg:"bg-slate-100",sidenav:Q6,topnav:t8},_s={settings:{theme:{label:"Theme",defaultOpen:!0,controls:{theme:{label:"Theme",type:"select",options:["default","mnyv1"]}}}},navOptions:{topNav:{label:"Top Nav",defaultOpen:!0,controls:{size:{label:"Size",type:"select",options:["none","compact"]},logo:{label:"Logo",type:"select",options:["none","left","right"]},search:{label:"Search",type:"select",options:["none","left","right"]},dropdown:{label:"Menu",type:"select",options:["none","left","right"]},nav:{label:"Navigation",type:"select",options:["none","main","secondary"]}}},sideNav:{label:"Side Nav",defaultOpen:!1,controls:{size:{label:"Size",type:"select",options:["none","micro","mini","compact","full"]},color:{label:"Color",type:"select",options:["transparent","white","bright","dark"]},logo:{label:"Logo",type:"select",options:["none","top","bottom"]},search:{label:"Search",type:"select",options:["none","top","bottom"]},dropdown:{label:"Menu",type:"select",options:["none","top","bottom"]},nav:{label:"Navigation",type:"select",options:["none","main","secondary"]}}},secondaryNav:{label:"Secondary Nav",defaultOpen:!1,controls:{navItems:{label:"Nav Items",type:"menu"}}},authMenu:{label:"Auth Menu",defaultOpen:!1,controls:{navItems:{label:"Nav Items",type:"menu"}}}}},s8=t=>{const[s,n]=C.useState(null);return C.useEffect(()=>{const r=a=>{s.contains(a.target)||typeof t=="function"&&t(a)};return s&&document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[s,t]),[n,s]};function n8({control:t,children:s,className:n,width:r="w-full max-w-[200px]",openType:a="hover"}){const[l,i]=C.useState(!1),c=C.useCallback(()=>i(!1),[]),[d]=s8(c);return e.jsxs("div",{ref:d,className:`h-full relative cursor-pointer ${n}`,onMouseEnter:u=>{a==="hover"&&i(!0)},onMouseLeave:u=>i(!1),onClick:u=>{i(!l)},children:[t,l?e.jsx("div",{className:`shadow fixed ${r} rounded-b-lg ${l?"block":"hidden"} z-20`,children:s}):""]})}function r8({children:t,width:s="w-64"}){return e.jsx("div",{className:"w-64 hidden xl:block",children:e.jsx("div",{className:"w-64 sticky top-2 hidden xl:block max-h-[100vh_-_450px]",children:t})})}function a8({open:t,setOpen:s,initialFocus:n,children:r}){return e.jsx(Oe.Root,{show:t,as:b.Fragment,children:e.jsxs(Je,{as:"div",className:"relative z-30",initialFocus:n,onClose:s,children:[e.jsx(Oe.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),e.jsx("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:e.jsx("div",{onClick:()=>{s(!1)},className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:e.jsx(Oe.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:e.jsx(Je.Panel,{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6",children:r})})})})]})})}const o8=({user:t})=>{var s;return e.jsxs("div",{className:"flex justify-column align-middle py-1 px-4 w-44 overflow-hidden",children:[e.jsx("div",{className:"pt-[4px]",children:e.jsx("span",{className:`rounded-full border-2 border-blue-400
                    inline-flex items-center justify-center 
                    h-6 w-6 sm:h-8 sm:w-8 ring-white text-white 
                    bg-blue-500 overflow-hidden`,children:e.jsx(nx,{className:"text-slate-50 "})})}),e.jsxs("span",{className:"pl-2",children:[e.jsx("div",{className:"text-md font-thin tracking-tighter  text-left text-blue-600 group-hover:text-white ",children:t.email?t.email:""}),e.jsx("div",{className:"text-xs font-medium -mt-1 tracking-widest text-left text-gray-500 group-hover:text-gray-200",children:(s=t==null?void 0:t.groups)!=null&&s[0]?t.groups[0]:""})]})]})},pu=({to:t,icon:s,children:n})=>e.jsx(ue,{to:t,children:e.jsx("div",{className:"px-6 py-1 bg-blue-500 text-white hover:text-blue-100",children:e.jsxs("div",{className:"hover:translate-x-2 transition duration-100 ease-out hover:ease-in",children:[e.jsx("i",{className:`${s} `}),e.jsx("span",{className:"pl-2 text-sm",children:n})]})})}),Wh=({title:t,children:s,adminPath:n})=>{var u,m;const{user:r,baseUrl:a,parent:l,theme:i}=C.useContext(Ye),c=Ge();let d=((m=(u=i==null?void 0:i.navOptions)==null?void 0:u.authMenu)==null?void 0:m.navItems)||[{name:"Patterns",icon:"fad fa-sign-out-alt pb-2 pr-1",path:"/list",authLevel:5},{name:"Manager",icon:"fad fa-sign-out-alt pb-2 pr-1",path:`${a}/manage`,authLevel:5}];return e.jsx("div",{className:"h-full z-40",children:r.authed?e.jsx(n8,{control:e.jsx(o8,{user:r}),className:" hover:bg-blue-500 group z-40 ",children:e.jsxs("div",{className:"p-1 bg-blue-500 z-40",children:[e.jsx("div",{className:"py-2",children:d.map(p=>e.jsx(e.Fragment,{children:r.authLevel>=(+p.authLevel||-1)&&e.jsx(pu,{to:p.path,icon:p.icon,children:p.name})}))}),!r.fake&&e.jsx("div",{className:"py-1 border-t border-blue-400",children:e.jsx(pu,{to:"/auth/logout",icon:"fad fa-sign-out-alt pb-2 pr-1",children:"Logout"})})]})}):e.jsx(ue,{className:"flex items-center px-8 text-lg font-bold h-12 dark:text-blue-100 px-4",to:"/auth/login",state:{from:c==null?void 0:c.pathname},children:"Login"})})};function xu({icon:t,className:s}){let n="";if(!t||t!=null&&t.includes("fa"))n=e.jsx("span",{className:t});else{let r=zs[t];n=e.jsx(r,{})}return e.jsx("div",{className:`${s} flex justify-center items-center`,children:n})}const To=({i:t=0,children:s,icon:n,to:r,onClick:a,className:l=null,type:i="side",active:c=!1,subMenus:d=[],themeOptions:u,subMenuActivate:m="onClick",subMenuOpen:p=!1})=>{const{theme:x}=C.useContext(Ye)||{},h=(x==null?void 0:x[i==="side"?"sidenav":"topnav"])||{},f=Le(),g=C.useMemo(()=>Array.isArray(r)?r:[r],[r]),y=C.useMemo(()=>{const _=d.reduce((L,D)=>(Array.isArray(D.path)?L.push(...D.path):D.path&&L.push(D.path),L),[]);return[...g,..._]},[g,d]),v=!!_r({path:`${y[0]}/*`||"",end:!0}),j=i==="side"?h==null?void 0:h.navitemSide:h==null?void 0:h.navitemTop,N=i==="side"?h==null?void 0:h.navitemSideActive:h==null?void 0:h.navitemTopActive,S=v||c,w=S?N:j,[k,$]=C.useState(p||v),[E,M]=C.useState(!1);return b.useEffect(()=>{$(v)},[v,k,r]),e.jsx("div",{className:i==="side"?h==null?void 0:h.subMenuParentWrapper:null,onMouseOutCapture:()=>m==="onHover"&&$(!1)||m!=="onHover"&&M(!1)&&$(!1),onMouseMove:()=>m==="onHover"&&$(!0)||m!=="onHover"&&M(!0)&&$(!0),children:e.jsx("div",{className:`${l||w}`,onClick:_=>{if(_.stopPropagation(),a)return a(g[0]);g[0]&&f(g[0])},children:e.jsxs("div",{className:h.menuItemWrapper,children:[e.jsxs("div",{className:"flex-1 flex items-center",children:[n?e.jsx(xu,{icon:n,className:i==="side"?S?h==null?void 0:h.menuIconSideActive:h==null?void 0:h.menuIconSide:S?h==null?void 0:h.menuIconTopActive:h==null?void 0:h.menuIconTop}):null,e.jsx("div",{className:h==null?void 0:h.navItemContent,children:s}),e.jsx("div",{onClick:()=>{m==="onClick"&&$(!k)},children:d.length?e.jsx(xu,{icon:k?h==null?void 0:h.indicatorIconOpen:h==null?void 0:h.indicatorIcon}):null})]}),d.length?e.jsx(l8,{i:t,showSubMenu:k,subMenuActivate:m,active:v,hovering:E,subMenus:d,type:i,themeOptions:u,className:l}):""]})})})},l8=({i:t,showSubMenu:s,subMenus:n,type:r,hovering:a,subMenuActivate:l,active:i,themeOptions:c})=>{const{theme:d}=C.useContext(Ye),u=(d==null?void 0:d[r==="side"?"sidenav":"topnav"])||{},m=!i&&l!=="onHover"&&a;return(!s||!n.length)&&!m?null:e.jsx("div",{className:r==="side"?u==null?void 0:u.subMenuWrapper:m&&t===0?u==null?void 0:u.subMenuWrapperInactiveFlyout:m&&t>0?u==null?void 0:u.subMenuWrapperInactiveFlyoutBelow:u==null?void 0:u.subMenuWrapperTop,children:e.jsx("div",{className:`
							${m&&(u==null?void 0:u.subMenuWrapperInactiveFlyoutDirection)}
							${!m&&(u==null?void 0:u.subMenuWrapperChild)}
					
				`,children:n.map((p,x)=>e.jsx(To,{i:x+1,to:p.path,icon:p.icon,type:r,className:p.className,onClick:p.onClick,themeOptions:c,subMenus:p.subMenus,children:p.name},x))})})},Vh=({open:t,toggle:s,menuItems:n=[],rightMenu:r=null,themeOptions:a={}})=>{const{theme:l}=C.useContext(Ye)||{},i=(l==null?void 0:l.topnav)||{};return e.jsxs("div",{className:`${t?"md:hidden":"hidden"} ${i==null?void 0:i.topnavMobileContainer}`,id:"mobile-menu",children:[e.jsx("div",{className:"",children:n.map((c,d)=>e.jsx(To,{type:"top",to:c.path,icon:c.icon,themeOptions:a,subMenus:ne(c,"subMenus",[]),children:c.name},d))}),e.jsx("div",{className:"",children:r})]})},i8=({open:t,toggle:s,menuItems:n=[],rightMenu:r=null,leftMenu:a=null,subMenuActivate:l,themeOptions:i={}})=>{const{theme:c}=C.useContext(Ye)||{},d=(c==null?void 0:c.topnav)||{};return e.jsx("div",{className:`${d==null?void 0:d.topnavWrapper}`,children:e.jsxs("div",{className:`${d==null?void 0:d.topnavContent} justify-between`,children:[e.jsx("div",{children:a}),e.jsx("div",{className:`${d==null?void 0:d.topnavMenu}`,children:n.map((u,m)=>e.jsx(To,{type:"top",to:u.path,icon:u.icon,subMenuActivate:l,themeOptions:i,subMenus:ne(u,"subMenus",[]),children:u.name},m))}),e.jsxs("div",{className:"flex items-center justify-center h-full",children:[e.jsx("div",{className:`${d==null?void 0:d.topmenuRightNavContainer}`,children:r}),e.jsxs("button",{type:"button",className:`${d==null?void 0:d.mobileButton}`,onClick:()=>s(!t),children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("div",{className:"flex justify-center items-center text-2xl",children:e.jsx("span",{className:t?d==null?void 0:d.menuCloseIcon:d==null?void 0:d.menuOpenIcon})})]})]})]})})},c8=({...t})=>{const[s,n]=b.useState(!1);return e.jsxs("nav",{children:[e.jsx(i8,{open:s,toggle:n,...t}),e.jsx(Vh,{open:s,...t})]})},Uh=({i:t,item:s,themeOptions:n,subMenuActivate:r})=>e.jsx(To,{to:s.path,icon:s.icon,className:s.className,onClick:s.onClick,themeOptions:n,subMenuActivate:r,subMenus:ne(s,"subMenus",[]),children:s.name},t),d8=({open:t,toggle:s,logo:n=null,topMenu:r,menuItems:a=[],bottomMenu:l,themeOptions:i={},subMenuActivate:c,subMenuStyle:d,...u})=>{const{theme:m}=C.useContext(Ye)||{},p=(m==null?void 0:m.sidenav)||{};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden",onClick:()=>s(!t),children:e.jsx("span",{className:t?p==null?void 0:p.menuIconOpen:p==null?void 0:p.menuIconClosed})}),e.jsxs("div",{style:{display:t?"block":"none"},className:"md:hidden",children:[e.jsx("div",{className:"fixed inset-0 z-20 transition-opacity ease-linear duration-300",children:e.jsx("div",{className:"absolute inset-0 opacity-75"})}),e.jsx("div",{className:`fixed inset-0 flex z-40 ${p==null?void 0:p.contentBgAccent}`,children:e.jsxs("div",{className:`flex-1 flex flex-col max-w-xs w-full transform ease-in-out duration-300 ${p==null?void 0:p.contentBg}`,children:[e.jsx("div",{className:"absolute top-0 right-0 -mr-14 p-1",children:e.jsx("button",{onClick:()=>s(!t),className:"flex items-center justify-center h-12 w-12 rounded-full focus:outline-none focus:bg-gray-600 os-icon os-icon-x"})}),e.jsxs("div",{className:"flex-1 h-0 border border-orange-400 pt-2 pb-4 overflow-y-auto overflow-x-hidden flex",children:[e.jsx("div",{children:r}),e.jsx("nav",{className:"flex-1 ",children:a.map((x,h)=>e.jsx("div",{className:x.sectionClass,children:Uh({i:h,themeOptions:i,subMenuActivate:c})},h))}),e.jsx("div",{children:l})]})]})})]})]})},u8=({menuItems:t=[],logo:s=null,topMenu:n,bottomMenu:r,toggle:a,open:l,mobile:i,themeOptions:c={},subMenuActivate:d,subMenuStyle:u,...m})=>{const{theme:p}=C.useContext(Ye),x=(p==null?void 0:p.sidenav)||{};return console.log("sidenav theme",x),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`${x==null?void 0:x.sidenavWrapper}`,children:[n,e.jsx("nav",{className:`${x==null?void 0:x.itemsWrapper}`,children:t.map((h,f)=>Uh({i:f,item:h,themeOptions:c,subMenuActivate:d}))}),r]}),i==="side"?"":e.jsx("div",{className:`${x==null?void 0:x.topnavWrapper} md:hidden`,children:e.jsxs("div",{className:`${x==null?void 0:x.topnavContent} justify-between`,children:[e.jsx("div",{children:n}),e.jsxs("div",{className:"flex items-center justify-center h-full",children:[e.jsx("div",{className:`${x==null?void 0:x.topmenuRightNavContainer}`,children:r}),e.jsxs("button",{type:"button",className:x==null?void 0:x.mobileButton,onClick:()=>a(!l),children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("div",{className:"flex justify-center items-center text-2xl",children:e.jsx("span",{className:l?x==null?void 0:x.menuCloseIcon:x==null?void 0:x.menuOpenIcon})})]})]})]})})]})},m8=t=>{const[s,n]=b.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(u8,{...t,open:s,toggle:n}),t.mobile==="side"?e.jsx(d8,{open:s,toggle:n,...t}):e.jsx(Vh,{open:s,...t,themeOptions:{}})]})},p8=()=>e.jsx("div",{className:"h-12"}),aa=()=>e.jsx("div",{}),Oo=({children:t,navItems:s=[],title:n,theme:r,yPadding:a="0px",...l})=>{var y,v,j,N,S,w;const{theme:i,app:c,type:d,Menu:u}=C.useContext(Ye)||{},m=((v=(y=i==null?void 0:i.navOptions)==null?void 0:y.secondaryNav)==null?void 0:v.navItems)||[];r=Ze(pe(i),pe(r));const{sideNav:p={},topNav:x={},logo:h=p8}=(r==null?void 0:r.navOptions)||{},f={size:p.size||"none",color:p.color||"transparent",menuItems:((p==null?void 0:p.nav)==="main"?s:(p==null?void 0:p.nav)==="secondary"?m||[]:[]).filter(k=>!(k!=null&&k.hideInNav)),topMenu:e.jsxs("div",{className:"flex flex-row md:flex-col",children:[(p==null?void 0:p.logo)==="top"&&h,(p==null?void 0:p.dropdown)==="top"&&e.jsx(u,{}),(p==null?void 0:p.search)==="top"&&e.jsx(aa,{app:c,type:d})]}),bottomMenu:e.jsxs("div",{className:"flex flex-row md:flex-col",children:[(p==null?void 0:p.logo)==="bottom"&&h,(p==null?void 0:p.search)==="bottom"&&e.jsx(aa,{app:c,type:d}),(p==null?void 0:p.dropdown)==="bottom"&&e.jsx(u,{})]})},g={position:x.position||"block",size:x.size||"compact",menu:x.menu||"left",subMenuStyle:x.subMenuStyle||"row",menuItems:((x==null?void 0:x.nav)==="main"?s:[]).filter(k=>!k.hideInNav),leftMenu:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[(x==null?void 0:x.logo)==="left"&&h,(x==null?void 0:x.search)==="left"&&e.jsx(aa,{app:c,type:d}),(x==null?void 0:x.dropdown)==="left"&&e.jsx(u,{})]}),rightMenu:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[x==null?void 0:x.rightMenu,(x==null?void 0:x.search)==="right"&&e.jsx(aa,{app:c,type:d}),(x==null?void 0:x.dropdown)==="right"&&e.jsx(u,{}),(x==null?void 0:x.logo)==="right"&&h]})};return f.logo,e.jsx("div",{className:`flex ${r==null?void 0:r.bg} max-w-screen`,children:e.jsx("div",{className:`flex flex-1 max-w-screen ${(j=r==null?void 0:r.layout)==null?void 0:j.wrapper}`,children:e.jsxs("div",{className:"flex-1 flex items-start flex-col items-stretch max-w-full",style:{minHeight:`calc(100vh - ${a}`},children:[g.size==="none"?"":e.jsx(e.Fragment,{children:e.jsx("div",{className:`${(N=r==null?void 0:r.layout)==null?void 0:N.topnavContainer2}`,children:e.jsx(c8,{themeOptions:g,leftMenu:g.leftMenu,menuItems:g.menuItems,rightMenu:g.rightMenu})})}),e.jsxs("div",{className:"flex-1 flex",children:[f.size==="none"?"":e.jsx("div",{className:`${(S=r==null?void 0:r.layout)==null?void 0:S.sidenavContainer1}`,children:e.jsx("div",{className:`${(w=r==null?void 0:r.layout)==null?void 0:w.sidenavContainer2}`,children:e.jsx(m8,{topMenu:f.topMenu,bottomMenu:f.bottomMenu,themeOptions:f,menuItems:f.menuItems})})}),e.jsx("div",{className:"flex-1",children:t})]})]})})})},x8={navOptions:{sideNav:{size:"compact",search:"none",logo:"none",dropdown:"none",nav:"main"},topNav:{size:"compact",dropdown:"right",search:"none",logo:"left",position:"fixed",nav:"none"}}};function h8({children:t}){var l;const{baseUrl:s,theme:n={},user:r}=C.useContext(Ye)||{},a=[{name:"< Manage Site",path:"/list"},{name:"",className:"p-2"},{name:"Dashboard",path:`${s}/manage`},{name:"View Site",path:`${s}/`},{name:"Layout",className:n.navLabel},{name:"Design",path:`${s}/manage/design`}];return e.jsx(Oo,{navItems:a,theme:x8,children:e.jsx("div",{className:`${(l=n==null?void 0:n.page)==null?void 0:l.wrapper1} `,children:t})})}function f8({item:t,dataItems:s,attributes:n,logo:r,rightMenu:a}){var d,u;const{baseUrl:l,theme:i,user:c}=C.useContext(Ye)||{};return e.jsx("div",{className:`${(d=i==null?void 0:i.page)==null?void 0:d.wrapper2}`,children:e.jsx("div",{className:(u=i==null?void 0:i.page)==null?void 0:u.wrapper3,children:e.jsx("div",{children:"Forms Dashboard"})})})}function Va(t,s=[],n="",r){let a=s.filter(l=>t.id&&l.parent===t.id).sort((l,i)=>l.index-i.index);return a.length===0?!1:a.map((l,i)=>{let c={id:l.id,path:`${r?`${n}/edit`:n}/${l.url_slug||l.id}`,name:l.title};return Va(c,s)&&(c.subMenus=Va(l,s,n,r)),c})}function g8(t=[],s="",n=!1){return t.sort((r,a)=>r.index-a.index).filter(r=>!r.parent).filter(r=>n||r.published!=="draft").map((r,a)=>{let l={id:r.id,path:`${n?`${s}/edit`:s}${r.url_slug==="/"?"":"/"}${r.url_slug||r.id}`,name:`${r.title} ${r.published==="draft"?"*":""}`,hideInNav:r.hide_in_nav};return Va(l,t,s,n)&&(l.subMenus=Va(r,t,s,n)),l})}function b8({themeOptions:t,theme:s,newTheme:n,setNewTheme:r,sectionKey:a,navKey:l,controlKey:i}){var d,u,m,p;let c=t[a][l].controls[i];return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"text-xs font-medium pt-1 text-slate-400",children:c.label}),e.jsx("div",{className:"w-full",children:e.jsx("select",{className:"p-2 bg-white w-full",value:((u=(d=n[a])==null?void 0:d[l])==null?void 0:u[i])||((p=(m=s[a])==null?void 0:m[l])==null?void 0:p[i]),onChange:x=>{r(Ze(pe(n),{[a]:{[l]:{[i]:x.target.value}}}))},children:c.options.map(x=>e.jsx("option",{value:x,children:x},x))})})]})}function y8({onSave:t,onCancel:s,item:n}){const r={name:"",icon:"",path:"",className:"",authLevel:"-1"};let[a,l]=C.useState(n||r);return C.useEffect(()=>{l(n||r)},[n]),e.jsxs("div",{children:[["name","icon","path","className","authLevel"].map(i=>e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium pt-1 text-slate-400",children:i}),e.jsx("div",{className:"w-full",children:e.jsx("input",{className:"p-2 bg-white w-full",value:a[i],onChange:c=>l({...a,[i]:c.target.value})})})]},i)),e.jsxs("div",{className:"flex justify-end py-2",children:[e.jsx("div",{className:"bg-slate-300 rounded px-2 py-1 text-slate-100 cursor-pointer",onClick:s,children:"Cancel"}),e.jsx("div",{className:"bg-blue-500 rounded px-2 py-1 text-white cursor-pointer ml-2",onClick:()=>t(a),children:"Save"})]})]})}function v8({onSave:t,onCancel:s,items:n}){let[r,a]=C.useState(JSON.stringify(n||[],null,3));return e.jsxs("div",{children:["(",e.jsx("div",{children:e.jsx("div",{className:"w-full",children:e.jsx("textarea",{className:"p-2 bg-white w-full",value:r,onChange:l=>a(l.target.value)})})}),e.jsxs("div",{className:"flex justify-end py-2",children:[e.jsx("div",{className:"bg-slate-300 rounded px-2 py-1 text-slate-100 cursor-pointer",onClick:s,children:"Cancel"}),e.jsx("div",{className:"bg-blue-500 rounded px-2 py-1 text-white cursor-pointer ml-2",onClick:()=>t(JSON.parse(r)||n),children:"Save"})]})]})}function w8({themeOptions:t,theme:s,newTheme:n,setNewTheme:r,sectionKey:a,navKey:l,controlKey:i}){var p,x;let[c,d]=C.useState(-2),u=t[a][l].controls[i],m=((x=(p=n==null?void 0:n[a])==null?void 0:p[l])==null?void 0:x[i])||[];return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"text-xs font-medium pt-1 text-slate-400 w-full flex justify-between",children:[e.jsxs("div",{className:"flex-1",children:[u.label," ",c]}),e.jsx("div",{children:e.jsx("button",{className:"bg-blue-500 rounded px-0.5 py-1 text-white cursor-pointer",onClick:()=>d(-3),children:"</>"})}),e.jsx("div",{children:e.jsx("button",{className:"bg-blue-500 rounded px-0.5 py-1 text-white cursor-pointer",onClick:()=>d(-1),children:"Add Item"})})]}),c===-3?e.jsx("div",{children:e.jsx(v8,{onCancel:h=>d(-2),items:m,onSave:h=>{r(Ze(pe(n),{[a]:{[l]:{[i]:h}}})),d(-2)}})}):e.jsx("div",{children:m.length===0?"No Items":m.map((h,f)=>e.jsxs("div",{className:"flex w-full text-sm items-center py-1 border-b",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-medium text-slate-600",children:h.name})," ",e.jsx("span",{className:"text-slate-400",children:h.path})]}),e.jsx("div",{onClick:()=>{console.log("pencil click",f),d(f)},children:e.jsx(zs.PencilIcon,{className:"h-5 w-5 cursor-pointer text-slate-500 hover:text-blue-500"})}),e.jsx("div",{children:e.jsx(zs.RemoveCircle,{onClick:()=>{console.log("menuItems",m),m.splice(f,1);let g=m;console.log("splice",g,f),r(Ze(pe(n),{[a]:{[l]:{[i]:g}}}))},className:"h-5 w-5 cursor-pointer text-slate-500 hover:text-red-500"})})]},f))}),e.jsx("div",{children:c!==-2?e.jsx(y8,{onCancel:h=>d(-2),item:m==null?void 0:m[c],onSave:h=>{const f=m;c===-1?f.push(h):f[c]=h,r(Ze(pe(n),{[a]:{[l]:{[i]:f}}})),d(-2)}}):""})]})}const j8={select:b8,menu:w8};function C8({item:t,dataItems:s,attributes:n,apiLoad:r,apiUpdate:a,format:l,logo:i,rightMenu:c,themes:d,...u}){var w,k,$,E,M,_;const{baseUrl:m,theme:p,user:x}=C.useContext(Ye)||{},[h,f]=C.useState({}),[g,y]=C.useState({}),v=Ze(pe(p),pe(d[((k=(w=h==null?void 0:h.settings)==null?void 0:w.theme)==null?void 0:k.theme)||"default"]),pe(h)),j={app:l.app,type:"pattern",attributes:[{key:"theme",type:"text"}]},N=C.useMemo(()=>g8(s,m,!1),[s]);C.useEffect(()=>{(async()=>{var O;const{app:D,type:A}=l;console.log("format type",A);let T=await r({children:[{action:"list",path:"/*",filter:{options:JSON.stringify({filter:{"data->>'doc_type'":[l.type]}})}}],format:j});console.log("got data",T),f(pe(((O=T==null?void 0:T[0])==null?void 0:O.theme)||{})),y(pe({theme:{},...T==null?void 0:T[0]}))})()},[]);function S(){a({data:{id:g.id,theme:h},config:{format:j}}),y({...g,theme:h})}return e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:"flex-1 h-full flex p-4",children:e.jsx(op,{className:"flex-1 border",head:e.jsxs(e.Fragment,{children:[e.jsx("link",{type:"text/css",rel:"stylesheet",href:"/css/build.css"}),e.jsx("link",{href:"/fonts/font-awesome-6/css/all.min.css",rel:"stylesheet"})]}),children:e.jsx(Oo,{navItems:N,secondNav:((E=($=h==null?void 0:h.navOptions)==null?void 0:$.secondaryNav)==null?void 0:E.navItems)||[],theme:v,children:e.jsx("div",{className:`${(M=v==null?void 0:v.page)==null?void 0:M.wrapper2}`,children:e.jsx("div",{className:`${(_=v==null?void 0:v.page)==null?void 0:_.wrapper3} `,children:"Placeholder Content"})})})})}),e.jsx(r8,{custom:"top-12 h-full",children:e.jsxs("div",{className:"border-l h-full",children:[e.jsxs("div",{className:"px-1 py-2 w-full flex justify-between items-center",children:[e.jsx("div",{children:"Design Options"}),e.jsx("div",{children:e.jsx("button",{onClick:S,disabled:Qe(g.theme,h),className:"bg-blue-500 disabled:bg-slate-300  disabled:border-slate-400  rounded px-3 border border-blue-400 shadow  py-1 text-white cursor-pointer mx-2",children:"Save"})})]}),e.jsx("div",{className:"border-t",children:Object.keys(_s).map(L=>e.jsxs("div",{children:[L,Object.keys(_s[L]).map(D=>e.jsx(lp,{as:"div",className:"border-b",defaultOpen:_s[L][D].defaultOpen,children:({open:A})=>e.jsxs(e.Fragment,{children:[e.jsxs(ip,{className:"group flex w-full items-center justify-between p-1 ",children:[e.jsx("span",{className:"text-xs/6 font-bold text-slate-700 group-data-[hover]:text-slate-700/80",children:_s[L][D].label}),e.jsx("span",{children:A?e.jsx(rx,{className:"text-slate-400 h-6 w-6 mr-2"}):e.jsx(rn,{className:"text-slate-400 h-6 w-6 mr-2"})})]}),e.jsx(cp,{className:"text-xs/5 text-slate-700/50 py-1 px-2",children:Object.keys(_s[L][D].controls).map(T=>{const O=j8[_s[L][D].controls[T].type||"select"];return e.jsx("div",{children:e.jsx(O,{theme:p,newTheme:h,setNewTheme:f,themeOptions:_s,sectionKey:L,navKey:D,controlKey:T})},`${L}_${D}_${T}`)})})]})},D))]},L))}),e.jsx("div",{children:e.jsx("pre",{className:"text-xs",children:JSON.stringify(h,null,3)})})]})})]})}const N8=[{name:"Overview",href:"",viewDependentPage:!1},{name:"Table",href:"table",viewDependentPage:!0},{name:"Validate",href:"validate",viewDependentPage:!0},{name:"Metadata",href:"metadata",viewDependentPage:!1},{name:"Upload",href:"upload",viewDependentPage:!0},{name:"Admin",href:"admin",viewDependentPage:!1}],ks=({children:t,fullWidth:s,hideBreadcrumbs:n,hideNav:r,form:a,page:l,baseUrl:i,pageBaseUrl:c,id:d,views:u=[],view_id:m,showVersionSelector:p=!1})=>{const x=Le();return e.jsxs("div",{className:`${s?"":"max-w-6xl mx-72"} h-full flex flex-col`,children:[n?"":e.jsx("div",{className:"",children:e.jsx($8,{fullWidth:s,baseUrl:i,form:a,page:l})}),e.jsxs("div",{className:"w-full flex justify-between",children:[e.jsx(k8,{navPages:N8,page:l,hideNav:r,baseUrl:c,id:d,view_id:m}),p?e.jsxs("select",{id:"version-selector",onChange:h=>{const f=l.href.replace(`/${m}`,"");x(`${f}/${h.target.value}`)},className:"w-fit p-1 rounded hover:bg-gray-100 bg-transparent",value:m,children:[e.jsx("option",{value:void 0,children:"No version selected"},"default"),u.map(h=>e.jsx("option",{value:h.id,children:h.name||h.id},h.id))]}):null]}),e.jsx("div",{className:"flex-1 flex flex-col",children:t})]})},k8=({baseUrl:t,navPages:s,page:n,hideNav:r,id:a,view_id:l})=>r?null:e.jsx("nav",{className:"w-full flex",children:s.map(i=>e.jsx(ue,{className:`p-2 mx-1 font-display font-medium text-l text-slate-700
                    ${i.name===n.name?"border-b-2 border-blue-600":"hover:border-b-2 hover:border-gray-300"}`,to:`${t}/${a}/${i.viewDependentPage?`${i.href}/${l||""}`:i.href}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"pr-0.5",children:i.name})," ",n.warn&&i.name===n.name?e.jsx(qi,{}):""]})}))}),$8=({fullWidth:t,baseUrl:s,form:n,page:r})=>e.jsx("nav",{className:"border-b border-gray-200 flex ","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:`${t?"w-full":"max-w-screen-xl w-full mx-auto"}  px-4 flex space-x-4 sm:px-6 lg:px-8`,children:[e.jsx("li",{className:"flex",children:e.jsx("div",{className:"flex items-center",children:e.jsxs(ue,{to:`${s||"/"}`,className:"hover:text-[#bbd4cb] text-[#679d89]",children:[e.jsx("i",{className:"fad fa-database flex-shrink-0 h-5 w-5","aria-hidden":"true"}),e.jsx("span",{className:"sr-only",children:"Data Sources"})]})})}),[n,r].filter(a=>a).map((a,l)=>e.jsx("li",{className:"flex",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"flex-shrink-0 w-6 h-full text-gray-300",viewBox:"0 0 30 44",preserveAspectRatio:"none",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:e.jsx("path",{d:"M.293 0l22 22-22 22h1.414l22-22-22-22H.293z"})}),a.href?e.jsx(ue,{to:a.href,className:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700","aria-current":a.current?"page":void 0,children:a.name}):e.jsx("div",{className:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700","aria-current":a.current?"page":void 0,children:a.name})]})},l))]})}),hu=(t,s,n,r,a)=>`SUM(CASE ${r?`WHEN (data->>'${t}' IS NULL OR data->>'${t}'::text = '') THEN 1`:""}
              ${n!=null&&n.length?`WHEN data->>'${t}' NOT IN (${n.map(i=>`'${((i==null?void 0:i.value)||i).replace(/'/,"''")}'`)}) THEN 1`:""} ELSE 0 END) AS ${s}_error`.replaceAll(`
`," "),fu=(t,s,n,r,a)=>(a==="multiselect"&&(r||n!=null&&n.length)?`array_agg(CASE 
                        ${r?`WHEN (data->>'${t}' IS NULL OR data->>'${t}'::text = '') THEN data->'${t}'`:""}
                        ${n!=null&&n.length?`WHEN NOT data->'${t}' <@  '[${n.map(i=>`"${((i==null?void 0:i.value)||i).replace(/'/,"''")}"`)}]'::jsonb THEN data->'${t}' ELSE '"__VALID__"'::jsonb`:""}
                   END) AS ${s}_invalid_values`:a==="select"&&(r||n!=null&&n.length)?`array_agg(CASE 
                            ${r?`WHEN (data->>'${t}' IS NULL OR data->>'${t}'::text = '') THEN data->>'${t}'`:""}
                            ${n!=null&&n.length?`WHEN data->>'${t}' NOT IN (${n.map(i=>`'${((i==null?void 0:i.value)||i).replace(/'/,"''")}'`)}) THEN data->>'${t}' ELSE '"__VALID__"'`:""}
                       END) AS ${s}_invalid_values`:!["select","multiselect"].includes(a)&&r?`array_agg(CASE WHEN (data->>'${t}' IS NULL OR data->>'${t}'::text = '') THEN data->>'${t}' ELSE '"__VALID__"' END) AS ${s}_invalid_values`:"").replaceAll(`
`," "),gu=(t,s)=>s.find(n=>n.name===t),S8=(t,s)=>t?ih(t,s):null,_8=({display:t,type:s,origin:n})=>t==="calculated"||s==="calculated"||n==="calculated-column",qh="|||",I8=async({app:t,type:s,parentId:n,parentDocType:r,dmsServerPath:a,setValidating:l,setError:i,falcor:c})=>{try{l(!0);const d={parentId:n,parentDocType:r},u=await fetch(`${a}/dms/${t}+${s}/validate`,{method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json"}});await c.invalidate(["uda",`${t}+${s}`]),await c.invalidate(["uda"]);const m=await u.json();l(!1)}catch(d){l(!1),i(d)}},Gh=t=>Array.from(t.keys()).reduce((s,n)=>{var r,a;return{...s,[n]:(a=(r=t.get(n))==null?void 0:r.split(qh))==null?void 0:a.filter(l=>l.length)}},{}),bu=({columns:t,defaultColumns:s=[],app:n,doc_type:r,params:a,data:l,searchParams:i})=>JSON.stringify({dataRequest:{filter:Gh(i)},data:[],columns:ki([...s.map(c=>t.find(d=>d.name===c.name)).filter(c=>c),...t.filter(({name:c,shortName:d})=>!s.find(u=>u.name===c)&&l[`${d}_error`]).sort((c,d)=>l[`${d.shortName}_invalid_values`].filter(u=>u!=='"__VALID__"'&&u!=="__VALID__").length-l[`${c.shortName}_invalid_values`].filter(u=>u!=='"__VALID__"'&&u!=="__VALID__").length)],c=>c.name).map(c=>{var d,u;return{...c,show:!0,externalFilter:(u=(d=i.get(c.name))==null?void 0:d.split(qh))==null?void 0:u.filter(m=>m.length)}}),sourceInfo:{app:n,type:`${r}-${a.view_id}-invalid-entry`,doc_type:`${r}-${a.view_id}-invalid-entry`,env:`${n}+${r}-${a.view_id}-invalid-entry`,isDms:!0,originalDocType:`${r}-invalid-entry`,view_id:a.view_id,columns:t},display:{usePagination:!1,pageSize:100,loadMoreId:"id-validate-page",allowSearchParams:!0,allowDownload:!0}}),L8=async({column:t,app:s,type:n,maps:r,falcor:a,user:l,setUpdating:i,setLoadingAfterUpdate:c})=>{i(!0),await a.call(["dms","data","massedit"],[s,n,t.name,r,l.id]),await a.invalidate(["uda",`${s}+${n}`]),i(!1),c(!0)},E8=({sourceInfo:t,open:s,setOpen:n,falcor:r,columns:a,data:l,user:i,updating:c,setUpdating:d})=>{if(!s)return;const[u,m]=b.useState([]),[p,x]=b.useState(!1),h=a.find(N=>N.name===s),{app:f,type:g}=t,y=b.useMemo(()=>{var N;return((N=Ue[h.type])==null?void 0:N.EditComp)||Ue.text.EditComp},[h.type]),v=b.useMemo(()=>l[`${h.shortName}_invalid_values`],[l,h.shortName]),j=b.useMemo(()=>bs(v.map(N=>Array.isArray(N)?JSON.stringify(N):N)).filter(N=>N!=='"__VALID__"'&&N!=="__VALID__").map(N=>{const S=N&&N.startsWith("[")?JSON.parse(N):N,w=l[`${h.shortName}_invalid_values`].filter(k=>Qe(k,S)).length;return{invalidValue:S,count:w}}).sort((N,S)=>S.count-N.count),[v]);return e.jsx("div",{className:"fixed inset-0 h-full w-full z-[100] content-center",style:{backgroundColor:"#00000066"},onClick:()=>n(!1),children:e.jsxs("div",{className:"w-3/4 h-1/2 overflow-auto scrollbar-sm flex flex-col gap-[12px] p-[16px] bg-white place-self-center rounded-md",onClick:N=>N.stopPropagation(),children:[e.jsx("div",{className:"w-full flex justify-end",children:e.jsx("div",{className:"w-fit h-fit p-[8px] text-[#37576B] border border-[#E0EBF0] rounded-full cursor-pointer",onClick:()=>n(!1),children:e.jsx(Pr,{height:16,width:16})})}),e.jsx("div",{className:"text-lg",children:h.display_name||h.name}),e.jsxs("div",{className:"max-h-3/4 overflow-auto scrollbar-sm border rounded-md p-4",children:[e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx("div",{children:"Invalid Values"}),e.jsx("div",{children:"Valid Values"}),e.jsx("div",{})]}),j.map(({invalidValue:N},S)=>{var k;const w=(k=u.find($=>Qe($.invalidValue,N)))==null?void 0:k.validValue;return e.jsxs("div",{className:`group grid grid-cols-3 items-center gap-y-1 ${S%2?"bg-gray-50":""} rounded-md `,children:[e.jsxs("div",{children:[Array.isArray(N)?N.join(", "):typeof N=="object"?JSON.stringify(N):N,e.jsx("span",{className:"mx-1 px-1 py-0.5 text-sm bg-red-50 text-red-500",children:l[`${h.shortName}_invalid_values`].filter($=>Qe($,N)).length})]}),e.jsx("div",{children:e.jsx(y,{className:"px-2 py-1",value:w,options:h.options,onChange:$=>{const E=Array.isArray($)?$.map(_=>(_==null?void 0:_.value)||_):($==null?void 0:$.value)||$;if(u.find(_=>Qe(_.invalidValue,N))){const _=u.map(L=>Qe(L.invalidValue,N)?{invalidValue:N,validValue:E}:L);m(_)}else m([...u,{invalidValue:N,validValue:(E==null?void 0:E.value)||E}])}})}),e.jsx("button",{onClick:()=>m(u.filter($=>$.invalidValue!==N)),children:"reset"})]},N)})]}),e.jsx("button",{className:"px-2 py-1 bg-blue-500/15 text-blue-700 hover:bg-blue-500/25",onClick:()=>L8({column:h,app:f,type:g,maps:u,falcor:r,user:i,setUpdating:d,setLoadingAfterUpdate:x}),children:c?"updating...":p?"loading updates...":"update"})]})})},M8=({status:t,apiUpdate:s,apiLoad:n,item:r,params:a})=>{var q,Q,Y;const l=Le(),[i,c]=b.useState({}),[d,u]=b.useState({}),[m,p]=b.useState(!1),[x,h]=b.useState(!1),[f,g]=b.useState(),[y,v]=b.useState(),[j,N]=b.useState(!1),[S,w]=b.useState(""),{API_HOST:k,baseUrl:$,pageBaseUrl:E,theme:M,user:_,falcor:L}=C.useContext(Ye)||{},[D]=Rt(),A=`${k}/dama-admin`,{app:T,doc_type:O,config:B,defaultColumns:F}=r,z=(((q=JSON.parse(B||"{}"))==null?void 0:q.attributes)||[]).filter(H=>H.type!=="calculated").map((H,J)=>({...H,shortName:`col_${J}`})),P=(Q=JSON.parse(B||"{}"))==null?void 0:Q.is_dirty,[U,R]=b.useState(bu({columns:z,defaultColumns:F,app:T,doc_type:O,params:a,data:i,searchParams:D})),W={app:T,type:`${O}-${a.view_id}`,doc_type:`${O}-${a.view_id}`,env:`${r.app}+${O}-${a.view_id}`,isDms:!0,originalDocType:`${O}`,view_id:a.view_id};b.useEffect(()=>{var H;if(!a.view_id&&((H=r==null?void 0:r.views)!=null&&H.length)){const J=Math.max(...r.views.map(({id:G})=>G));l(`${E}/${a.id}/validate/${J}`)}},[r.views]),b.useEffect(()=>{if(!a.view_id||j||x)return;let H=!1;async function J(){p(!0);const G=Gh(D),se={};for(const ae of D.keys()){const{name:de,display:te,meta:re,type:ee}=gu(ae,z),xe=_8(gu(ae,z)),ke=_o(ae,!0,xe),we=S8({...{name:de,display:te,meta:re,refName:ke,type:ee},fn:void 0},!0);if(ee==="multiselect"){const be=await fr({reqName:we,refName:ke,allAttributes:[{name:de,display:te,meta:re}],apiLoad:n,format:JSON.parse(U).sourceInfo}),Me=await fr({reqName:we,refName:ke,allAttributes:[{name:de,display:te,meta:re}],apiLoad:n,format:W}),Ve=(G[ae]||[]).map(Xe=>(Xe==null?void 0:Xe.value)||Xe);if(!Ve.length)continue;try{const Xe=bs([...be,...Me]).map(yt=>{const _t=yt[we];return(Jt(_t)&&Array.isArray(JSON.parse(_t))?JSON.parse(_t):[]).find(Zr=>Ve.includes(Zr))?_t:null}).filter(yt=>yt);se[ae]=Xe}catch(Xe){console.error("Could not load options for",ae,Xe)}}}const le=Object.keys(G).filter(ae=>{var de,te;return((de=se[ae])==null?void 0:de.length)||((te=G[ae])==null?void 0:te.length)}).reduce((ae,de)=>({...ae,[`data->>'${de}'`]:se[de]||G[de]}),{}),ce=await n({format:JSON.parse(U).sourceInfo,children:[{type:()=>{},action:"udaLength",path:"/",filter:{options:JSON.stringify({filter:le}),stopFullDataLoad:!0}}]}),je=await n({format:W,children:[{type:()=>{},action:"udaLength",path:"/",filter:{options:JSON.stringify({filter:le}),stopFullDataLoad:!0}}]});u({validLength:je,invalidLength:ce});const Ce=z.reduce((ae,de)=>{var te,re;return[...ae,(["select","multiselect","radio"].includes(de.type)&&((te=de.options)==null?void 0:te.length)||de.required==="yes")&&hu(de.name,de.shortName,de.options,de.required==="yes"),(["select","multiselect","radio"].includes(de.type)&&((re=de.options)==null?void 0:re.length)||de.required==="yes")&&fu(de.name,de.shortName,de.options,de.required==="yes",de.type)]},[]).filter(ae=>ae);if(H)return;console.time("getData");const oe=await n({format:JSON.parse(U).sourceInfo,attributes:Ce,children:[{type:()=>{},action:"uda",path:"/",filter:{fromIndex:()=>0,toIndex:()=>0,options:JSON.stringify({orderBy:{1:"asc"}}),attributes:Ce,stopFullDataLoad:!0}}]});if(console.timeEnd("getData"),console.time("setData"),H)return;const ve=z.filter(ae=>{var de;return["select","multiselect","radio"].includes(ae.type)&&((de=ae.options)==null?void 0:de.length)||ae.required==="yes"}).reduce((ae,de)=>{var ee,xe,ke;const te=(xe=(ee=oe==null?void 0:oe[0])==null?void 0:ee[fu(de.name,de.shortName,de.options,de.required==="yes",de.type)])==null?void 0:xe.value,re=Array.isArray(te)?te.filter(he=>{const we=(he==null?void 0:he.value)||he;return["select","multiselect","radio"].includes(de.type)&&de.options?Array.isArray(we)?we.reduce((be,Me)=>be||!de.options.some(Ve=>((Ve==null?void 0:Ve.value)||Ve)===((Me==null?void 0:Me.value)||Me))&&Me!=='"__VALID__"'&&Me!=="__VALID__",!1):!de.options.find(be=>((be==null?void 0:be.value)||be)===we)&&we!=='"__VALID__"'&&we!=="__VALID__":he!=='"__VALID__"'&&he!=="__VALID__"}).map(he=>Array.isArray(he)?he.map(we=>(we==null?void 0:we.value)||we):(he==null?void 0:he.value)||he):te;return{...ae,[`${de.shortName}_error`]:+((ke=oe==null?void 0:oe[0])==null?void 0:ke[hu(de.name,de.shortName,de.options,de.required==="yes")]),[`${de.shortName}_invalid_values`]:re}},{});c(ve),R(bu({columns:z,defaultColumns:F,app:T,doc_type:O,params:a,data:ve,searchParams:D})),w(`${Date.now()}`),p(!1),v(void 0),console.timeEnd("setData")}return J(),()=>{H=!0}},[r,D,j,x]);const V=b.useMemo(()=>({name:"Validate",href:`${E}/${a.id}/validate`}),[P,E,a.id]);b.useMemo(()=>z.filter(H=>i[`${H.shortName}_invalid_values`]&&i[`${H.shortName}_invalid_values`].filter(J=>J!=='"__VALID__"'&&J!=="__VALID__").length).sort((H,J)=>i[`${J.shortName}_invalid_values`].filter(G=>G!=='"__VALID__"'&&G!=="__VALID__").length-i[`${H.shortName}_invalid_values`].filter(G=>G!=='"__VALID__"'&&G!=="__VALID__").length).map(H=>({column:H,invalidValues:i[`${H.shortName}_invalid_values`].filter(J=>J!=='"__VALID__"'&&J!=="__VALID__")})),[i]);const X=pe(oc);return X.controls.columns=X.controls.columns.filter(({label:H})=>H!=="duplicate"),X.controls.header={displayFn:H=>{var se,le,ce,je;const J=((se=i[`${H.shortName}_invalid_values`])==null?void 0:se.filter(Ce=>Ce!=='"__VALID__"'&&Ce!=="__VALID__"))||[],G=(je=(ce=(((le=JSON.parse(U))==null?void 0:le.columns)||[]).find(Ce=>Ce.name===H.name))==null?void 0:ce.filters)==null?void 0:je.length;return J!=null&&J.length?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"truncate select-none min-w-[15px]",title:H.customName||H.display_name||H.name,children:H.customName||H.display_name||H.name}),e.jsxs("span",{className:"flex ml-1 gap-0.5 font-light",children:[e.jsx("span",{className:"flex px-1 py-0.5 text-xs bg-red-50 text-red-500 rounded-sm",onClick:Ce=>{Ce.stopPropagation(),v(H.name)},children:J.length}),e.jsx("span",{className:"flex place-items-center px-1 py-0.5 text-sm bg-blue-50 rounded-sm",onClick:Ce=>{Ce.stopPropagation();const oe=JSON.parse(U),ve=oe.columns.findIndex(de=>de.name===H.name);if(ve===-1)return;const ae=J.reduce((de,te)=>Array.isArray(te)?[...de,...te]:[...de,te],[]).map(de=>de===null?"null":de);oe.columns[ve].filters=G?void 0:[{type:"external",operation:"filter",isMulti:!0,values:bs(ae)}],oe.dataRequest={filter:{[H.name]:bs(ae)}},R(JSON.stringify(oe)),w(`${Date.now()}`)},children:G?e.jsx(ox,{className:"text-blue-500",height:14,width:14}):e.jsx(ax,{className:"text-blue-500",height:14,width:14})})]})]}):e.jsx("span",{className:"truncate select-none",title:H.customName||H.display_name||H.name,children:H.customName||H.display_name||H.name})}},e.jsx(ks,{fullWidth:!1,baseUrl:$,pageBaseUrl:E,isListAll:!1,hideBreadcrumbs:!1,form:{name:r.name||r.doc_type,href:r.url_slug},page:V,id:a.id,view_id:a.view_id,views:r.views,showVersionSelector:!0,children:e.jsx("div",{className:`${(Y=M==null?void 0:M.page)==null?void 0:Y.wrapper1}`,children:!a.view_id||a.view_id==="undefined"?"Please select a version":e.jsx("div",{children:e.jsxs("div",{className:"flex flex-1 w-full flex-col shadow bg-white relative text-md font-light leading-7 p-4",children:[t?e.jsx("div",{children:JSON.stringify(t)}):"",e.jsxs("div",{className:"w-full max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsxs("div",{className:"flex gap-2 text-gray-500",children:[e.jsxs("div",{className:"bg-gray-100 rounded-md px-2 py-1",children:["Total Rows: ",e.jsx("span",{className:"text-gray-900",children:(d.validLength||0)+(d.invalidLength||0)})]}),e.jsxs("div",{className:"bg-gray-100 rounded-md px-2 py-1",children:["Invalid Rows: ",e.jsx("span",{className:"text-gray-900",children:d.invalidLength||0})]}),e.jsxs("div",{className:"bg-gray-100 rounded-md px-2 py-1",children:["Valid Rows: ",e.jsx("span",{className:"text-gray-900",children:d.validLength||0})]})]}),e.jsx("button",{className:`px-2 py-1 text-sm ${f?"bg-red-300 hover:bg-red-600 text-white":"bg-blue-500/15 text-blue-700 hover:bg-blue-500/25"} rounded-md`,onClick:()=>I8({app:T,type:JSON.parse(U).sourceInfo.type,parentDocType:O,dmsServerPath:A,setValidating:h,setError:g,falcor:L}),children:f?JSON.stringify(f):x?"Validating":"Re - Validate"})]}),e.jsx(E8,{open:y,setOpen:v,columns:z,apiUpdate:s,data:i,sourceInfo:JSON.parse(U).sourceInfo,falcor:L,user:_,updating:j,setUpdating:N}),z.find(H=>i[`${H.shortName}_error`])||m?e.jsxs("div",{className:"w-full flex items-center justify-between px-2 py-1 text-gray-500 bg-gray-100 rounded-md my-2",children:[m?"loading":""," Invalid Rows"]}):null,!z.find(H=>i[`${H.shortName}_error`])||m?null:e.jsx(Eo.EditComp,{component:X,value:U,onChange:H=>{R(H)},hideSourceSelector:!0,size:1,apiLoad:n,apiUpdate:s},S)]})]})})})})},yu=({children:t,remove:s,indices:n,editing:r,className:a=""})=>{const l=C.useCallback(i=>{s(...n)},[s,n]);return e.jsxs("div",{className:`
        overflow-hidden text-ellipsis whitespace-nowrap ${a}
        flex-1 flex items-center py-1 pl-2 pr-4 bg-blue-200 text-blue-600 font-light hover:bg-blue-50 mr-2 rounded-md my-1
      `,children:[e.jsx("div",{className:"flex-1",children:t}),r?e.jsx("button",{onClick:l,className:"hover:text-red-500 pl-2",children:e.jsx("span",{className:"fas fa-remove"})}):null]})},A8=()=>e.jsx("span",{className:"fas fa-caret-right mx-1"}),T8=t=>e.jsx("span",{...t,className:`
        fas fa-plus p-1 rounded cursor-pointer
        text-blue-500 hover:bg-blue-500 hover:text-white
      `}),O8=t=>{const{categories:s,parent:n,addNewCategory:r,removeCategory:a,editingCategories:l}=t,i=s.length,[c,d]=C.useState(!1),u=C.useCallback(x=>{x.stopPropagation(),d(!0)},[]),m=C.useCallback(x=>{x.stopPropagation(),d(!1)},[]),p=C.useCallback(x=>{r(x,n),d(!1)},[r,n,m]);return e.jsxs("div",{className:`flex flex-col border-current ${l?"border-b":""}`,children:[e.jsxs("div",{className:`flex ${l?"border-b":""}`,children:[e.jsx(yu,{className:"font-bold flex-1",remove:a,indices:[n,0],editing:c||l,children:s[0]}),!l||c?null:e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(T8,{onClick:u})})]}),e.jsx("div",{className:"flex ml-4",children:s.slice(1).map((x,h)=>e.jsxs(yu,{remove:a,indices:[n,h+1],editing:c||l,children:[e.jsx("span",{children:x}),h<i-2?e.jsx(A8,{}):null]},x))}),c?e.jsx(Jh,{isSub:!0,stopEditing:m,addNewCategory:p}):null]})},D8=({value:t,onChange:s,editingCategories:n,stopEditingCategories:r})=>{const a=C.useCallback((i,c=-1)=>{s(c===-1?[...t,[i]]:t.reduce((d,u,m)=>(m===c?d.push([...u,i]):d.push(u),d),[]))},[t,s]),l=C.useCallback((i,c=0)=>{if(c===0){const d=[...t];d.splice(i,1),s(d)}else t[i].splice(c,1),s(t)},[t,s]);return e.jsxs("div",{children:[t==null?void 0:t.map((i,c)=>e.jsx(O8,{categories:i,parent:c,editingCategories:n,addNewCategory:a,removeCategory:l},c)),n?e.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[e.jsx(Jh,{addNewCategory:a}),e.jsx("button",{onClick:r,themeOptions:{size:"sm",color:"cancel"},children:"Stop editing categories"})]}):null]})},B8=({onChange:t,...s})=>{const n=C.useCallback(l=>{t(l.target.value)},[t]),[r,a]=C.useState(null);return C.useEffect(()=>{r&&r.focus()},[r]),e.jsx("input",{type:"text",ref:a,...s,className:"px-2 w-full",onChange:n})},Jh=({addNewCategory:t,stopEditing:s,isSub:n=!1})=>{const[r,a]=C.useState(""),l=C.useCallback(m=>{m.stopPropagation(),t(r),a("")},[t,r]),i=C.useCallback(m=>{typeof s=="function"&&s(m),a("")},[s]),c=C.useCallback(m=>{m.key==="Enter"||m.keyCode===13?l(m):(m.key==="Escape"||m.keyCode===27)&&i(m)},[l,i]),[d,u]=C.useState(null);return e.jsx("div",{ref:u,className:"px-2 py-1 bg-gray-100 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"mb-1",children:e.jsx(B8,{type:"text",value:r,onChange:a,onKeyDown:c})}),e.jsx("div",{className:"px-2 rounded bg-gray-200 text-center",children:r?"Press Enter to save or Esc to cancel":`Start typing to add new ${n?"subcategory":"category"}`})]})})},F8=t=>{try{JSON.parse(t)}catch{return!1}return!0},vu=(t={color:"white",size:"compact"})=>{const{color:s="white",size:n="compact"}=t;let r={white:"bg-white hover:bg-blue-50",gray:"bg-gray-100 hover:bg-gray-200",transparent:"gray-100",total:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold"},a={small:"px-4 py-1 text-xs",compact:"px-4 py-1 text-sm",full:"px-10 py-5"};return{tableHeader:`${a[n]} pb-1 h-8 border border-b-4 border-gray-200 bg-slate-50 text-left font-semibold text-gray-700 uppercase first:rounded-tl-md last:rounded-tr-md`,tableInfoBar:"bg-white",tableRow:`${r[s]} transition ease-in-out duration-150 hover:bg-blue-100`,totalRow:`${r.total} transition ease-in-out duration-150`,tableOpenOutRow:"flex flex-col",tableRowStriped:"bg-white odd:bg-blue-50 hover:bg-blue-100 bg-opacity-25 transition ease-in-out duration-150",tableCell:`${a[n]} break-words border border-gray-200 pl-1 align-top font-light text-sm`,inputSmall:"w-24",sortIconDown:"fas fa-sort-amount-down text-tigGray-300 opacity-75",sortIconUp:"fas fa-sort-amount-up text-tigGray-300 opacity-75",sortIconIdeal:"fa fa-sort-alt text-tigGray-300 opacity-25",infoIcon:"fas fa-info text-sm text-blue-300 hover:text-blue-500",vars:{color:r,size:a}}},z8={root:{type:"root",format:"",indent:0,version:1,children:[{type:"paragraph",format:"",indent:0,version:1,children:[{mode:"normal",text:"No Description",type:"text",style:"",detail:0,format:0,version:1}],direction:"ltr"}],direction:"ltr"}},wu=({user:t,editing:s,setEditing:n,attr:r})=>(t==null?void 0:t.authLevel)<=5?null:e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:a=>n(s===r?null:r),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-4 p-2.5 rounded hover:bg-blue-500 hover:text-white "})}),Xh=({status:t,apiUpdate:s,attributes:n,dataItems:r,format:a,item:l,setItem:i,updateAttribute:c,params:d,submit:u,apiLoad:m})=>{const{app:p,falcor:x,falcorCache:h,baseUrl:f,pageBaseUrl:g,user:y}=b.useContext(Ye),[v,j]=b.useState(),N=b.useMemo(()=>{var A;return F8(l.config)?(A=JSON.parse(l.config))==null?void 0:A.attributes:[]},[l.config]),[S,w]=b.useState(15),k=(A,T)=>{console.log("updating data",l,T,A,a),s({data:{...l,[T]:A},config:{format:a}})},$={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},E=new Date((l==null?void 0:l.created_at)||"").toLocaleDateString(void 0,$),M=new Date((l==null?void 0:l.updated_at)||"").toLocaleDateString(void 0,$),_=b.useMemo(()=>v==="description"?n.description.EditComp:n.description.ViewComp,[v]),L=D8;console.log("props",l,f,g,d.id);const D=Ue.lexical.ViewComp;return e.jsx(ks,{fullWidth:!1,baseUrl:f,pageBaseUrl:g,isListAll:!1,hideBreadcrumbs:!1,form:{name:l.name||l.doc_type,href:a.url_slug},page:{name:"Overview",href:`${g}/${d.id}`},id:d.id,children:e.jsxs("div",{className:"p-4 bg-white flex flex-col",children:[e.jsx("div",{className:"mt-1 text-2xl text-blue-600 font-medium overflow-hidden sm:mt-0 sm:col-span-3",children:l.name||l.doc_type}),e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsxs("div",{className:"w-full md:w-[70%] pl-4 py-2 sm:pl-6 flex justify-between group text-sm text-gray-500 pr-14",children:[e.jsx(_,{value:v==="description"?l==null?void 0:l.description:(l==null?void 0:l.description)||z8,onChange:A=>{k(A,"description")},...n.description}),e.jsx(wu,{attr:"description",user:y,editing:v,setEditing:j})]}),e.jsxs("div",{className:"w-full md:w-[30%]",children:[e.jsxs("div",{className:"mt-2 flex flex-col px-6 text-sm text-gray-600",children:["Created",e.jsx("span",{className:"text-l font-medium text-blue-600 ",children:E})]}),e.jsxs("div",{className:"mt-2 flex flex-col px-6 text-sm text-gray-600",children:["Updated",e.jsx("span",{className:"text-l font-medium text-blue-600 ",children:M})]}),e.jsxs("div",{className:"flex justify-between group",children:[e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-2 sm:gap-1 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 mt-1.5",children:"Categories"}),e.jsx("dd",{className:"text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.jsx("div",{className:"pb-2 px-2 relative",children:e.jsx(L,{value:Array.isArray(l==null?void 0:l.categories)?l==null?void 0:l.categories:[],onChange:A=>{k(A,"categories")},editingCategories:v==="categories",stopEditingCategories:()=>j(null),...n.categories})})})]}),e.jsx(wu,{attr:"categories",user:y,editing:v,setEditing:j})]},"categories")]})]}),e.jsxs("div",{className:"flex items-center p-2 mx-4 text-blue-600 hover:bg-blue-50 rounded-md",children:["Columns",e.jsx("span",{className:"bg-blue-200 text-blue-600 text-xs p-1 ml-2 shrink-0 grow-0 rounded-lg flex items-center justify-center border border-blue-300",children:N.length})]}),e.jsxs("div",{className:"w-full p-4",children:[e.jsx(si,{columns:["column","description"].map(A=>({Header:A,accessor:A,align:"left",width:A==="column"?"30%":"70%",minWidth:A==="column"?"30%":"70%",maxWidth:A==="column"?"30%":"70%"})),data:N.map(A=>({column:e.jsxs("div",{className:"pr-8 font-bold",children:[ne(A,"display_name",ne(A,"name"))||"No Name",e.jsxs("span",{className:"italic pl-1 pt-3 pr-8 font-light",children:["(",ne(A,"type"),")"]})]}),description:ne(A,["description","root"])?e.jsx(D,{value:ne(A,"description")}):e.jsx("div",{className:"pl-6",children:JSON.stringify(ne(A,"description"))||"No Description"})})),pageSize:S,striped:!0,theme:vu()}),N.length>15?e.jsx("div",{className:"float-right text-blue-600 underline text-sm cursor-pointer",onClick:()=>w(S===15?N.length:15),children:S>15?"see less":"see more"}):null]}),e.jsx("div",{className:"w-full p-4",children:e.jsx(si,{columns:["name","created_at","updated_at"].map(A=>({Header:A.replace("_"," "),accessor:A,align:"left",width:A==="name"?"50%":"25%",minWidth:A==="name"?"50%":"25%",maxWidth:A==="name"?"50%":"25%"})),data:((l==null?void 0:l.views)||[]).map(({id:A,name:T,created_at:O,updated_at:B})=>({name:e.jsx("div",{className:"",children:e.jsx(ue,{to:`${g}/${d.id}/view/${A}`,children:T||"No Name"})}),created_at:new Date(O.replace(/"/g,"")).toLocaleString(),updated_at:new Date(B.replace(/"/g,"")).toLocaleString()})),pageSize:5,striped:!0,sortBy:"created_at",sortOrder:"desc",theme:vu()})})]})})};Xh.settings={hasControls:!0,name:"ElementEdit"};const P8={EditComp:Xh},R8=({apiUpdate:t,apiLoad:s,format:n,item:r,params:a})=>{var y,v,j,N,S;const{baseUrl:l,pageBaseUrl:i,theme:c,user:d}=b.useContext(Ye)||{},u=Le(),m=((y=JSON.parse((r==null?void 0:r.config)||"{}"))==null?void 0:y.attributes)||[],p=r.defaultColumns,[x,h]=b.useState(JSON.stringify({dataRequest:{},data:[],sourceInfo:{app:r.app,type:`${r.doc_type}-${a.view_id}`,env:`${r.app}+${r.doc_type}`,doc_type:`${r.doc_type}-${a.view_id}`,isDms:!0,originalDocType:r.doc_type,view_id:a.view_id,columns:m},display:{usePagination:!1,pageSize:1e3,loadMoreId:"id-table-page",allowSearchParams:!1,allowDownload:!0},columns:p!=null&&p.length?ki(p.map(w=>m.find(k=>k.name===w.name)).filter(w=>w).map(w=>({...w,show:!0})),w=>w==null?void 0:w.name):m.slice(0,3).map(w=>({...w,show:!0}))})),f=b.useCallback(()=>{var k;const w=(((k=JSON.parse(x))==null?void 0:k.columns)||[]).filter(({show:$})=>$).map($=>({...$,filters:void 0,group:void 0}));t({data:{...r,defaultColumns:w},config:{format:n}})},[x]);b.useEffect(()=>{var w;if(!a.view_id&&((w=r==null?void 0:r.views)!=null&&w.length)){const k=Math.max(...r.views.map(({id:$})=>$));u(`${i}/${a.id}/table/${k}`)}},[r.views]);const g=pe(oc);return g.controls.columns=g.controls.columns.filter(({label:w})=>w!=="duplicate"),e.jsx(ks,{fullWidth:!1,baseUrl:l,pageBaseUrl:i,isListAll:!1,hideBreadcrumbs:!1,form:{name:r.name||r.doc_type,href:n.url_slug},page:{name:"Table",href:`${i}/${a.id}/table`},id:a.id,view_id:a.view_id,views:r.views,showVersionSelector:!0,children:!r.config||!((N=(j=(v=JSON.parse(x))==null?void 0:v.sourceInfo)==null?void 0:j.columns)!=null&&N.length)?e.jsx("div",{className:"p-1 text-center",children:"Please setup metadata."}):!a.view_id||a.view_id==="undefined"?"Please select a version":e.jsxs("div",{className:`${(S=c==null?void 0:c.page)==null?void 0:S.wrapper1}`,children:[d.authLevel>=10?e.jsx("button",{className:"w-fit p-1 bg-blue-100 hover:bg-blue-200 text-blue-500 text-sm place-self-end rounded-md",onClick:f,children:"Set Default Columns"}):null,e.jsx(Eo.EditComp,{component:g,value:x,onChange:w=>{h(w)},size:1,hideSourceSelector:!0,apiLoad:s,apiUpdate:t},"table-page-spreadsheet")]})})},H8=({status:t,apiUpdate:s,apiLoad:n,attributes:r={},dataItems:a,format:l,item:i,setItem:c,updateAttribute:d,params:u,submit:m,manageTemplates:p=!1})=>{var j;const{API_HOST:x,baseUrl:h,pageBaseUrl:f,theme:g,user:y,...v}=C.useContext(Ye)||{};return e.jsx(ks,{fullWidth:!1,baseUrl:h,pageBaseUrl:f,isListAll:!1,hideBreadcrumbs:!1,form:{name:i.name||i.doc_type,href:l.url_slug},page:{name:"Upload",href:`${f}/${u.id}/upload`},id:u.id,view_id:u.view_id,views:i.views,showVersionSelector:!0,children:e.jsx("div",{className:`${(j=g==null?void 0:g.page)==null?void 0:j.wrapper1}`,children:!u.view_id||u.view_id==="undefined"?"Please select a version":e.jsx(tf.EditComp,{onChange:()=>{},size:1,format:{app:i.app,type:`${i.doc_type}-${u.view_id}`,config:i.config},view_id:u.view_id,parent:i,apiLoad:n,apiUpdate:s,context:Ye})})})},W8=({status:t,apiUpdate:s,attributes:n,dataItems:r,format:a,item:l,setItem:i,updateAttribute:c,params:d,submit:u,manageTemplates:m=!1,apiLoad:p,...x})=>{var j;const{baseUrl:h,pageBaseUrl:f,theme:g,user:y}=C.useContext(Ye)||{},v=(N,S)=>{s({data:{...l,[S]:N},config:{format:a}})};return console.log("manage forms /manage_pattern/:id/templates?",m,n),e.jsx(ks,{fullWidth:!1,baseUrl:h,pageBaseUrl:f,isListAll:!1,hideBreadcrumbs:!1,form:{name:l.name||l.doc_type,href:a.url_slug},page:{name:"Metadata",href:`${f}/${d.id}`},id:d.id,children:e.jsx("div",{className:`${(j=g==null?void 0:g.page)==null?void 0:j.wrapper1}`,children:e.jsxs("div",{className:"overflow-auto flex flex-1 w-full flex-col shadow bg-white relative text-md font-light leading-7 p-4",children:[t?e.jsx("div",{children:JSON.stringify(t)}):"",e.jsx("div",{className:"w-full max-w-6xl mx-auto",children:Object.keys(n).filter(N=>N==="config").map((N,S)=>{let w=n[N].EditComp;return e.jsx("div",{children:e.jsx(w,{value:l==null?void 0:l[N],onChange:k=>{v(k,N)},manageTemplates:m,placeholder:n[N].placeholder,options:n[N].options,item:l,apiLoad:p,...n[N],format:a})},`${N}-${S}`)})})]})})})},V8={EditComp:W8},U8=t=>{var s,n;return(n=(s=q8(t)?JSON.parse(t):t)==null?void 0:s.root)!=null&&n.children?t:{root:{children:[{children:[{detail:0,format:0,mode:"normal",text:t||"No Description",type:"text",version:1},{detail:0,format:0,mode:"normal",text:`

`,type:"text",version:1}],tag:"",direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}}},q8=t=>{try{JSON.parse(t)}catch{return!1}return!0},G8=async({format:t,apiLoad:s,parent:n})=>{var d;const r=(n==null?void 0:n.sources)||[];if(!r.length)return;const a=r.map(u=>+u.id),l=(((d=r[0])==null?void 0:d.ref)||"").split("+"),i=[{type:()=>{},action:"list",path:"/",filter:{options:JSON.stringify({filter:{id:a}})}}],c=await s({app:t.app,type:l[1],format:{...t,type:l[1]},attributes:["data"],children:i},"/");return console.log("data",c),c},J8=({source:t})=>{const s=Ue.lexical.ViewComp;return e.jsx("div",{className:"w-full p-4 bg-white hover:bg-blue-50 block border shadow flex",children:e.jsxs("div",{children:[e.jsx(ue,{to:`source/${t.id}`,className:"text-xl font-medium w-full block",children:e.jsx("span",{children:(t==null?void 0:t.name)||(t==null?void 0:t.doc_type)})}),e.jsx("div",{children:(ne(t,["data","value","categories"],[])||[]).map(n=>(typeof n=="string"?[n]:n).map((r,a)=>e.jsx(ue,{to:`?cat=${a>0?n[a-1]+"/":""}${r}`,className:"text-xs p-1 px-2 bg-blue-200 text-blue-600 mr-2",children:r},a)))}),e.jsx(ue,{to:`source/${t.id}`,className:"py-2 block",children:e.jsx(s,{value:U8(t==null?void 0:t.description)})})]})})},X8=({isAdding:t,setIsAdding:s,updateData:n,sources:r=[],setSources:a,submit:l})=>{const[i,c]=b.useState({name:""});return console.log("sources",r,i),e.jsxs(a8,{open:t,setOpen:s,className:"w-full p-4 bg-white hover:bg-blue-50 block border shadow flex items-center",children:[e.jsxs("select",{className:"w-full p-1 rounded-md border bg-white",value:i.id,onChange:d=>{const u=r.find(m=>m.id===d.target.value);if(u){const m=r.filter(x=>x.doc_type.includes(`${u.doc_type}_copy_`)).length,p=pe(u);p.name=`${p.name} copy (${m+1})`,c(p)}else c({name:""})},children:[e.jsx("option",{value:void 0,children:"Create new"},"create-new"),(r||[]).map(d=>e.jsxs("option",{value:d.id,children:[d.name," (",d.doc_type,")"]},d.id))]}),e.jsx("input",{className:"p-1 mx-1 text-sm font-light w-full block",value:i.name,placeholder:"Name",onChange:d=>c({...i,name:d.target.value})},"new-form-name"),e.jsx("button",{className:"p-1 mx-1 bg-blue-300 hover:bg-blue-500 text-white",disabled:!i.name,onClick:async()=>{const d=pe(i);delete d.id,delete d.views,d.doc_type=tn(),await n({sources:[...r||[],d]}),window.location.reload()},children:"add"}),e.jsx("button",{className:"p-1 mx-1 bg-red-300 hover:bg-red-500 text-white",onClick:()=>{c({name:""}),s(!1)},children:"cancel"})]})},Zh=({attributes:t,item:s,dataItems:n,apiLoad:r,apiUpdate:a,updateAttribute:l,format:i,submit:c,...d})=>{const{baseUrl:u,user:m,parent:p}=b.useContext(Ye),[x,h]=b.useState([]),[f,g]=b.useState(""),{...y}=Be(),[v,j]=Rt(),[N,S]=b.useState("asc"),[w,k]=b.useState(!1),$="bg-transparent hover:bg-blue-100 rounded-sm p-2 ml-0.5 border-2",E=[],M=v.get("cat"),_=void 0;console.log("??????????????????",s,p,x);const L=T=>(console.log("updating data",p,T,i),a({data:{...p,...T},config:{format:i}}));b.useEffect(()=>{G8({format:i,apiLoad:r,parent:p}).then(T=>h(T))},[i,p==null?void 0:p.sources]);const D=[...new Set((x||[]).filter(T=>{var O;return!((O=T==null?void 0:T.categories)!=null&&O.find(B=>E.find(F=>B.includes(F))))}).reduce((T,O)=>{var B;return[...T,...((B=O==null?void 0:O.categories)==null?void 0:B.map(F=>F[0]))||[]]},[]))].sort(),A=D.reduce((T,O)=>{var B;return T[O]=(B=(x||[]).filter(F=>F==null?void 0:F.categories).filter(F=>{var z;return(z=Array.isArray(F==null?void 0:F.categories)?F==null?void 0:F.categories:[F==null?void 0:F.categories])==null?void 0:z.find(P=>P.includes(O))}))==null?void 0:B.length,T},{});return e.jsxs(ks,{fullWidth:!0,isListAll:!1,hideBreadcrumbs:!1,hideNav:!0,baseUrl:`${u}/${y["*"]}`,page:M?{name:M,href:`?cat=${M}`}:{},children:[e.jsxs("div",{className:"flex flex-rows items-center",children:[e.jsx("input",{className:"w-full text-lg p-2 border border-gray-300 ",placeholder:"Search datasources",value:f,onChange:T=>g(T.target.value)}),e.jsx("button",{className:$,title:"Toggle Sort",onClick:()=>S(N==="asc"?"desc":"asc"),children:e.jsx("i",{className:`fa-solid ${N==="asc"?"fa-arrow-down-z-a":"fa-arrow-down-a-z"} text-xl text-blue-400`})}),(m==null?void 0:m.authed)&&m.authLevel===10&&e.jsx("button",{className:$,title:"Add",onClick:()=>k(!w),children:e.jsx("i",{className:"fa-solid fa-add text-xl text-blue-400"})})]}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx("div",{className:"w-1/4 flex flex-col space-y-1.5 max-h-[80dvh] overflow-auto scrollbar-sm",children:(D||[]).sort((T,O)=>T.localeCompare(O)).map(T=>e.jsxs(ue,{className:`${M===T||_===T?"bg-blue-100":"bg-white"} hover:bg-blue-50 p-2 rounded-md flex items-center`,to:`?cat=${T}`,children:[e.jsx("i",{className:"fa fa-category"})," ",T,e.jsx("div",{className:"bg-blue-200 text-blue-600 text-xs w-5 h-5 ml-2 shrink-0 grow-0 rounded-lg flex items-center justify-center border border-blue-300",children:A[T]})]},T))}),e.jsxs("div",{className:"w-3/4 flex flex-col space-y-1.5 ml-1.5 max-h-[80dvh] overflow-auto scrollbar-sm",children:[e.jsx(X8,{sources:x,setSources:h,updateData:L,isAdding:w,setIsAdding:k,submit:c}),(x||[]).filter(T=>{var O;return!((O=T==null?void 0:T.categories)!=null&&O.find(B=>E.find(F=>B.includes(F))))}).filter(T=>{let O=!0;return M&&(O=!1,(ne(T,["data","value","categories"],[])||[]).forEach(B=>{B[0]===M&&(O=!0)})),O}).filter(T=>{let O=((T==null?void 0:T.name)||(T==null?void 0:T.doc_type))+" "+((Array.isArray(T==null?void 0:T.categories)?T==null?void 0:T.categories:[T==null?void 0:T.categories])||[]).reduce((B,F)=>(B+=Array.isArray(F)?F.join(" "):typeof F=="string"?F:"",B),"");return!f.length>2||O.toLowerCase().includes(f.toLowerCase())}).sort((T,O)=>{var F;return(N==="asc"?1:-1)*((F=T==null?void 0:T.doc_type)==null?void 0:F.localeCompare(O==null?void 0:O.doc_type))}).map((T,O)=>e.jsx(J8,{source:T,baseUrl:u},O))]})]})]})};Zh.settings={hasControls:!0,name:"ElementEdit"};const Z8={EditComp:Zh},Yh="p-2 mx-1 bg-red-500 hover:bg-red-700 text-white rounded-md",ju="p-2 mx-1 bg-green-500 hover:bg-green-700 text-white rounded-md",Y8=({parent:t,item:s,apiUpdate:n,baseUrl:r})=>{const[a,l]=b.useState(!1);Le();const i=async()=>{const c=t.ref.split("+")[1];if(!c)return;const d={format:{app:t.app,type:c}},u=pe(t);u.sources=u.sources.filter(m=>m.id!==s.id),console.log("parent",d,u,s),await n({data:u,config:d}),window.location.assign(r)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:Yh,onClick:()=>l(!0),children:"Delete Source"}),e.jsx(Wr,{title:"Delete Source",open:a,prompt:`Are you sure you want to delete this source? All of the source data will be permanently removed
                                            from our servers forever. This action cannot be undone.`,setOpen:c=>l(c),onDelete:()=>{async function c(){await i(),l(!1)}c()}})]})},Q8=({item:t,format:s,apiLoad:n,apiUpdate:r})=>{var m;const[a,l]=b.useState(!1),[i,c]=b.useState("");Le();const d=`version ${(((m=t==null?void 0:t.views)==null?void 0:m.length)||0)+1}`,u=async()=>{const p={format:s},x=pe(t);x.views=[...x.views||[],{name:i||d}];const h=await r({data:x,config:p});console.log("res",h)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{disabled:!t.id,className:ju,onClick:()=>l(!0),children:"Add Version"}),e.jsxs(Vr,{open:a,setOpen:p=>l(p),children:[e.jsx("input",{placeholder:d,value:i,onChange:p=>c(p.target.value)},"view-name"),e.jsx("button",{className:ju,onClick:()=>{async function p(){await u(),l(!1)}p()},children:"add"})]})]})},K8=({app:t,type:s,apiLoad:n,apiUpdate:r})=>{const[a,l]=b.useState(!1),i=async()=>{const c=["id"],u={format:{app:t,type:s,attributes:c},children:[{type:()=>{},action:"load",filter:{options:JSON.stringify({}),attributes:c},path:"/"}]},m=await n(u);if(!(m!=null&&m.length))return;const p=m.map(x=>x.id).filter(x=>x);p!=null&&p.length&&await r({data:{id:p},config:u,requestType:"delete"})};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:Yh,onClick:()=>l(!0),children:"Clear Data"}),e.jsx(Wr,{title:"Clear Uploaded Data",open:a,prompt:"Are you sure you want to clear all uploaded data for this source? This action cannot be undone.",setOpen:c=>l(c),onDelete:()=>{async function c(){await i(),l(!1)}c()}})]})},e9=({status:t,apiUpdate:s,apiLoad:n,attributes:r={},dataItems:a,format:l,item:i,setItem:c,updateAttribute:d,params:u,submit:m,manageTemplates:p=!1,...x})=>{var w;const{app:h,API_HOST:f,baseUrl:g,pageBaseUrl:y,theme:v,user:j,parent:N,...S}=C.useContext(Ye)||{};return e.jsx(ks,{fullWidth:!1,baseUrl:g,pageBaseUrl:y,isListAll:!1,hideBreadcrumbs:!1,form:{name:i.name||i.doc_type,href:l.url_slug},page:{name:"Admin",href:`${y}/${u.id}/admin`},id:u.id,children:e.jsx("div",{className:`${(w=v==null?void 0:v.page)==null?void 0:w.wrapper1}`,children:e.jsxs("div",{className:"w-full p-2 bg-white flex",children:[e.jsx(Q8,{item:i,format:l,apiLoad:n,apiUpdate:s}),e.jsx(K8,{app:h,type:i.doc_type,apiLoad:n,apiUpdate:s}),e.jsx(Y8,{parent:N,item:i,apiUpdate:s,baseUrl:g})]})})})},Qh="w-full p-2 mx-1 bg-red-300 hover:bg-red-500 text-gray-800 rounded-md",t9=({item:t,view_id:s,format:n,url:r,apiUpdate:a,baseUrl:l})=>{const[i,c]=b.useState(!1),d=Le(),u=async()=>{const m={format:n},p=pe(t);p.views=p.views.filter(x=>x.id!==s),console.log("parent",m,p,t),await a({data:p,config:m}),d(r)};return e.jsxs("div",{className:"w-full",children:[e.jsx("button",{className:Qh,onClick:()=>c(!0),children:"Delete Version"}),e.jsx(Wr,{title:"Delete View",open:i,prompt:`Are you sure you want to delete this version? All of the version data will be permanently removed
                                            from our servers forever. This action cannot be undone.`,setOpen:m=>c(m),onDelete:()=>{async function m(){await u(),c(!1)}m()}})]})},s9=({app:t,type:s,view_id:n,apiLoad:r,apiUpdate:a})=>{const[l,i]=b.useState(!1),c=async()=>{const d=["id"],u="load",m={format:{app:t,type:`${s}-${n}`,attributes:d},children:[{type:()=>{},action:u,filter:{options:JSON.stringify({}),attributes:d},path:"/"}]},p={format:{app:t,type:`${s}-${n}-invalid-entry`,attributes:d},children:[{type:()=>{},action:u,filter:{options:JSON.stringify({}),attributes:d},path:"/"}]},x=await r(m),h=await r(p);if(!(x!=null&&x.length)&&!(h!=null&&h.length))return;const f=[...x,...h].map(g=>g.id).filter(g=>g);f!=null&&f.length&&await a({data:{id:f},config:m,requestType:"delete"})};return e.jsxs("div",{className:"w-full",children:[e.jsx("button",{className:Qh,onClick:()=>i(!0),children:"Clear Data"}),e.jsx(Wr,{title:"Clear Uploaded Data",open:l,prompt:"Are you sure you want to clear all uploaded data for this version? This action cannot be undone.",setOpen:d=>i(d),onDelete:()=>{async function d(){await c(),i(!1)}d()}})]})},n9=({status:t,apiUpdate:s,apiLoad:n,attributes:r={},dataItems:a,format:l,item:i,setItem:c,updateAttribute:d,params:u,submit:m,manageTemplates:p=!1,...x})=>{var $;const{API_HOST:h,baseUrl:f,pageBaseUrl:g,theme:y,user:v,parent:j}=C.useContext(Ye)||{},{app:N,type:S,config:w}=j,k=((i==null?void 0:i.views)||[]).find(E=>E.id===u.view_id);return e.jsx(ks,{fullWidth:!1,baseUrl:f,pageBaseUrl:g,isListAll:!1,hideBreadcrumbs:!1,form:{name:i.name||i.doc_type,href:l.url_slug},page:{name:"Version",href:`${g}/${u.id}/view/${u.view_id}`},id:u.id,view_id:u.view_id,views:i.views,showVersionSelector:!0,children:e.jsx("div",{className:`${($=y==null?void 0:y.page)==null?void 0:$.wrapper1}`,children:e.jsx("div",{className:"w-full p-2 bg-white flex",children:e.jsxs("div",{className:"w-full flex flex-col justify-between",children:[e.jsxs("div",{className:"w-full text-lg text-gray-500 border-b",children:[i==null?void 0:i.name," - ",(k==null?void 0:k.name)||(k==null?void 0:k.id)]}),e.jsxs("div",{className:"w-fit flex flex-col gap-1 text-center self-end",children:[["created_at","updated_at"].map(E=>e.jsxs("div",{className:"",children:[e.jsx("div",{className:"text-sm text-gray-500 capitalize",children:E.replace("_"," ")}),e.jsx("div",{className:"text-blue-500",children:k==null?void 0:k[E]})]})),e.jsx(s9,{app:N,type:i.doc_type,view_id:u.view_id,apiLoad:n,apiUpdate:s}),e.jsx(t9,{item:i,format:l,view_id:u.view_id,url:`${g}/${u.id}`,apiUpdate:s,baseUrl:f})]})]})})})})},Ye=C.createContext(void 0),Kh={email:"user",authLevel:10,authed:!0,fake:!0},r9=({app:t,type:s,siteType:n,adminPath:r,title:a,baseUrl:l,damaBaseUrl:i,Menu:c=Wh,API_HOST:d="https://graph.availabs.org",columns:u,logo:m,pattern:p,themes:x={default:{}},checkAuth:h=()=>{}})=>{let f=Ze(pe(Hh),pe(x[p==null?void 0:p.theme_name]||x.default));l=l==="/"?"":l;const g=e.jsx(ue,{to:l||"/",className:"h-12 flex px-4 items-center",children:e.jsx("div",{className:"rounded-full h-8 w-8 bg-blue-500 border-2 border-blue-300 hover:bg-blue-600"})});f.navOptions.logo||(f.navOptions.logo=m||g);const y=pe(J6);return y.app=t,y.type=s,y.registerFormats=Do(y.registerFormats,t,s),y.attributes=dc(y.attributes,t,s),{siteType:n,format:y,baseUrl:`${l}`,API_HOST:d,children:[{type:v=>e.jsx(Ye.Provider,{value:{baseUrl:`${l}`,damaBaseUrl:i,user:v.user||Kh,theme:f,app:t,type:s,parent:p,Menu:c,API_HOST:d},children:v.children}),action:"list",filter:{stopFullDataLoad:!0,fromIndex:()=>0,toIndex:()=>0},path:"/*",children:[{type:v=>{var j,N;return e.jsx(Oo,{secondNav:((N=(j=f==null?void 0:f.navOptions)==null?void 0:j.secondaryNav)==null?void 0:N.navItems)||[],children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(Z8.EditComp,{...v})})})},path:"",action:"edit"},{type:h8,path:"manage/*",action:"list",filter:{options:JSON.stringify({filter:{"data->>'hide_in_nav'":["null"]}}),attributes:["title","index","url_slug","parent","published","hide_in_nav"]},children:[{type:f8,path:"manage/",action:"edit"},{type:v=>e.jsx(C8,{themes:x,...v}),path:"manage/design",action:"edit"}]}]}]}},a9=({app:t,type:s,siteType:n,adminPath:r,title:a,baseUrl:l,damaBaseUrl:i,Menu:c=Wh,API_HOST:d="https://graph.availabs.org",columns:u,logo:m,pattern:p,pgEnv:x,themes:h={default:{}},checkAuth:f=()=>{}})=>{let g=Ze(pe(Hh),pe(h[p==null?void 0:p.theme_name]||h.default));l=l==="/"?"":l;const y=e.jsx(ue,{to:l||"/",className:"h-12 flex px-4 items-center",children:e.jsx("div",{className:"rounded-full h-8 w-8 bg-blue-500 border-2 border-blue-300 hover:bg-blue-600"})});g.navOptions.logo||(g.navOptions.logo=m||y);const v=pe(Rh),j=`${s}|source`;return v.app=t,v.type=j,v.registerFormats=Do(v.registerFormats,t,j),v.attributes=dc(v.attributes,t,j),{siteType:n,format:v,baseUrl:`${l}/source`,API_HOST:d,children:[{type:N=>{const{falcor:S,falcorCache:w}=Gt.useFalcor();return e.jsx(Ye.Provider,{value:{baseUrl:`${l}`,pageBaseUrl:`${l}/source`,damaBaseUrl:i,user:N.user||Kh,pgEnv:x,theme:g,app:t,type:s,parent:p,Menu:c,API_HOST:d,falcor:S,falcorCache:w},children:e.jsx(Oo,{children:N.children})})},action:"list",filter:{stopFullDataLoad:!0,fromIndex:()=>0,toIndex:()=>0},path:"/*",authLevel:5,children:[{type:N=>e.jsx(P8.EditComp,{...N}),filter:{stopFullDataLoad:!0,fromIndex:()=>0,toIndex:()=>0},action:"edit",path:":id"},{type:N=>e.jsx(V8.EditComp,{...N}),filter:{stopFullDataLoad:!0,fromIndex:()=>0,toIndex:()=>0},action:"edit",path:":id/metadata"},{type:N=>e.jsx(e9,{...N}),filter:{stopFullDataLoad:!0,fromIndex:()=>0,toIndex:()=>0},action:"edit",path:":id/admin"},{type:N=>e.jsx(R8,{...N}),filter:{stopFullDataLoad:!0,fromIndex:()=>0,toIndex:()=>0},action:"edit",path:":id/table/:view_id?"},{type:N=>e.jsx(H8,{...N}),filter:{stopFullDataLoad:!0,fromIndex:()=>0,toIndex:()=>0},action:"edit",path:":id/upload/:view_id?"},{type:N=>e.jsx(M8,{...N}),filter:{stopFullDataLoad:!0,fromIndex:()=>0,toIndex:()=>0},action:"edit",path:":id/validate/:view_id?"},{type:N=>e.jsx(n9,{...N}),filter:{stopFullDataLoad:!0,fromIndex:()=>0,toIndex:()=>0},action:"edit",path:":id/view/:view_id?"}]}]}},o9=[r9,a9],Do=(t,s,n)=>(Array.isArray(t)&&(t=t.map(r=>{const a=`${n}|${r.type}`;return r.app=s,r.type=a,r.registerFormats=Do(r.registerFormats,s,a),r.attributes=dc(r.attributes,s,a),r})),t),dc=(t,s,n)=>(Array.isArray(t)&&(t=t.map(r=>(r.format=r.format?`${s}+${n}|${r.format.split("+")[1]}`:void 0,Do(r,s,n)))),t),oa=t=>{t.preventDefault(),t.stopPropagation()};function l9(t){return new Promise(s=>setTimeout(s,t))}const Cu=async({file:t,user:s,etlContextId:n,pgEnv:r,falcor:a,damaServerPath:l,setGisUploadId:i,setLoading:c,setLayers:d,setLayerName:u})=>{const m=async()=>{const p=["dama",r,"etlContexts",n,"allEvents","length"],x=["dama",r,"etlContexts",n,"allEvents"],h=["event_id","etl_context_id","type","payload","user"];a.invalidate(p),a.invalidate(x);const f=await a.get(p),g=ne(f,["json",...p]);if(!g)return;const y=await a.get([...x,{from:0,to:g-1},h]),v=ne(y,["json",...x],{});if(!Object.values(v).some(S=>S.type&&S.type.toLowerCase().includes(":final")))return await l9(2e3),m()};try{c(!0);const p=new FormData;p.append("etlContextId",n),p.append("user_id",s.userId),p.append("email",s.email),p.append("fileSizeBytes",t.size),p.append("file",t);const h=await(await fetch(`${l}/gis-dataset/upload`,{method:"POST",body:p})).json();if(Array.isArray(h)){const[{id:f}]=h;if(f){await m();try{(async y=>{var S;c(!0);const v=`${l}/gis-dataset/${y}/layers`,N=await(await fetch(v)).json();d(N),u((S=N==null?void 0:N[0])==null?void 0:S.layerName),i(f),c(!1)})(f)}catch(g){console.error(g)}}c(!1)}else throw c(!1),h}catch(p){c(!1),console.error(p==null?void 0:p.message)}},i9=async({userId:t,email:s,gisUploadId:n,layerName:r,app:a,type:l,dmsServerPath:i,setPublishing:c,setPublishStatus:d,updateMetaData:u,existingAttributes:m=[],columns:p=[]})=>{const x={user_id:t,email:s,gisUploadId:n,layerName:r,columns:p};c(!0);const h=p.filter(g=>!m.find(y=>y.display_name===g.display_name||y.name===g.name));h.length&&u(JSON.stringify({attributes:[...m,...h]}),"config"),await(await fetch(`${i}/dms/${a}+${l}/publish`,{method:"POST",body:JSON.stringify(x),headers:{"Content-Type":"application/json"}})).json(),c(!1),d(!0)},ef=({value:t,onChange:s,size:n,format:r,view_id:a,apiLoad:l,apiUpdate:i,parent:c,updateMeta:d=!0,context:u,...m})=>{var V,X;const{API_HOST:p,user:x,falcor:h,pgEnv:f}=b.useContext(u),g=`${p}/dama-admin/${f}`,y=`${p}/dama-admin`,[v,j]=b.useState(!1),[N,S]=b.useState(!1),[w,k]=b.useState(!1),[$,E]=b.useState(""),[M,_]=b.useState(),[L,D]=b.useState(),[A,T]=b.useState([]),[O,B]=b.useState(""),F="p-1.5 hover:bg-blue-100 rounded-sm",z=((V=JSON.parse(r.config||"{}"))==null?void 0:V.attributes)||[],[P,U]=b.useState([]),R=(q,Q)=>{var Y;d&&i({data:{...c,[Q]:q},config:{format:r,type:(Y=r==null?void 0:r.type)==null?void 0:Y.replace(`-${a}`,"")}})};b.useEffect(()=>{async function q(){const Y=+await(await fetch(`${g}/etl/new-context-id`)).text();_(Y)}q()},[f]),b.useEffect(()=>{var q,Q;(q=A.find(Y=>Y.layerName===O))!=null&&q.fieldsMetadata&&U((Q=A.find(Y=>Y.layerName===O))==null?void 0:Q.fieldsMetadata.map(({name:Y,display_name:H},J)=>{const G=z.find(se=>se.display_name===H||se.name===Y);return{name:Y||`col_${J+1}`,display_name:H||Y||`col_${J+1}`,existingColumnMatch:G==null?void 0:G.name,options:["select","multiselect"].includes(G==null?void 0:G.type)?G.options:null,type:["select","multiselect"].includes(G==null?void 0:G.type)?G==null?void 0:G.type:"text",required:(G==null?void 0:G.required)==="yes"}}))},[A,O]);const W=z.filter(q=>P.filter(Q=>Q.existingColumnMatch===q.name).length>1);return a?w?e.jsx("div",{className:"flex items-center justify-center w-full h-[150px] border rounded-md",children:"The Sheet has been Processed. Please validate your records."}):L?e.jsxs("div",{className:"w-full border p-2 rounded-md",children:[e.jsxs("div",{className:"w-full pb-4",children:[e.jsx("label",{htmlFor:"layer-selector",children:"Sheet to upload:"}),e.jsxs("select",{id:"layer-selector",className:"p-2 ml-4 bg-transparent border rounded-md hover:cursor-pointer",value:O,onChange:q=>B(q.target.value),children:[e.jsx("option",{value:void 0,children:"Please select..."},"default"),(A||[]).map(({layerName:q})=>e.jsx("option",{value:q,children:q},q))]})]}),W.length?e.jsxs("div",{className:"p-2 border border-blue-300 rounded-md",children:[e.jsxs("div",{className:"flex items-center text-blue-500 font-semibold",children:["Pivot Columns",e.jsx(sx,{className:"ml-1 text-blue-500 hover:text-blue-300 cursor-pointer",height:18,width:18,title:"These column headers will become values for the Destination column if there exists a value for a given row in the data."})]}),e.jsxs("div",{className:"grid grid-cols-2",style:{gridTemplateColumns:"1fr 2fr"},children:[e.jsx("div",{children:"Destination Column"}),e.jsx("div",{children:"Source Columns"})]}),W.map(q=>e.jsxs("div",{className:"grid grid-cols-2",style:{gridTemplateColumns:"1fr 2fr"},children:[e.jsx("div",{children:q.display_name||q.name}),e.jsx("div",{children:P.filter(Q=>Q.existingColumnMatch===q.name).map(Q=>Q.display_name||Q.name).join(", ")})]},q.name))]}):null,e.jsxs("div",{className:"w-full pb-4 text-red-500",children:[e.jsxs("label",{htmlFor:"layer-selector",children:["Primary Column ",e.jsx("span",{className:"text-xs italic",children:"(If selected, existing records will be updated for matching column values)"}),":"]}),e.jsxs("select",{id:"primary-col-selector",className:"p-2 ml-4 bg-transparent border rounded-md hover:cursor-pointer border-red-500",value:(X=P.find(q=>q.isPrimary))==null?void 0:X.name,onChange:q=>U(P.map(Q=>Q.name===q.target.value?{...Q,isPrimary:!0}:Q)),children:[e.jsx("option",{value:void 0,children:"Please select a Primary column if applicable..."},"primary-col-selector-default-option"),P.map(({name:q,display_name:Q})=>e.jsx("option",{value:q,children:Q||q},q))]})]}),P!=null&&P.length?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-1 hover:bg-blue-50 rounded-md grid grid-cols-3 font-semibold border-b",style:{gridTemplateColumns:"1fr 1fr 100px"},children:[e.jsxs("label",{className:"flex flex-wrap items-center",children:["Display Name",e.jsx("input",{className:"p-0.5 mx-1 border rounded-md text-sm font-light",value:$,onChange:q=>E(q.target.value),placeholder:"search..."})]}),e.jsx("label",{children:"Existing Column Match"}),e.jsx("label",{children:"GEO Column"})]}),e.jsx("div",{className:"flex flex-col max-h-[700px] overflow-auto scrollbar-sm",children:P.filter(({display_name:q,name:Q})=>!$||(q||Q).toLowerCase().includes($.toLowerCase())).map(({name:q,display_name:Q,existingColumnMatch:Y,geo_col:H})=>e.jsxs("div",{className:"p-0.5 hover:bg-blue-50 rounded-md grid grid-cols-3",style:{gridTemplateColumns:"1fr 1fr 100px"},children:[e.jsx("div",{className:F,children:Q},`${q}_display_name`),e.jsxs("select",{className:Y?F:`${F} bg-red-50`,value:Y,onChange:J=>U(P.map(G=>G.name===q?{...G,existingColumnMatch:J.target.value}:G)),children:[e.jsx("option",{children:"Please select..."}),z.sort((J,G)=>{var se;return(se=J==null?void 0:J.display_name)==null?void 0:se.localeCompare(G==null?void 0:G.display_name)}).map(({name:J,display_name:G})=>e.jsx("option",{value:J,children:G||J},J))]},`${q}_select_existing_col`),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("input",{className:"",type:"checkbox",checked:H||!1,onChange:()=>{},onClick:J=>{U(P.map(G=>G.name===q?{...G,geo_col:J.target.checked}:G))}})},`${q}_geo_col_div`)]},q))}),e.jsx("div",{className:"mt-1 flex justify-end",children:e.jsx("button",{className:"p-1 bg-blue-300 hover:bg-blue-600 text-white rounded-md",disabled:N,onClick:()=>i9({...x,gisUploadId:L,layerName:O,app:r.app,type:r.type,dmsServerPath:y,columns:P,setPublishStatus:k,setPublishing:S,existingAttributes:z,updateMetaData:R}),children:N?"publishing...":"publish"})})]}):e.jsx("div",{children:"No columns available."})]}):e.jsx("div",{className:"w-full h-[300px]",children:e.jsx("div",{className:"flex items-center justify-center w-full",onDragOver:oa,onDragEnter:oa,onDragLeave:oa,onDrop:q=>{if(oa(q),!!q.dataTransfer.files[0])return Cu({file:q.dataTransfer.files[0],user:x,etlContextId:M,damaServerPath:g,setGisUploadId:D,setLoading:j,setLayers:T,setLayerName:B,pgEnv:f,falcor:h})},children:e.jsxs("label",{htmlFor:"dropzone-file",className:"flex flex-col items-center justify-center w-full h-96 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500 ","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),v?e.jsx("p",{className:"text-xs text-gray-500 ",children:"Uploading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"mb-2 text-sm text-gray-500 ",children:[e.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"a zipped Excel"})]})]}),e.jsx("input",{disabled:v,id:"dropzone-file",type:"file",className:"hidden",onChange:q=>Cu({file:q.target.files[0],user:x,pgEnv:f,falcor:h,etlContextId:M,damaServerPath:g,setGisUploadId:D,setLoading:j,setLayers:T,setLayerName:B})})]})})}):"No version selected."};ef.settings={hasControls:!0,name:"ElementEdit"};const tf={EditComp:ef},Nu=C.createContext({}),ai={columns:[],display:{allowSearchParams:!1},sourceInfo:{columns:[]}},sf=({value:t,onChange:s,pageFormat:n,apiLoad:r,apiUpdate:a,renderCard:l})=>{const i=!!s,[c,d]=st(Jt(t)?JSON.parse(t):ai);return b.useEffect(()=>{i&&s(JSON.stringify(c))},[c]),e.jsx("div",{className:"w-full h-full min-h-[50px]",children:e.jsx(Lo,{apiLoad:r,app:n==null?void 0:n.app,state:c,setState:d,sourceTypes:["internal"]})})},c9=({value:t,onChange:s,size:n,apiLoad:r,apiUpdate:a,renderCard:l,...i})=>{const[c,d]=st(Jt(t)?JSON.parse(t):ai),{API_HOST:u,user:m,falcor:p,pgEnv:x}=b.useContext(me);return b.useEffect(()=>{d(Jt(t)?JSON.parse(t):ai)},[t]),e.jsx(Nu.Provider,{value:{state:c,API_HOST:u,user:m,falcor:p,pgEnv:x},children:e.jsx("div",{className:"w-full h-full min-h-[50px]",children:e.jsx("div",{className:"w-full pt-2 flex justify-end gap-2",children:e.jsx(tf.EditComp,{onChange:()=>{},size:1,format:{app:c.sourceInfo.app,type:`${c.sourceInfo.type}-${c.sourceInfo.view_id}`,config:JSON.stringify({attributes:c.sourceInfo.columns})},view_id:c.sourceInfo.view_id,apiLoad:r,apiUpdate:a,updateMeta:!1,context:Nu})})})})};sf.settings={hasControls:!0,name:"ElementEdit"};const d9={name:"Upload",type:"upload",variables:[],EditComp:sf,ViewComp:c9},u9={lexical:j6,"Header: Default Header":g6,"Header: MNY Data":x6,"Footer: MNY Footer":RN,Card:H3,Spreadsheet:oc,Graph:fN,Item:_6,Filter:q6,Upload:d9,"Table: Components Index":V6};let tt=u9;const m9=t=>{try{JSON.parse(t)}catch{return!1}return!0},p9={card:"fa-thin fa-credit-card",table:"fa-thin fa-table",graph:"fa-thin fa-chart-column",map:"fa-thin fa-map",lexical:"fa-thin fa-text"};function x9(t){const{value:s,onChange:n,size:r,handlePaste:a,...l}=t,{theme:i}=C.useContext(me),[c,d]=b.useState(),u=(x,h)=>{Qe(s,{...s,[x]:h})||n({...s,[x]:h})};b.useEffect(()=>{s!=null&&s["element-type"]||n({...s,"element-type":"lexical"})},[]);const m=tt[ne(s,"element-type","lexical")]||tt.lexical;let p=m.useDataSource?Eo.EditComp:m.EditComp;return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"relative my-1",children:e.jsx(Ms,{contentEditable:!0,className:"flex-row-reverse",placeholder:"Search for a Component...",options:Object.keys(tt).filter(x=>!tt[x].hideInSelector).map(x=>({key:x,label:tt[x].name||x})),value:s==null?void 0:s["element-type"],onChange:async x=>{x==="paste"||u("element-type",x)},filters:[{icon:"fa-thin fa-paste",label:"Paste",value:"paste",onClick:x=>a(x,d)},...[...new Set(Object.keys(tt).filter(x=>!tt[x].hideInSelector).map(x=>(tt[x].name||x).split(":")[0]))].map(x=>({icon:`${p9[x.toLowerCase()]||x.toLowerCase()}`,label:x,filterText:x}))]})}),e.jsx("div",{children:e.jsx(p,{value:(s==null?void 0:s["element-data"])||"",onChange:x=>u("element-data",x),size:r,theme:i,component:m!=null&&m.useDataSource?m:void 0,...l},c||"")})]})}function h9({value:t,...s}){const{theme:n}=C.useContext(me),r=()=>e.jsxs("div",{children:[" Component ",t["element-type"]," Not Registered "]});let a=tt[ne(t,"element-type","lexical")]?tt[ne(t,"element-type","lexical")]:void 0,l=a?a.useDataSource?Eo.ViewComp:a.ViewComp:r;return e.jsx(l,{value:(t==null?void 0:t["element-data"])||"",theme:n,...s,component:a!=null&&a.useDataSource?a:void 0})}const f9={EditComp:x9,ViewComp:h9},g9=(t={})=>{tt={...tt,...t}},la=async({item:t,url:s,destination:n,id_column:r,dataRows:a,falcor:l,setLoadingStatus:i,locationNameMap:c,setGeneratedPages:d,from:u,to:m,urlSuffixCol:p="geoid",app:x,type:h,apiLoad:f})=>{i("Generating Pages...",a);const g=a.filter((j,N)=>!u||!m||N>=u&&N<=m).sort((j,N)=>j!=null&&j.state_fips?+N[r.name]-+j[r.name]:!0).map(j=>j[r.name]);let y=0;const v=[];await ku(g,async(j,N)=>{var _,L,D,A;const S=await c.reduce(async(T,O)=>(await T,(await St(l,Ha({app:x,type:h,filter:{"data->>'template_id'":[t.id],"data->>'id_column_value'":[j]}}),"/"))[0]),Promise.resolve([])),w=((D=(L=(_=S==null?void 0:S.data)==null?void 0:_.value)==null?void 0:L.sections)==null?void 0:D.map(T=>T.id))||[];i(`${S?"Updating":"Generating"} page ${++y}/${g==null?void 0:g.length}`);const k=await w.reduce(async(T,O)=>{const B=await T,F=await St(l,Ha({app:x,type:`${h}|cms-section`,filter:{id:[O]}}),"/");return[...B,...F]},Promise.resolve([])),$=t.data_controls,E=a.find(T=>T[r.name]===j)||{};let M=await Promise.allSettled(t.sections.map(T=>T.id).map(T=>{var X,q,Q,Y;let O=t.sections.find(H=>H.id===T)||{},B=Ji((X=O==null?void 0:O.element)==null?void 0:X["element-data"])||{},F=((q=O==null?void 0:O.element)==null?void 0:q["element-type"])||"",z=tt[F]||{},P=((z==null?void 0:z.variables)||[]).reduce((H,J)=>(H[J.name]=J.name===r.name?j:B[J.name],H),{}),U=Object.keys(((Q=$==null?void 0:$.sectionControls)==null?void 0:Q[T])||{}).reduce((H,J)=>{var se,le,ce,je,Ce,oe;const G=((ce=(le=(se=$==null?void 0:$.sectionControls)==null?void 0:se[T])==null?void 0:le[J])==null?void 0:ce.name)||((Ce=(je=$==null?void 0:$.sectionControls)==null?void 0:je[T])==null?void 0:Ce[J]);return H[J]=G===r.name?j:E[G]||((oe=$==null?void 0:$.active_row)==null?void 0:oe[G])||null,H},{}),R=(Y=B.additionalVariables)==null?void 0:Y.map(H=>{var se,le;const J=H.name,G=(le=(se=$==null?void 0:$.sectionControls)==null?void 0:se[T])==null?void 0:le[J];return H.defaultValue=(E==null?void 0:E[G])||H.defaultValue,H}),W=Array.isArray(B.filters)?B.filters.map(H=>{var se,le,ce,je;const J=H.column,G=(le=(se=$==null?void 0:$.sectionControls)==null?void 0:se[T])==null?void 0:le[J];return G&&(H.values=[(ce=$==null?void 0:$.active_row)==null?void 0:ce[G]],H.valueSets=[(je=$==null?void 0:$.active_row)==null?void 0:je[G]]),H}):B.filters,V={...P,...U,additionalVariables:R,filters:W,apiLoad:f};try{return z!=null&&z.getData?z.getData(V,l).then(async H=>({section_id:T,data:H,type:F})):{section_id:T,data:B,type:F}}catch(H){return console.error("<generatePages> Error: ",j,H),{section_id:T,data:B,err:H,type:F}}}));if(await l.setCache({}),M.length>0){const T=t.sections.map(z=>{var P;return((P=M.find(U=>{var R;return((R=U==null?void 0:U.value)==null?void 0:R.section_id)===z.id}))==null?void 0:P.value)||z}).filter(z=>z).map(({section_id:z,data:P,err:U,type:R})=>{var q;let W=t.sections.find(Q=>Q.id===z)||{},V=k.find(Q=>Q.data.value.element["template-section-id"]===z)||{},X=((q=V==null?void 0:V.data)==null?void 0:q.value)||{element:{}};return V!=null&&V.id&&(X.id=V==null?void 0:V.id),X.title=W.title,X.level=W.level,X.size=W.size,X.tags=W.tags,X.status=U?JSON.stringify(U,Object.getOwnPropertyNames(U)):"success",X.element["element-data"]=JSON.stringify(P),X.element["element-type"]=R,X.element["template-section-id"]=z,X}),O=`${h}|cms-section`,B={format:{app:x,type:O}},F={format:{app:x,type:h}};try{const z=await ku(T.map(W=>ys(l,B,W)),W=>W,{concurrency:10,saveResponse:!0}),U=p==="county"&&(W=>W.toLowerCase().replace(" county","").replace(".","").replace(/ /g,"_"))((E==null?void 0:E.county)||(E==null?void 0:E.name))||j,R={...S&&{id:S.id},...((A=S==null?void 0:S.data)==null?void 0:A.value)||{},id_column_value:j,template_id:t.id,sidebar:t.sidebar,header:t.header,footer:t.footer,full_width:t.full_width,hide_in_nav:"true",index:999,url_slug:`${s||r.name}/${U}`,title:`${r.name} ${j} Template`,num_errors:T.filter(W=>W.status!=="success").length,sections:[...T.map((W,V)=>{var X;return{id:W.id||((X=z[V])==null?void 0:X.id),ref:`${x}+${h}|cms-section`}}),...k.filter(W=>!W.data.value.element["template-section-id"]).map((W,V)=>({id:W.id,ref:`${x}+${h}|cms-section`}))],draft_sections:[...T.map((W,V)=>{var X;return{id:W.id||((X=z[V])==null?void 0:X.id),ref:"dms-site+cms-section"}}),...k.filter(W=>!W.data.value.element["template-section-id"]).map((W,V)=>({id:W.id,ref:`${x}+${h}|cms-section`}))]};try{const W=await ys(l,F,R);v.push({id:W==null?void 0:W.id,num_errors:R.num_errors,id_column_value:R.id_column_value})}catch(W){console.error("<generatePages> Create/Update Page Error:",j,W)}}catch(z){console.error("<generatePages> Create/Update Sections Error:",j,z)}}},{concurrency:10,saveResponse:!1}),d(v),i(void 0)};function ku(t,s,n={}){let r=n.concurrency||1/0,a=0;const l=[],i=[],c=t[Symbol.iterator]();for(;r-- >0;){const u=d();if(u)i.push(u);else break}return Promise.all(i).then(()=>l);function d(){const u=c.next();if(u.done)return null;const m=a++,p=s(u.value,m);return Promise.resolve(p).then(x=>(n.saveResponse&&(l[m]=x),console.log("size of the results object in PromiseMap:",JSON.stringify(l).length,l),d()))}}const nf=({submit:t,item:s,onChange:n,loadingStatus:r,apiLoad:a,setLoadingStatus:l=()=>{}})=>{var U,R;const{falcor:i,falcorCache:c,pgEnv:d,app:u,type:m}=C.useContext(me),[p,x]=b.useState([]),[h,f]=b.useState(!1),[g,y]=b.useState(((U=s==null?void 0:s.data_controls)==null?void 0:U.urlSuffixCol)||"geoid"),[v,j]=b.useState({}),[N,S]=b.useState(0),[w,k]=b.useState([]),{url:$,destination:E=s.type,source:M,view:_,view_id:L,id_column:D,active_row:A}=s==null?void 0:s.data_controls;if(!(_!=null&&_.view_id))return null;const T=[m];C.useEffect(()=>{(async()=>await i.get(["dama",d,"viewsbyId",_.view_id,"data","length"]).then(()=>{const V=i.getCache();S(ne(V,["dama",d,"viewsbyId",_.view_id,"data","length"],0))}))()},[d,_.view_id]);const O=C.useMemo(()=>{let W=ne(M,["metadata","value","columns"],ne(M,"metadata",[]));return Array.isArray(W)||(W=[]),W.filter(V=>!["geom","wkb_geometry","ogc_fid"].includes(V==null?void 0:V.name))},[M]);C.useEffect(()=>{_!=null&&_.view_id&&(D!=null&&D.name)&&N&&(async()=>await i.get(["dama",d,"viewsbyId",_.view_id,"databyIndex",{from:0,to:N-1},O.map(V=>V.name)]).then(()=>{const V=i.getCache(),X=Object.values(ne(V,["dama",d,"viewsbyId",_.view_id,"databyIndex"],{})).map(q=>ne(V,[...q.value],""));k(X)}))()},[D,_.view_id,N]),C.useEffect(()=>{(async function(){l("Loading Pages...");const W=await T.reduce(async(V,X)=>{const q=await V,Q=[{key:"id",label:"id"},{key:"data->>'id_column_value' as id_column_value",label:"id_column_value"},{key:"data->>'num_errors' as num_errors",label:"num_errors"}];let Y=await St(i,Ha({app:u,type:X,filter:{"data->>'template_id'":[s.id]},attributes:Q}),"/");return Y=Y.map(H=>Q.reduce((J,G)=>(J[G.label]=H[G.key],J),{})),[...q,...Y]},Promise.resolve([]));x(W),l(void 0)})()},[s.id,(R=s.data_controls)==null?void 0:R.sectionControls]);const B=b.useMemo(()=>p.filter(W=>typeof+W.num_errors=="number"&&+W.num_errors>0).map(W=>W.id_column_value.toString()),[p]),F=b.useMemo(()=>p.filter(W=>W.id_column_value&&typeof W.id_column_value!="object").map(W=>W.id_column_value.toString()),[p]),z=b.useMemo(()=>w.filter(W=>{var V;return!F.includes((V=W[D==null?void 0:D.name])==null?void 0:V.toString())}),[F,w,D==null?void 0:D.name]),P=b.useMemo(()=>w.filter(W=>{var V;return B.includes((V=W[D==null?void 0:D.name])==null?void 0:V.toString())}),[B,w,D==null?void 0:D.name]);return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs uppercase font-bold text-slate-400 ml-4",children:" url suffix "}),e.jsx(Nn,{className:"ml-2.5 relative w-full cursor-default overflow-hidden bg-transparent border-b-2 border-slate-300 text-slate-500 text-left sm:text-sm",options:O.map(W=>W.name),value:g,nameAccessor:W=>W==null?void 0:W.name,valueAccessor:W=>W==null?void 0:W.name,onChange:W=>{y(W),n("urlSuffixCol",W)}}),e.jsx(Nn,{options:["",...O],value:D,nameAccessor:W=>W==null?void 0:W.name,valueAccessor:W=>W==null?void 0:W.name,onChange:W=>n("id_column",W)}),D!=null&&D.name?e.jsx(Nn,{options:w,value:A,nameAccessor:W=>(D==null?void 0:D.name)==="geoid"&&((W==null?void 0:W.county)||(W==null?void 0:W.name))||(W==null?void 0:W[D==null?void 0:D.name]),onChange:W=>n("active_row",{active_row:W})}):"",e.jsx("div",{className:"flex items-center pt-2",children:p!=null&&p.length||w!=null&&w.length?e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row",children:[e.jsx("button",{className:`inline-flex w-36 justify-center rounded-lg cursor-pointer text-sm font-semibold 
                                            py-2 px-2 text-white shadow-lg border active:border-b-2 active:mb-[2px] active:shadow-none 
                                            ${r?"bg-gray-500 border-b-2 border-gray-800 cursor-not-allowed":"bg-blue-500 hover:bg-blue-400 border-b-4 border-blue-800 hover:border-blue-700"}`,disabled:r,onClick:W=>la({item:s,url:$,destination:E,id_column:D,dataRows:w,falcor:i,setLoadingStatus:l,locationNameMap:T,setGeneratedPages:x,urlSuffixCol:g,app:u,type:m,apiLoad:a}),children:r||(p!=null&&p.length?"Update Pages":"Generate Pages")}),e.jsx("button",{disabled:r,className:`inline-flex rounded-lg cursor-pointer text-white text-bold px-2 py-2.5 shadow-lg
                                border active:border-b-2 active:mb-[2px] active:shadow-none 
                                ${r?"bg-gray-500 border-b-2 border-gray-800 cursor-not-allowed":"bg-blue-500 hover:bg-blue-400 border-b-4 border-blue-800 hover:border-blue-700"}`,onClick:()=>f(!h),children:e.jsx("i",{className:h?"fa fa-caret-up":"fa fa-caret-down"})})]}),e.jsxs("div",{className:h?"flex flex-col":"hidden",children:[e.jsx("button",{className:`inline-flex w-36 justify-center rounded-lg text-sm font-semibold 
                                            py-2 px-2 text-white shadow-lg border active:border-b-2 active:mb-[2px] active:shadow-none' 
                                            ${r||!(z!=null&&z.length)?"bg-gray-500 border-b-2 border-gray-800 cursor-not-allowed":"bg-blue-500 hover:bg-blue-400 border-b-4 border-blue-800 hover:border-blue-700 cursor-pointer"}`,disabled:r||!(z!=null&&z.length),onClick:W=>(f(!1),la({item:s,url:$,destination:E,id_column:D,dataRows:z,falcor:i,setLoadingStatus:l,locationNameMap:T,setGeneratedPages:x,urlSuffixCol:g,app:u,type:m,apiLoad:a})),children:r||`Generate missing pages (${z==null?void 0:z.length})`}),e.jsx("button",{className:`inline-flex w-36 justify-center rounded-lg text-sm font-semibold 
                                            py-2 px-2 text-white shadow-lg border active:border-b-2 active:mb-[2px] active:shadow-none' 
                                            ${r||!(P!=null&&P.length)?"bg-gray-500 border-b-2 border-gray-800 cursor-not-allowed":"bg-blue-500 hover:bg-blue-400 border-b-4 border-blue-800 hover:border-blue-700 cursor-pointer"}`,disabled:r||!(P!=null&&P.length),onClick:W=>(f(!1),la({item:s,url:$,destination:E,id_column:D,dataRows:P,falcor:i,setLoadingStatus:l,locationNameMap:T,setGeneratedPages:x,urlSuffixCol:g,app:u,type:m,apiLoad:a})),children:r||`Update errored pages (${P==null?void 0:P.length})`}),e.jsxs("div",{className:`inline-flex flex-col w-36 justify-center rounded-lg text-sm font-semibold 
                                            py-2 px-2 shadow-lg border active:border-b-2 active:mb-[2px] active:shadow-none' 
                                            bg-blue-100 border-b-4 border-blue-500`,children:[e.jsxs("div",{className:"w-full flex py-1",children:[e.jsxs("select",{className:"p-1 border hover:cursor-pointer rounded-md",value:v.from,onChange:W=>j({...v,from:W.target.value}),children:[e.jsx("option",{children:"from"}),Array.from({length:w.length},(W,V)=>V).map(W=>e.jsx("option",{value:W,children:W+1},W))]}),e.jsxs("select",{className:"p-1 border hover:cursor-pointer rounded-md",value:v.to,onChange:W=>j({...v,to:W.target.value}),children:[e.jsx("option",{children:"to"}),Array.from({length:w.length},(W,V)=>V).map(W=>e.jsx("option",{value:W,children:W+1},W))]})]}),r||e.jsx("button",{className:"w-full text-white bg-blue-500 hover:bg-blue-400 border-b-4 border-blue-800 hover:border-blue-700 cursor-pointer rounded-md",onClick:W=>(f(!1),la({item:s,url:$,destination:E,id_column:D,dataRows:w,falcor:i,setLoadingStatus:l,locationNameMap:T,setGeneratedPages:x,...v,urlSuffixCol:g,app:u,type:m,apiLoad:a})),children:"Generate"})]})]})]}):e.jsx("button",{className:"mt-4 p-2 rounded-lg text-white bg-gray-500 border border-b-2 border-gray-800 cursor-not-allowed",disabled:!0,children:"No template data available."})})]})},b9=({section:t,source:s,sectionControl:n={},updateSectionControl:r})=>{var u,m;let a=Ji((u=t==null?void 0:t.element)==null?void 0:u["element-data"])||{},l=((m=t==null?void 0:t.element)==null?void 0:m["element-type"])||"",i=tt[l]||{},c=[...(i==null?void 0:i.variables)||[],...(a==null?void 0:a.additionalVariables)||[],...(Array.isArray(a==null?void 0:a.filters)?a.filters:[]).map(p=>({name:p.column}))];const d=C.useMemo(()=>{let p=ne(s,["metadata","value","columns"],ne(s,"metadata",[]));return Array.isArray(p)||(p=[]),p.map(x=>x.name)},[s]);return e.jsxs("div",{className:"p-4 border rounded mb-1",children:[e.jsxs("div",{children:["Title: ",t==null?void 0:t.title," ",t==null?void 0:t.id]}),e.jsx("div",{children:l}),e.jsx("div",{children:c.filter(p=>!p.hidden).map(p=>e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex-1 items-center",children:[e.jsx("div",{children:p.name}),e.jsx("div",{className:"text-xs",children:typeof a[p.name]=="object"?JSON.stringify(a[p.name]):a[p.name]})]}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsx(Nn,{options:["",...d],value:n[p.name]||"",onChange:x=>{r({...n,[p.name]:x})}})})]},p.name))})]})},y9=({sections:t=[],sectionControls:s,source:n,onChange:r})=>e.jsx("div",{children:t.map(a=>e.jsx(b9,{section:a,source:n,sectionControl:(s==null?void 0:s[a.id])||{},updateSectionControl:l=>{r({...s,[a.id]:l})}},a.id))}),v9=({item:t,dataControls:s={},setDataControls:n,baseUrl:r,loadingStatus:a,setLoadingStatus:l,apiLoad:i})=>{var d,u,m,p,x;const c=(h,f)=>{n({...s,[h]:f})};return e.jsxs("div",{className:"relative mt-6 flex-1 px-4 sm:px-6",children:[e.jsx("span",{className:"text-sm text-gray-500 p-1",children:"Select Template Source:"}),e.jsx(c6,{value:s==null?void 0:s.source,onChange:h=>{c("source",h)}}),(d=s==null?void 0:s.source)!=null&&d.source_id?e.jsx(d6,{source_id:(u=s==null?void 0:s.source)==null?void 0:u.source_id,value:(m=s.view)==null?void 0:m.view_id,onChange:h=>{c("view",h)}}):"",(p=s==null?void 0:s.source)!=null&&p.source_id&&((x=s==null?void 0:s.view)!=null&&x.view_id)?e.jsxs("div",{children:[e.jsx(nf,{item:t,source:s==null?void 0:s.source,view:s==null?void 0:s.view,id_column:s==null?void 0:s.id_column,active_row:s==null?void 0:s.active_row,onChange:(h,f)=>{h==="id_column"&&(c("id_column",f),n({...s,id_column:f,active_row:{}})),h==="active_row"&&n({...s,...f})},loadingStatus:a,setLoadingStatus:l,baseUrl:r,apiLoad:i}),e.jsx(y9,{sections:t.sections,sectionControls:s.sectionControls,source:s==null?void 0:s.source,onChange:h=>{c("sectionControls",{...s.sectionControls,...h})}})]}):"",e.jsx("div",{children:e.jsx("pre",{children:JSON.stringify(s,null,3)})})]})};function w9(t){const{open:s,setOpen:n}=t;return e.jsx(Oe.Root,{show:s,as:b.Fragment,children:e.jsx(Je,{as:"div",className:"relative z-20 ",onClose:()=>{n(!1),console.log("onclose")},children:e.jsx("div",{className:"fixed inset-x-0 bottom-0 top-12  overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"pointer-events-none fixed inset-y-0 top-12 right-0 flex max-w-full pl-10",children:e.jsx(Oe.Child,{as:b.Fragment,enter:"transform transition ease-in-out duration-500 sm:duration-700",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-500 sm:duration-700",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(Je.Panel,{className:"pointer-events-auto w-screen max-w-md",children:e.jsxs("div",{className:"flex h-full flex-col overflow-y-scroll bg-white py-6 shadow-xl",children:[e.jsx("div",{className:"px-4 sm:px-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(Je.Title,{className:"text-base font-semibold leading-6 text-gray-900",children:"Data Controls"}),e.jsx("div",{className:"ml-3 flex h-7 items-center",children:e.jsxs("button",{type:"button",className:"relative rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>n(!1),children:[e.jsx("span",{className:"absolute -inset-2.5"}),e.jsx("span",{className:"sr-only",children:"Close panel"}),e.jsx("i",{className:"h-6 w-6 text-lg fa fa-close","aria-hidden":"true"})]})})]})}),e.jsx(v9,{...t})]})})})})})})})})}const Zn={pageControls:{controlItem:"pl-6 py-0.5 text-md cursor-pointer hover:text-blue-500 text-slate-400 flex items-center"}};function j9({item:t,dataItems:s,updateAttribute:n,attributes:r,edit:a,status:l,setItem:i,apiLoad:c}){var P,U;const d=bt(),{pathname:u="/edit"}=Ge(),[m,p]=C.useState(!1),[x,h]=C.useState(!1),[f,g]=b.useState(!1),[y,v]=b.useState(!1),[j,N]=b.useState(l==null?void 0:l.message),[S,w]=b.useState(!1),[k,$]=b.useState(t.type),[E,M]=b.useState(),{baseUrl:_,user:L,falcor:D,falcorCache:A}=C.useContext(me),T=async R=>{let W={id:t.id,url_slug:vs(t,s)};R&&(W.sections=R),d(mt(W),{method:"post",action:u})};async function O(R){var X,q;const W=(q=(X=Object.keys(R.sectionControls))==null?void 0:X.filter((Q,Y)=>Q&&Q!=="undefined"))==null?void 0:q.length;M("Loading sections...");const V=await Object.keys(R.sectionControls).filter((Q,Y)=>Q&&Q!=="undefined"&&t.sections.find(H=>H.id===Q)).reduce(async(Q,Y,H)=>{var te,re,ee,xe,ke;const J=await Q;let G=((te=t.sections.filter(he=>he.id===Y))==null?void 0:te[0])||{};M(`Updating section ${G==null?void 0:G.title}  ${(re=G==null?void 0:G.element)==null?void 0:re["element-type"]}  ${H+1}/${W}`);let se=Ji(((ee=G==null?void 0:G.element)==null?void 0:ee["element-data"])||{}),le=((xe=G==null?void 0:G.element)==null?void 0:xe["element-type"])||"",ce=tt[le]||{},je=((ce==null?void 0:ce.variables)||[]).reduce((he,we)=>(he[we.name]=se[we.name],he),{}),Ce=Object.keys(R.sectionControls[Y]).reduce((he,we)=>{var be,Me,Ve,Xe,yt,_t,an;return he[we]=((Xe=R==null?void 0:R.active_row)==null?void 0:Xe[(Ve=(Me=(be=R==null?void 0:R.sectionControls)==null?void 0:be[Y])==null?void 0:Me[we])==null?void 0:Ve.name])||((an=R==null?void 0:R.active_row)==null?void 0:an[(_t=(yt=R==null?void 0:R.sectionControls)==null?void 0:yt[Y])==null?void 0:_t[we]])||null,he},{}),oe=(ke=se.additionalVariables)==null?void 0:ke.map(he=>{var Me,Ve,Xe;const we=he.name,be=(Ve=(Me=R==null?void 0:R.sectionControls)==null?void 0:Me[Y])==null?void 0:Ve[we];return he.defaultValue=(Xe=R==null?void 0:R.active_row)==null?void 0:Xe[be],he}),ve=Array.isArray(se.filters)?se.filters.map(he=>{var Me,Ve,Xe,yt;const we=he.column,be=(Ve=(Me=R==null?void 0:R.sectionControls)==null?void 0:Me[Y])==null?void 0:Ve[we];return be&&(he.values=[(Xe=R==null?void 0:R.active_row)==null?void 0:Xe[be]],he.valueSets=[(yt=R==null?void 0:R.active_row)==null?void 0:yt[be]]),he}):se.filters,ae={...je,...Ce,additionalVariables:oe,filters:ve,apiLoad:c};const de=ce!=null&&ce.getData?await ce.getData(ae,D).then(he=>({section_id:Y,data:he})):null;return de?[...J,de]:J},Promise.resolve([]));if(V.length>0){let Q=pe(t.sections);V.forEach(({section_id:Y,data:H})=>{var G;let J=((G=Q.filter(se=>se.id===Y))==null?void 0:G[0])||{};J.element["element-data"]=JSON.stringify(H)}),n("sections",Q),T(Q)}M(void 0)}const B=async(R,W="")=>{var q,Q;const V=pe(t);V[R]=W;let X="sections";R==="header"&&!((Q=(q=V==null?void 0:V[X])==null?void 0:q.filter(Y=>Y.is_header))!=null&&Q[0])?(V[X].unshift({is_header:!0,element:{"element-type":"Header: Default Header","element-data":{}}}),n("","",{header:W,[X]:V[X]})):n(R,W),d(mt(V),{method:"post",action:u})},F=async(R="")=>{if(R!==t.title){let W=t.history?pe(t.history):[],V={type:`changed page title to ${R}`,user:L.email,time:new Date().toString()};W.push(V);const X={id:t.id,title:R,history:W};X.url_slug=vs(X,s),n("title",R),d(mt(X),{method:"post",action:`${_}/edit/${X.url_slug}`})}},z=R=>{if(!Qe(t.data_controls,R)){console.log("------setting data controls-------------");const W=pe(t);t.id,W.data_controls=R,n("data_controls",R),d(mt(W),{method:"post",action:u})}};return e.jsxs(e.Fragment,{children:[e.jsx(w9,{item:t,open:f,setOpen:g,dataControls:t==null?void 0:t.data_controls,setDataControls:z,loadingStatus:E,setLoadingStatus:M,baseUrl:_,apiLoad:c}),a&&e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"pl-4 pb-2",children:[e.jsx("span",{className:"text-xs uppercase font-bold text-slate-400",children:" page name "}),e.jsx($u,{value:t==null?void 0:t.title,onChange:F})]}),e.jsxs("div",{className:"flex w-full h-12 px-4",children:[e.jsx(C9,{icon:"fad fa-sliders-h p-2 text-blue-300 hover:text-blue-500 cursor-pointer text-lg",children:e.jsxs("div",{className:"py-2",children:[e.jsx("div",{className:"px-6 font-medium text-sm",children:" Page Settings "}),e.jsxs("div",{className:Zn.pageControls.controlItem,children:[e.jsx(ia,{item:t,type:"sidebar",toggleSidebar:B}),"Show Sidebar"]}),e.jsxs("div",{className:Zn.pageControls.controlItem,children:[e.jsx(ia,{type:"full_width",item:t,toggleSidebar:B}),"Full Width"]}),e.jsxs("div",{className:Zn.pageControls.controlItem,children:[e.jsx(ia,{type:"hide_in_nav",item:t,toggleSidebar:B}),"Hide In Nav"]}),e.jsx("div",{className:Zn.pageControls.controlItem+" pr-4",children:e.jsx(i6,{label:"Header:",types:[{label:"None",value:"none"},{label:"Above",value:"above"},{label:"Below",value:"below"},{label:"In page",value:"inpage"}],type:t.header,setType:R=>B("header",R)})}),e.jsxs("div",{className:Zn.pageControls.controlItem,children:[e.jsx(ia,{type:"footer",item:t,toggleSidebar:B}),"Show Footer"]})]})}),e.jsx("div",{className:"fad fa-sliders-h-square p-2 text-blue-300 hover:text-blue-500 cursor-pointer text-lg",onClick:()=>g(!0)}),e.jsx("div",{className:"fad fa-history p-2 text-blue-300 hover:text-blue-500 cursor-pointer text-lg",onClick:()=>h(!0)})]}),e.jsxs("div",{className:"pl-4 pb-2",children:[e.jsx("span",{className:"text-xs uppercase font-bold text-slate-400",children:" url prefix "}),e.jsx($u,{value:(P=t==null?void 0:t.data_controls)==null?void 0:P.url,onChange:R=>z({...t.data_controls,url:R})})]}),((U=t==null?void 0:t.data_controls)==null?void 0:U.id_column)&&e.jsx("div",{children:e.jsx(nf,{item:t,submit:d,onChange:(R,W)=>{let V;if(R==="id_column"&&(V={...t==null?void 0:t.data_controls,id_column:W,active_row:{}}),R==="active_row"&&(V={...t==null?void 0:t.data_controls,...W}),R==="urlSuffixCol"){V={...t==null?void 0:t.data_controls,[R]:W},z(V);return}z(V),O(V)},loadingStatus:E,setLoadingStatus:M,apiLoad:c,baseUrl:_})}),e.jsx(Wr,{item:t,open:y,setOpen:v})]})]})}function $u({value:t,onChange:s}){const[n,r]=C.useState(!1),[a,l]=C.useState(t||"");return e.jsx("div",{className:"flex justify-between group",children:e.jsx("div",{className:"flex-1",children:e.jsx("dd",{className:" text-sm text-gray-900 ",children:n?e.jsxs("div",{className:"flex group focus:outline-none border-slate-300 border-b-2 group-focus:border-blue-500",children:[e.jsx("input",{className:"w-full px-2 py-1 text font-medium text-slate-500 focus:outline-none focus:border-blue-500",value:a,onChange:i=>l(i.target.value)}),e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx("span",{className:" pt-0.5 text-green-500 rounded hover:bg-green-500 hover:text-white ",onClick:i=>{s(a),r(!1)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-6 h-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})}),e.jsx("span",{className:"pt-0.5 text-slate-300  rounded  hover:text-red-300 ",onClick:i=>r(!1),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-6 h-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})})]})]}):e.jsxs("div",{className:"w-full min-h-[30px] flex flex-row px-2 py-1 text font-medium text-slate-500 focus:outline-none border-slate-300 border-b-2 focus:border-blue-500",children:[e.jsx("div",{className:"w-full",children:t}),e.jsx("span",{className:"hidden group-hover:block text-blue-300 hover:text-blue-500 cursor-pointer ",onClick:i=>r(!n),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-4 -mt-0.5 p-1.5 rounded hover:bg-blue-500 hover:text-white"})})]})})})})}function C9({icon:t,children:s}){let[n,r]=b.useState(),[a,l]=b.useState(),{styles:i,attributes:c}=Qm(n,a);return e.jsxs(Tt,{className:"relative",children:[e.jsx(Tt.Button,{ref:r,className:"text-md cursor-pointer hover:text-blue-800 text-blue-500",children:e.jsx("i",{className:t,title:"Help"})}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:e.jsx(Tt.Panel,{ref:l,style:i.popper,...c.popper,className:"shadow-lg bg-white rounded z-10 transform  border border-blue-200 w-[180px] ",children:s})})]})}function ia({type:t,item:s,toggleSidebar:n}){let r=s[t]==="show";return e.jsxs(sn,{checked:r,onChange:a=>n(t,r?"":"show"),className:"group relative inline-flex h-5 w-10 flex-shrink-0 cursor-pointer items-center justify-center rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-600 focus:ring-offset-2",children:[e.jsx("span",{className:"sr-only",children:"Use setting"}),e.jsx("span",{"aria-hidden":"true",className:"pointer-events-none absolute h-full w-full rounded-md bg-white"}),e.jsx("span",{"aria-hidden":"true",className:`
          ${r?"bg-blue-500":"bg-gray-200"}
          pointer-events-none absolute mx-auto h-4 w-9 rounded-full transition-colors duration-200 ease-in-out
        `}),e.jsx("span",{"aria-hidden":"true",className:`
          ${r?"translate-x-5":"translate-x-0"}
          pointer-events-none absolute left-0 inline-block h-5 w-5 transform rounded-full border border-gray-200 bg-white shadow ring-0 transition-transform duration-200 ease-in-out
        `})]})}function N9({item:t,dataItems:s,updateAttribute:n,attributes:r,setItem:a,status:l,params:i,apiLoad:c,apiUpdate:d,logo:u,rightMenu:m,sideNav:p=[]}){var M,_,L;Le();const x=bt(),{baseUrl:h,user:f,theme:g}=C.useContext(me),{pathname:y="/edit"}=Ge(),{id:v}=i,j=1,N=hr(t),S=(_=(M=t.sections)==null?void 0:M.filter(D=>D.is_header))==null?void 0:_[0],w=(L=t.sections)==null?void 0:L.filter(D=>!D.is_header&&!D.is_footer),k=D=>{let A=t.history?pe(t.history):[];A.push({type:"Header updated.",user:f.email,time:new Date().toString()}),n("","",{has_changes:!0,history:A,sections:[...D,...w].filter(O=>O)});const T={id:t.id,sections:[...D,...w].filter(O=>O),has_changes:!0,history:A};console.log("save header",T),x(mt(T),{method:"post",action:y})},$=(D,A)=>{let T={type:A,user:f.email,time:new Date().toString()},O=t.history?pe(t.history):[];A&&O.push(T),n("","",{has_changes:!0,history:O,sections:[S,...D].filter(F=>F)});const B={id:t.id,sections:[S,...D].filter(F=>F),has_changes:!0,history:O};x(mt(B),{method:"post",action:y})},E=C.useMemo(()=>r.sections.EditComp,[]);return e.jsxs("div",{children:[(t==null?void 0:t.header)==="above"&&e.jsx("div",{className:"w-full",children:e.jsx(E,{full_width:t.full_width,value:[S],onChange:k,...r.sections})}),e.jsxs("div",{className:`${g.page.wrapper1} ${g.navPadding[j]}`,children:[(t==null?void 0:t.header)==="below"&&e.jsx("div",{className:"w-full",children:e.jsx(E,{item:t,value:[S],onChange:k,...r.sections})}),e.jsxs("div",{className:`${g.page.wrapper2}`,children:[(t==null?void 0:t.sidebar)==="show"&&e.jsx(k9,{inPageNav:N}),e.jsxs("div",{className:g.page.wrapper3+" border-r",children:[(t==null?void 0:t.header)==="inpage"&&e.jsx("div",{className:"w-full",children:e.jsx(E,{item:t,value:[S],onChange:k,...r.sections})}),e.jsx(E,{full_width:t.full_width,value:w,onChange:$,apiLoad:c,apiUpdate:d,...r.sections})]}),e.jsx("div",{className:"w-52 hidden xl:block",children:e.jsx("div",{className:"w-52 sticky top-12 hidden xl:block h-screen",children:e.jsx(j9,{apiLoad:c,item:t,dataItems:s,setItem:a,edit:!0,status:l,attributes:r,updateAttribute:n,pageType:"template"})})})]})]}),(t==null?void 0:t.footer)&&e.jsx("div",{className:"h-[300px] bg-slate-100"})]},v)}function k9({inPageNav:t}){return e.jsx(_h,{custom:"max-h-[calc(100vh_-_6rem)] overflow-y-auto overflow-x-hidden top-20 sticky",children:e.jsx(Ki,{...t})})}const $9={navOptions:{sideNav:{size:"compact",search:"none",logo:"none",dropdown:"none",nav:"main"},topNav:{size:"compact",dropdown:"right",search:"none",logo:"left",position:"fixed",nav:"none"}}};function S9({children:t}){var l;const{baseUrl:s,theme:n,user:r}=C.useContext(me)||{},a=[{name:"< Manage Site",path:"/list"},{name:"",className:"p-2"},{name:"Dashboard",path:`${s}/manage`},{name:"View Site",path:`${s}/`},{name:"Content",className:n.navLabel},{name:"Pages",path:`${s}/manage/pages`},{name:"Templates",path:`${s}/manage/templates`},{name:"Tags",path:`${s}/manage/tags`},{name:"Layout",className:n.navLabel},{name:"Design",path:`${s}/manage/design`}];return e.jsx("div",{id:"page_view",children:e.jsx(Rr,{navItems:a,theme:$9,children:e.jsx("div",{className:`${(l=n==null?void 0:n.page)==null?void 0:l.wrapper1} `,children:t})})})}function _9({item:t,dataItems:s,attributes:n,logo:r,rightMenu:a}){var d,u;const{baseUrl:l,theme:i,user:c}=C.useContext(me)||{};return e.jsx("div",{className:`${(d=i==null?void 0:i.page)==null?void 0:d.wrapper2}`,children:e.jsx("div",{className:(u=i==null?void 0:i.page)==null?void 0:u.wrapper3,children:e.jsx("div",{children:"Dashboard"})})})}const bn={nav:{container:t=>t?"w-1/4 max-w-[25%] border-r overflow-hidden":"hidden",navItemContainer:"max-h-[80vh] w-full overflow-y-auto overflow-x-hidden pt-3 scrollbar-xs",navItem:({isActive:t,isPending:s})=>`block px-4 py-2 font-light ${t?"w-[256px] bg-white text-blue-500 border-l border-y":"w-[248px] hover:bg-blue-100 text-slate-600"}`,navItemChild:({isActive:t,isPending:s})=>`block px-4 py-2 font-light ${t?"w-[238px] bg-white text-blue-500 border-l border-y":"w-[230px] hover:bg-blue-100 text-slate-600"}`,addItemButton:"cursor-pointer px-4 py-2 mt-3 hover:bg-blue-100 w-full text-slate-400 border-t border-slate-200",expandCollapseButton:"p-0.5 h-fit w-fit rounded-md text-blue-400 text-xs  hover:text-blue-500"},page:{pageContainer:t=>`border max-h-[80vh] ${t?"max-w-[90%] w-[90%]":"max-w-[100%]"} overflow-y-auto overflow-x-auto scrollbar-xs`}};function I9({dataItems:t}){const s=bt(),{pathname:n="/edit"}=Ge(),{baseUrl:r,user:a}=C.useContext(me),i={title:"New Page",index:t.filter(d=>!d.parent).reduce((d,u)=>Math.max(isNaN(u.index)?-1:u.index,d),-1)+1,published:"draft",history:[{type:" created Page.",user:a.email,time:new Date().toString()}]};i.url_slug=vs(i,t);const c=()=>{s(mt(i),{method:"post",action:n})};return e.jsx("div",{className:"pr-2",children:e.jsx("div",{onClick:c,className:bn.nav.addItemButton,children:"+ Add Page"})})}function rf(t,s="",n){let r=[];return t.forEach((a,l)=>{let i=n[a.id];const c={id:i.id,index:i.index,title:i.title,url_slug:i.url_slug};(i.index!==l||i.parent!==s)&&(c.index=l,c.parent=s,r.push(c)),a.children&&(r=[...r,...rf(a.children,a.id,n)])}),r}const af=t=>t.reduce((s,n)=>n.children?[...s,n.id,...af(n.children)]:s,[]),Su=({color:t,text:s})=>{const n={orange:"bg-orange-500/15 text-orange-700 group-data-[hover]:bg-orange-500/25",blue:"bg-blue-500/15 text-blue-700 group-data-[hover]:bg-blue-500/25",gray:"text-gray-400"};return e.jsx("div",{className:"group relative inline-flex rounded-md focus:outline-none",children:e.jsx("span",{className:`inline-flex items-center gap-x-1.5 rounded-md px-1.5 py-0.5 text-sm/5 font-medium sm:text-xs/5 forced-colors:outline
            ${n[t]}
            `,children:s})})};function L9({dataItems:t,edit:s,open:n,setOpen:r,selectedPage:a,setSelectedPage:l}){const i=bt(),{pathname:c="/edit"}=Ge();Le();const{baseUrl:d}=C.useContext(me),[u,m]=b.useState({}),p=b.useRef(null),x=w=>{m(k=>({...k,[w]:!k[w]}))},h=C.useCallback(w=>{let k=t.reduce((M,_)=>(M[_.id]=_,M),{}),$=rf(w.items,"",k),E=[...$,...t.filter(M=>!$.map(_=>_.id).includes(M.id))];$.forEach(M=>M.url_slug=vs(M,E)),Promise.all($.map(M=>{i(mt(M),{method:"post",action:c})}))},[]),f=w=>w.published==="draft"||w.has_changes==="true"||w.has_changes===!0,g=(w,k)=>{let $={id:w.id,index:w.index,title:w.title,has_changes:f(w),url:w.url_slug};return j($,t)&&($.children=j(w,t)),$.Comp=({isExpanded:E,hasChanges:M,isSelectedPage:_})=>{var A;const L=y($,t),D=v($,t);return e.jsxs("div",{className:`p-1.5 flex items-center gap-1 cursor-pointer ${_?"bg-gray-100":""} hover:bg-gray-100 rounded-md`,children:[e.jsx("span",{className:"flex-1 truncate",title:$.title,onClick:T=>{T.stopPropagation(),l($.id)},children:$.title}),e.jsxs("div",{className:"flex gap-0.5 items-center",children:[M?e.jsx(Lx,{className:"text-orange-500"}):null,L?e.jsx(Su,{text:L,color:"orange"}):null,D?e.jsx(Su,{text:D,color:"gray"}):null]}),(A=$.children)!=null&&A.length?E?e.jsx(Yi,{className:"text-gray-400 hover:text-gray-500",onClick:()=>{x($.id)}}):e.jsx(ds,{className:"text-gray-400 hover:text-gray-500",onClick:()=>{x($.id)}}):""]},$.id)},$};function y(w,k){let $=k.filter(E=>E.parent===w.id);return $.length===0?0:$.reduce((E,M)=>E+(f(M)?1:0)+y(M,k),0)}function v(w,k){let $=k.filter(E=>E.parent===w.id);return $.length===0?0:$.reduce((E,M)=>E+1+v(M,k),0)}function j(w,k){let $=k.filter(E=>E.parent===w.id).sort((E,M)=>E.index-M.index);return $.length===0?!1:$.map(g)}const N=t.sort((w,k)=>w.index-k.index).filter(w=>!w.parent&&w.index!=="999").map(g),S=w=>{if(!w)return null;let k=w.Comp;const $=u[w.id],E=f(w),M=a===w.id;return e.jsxs(e.Fragment,{children:[e.jsx(k,{isExpanded:$,hasChanges:E,isSelectedPage:M}),$?e.jsx("div",{className:"pl-3 ml-2 border-l",children:w.children.map(S)}):null]})};return n?e.jsx("div",{className:bn.nav.container(n),children:e.jsxs("div",{className:bn.nav.navItemContainer,children:[e.jsxs("div",{className:"px-1 flex gap-1 w-full justify-end",children:[e.jsx("button",{className:bn.nav.expandCollapseButton,onClick:()=>m({}),children:"Collapse All"}),e.jsx("button",{className:bn.nav.expandCollapseButton,onClick:()=>m(af(N).reduce((w,k)=>({...w,[k]:!0}),{})),children:"Expand All"}),e.jsx(Ex,{className:"cursor-pointer text-blue-400 hover:text-blue-500",onClick:()=>r(!1)})]}),e.jsx(Pa,{ref:p,items:N,collapsed:!0,onChange:h,maxDepth:4,renderItem:({item:w})=>S(w)}),s&&e.jsx(I9,{dataItems:t})]})}):e.jsx(Pn,{className:"cursor-pointer text-blue-400 hover:text-blue-500",onClick:()=>r(!0)})}function E9({selectedPage:t,isNavOpen:s,format:n,attributes:r,dataItems:a,apiLoad:l,apiUpdate:i,theme:c}){const[d,u]=b.useState();return b.useEffect(()=>{if(!t)return;async function m(){const p={format:n,children:[{type:()=>{},action:"view",filter:{stopFullDataLoad:!0,options:JSON.stringify({filter:{id:[t]}})},path:"view/:id",params:{id:t}}]},x=await l(p,`/view/${t}`);u(x[0])}m()},[t]),e.jsx("div",{className:bn.page.pageContainer(s),children:t&&d?e.jsx(Lh,{item:d,dataItems:a,attributes:r,apiLoad:l,apiUpdate:i,format:n,siteType:"prod",updateAttribute:m=>console.log("updateAttribute called",m),theme:{layout:{wrapper:"max-w-full"},page:{wrapper1:"max-w-full"}}}):e.jsx("div",{className:"text-center mt-16",children:"Please click on a page title to preview it."})})}function M9({item:t,dataItems:s,format:n,attributes:r,apiLoad:a,apiUpdate:l,...i}){var f,g;const{baseUrl:c,theme:d,user:u}=C.useContext(me)||{},[m,p]=b.useState(!0),[x,h]=b.useState();return e.jsx("div",{className:`${(f=d==null?void 0:d.page)==null?void 0:f.wrapper2}`,children:e.jsxs("div",{className:`${(g=d==null?void 0:d.page)==null?void 0:g.wrapper3} max-w-[100vw]`,children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"text-2xl p-3 font-thin flex-1",children:"Pages"})}),e.jsxs("div",{className:"flex w-full max-w-[85%] h-full overflow-hidden",children:[e.jsx(L9,{item:t,dataItems:s,open:m,setOpen:p,selectedPage:x,setSelectedPage:h,edit:!0}),e.jsx(E9,{selectedPage:x,setSelectedPage:h,format:n,attributes:r,apiLoad:a,apiUpdate:l,dataItems:s,isNavOpen:m,theme:d})]})]})})}function A9({themeOptions:t,theme:s,newTheme:n,setNewTheme:r,sectionKey:a,navKey:l,controlKey:i}){var d,u,m,p;let c=t[a][l].controls[i];return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"text-xs font-medium pt-1 text-slate-400",children:c.label}),e.jsx("div",{className:"w-full",children:e.jsx("select",{className:"p-2 bg-white w-full",value:((u=(d=n[a])==null?void 0:d[l])==null?void 0:u[i])||((p=(m=s[a])==null?void 0:m[l])==null?void 0:p[i]),onChange:x=>{r(Ze(pe(n),{[a]:{[l]:{[i]:x.target.value}}}))},children:c.options.map(x=>e.jsx("option",{value:x,children:x},x))})})]})}function T9({onSave:t,onCancel:s,item:n}){const r={name:"",icon:"",path:"",className:"",authLevel:"-1"};let[a,l]=C.useState(n||r);return C.useEffect(()=>{l(n||r)},[n]),e.jsxs("div",{children:[["name","icon","path","className","authLevel"].map(i=>e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium pt-1 text-slate-400",children:i}),e.jsx("div",{className:"w-full",children:e.jsx("input",{className:"p-2 bg-white w-full",value:a[i],onChange:c=>l({...a,[i]:c.target.value})})})]},i)),e.jsxs("div",{className:"flex justify-end py-2",children:[e.jsx("div",{className:"bg-slate-300 rounded px-2 py-1 text-slate-100 cursor-pointer",onClick:s,children:"Cancel"}),e.jsx("div",{className:"bg-blue-500 rounded px-2 py-1 text-white cursor-pointer ml-2",onClick:()=>t(a),children:"Save"})]})]})}function O9({onSave:t,onCancel:s,items:n}){let[r,a]=C.useState(JSON.stringify(n||[],null,3));return e.jsxs("div",{children:["(",e.jsx("div",{children:e.jsx("div",{className:"w-full",children:e.jsx("textarea",{className:"p-2 bg-white w-full",value:r,onChange:l=>a(l.target.value)})})}),e.jsxs("div",{className:"flex justify-end py-2",children:[e.jsx("div",{className:"bg-slate-300 rounded px-2 py-1 text-slate-100 cursor-pointer",onClick:s,children:"Cancel"}),e.jsx("div",{className:"bg-blue-500 rounded px-2 py-1 text-white cursor-pointer ml-2",onClick:()=>t(JSON.parse(r)||n),children:"Save"})]})]})}function D9({themeOptions:t,theme:s,newTheme:n,setNewTheme:r,sectionKey:a,navKey:l,controlKey:i}){var p,x;let[c,d]=C.useState(-2),u=t[a][l].controls[i],m=((x=(p=n==null?void 0:n[a])==null?void 0:p[l])==null?void 0:x[i])||[];return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"text-xs font-medium pt-1 text-slate-400 w-full flex justify-between",children:[e.jsxs("div",{className:"flex-1",children:[u.label," ",c]}),e.jsx("div",{children:e.jsx("button",{className:"bg-blue-500 rounded px-0.5 py-1 text-white cursor-pointer",onClick:()=>d(-3),children:"</>"})}),e.jsx("div",{children:e.jsx("button",{className:"bg-blue-500 rounded px-0.5 py-1 text-white cursor-pointer",onClick:()=>d(-1),children:"Add Item"})})]}),c===-3?e.jsx("div",{children:e.jsx(O9,{onCancel:h=>d(-2),items:m,onSave:h=>{r(Ze(pe(n),{[a]:{[l]:{[i]:h}}})),d(-2)}})}):e.jsx("div",{children:m.length===0?"No Items":m.map((h,f)=>e.jsxs("div",{className:"flex w-full text-sm items-center py-1 border-b",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-medium text-slate-600",children:h.name})," ",e.jsx("span",{className:"text-slate-400",children:h.path})]}),e.jsx("div",{onClick:()=>{console.log("pencil click",f),d(f)},children:e.jsx(Gl.PencilIcon,{className:"h-5 w-5 cursor-pointer text-slate-500 hover:text-blue-500"})}),e.jsx("div",{children:e.jsx(Gl.RemoveCircle,{onClick:()=>{console.log("menuItems",m),m.splice(f,1);let g=m;console.log("splice",g,f),r(Ze(pe(n),{[a]:{[l]:{[i]:g}}}))},className:"h-5 w-5 cursor-pointer text-slate-500 hover:text-red-500"})})]},f))}),e.jsx("div",{children:c!==-2?e.jsx(T9,{onCancel:h=>d(-2),item:m==null?void 0:m[c],onSave:h=>{const f=m;c===-1?f.push(h):f[c]=h,r(Ze(pe(n),{[a]:{[l]:{[i]:f}}})),d(-2)}}):""})]})}const B9={select:A9,menu:D9};function F9({item:t,dataItems:s,attributes:n,apiLoad:r,apiUpdate:a,format:l,logo:i,rightMenu:c,themes:d,...u}){var w,k,$,E,M,_;const{baseUrl:m,theme:p,user:x}=C.useContext(me)||{},[h,f]=C.useState({}),[g,y]=C.useState({}),v=Ze(pe(p),pe(d[((k=(w=h==null?void 0:h.settings)==null?void 0:w.theme)==null?void 0:k.theme)||"default"]),pe(h)),j={app:l.app,type:"pattern",attributes:[{key:"theme",type:"text"}]},N=C.useMemo(()=>Co(s,m,!1),[s]);C.useEffect(()=>{(async()=>{var O;const{app:D,type:A}=l;let T=await r({children:[{action:"list",path:"/*",filter:{options:JSON.stringify({filter:{"data->>'doc_type'":[l.type]}})}}],format:j});f(pe(((O=T==null?void 0:T[0])==null?void 0:O.theme)||{})),y(pe({theme:{},...T==null?void 0:T[0]}))})()},[]);function S(){a({data:{id:g.id,theme:h},config:{format:j}}),y({...g,theme:h})}return e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:"flex-1 h-full flex p-4 h-[calc(100vh_-_6rem)] overflow-y-auto",children:e.jsx(op,{className:"flex-1 h-[calc(100vh_-_6rem)] border",head:e.jsxs(e.Fragment,{children:[e.jsx("link",{href:"https://cdn.jsdelivr.net/npm/tailwindcss@2.2.15/dist/tailwind.min.css",rel:"stylesheet"}),e.jsx("link",{href:"/build.css",rel:"stylesheet"})]}),children:e.jsx(Rr,{navItems:N,secondNav:((E=($=h==null?void 0:h.navOptions)==null?void 0:$.secondaryNav)==null?void 0:E.navItems)||[],theme:v,children:e.jsx("div",{className:`${(M=v==null?void 0:v.page)==null?void 0:M.wrapper2}`,children:e.jsx("div",{className:`${(_=v==null?void 0:v.page)==null?void 0:_.wrapper3} `,children:"Placeholder Content"})})})})}),e.jsx(_h,{custom:"top-12 h-full",children:e.jsxs("div",{className:"border-l h-full",children:[e.jsxs("div",{className:"px-1 py-2 w-full flex justify-between items-center",children:[e.jsx("div",{children:"Design Options"}),e.jsx("div",{children:e.jsx("button",{onClick:S,disabled:Qe(g.theme,h),className:"bg-blue-500 disabled:bg-slate-300  disabled:border-slate-400  rounded px-3 border border-blue-400 shadow  py-1 text-white cursor-pointer mx-2",children:"Save"})})]}),e.jsx("div",{className:"border-t",children:Object.keys(Ss).map(L=>e.jsxs("div",{children:[L,Object.keys(Ss[L]).map(D=>e.jsx(lp,{as:"div",className:"border-b",defaultOpen:Ss[L][D].defaultOpen,children:({open:A})=>e.jsxs(e.Fragment,{children:[e.jsxs(ip,{className:"group flex w-full items-center justify-between p-1 ",children:[e.jsx("span",{className:"text-xs/6 font-bold text-slate-700 group-data-[hover]:text-slate-700/80",children:Ss[L][D].label}),e.jsx("span",{children:A?e.jsx(Yi,{className:"text-slate-400 h-6 w-6 mr-2"}):e.jsx(ds,{className:"text-slate-400 h-6 w-6 mr-2"})})]}),e.jsx(cp,{className:"text-xs/5 text-slate-700/50 py-1 px-2",children:Object.keys(Ss[L][D].controls).map(T=>{const O=B9[Ss[L][D].controls[T].type||"select"];return e.jsx("div",{children:e.jsx(O,{theme:p,newTheme:h,setNewTheme:f,themeOptions:Ss,sectionKey:L,navKey:D,controlKey:T})},`${L}_${D}_${T}`)})})]})},D))]},L))}),e.jsx("div",{children:e.jsx("pre",{className:"text-xs",children:JSON.stringify(h,null,3)})})]})})]})}const z9={app:"dms-site",type:"cms-section",attributes:[{key:"title",type:"text",required:!1,default:"Untitled Section"},{key:"is_header",type:"boolean",hidden:"true",required:!1},{key:"helpText",type:"lexical"},{key:"level",type:"select",options:[{value:"0",label:"Hidden"},{value:"1",label:"H1"},{value:"2",label:"H2"},{value:"3",label:"H3"},{value:"4",label:"H4"}],required:!1,default:"1"},{key:"tags",type:"text",required:!1},{key:"requirements",type:"text",required:!1},{key:"description",type:"text",required:!1},{key:"size",type:"text"},{key:"element",type:"selector",required:!1}]},P9={app:"dms-site",type:"page-edit",attributes:[{key:"action",type:"text"},{key:"user",type:"text"},{key:"time",type:"text"},{key:"parent_type",type:"text"}]},of={app:"dms-site",type:"docs-page",registerFormats:[z9,P9],defaultSearch:"data ->> 'index' = '0' and (data ->> 'parent' = '' or data ->> 'parent' is null) and (data ->> 'template_id' is null)",defaultSort:t=>t.sort((s,n)=>(n.parent===null)-(s.parent===null)||s.index-n.index||+s.parent-+n.parent),attributes:[{key:"title",type:"text",required:!0,default:"New Page"},{key:"template_id",type:"number"},{key:"data_controls",type:"text",hidden:!0},{key:"generated-pages",type:"text",isArray:!0},{key:"hide_in_nav",type:"text",default:!1},{key:"index",type:"number",default:"props:index",editable:!1,hidden:!0},{key:"parent",type:"text",default:"",editable:!1,hidden:!0},{key:"url_slug",type:"text",matchWildcard:!0,hidden:!0},{key:"sidebar",type:"text",hidden:!0},{key:"header",type:"text",hidden:!0},{key:"footer",type:"text",hidden:!0},{key:"full_width",type:"text",hidden:!0},{key:"navOptions",type:"json",hidden:!0},{key:"theme",type:"json",hidden:!0},{key:"section_groups",type:"json",hidden:!0},{key:"draft_section_groups",type:"json",hidden:!0},{key:"sections",type:"dms-format",isArray:!0,format:"dms-site+cms-section",DisplayComp:Od},{key:"draft_sections",type:"dms-format",isArray:!0,format:"dms-site+cms-section",DisplayComp:Od},{key:"published",type:"text",default:"draft"},{key:"has_changes",type:"boolean",default:!1},{key:"history",type:"dms-format",isArray:!0,format:"dms-site+page-edit"}]},R9=({user:t})=>e.jsx("div",{className:"h-[47px] w-[47px] border border-[#E0EBF0] rounded-full place-items-center content-center",children:e.jsx($x,{height:24,width:24})}),_u=({to:t,icon:s,children:n})=>e.jsx(ue,{to:t,children:e.jsx("div",{className:"px-6 py-1 bg-blue-500 text-white hover:text-blue-100",children:e.jsxs("div",{className:"hover:translate-x-2 transition duration-100 ease-out hover:ease-in",children:[e.jsx("i",{className:`${s} `}),e.jsx("span",{className:"pl-2",children:n})]})})}),lf=({title:t,children:s})=>{var c,d,u;const{user:n,baseUrl:r,theme:a}=C.useContext(me),l=Ge();let i=((d=(c=a==null?void 0:a.navOptions)==null?void 0:c.authMenu)==null?void 0:d.navItems)||[{name:"Datasets",icon:"fad fa-sign-out-alt pb-2 pr-1",path:"/datasets",authLevel:5},{name:"Manager",icon:"fad fa-sign-out-alt pb-2 pr-1",path:`${r}/manage`,authLevel:5}];return e.jsx(e.Fragment,{children:n.authed?e.jsx(wN,{control:e.jsx(R9,{user:n}),className:"",children:e.jsxs("div",{className:"p-1 bg-blue-500 z-30",children:[e.jsxs("div",{className:"text-white py-2",children:[e.jsx("div",{className:"text-md font-thin tracking-tighter text-left",children:n.email?n.email:""}),e.jsx("div",{className:"text-xs font-medium -mt-1 tracking-widest text-left",children:(u=n==null?void 0:n.groups)!=null&&u[0]?n.groups[0]:""}),i.map((m,p)=>e.jsx("div",{children:n.authLevel>=(+m.authLevel||-1)&&e.jsx(_u,{to:m.path,icon:m.icon,children:m.name})},p))]}),!n.fake&&e.jsx("div",{className:"py-1 border-t border-blue-400",children:e.jsx(_u,{to:"/auth/logout",icon:"fad fa-sign-out-alt pb-2 pr-1",children:"Logout"})})]})}):e.jsx(ue,{className:"flex items-center px-8 text-lg font-bold h-12 text-slate-500 px-4",to:"/auth/login",state:{from:l==null?void 0:l.pathname},children:"Login"})})},me=C.createContext(void 0),H9=({app:t="dms-site",type:s="docs-page",siteType:n,rightMenu:r=e.jsx(lf,{}),baseUrl:a="/",damaBaseUrl:l,logo:i,authLevel:c=-1,themes:d={default:{}},pattern:u,site:m,pgEnv:p,API_HOST:x})=>{var v,j,N,S;let h=Ze(pe($h),pe(d[(N=(j=(v=u==null?void 0:u.theme)==null?void 0:v.settings)==null?void 0:j.theme)==null?void 0:N.theme]||d.default),pe(u==null?void 0:u.theme)||{});a=a==="/"?"":a;const f=e.jsx(ue,{to:`${a||"/"}`,className:"h-12 flex px-4 items-center",children:e.jsx("div",{className:"rounded-full h-8 w-8 bg-blue-500 border-2 border-blue-300 hover:bg-blue-600"})});(S=h==null?void 0:h.navOptions)!=null&&S.logo||(h.navOptions={...(h==null?void 0:h.navOptions)||{},logo:i||f});const g=pe(of);g.app=t,g.type=s,No(g.registerFormats,t,s),Xi(g.attributes,t,s);const y={email:"user",authLevel:10,authed:!0,fake:!0};return{siteType:n,format:g,baseUrl:a,API_HOST:x,children:[{type:({children:w,user:k=y,...$})=>{const{falcor:E,falcorCache:M}=Gt.useFalcor();return e.jsx(me.Provider,{value:{API_HOST:x,baseUrl:a,damaBaseUrl:l,user:k,theme:h,falcor:E,falcorCache:M,pgEnv:p,app:t,type:s,siteType:n,Menu:()=>e.jsx(e.Fragment,{children:r})},children:w})},authLevel:c,action:"list",path:"/*",filter:{options:JSON.stringify({filter:{"data->>'template_id'":["null"]}}),attributes:["title","index","url_slug","parent","published","description","icon","navOptions","hide_in_nav"]},children:[{type:w=>e.jsx(Lh,{...w}),path:"edit/*",action:"edit",authLevel:5},{type:w=>e.jsx(jN,{...w}),filter:{attributes:["title","index","url_slug","parent","published","hide_in_nav","sections","section_groups","sidebar","navOptions"]},path:"/*",action:"view"},{type:w=>e.jsx(eC,{...w}),path:"search/*",action:"list"}]}]}},W9=({app:t="dms-site",type:s="docs-page",siteType:n,rightMenu:r=e.jsx(lf,{}),baseUrl:a="/",damaBaseUrl:l,logo:i,authLevel:c=-1,themes:d={default:{}},pattern:u,site:m,pgEnv:p,API_HOST:x})=>{var v,j,N,S,w,k;let h=$h;a=a==="/"?"":a;const f=((w=(S=pe(d[(N=(j=(v=u==null?void 0:u.theme)==null?void 0:v.settings)==null?void 0:j.theme)==null?void 0:N.theme]||d.default))==null?void 0:S.navOptions)==null?void 0:w.logo)||e.jsx(ue,{to:`${a||"/"}`,className:"h-12 flex px-4 items-center",children:e.jsx("div",{className:"rounded-full h-8 w-8 bg-blue-500 border-2 border-blue-300 hover:bg-blue-600"})});(k=h==null?void 0:h.navOptions)!=null&&k.logo||(h.navOptions={...(h==null?void 0:h.navOptions)||{},logo:i||f}),h.navOptions.sideNav.size="compact",h.navOptions.sideNav.nav="main",h.navOptions.topNav.nav="none";const g=pe(of);g.app=t,g.type=s,No(g.registerFormats,t,s),Xi(g.attributes,t,s);const y={email:"user",authLevel:5,authed:!0,fake:!0};return{siteType:n,format:g,baseUrl:`${a}/manage`,API_HOST:x,children:[{type:({children:$,user:E=y,...M})=>{const{falcor:_,falcorCache:L}=Gt.useFalcor();return e.jsx(me.Provider,{value:{API_HOST:x,baseUrl:a,damaBaseUrl:l,user:E,theme:h,falcor:_,falcorCache:L,pgEnv:p,app:t,type:s,siteType:n,Menu:()=>e.jsx(e.Fragment,{children:r})},children:e.jsx(S9,{...M,children:$})})},authLevel:c,action:"list",path:"/*",filter:{options:JSON.stringify({filter:{"data->>'hide_in_nav'":["null"]}}),attributes:["title","index","url_slug","parent","published","hide_in_nav"]},children:[{type:_9,path:"",action:"edit"},{type:$=>e.jsx(F9,{themes:d,...$}),path:"design",action:"edit"},{type:M9,path:"pages",action:"edit"},{type:WN,action:"list",path:"templates/*",lazyLoad:!0,filter:{options:JSON.stringify({filter:{"data->>'template_id'":["-99"]}}),attributes:["title","index","url_slug","parent","hide_in_nav","template_id"]}},{type:N9,action:"edit",path:"templates/edit/:id"},{type:l6,action:"edit",path:"templates/pages/:id"}]}]}},V9=[H9,W9];function U9(t){const s=(t==null?void 0:t.dataItems[0])||{},n=s==null?void 0:s.id;return e.jsxs("div",{className:"p-10 max-w-5xl h-dvh",children:[e.jsxs("div",{className:"w-full flex justify-between border-b-2 border-blue-400",children:[e.jsx("div",{className:"text-2xl font-semibold text-gray-700",children:"Patterns Hola"}),e.jsx(ue,{to:`edit/${n}`,children:"Edit Site"})]}),e.jsxs("div",{className:"font-semibold",children:["Site Name: ",(s==null?void 0:s.site_name)||"No Site Name"]},s==null?void 0:s.site_name),e.jsxs("div",{className:"py-5",children:[e.jsx("div",{className:"py-2 font-semibold text-l",children:"Current Patterns"}),e.jsxs("div",{className:"font-light divide-y-2",children:[e.jsxs("div",{className:"font-semibold grid grid-cols-4 ",children:[e.jsx("div",{children:"Pattern Type"}),e.jsx("div",{children:"Doc Type"}),e.jsx("div",{children:"Auth Level"}),e.jsx("div",{children:"Base Url"}),e.jsx("div",{})]}),((s==null?void 0:s.patterns)||[]).map(r=>e.jsxs("div",{className:"grid grid-cols-4 ",children:[e.jsx("div",{children:r.pattern_type}),e.jsx("div",{children:r.doc_type}),e.jsx("div",{children:r.authLevel}),e.jsxs(ue,{to:r.base_url,children:[r.base_url," ok?"]}),e.jsx(ue,{to:`/manage_pattern/${r.id}`,children:"Manage"})]},r.id))]})]})]})}function q9({Component:t,attributes:s={},updateAttribute:n,status:r,onSubmit:a,onChange:l,value:i=[],format:c,...d}){const[u,m]=b.useState({app:c==null?void 0:c.app}),[p,x]=b.useState(void 0),[h,f]=b.useState(void 0),[g,y]=b.useState(),v=Object.keys(s).filter(w=>["pattern_type","doc_type","subdomain","base_url","authLevel"].includes(w)),j=v.length,N=w=>{const k=[...i,w||u];l(k),a(k),m({app:c==null?void 0:c.app})},S={1:"grid grid-cols-1",2:"grid grid-cols-2",3:"grid grid-cols-3",4:"grid grid-cols-4",5:"grid grid-cols-5",6:"grid grid-cols-6",7:"grid grid-cols-7",8:"grid grid-cols-8",9:"grid grid-cols-9",10:"grid grid-cols-10",11:"grid grid-cols-11"};return e.jsxs("div",{className:"flex flex-col p-10 w-full divide-y-2",children:[e.jsxs("div",{className:"w-full flex justify-between border-b-2 border-blue-400",children:[e.jsx("div",{className:"text-2xl font-semibold text-gray-700",children:"Patterns"}),e.jsx("button",{onClick:()=>navigate(-1),children:"back"})]}),e.jsxs("div",{className:`font-semibold ${S[j+1]}`,children:[v.map(w=>e.jsx("div",{children:w},w)),e.jsx("div",{children:"Actions"})]}),i.map((w,k)=>e.jsxs("div",{className:`${S[j+1]} ${g===k?"bg-gray-100":""} items-center px-2`,children:[v.filter($=>$!=="config").map($=>{let E=s[$].EditComp;return p===k?e.jsx(E,{value:h==null?void 0:h[$],onChange:M=>f({...h,app:c.app,[$]:M}),...s[$]},`${$}-${k}`):$==="base_url"?e.jsx(ue,{to:`${w[$]}`,children:w[$]}):e.jsx("div",{children:w[$]})}),e.jsxs("div",{className:"w-full flex items-center justify-start",children:[e.jsx(ue,{className:"bg-blue-100 hover:bg-blue-300 text-sm text-blue-800 px-2 py-0.5 m-1 rounded-lg w-fit h-fit",to:`${w.base_url==="/"?"":w.base_url}/manage/metadata`,children:"manage"}),e.jsx("button",{className:"bg-blue-100 hover:bg-blue-300 text-sm text-blue-800 px-2 py-0.5 m-1 rounded-lg w-fit h-fit",title:"edit item",onClick:()=>{x(p===k?void 0:k),f(p===k?void 0:w)},children:p===k?"cancel":"edit"}),p===k&&e.jsx("button",{className:"bg-blue-100 hover:bg-blue-300 text-sm text-blue-800 px-2 py-0.5 m-1 rounded-lg w-fit h-fit",title:"done editing",onClick:()=>{var $;i.splice(k,1,h),l(i),x(p===k?void 0:k),f(p===k?void 0:w),console.log("test123 ",i),i[0].base_url=`/${($=i[0].base_url)==null?void 0:$.replace(/^\/|\/$/g,"")}`,a(i)},children:"done"}),e.jsxs("div",{className:"relative w-fit",children:[e.jsx(j5,{className:`p-1 hover:cursor-pointer hover:bg-gray-100 ${g===k?"bg-gray-200":""} rounded-full`,height:24,width:24,onClick:()=>y(g===k?void 0:k)}),e.jsxs("div",{className:g===k?"z-10 absolute p-1 flex flex-col right-0 top-8 bg-white text-sm border rounded-md shadow-md":"hidden",children:[e.jsx("button",{className:"bg-green-100 hover:bg-green-300 text-green-800 px-2 py-0.5 my-1 rounded-lg w-full h-fit",title:"duplicate item",onClick:()=>{const $=JSON.stringify({app:w.app,base_url:`${w.base_url}_copy`,subdomain:w.subdomain,config:w.config,doc_type:`${w.doc_type}_copy`,pattern_type:w.pattern_type,auth_level:w.auth_level});N($)},children:" duplicate"}),e.jsx("div",{className:"w-full border-b-2 border-red-300"}),e.jsx("button",{className:"bg-red-100 hover:bg-red-300 text-red-800 px-2 py-0.5 my-1 rounded-lg w-full h-fit",title:"remove item",onClick:()=>{const $=i.filter((E,M)=>M!==k);l($),a($)},children:" remove"})]})]})]})]},w.id)),e.jsxs("div",{className:`${S[j+1]}`,children:[v.map((w,k)=>{let $=s[w].EditComp;return e.jsx($,{value:u==null?void 0:u[w],onChange:E=>m({...u,[w]:E}),...s[w]},`${w}-${k}`)}),e.jsx("div",{className:"w-full flex items-center justify-start",children:e.jsx("button",{className:"bg-blue-100 hover:bg-blue-300 text-sm text-blue-800 px-2 py-0.5 m-1 rounded-lg w-fit h-fit",onClick:()=>N(u),children:"Add"})})]})]})}const G9={EditComp:q9,ViewComp:U9};function J9({label:t,value:s,placeholder:n="",onChange:r}){return e.jsxs("div",{className:"w-full [&>[data-slot=label]+[data-slot=control]]:mt-3 [&>[data-slot=label]+[data-slot=description]]:mt-1 [&>[data-slot=description]+[data-slot=control]]:mt-3 [&>[data-slot=control]+[data-slot=description]]:mt-3 [&>[data-slot=control]+[data-slot=error]]:mt-3 [&>[data-slot=label]]:font-medium","data-headlessui-state":"",children:[t&&e.jsx("label",{"data-slot":"label",className:"select-none text-base/6 text-zinc-950 data-[disabled]:opacity-50 sm:text-sm/",children:t}),e.jsx("span",{"data-slot":"control",className:"relative block w-full before:absolute before:inset-px before:rounded-[calc(theme(borderRadius.lg)-1px)] before:bg-white before:shadow dark:before:hidden after:pointer-events-none after:absolute after:inset-0 after:rounded-lg after:ring-inset after:ring-transparent sm:after:focus-within:ring-2 sm:after:focus-within:ring-blue-500 has-[[data-disabled]]:opacity-50 before:has-[[data-disabled]]:bg-zinc-950/5 before:has-[[data-disabled]]:shadow-none before:has-[[data-invalid]]:shadow-red-500/10",children:e.jsx("input",{value:s,placeholder:n,onChange:r,className:"relative border shadow block w-full appearance-none rounded-lg px-[calc(theme(spacing[3.5])-1px)] py-[calc(theme(spacing[2.5])-1px)] sm:px-[calc(theme(spacing[3])-1px)] sm:py-[calc(theme(spacing[1.5])-1px)] text-base/6 text-zinc-950 placeholder:text-zinc-500 sm:text-sm/ border border-zinc-950/10 data-[hover]:border-zinc-950/20 dark:border-white/10 dark:data-[hover]:border-white/20 bg-transparent dark:bg-white/5 focus:outline-none data-[invalid]:border-red-500 data-[invalid]:data-[hover]:border-red-500 data-[invalid]:dark:border-red-500 data-[invalid]:data-[hover]:dark:border-red-500 data-[disabled]:border-zinc-950/20 dark:data-[hover]:data-[disabled]:border-white/15 data-[disabled]:dark:border-white/15 data-[disabled]:dark:bg-white/[2.5%]","data-autofocus":""})})]})}function X9({children:t,onClick:s}){return e.jsxs("button",{onClick:s,className:"w-full relative isolate inline-flex items-center justify-center gap-x-2 rounded-lg border text-base/6 font-semibold hover:bg-zinc-300  cursor-pointer px-[calc(theme(spacing[3.5])-1px)] py-[calc(theme(spacing[2.5])-1px)] sm:px-[calc(theme(spacing.3)-1px)] sm:py-[calc(theme(spacing[1.5])-1px)] sm:text-sm/6 focus:outline-none data-[focus]:outline data-[focus]:outline-2 data-[focus]:outline-offset-2 data-[focus]:outline-blue-500 data-[disabled]:opacity-50 [&>[data-slot=icon]]:-mx-0.5 [&>[data-slot=icon]]:my-0.5 [&>[data-slot=icon]]:size-5 [&>[data-slot=icon]]:shrink-0 [&>[data-slot=icon]]:text-[--btn-icon] [&>[data-slot=icon]]:sm:my-1 [&>[data-slot=icon]]:sm:size-4 forced-colors:[--btn-icon:ButtonText] forced-colors:data-[hover]:[--btn-icon:ButtonText] border-transparent bg-[--btn-border] before:absolute before:inset-0 before:-z-10 before:rounded-[calc(theme(borderRadius.lg)-1px)] before:bg-[--btn-bg] before:shadow  after:absolute after:inset-0 after:-z-10 after:rounded-[calc(theme(borderRadius.lg)-1px)] after:shadow-[shadow:inset_0_1px_theme(colors.white/15%)] after:data-[active]:bg-[--btn-hover-overlay] after:data-[hover]:bg-[--btn-hover-overlay] before:data-[disabled]:shadow-none after:data-[disabled]:shadow-none text-white [--btn-bg:theme(colors.zinc.900)] [--btn-border:theme(colors.zinc.950/90%)] [--btn-hover-overlay:theme(colors.white/10%)] dark:text-white dark:[--btn-bg:theme(colors.zinc.600)] dark:[--btn-hover-overlay:theme(colors.white/5%)] [--btn-icon:theme(colors.zinc.400)] data-[active]:[--btn-icon:theme(colors.zinc.300)]  cursor-default",type:"button","data-headlessui-state":"",children:[t,e.jsx("span",{className:"absolute left-1/2 top-1/2 size-[max(100%,2.75rem)] -translate-x-1/2 -translate-y-1/2 [@media(pointer:fine)]:hidden","aria-hidden":"true"})]})}function Iu({icon:t,className:s}){return e.jsx("div",{className:`${s} flex justify-center items-center`,children:e.jsx("span",{className:t})})}const Z9=()=>({}),Bo=({i:t=0,children:s,icon:n,to:r,onClick:a,className:l=null,type:i="side",active:c=!1,subMenus:d=[],themeOptions:u,subMenuActivate:m="onClick",subMenuOpen:p=!1})=>{const{theme:x}=C.useContext(us)||{},h=((x==null?void 0:x[i==="side"?"sidenav":"topnav"])||Z9)(u),f=Le(),g=C.useMemo(()=>Array.isArray(r)?r:[r],[r]),y=C.useMemo(()=>{const _=d.reduce((L,D)=>(Array.isArray(D.path)?L.push(...D.path):D.path&&L.push(D.path),L),[]);return[...g,..._]},[g,d]),v=!!_r({path:`${y[0]}/*`||"",end:!0}),j=i==="side"?h.navitemSide:h.navitemTop,N=i==="side"?h.navitemSideActive:h.navitemTopActive,S=v||c,w=S?N:j,[k,$]=C.useState(p||v),[E,M]=C.useState(!1);return b.useEffect(()=>{$(v)},[v,k,r]),e.jsx("div",{className:i==="side"?h.subMenuParentWrapper:null,onMouseOutCapture:()=>m==="onHover"&&$(!1)||m!=="onHover"&&M(!1)&&$(!1),onMouseMove:()=>m==="onHover"&&$(!0)||m!=="onHover"&&M(!0)&&$(!0),children:e.jsx("div",{className:`${l||w}`,onClick:_=>{if(_.stopPropagation(),a)return a(g[0]);g[0]&&f(g[0])},children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex-1 flex",children:[n?e.jsx(Iu,{icon:n,className:i==="side"?S?h.menuIconSideActive:h.menuIconSide:S?h.menuIconTopActive:h.menuIconTop}):null,e.jsx("div",{className:h.navItemContent,children:s})]}),e.jsx("div",{onClick:()=>{m==="onClick"&&$(!k)},children:d.length?e.jsx(Iu,{icon:k?h.indicatorIconOpen:h.indicatorIcon}):null}),d.length?e.jsx(Y9,{i:t,showSubMenu:k,subMenuActivate:m,active:v,hovering:E,subMenus:d,type:i,themeOptions:u,className:l}):""]})})})},Y9=({i:t,showSubMenu:s,subMenus:n,type:r,hovering:a,subMenuActivate:l,active:i,themeOptions:c})=>{const{theme:d}=C.useContext(us),u=d[r==="side"?"sidenav":"topnav"](c),m=!i&&l!=="onHover"&&a;return(!s||!n.length)&&!m?null:e.jsx("div",{className:r==="side"?u.subMenuWrapper:m&&t===0?u.subMenuWrapperInactiveFlyout:m&&t>0?u.subMenuWrapperInactiveFlyoutBelow:u.subMenuWrapperTop,children:e.jsx("div",{className:`
							${m&&u.subMenuWrapperInactiveFlyoutDirection}
							${!m&&u.subMenuWrapperChild}
					flex ${r==="side"||m?"flex-col":"flex-row"}
				`,children:n.map((p,x)=>e.jsx(Bo,{i:x+1,to:p.path,icon:p.icon,type:r,className:p.className,onClick:p.onClick,themeOptions:c,subMenus:p.subMenus,children:p.name},x))})})},cf=()=>({}),df=({open:t,toggle:s,menuItems:n=[],rightMenu:r=null,themeOptions:a={}})=>{const{theme:l}=C.useContext(us)||{},i=((l==null?void 0:l.topnav)||cf)(a);return e.jsxs("div",{className:`${t?"md:hidden":"hidden"} ${i.topnavMobileContainer}`,id:"mobile-menu",children:[e.jsx("div",{className:"",children:n.map((c,d)=>e.jsx(Bo,{type:"top",to:c.path,icon:c.icon,themeOptions:a,subMenus:ne(c,"subMenus",[]),children:c.name},d))}),e.jsx("div",{className:"",children:r})]})},Q9=({open:t,toggle:s,menuItems:n=[],rightMenu:r=null,leftMenu:a=null,subMenuActivate:l,themeOptions:i={}})=>{const{theme:c}=C.useContext(us)||{},d=((c==null?void 0:c.topnav)||cf)(i);return e.jsx("div",{className:`${d.topnavWrapper}`,children:e.jsxs("div",{className:`${d.topnavContent} justify-between`,children:[e.jsx("div",{children:a}),e.jsx("div",{className:`${d.topnavMenu}`,children:n.map((u,m)=>e.jsx(Bo,{type:"top",to:u.path,icon:u.icon,subMenuActivate:l,themeOptions:i,subMenus:ne(u,"subMenus",[]),children:u.name},m))}),e.jsxs("div",{className:"flex items-center justify-center h-full",children:[e.jsx("div",{className:`${d.topmenuRightNavContainer}`,children:r}),e.jsxs("button",{type:"button",className:`${d.mobileButton}`,onClick:()=>s(!t),children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("div",{className:"flex justify-center items-center text-2xl",children:e.jsx("span",{className:t?d.menuCloseIcon:d.menuOpenIcon})})]})]})]})})},K9=({...t})=>{const[s,n]=b.useState(!1);return e.jsxs("nav",{children:[e.jsx(Q9,{open:s,toggle:n,...t}),e.jsx(df,{open:s,...t})]})},e7=()=>({}),uf=({i:t,item:s,themeOptions:n,subMenuActivate:r})=>e.jsx(Bo,{to:s.path,icon:s.icon,className:s.className,onClick:s.onClick,themeOptions:n,subMenuActivate:r,subMenus:ne(s,"subMenus",[]),children:s.name},t),t7=({open:t,toggle:s,logo:n=null,topMenu:r,menuItems:a=[],bottomMenu:l,themeOptions:i={},subMenuActivate:c,subMenuStyle:d,...u})=>{const{theme:m}=C.useContext(us)||{},p=((m==null?void 0:m.sidenav)||e7)(i);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden",onClick:()=>s(!t),children:e.jsx("span",{className:t?p.menuIconOpen:p.menuIconClosed})}),e.jsxs("div",{style:{display:t?"block":"none"},className:"md:hidden",children:[e.jsx("div",{className:"fixed inset-0 z-20 transition-opacity ease-linear duration-300",children:e.jsx("div",{className:"absolute inset-0 opacity-75"})}),e.jsx("div",{className:`fixed inset-0 flex z-40 ${p.contentBgAccent}`,children:e.jsxs("div",{className:`flex-1 flex flex-col max-w-xs w-full transform ease-in-out duration-300 ${p.contentBg}`,children:[e.jsx("div",{className:"absolute top-0 right-0 -mr-14 p-1",children:e.jsx("button",{onClick:()=>s(!t),className:"flex items-center justify-center h-12 w-12 rounded-full focus:outline-none focus:bg-gray-600 os-icon os-icon-x"})}),e.jsxs("div",{className:"flex-1 h-0 pt-2 pb-4 overflow-y-auto overflow-x-hidden",children:[e.jsx("div",{className:"px-6 pt-4 pb-8 logo-text gray-900",children:e.jsx(ue,{to:"/",className:`flex-shrink-0 flex items-center ${p.text}`,children:n})}),e.jsx("div",{children:r}),e.jsx("nav",{className:"flex-1",children:a.map((x,h)=>e.jsx("div",{className:x.sectionClass,children:uf({i:h,themeOptions:i,subMenuActivate:c})},h))}),e.jsx("div",{children:l})]})]})})]})]})},s7=({menuItems:t=[],logo:s=null,topMenu:n,bottomMenu:r,toggle:a,open:l,mobile:i,themeOptions:c={},subMenuActivate:d,subMenuStyle:u,...m})=>{const{theme:p}=C.useContext(us),x=p.sidenav(c);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`${x.sidenavWrapper}`,children:[n,e.jsx("nav",{className:`${x.itemsWrapper}`,children:t.map((h,f)=>uf({i:f,item:h,themeOptions:c,subMenuActivate:d}))}),r]}),i==="side"?"":e.jsx("div",{className:`${x.topnavWrapper} md:hidden`,children:e.jsxs("div",{className:`${x.topnavContent} justify-between`,children:[e.jsx("div",{children:n}),e.jsxs("div",{className:"flex items-center justify-center h-full",children:[e.jsx("div",{className:`${x.topmenuRightNavContainer}`,children:r}),e.jsxs("button",{type:"button",className:x.mobileButton,onClick:()=>a(!l),children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("div",{className:"flex justify-center items-center text-2xl",children:e.jsx("span",{className:l?x.menuCloseIcon:x.menuOpenIcon})})]})]})]})})]})},n7=t=>{const[s,n]=b.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(s7,{...t,open:s,toggle:n}),t.mobile==="side"?e.jsx(t7,{open:s,toggle:n,...t}):e.jsx(df,{open:s,...t,themeOptions:{}})]})};let r7={none:"",micro:"mr-14",mini:"mr-20",miniPad:"mr-0",compact:"mr-44",full:"mr-64"},a7={none:"",micro:"w-14",mini:"w-20",miniPad:"w-0",compact:"w-44",full:"w-64"};const o7=()=>e.jsx("div",{className:"h-12"}),ca=()=>e.jsx("div",{className:"h-12"}),l7=({children:t,navItems:s=[],title:n})=>{var p,x,h;const{theme:r,app:a,type:l}=C.useContext(us)||{},{sideNav:i={},topNav:c={},logo:d=o7}=(r==null?void 0:r.navOptions)||{},u={size:i.size||"none",color:i.color||"white",menuItems:((i==null?void 0:i.nav)==="main"?s:[]).filter(f=>!f.hideInNav),topMenu:e.jsxs("div",{className:"flex flex-row md:flex-col",children:[(i==null?void 0:i.logo)==="top"&&d,(i==null?void 0:i.dropdown)==="top"&&e.jsx(ca,{})]}),bottomMenu:e.jsx("div",{className:"flex flex-row md:flex-col",children:(i==null?void 0:i.dropdown)==="bottom"&&e.jsx(ca,{})})},m={position:c.position||"block",size:c.size||"compact",menu:c.menu||"left",subMenuStyle:c.subMenuStyle||"row",menuItems:((c==null?void 0:c.nav)==="main"?s:[]).filter(f=>!f.hideInNav),leftMenu:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[(c==null?void 0:c.logo)==="left"&&d,(c==null?void 0:c.dropdown)==="left"&&e.jsx(ca,{})]}),rightMenu:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[c==null?void 0:c.rightMenu,(c==null?void 0:c.dropdown)==="right"&&e.jsx(ca,{})]})};return u.logo,e.jsxs("div",{className:"flex",children:[u.size==="none"?"":e.jsx("div",{className:`hidden md:block ${r7[u.size]}`,children:e.jsx("div",{className:`fixed h-screen ${a7[u.size]}`,children:e.jsx(n7,{topMenu:u.topMenu,themeOptions:u,menuItems:u.menuItems})})}),e.jsxs("div",{className:"flex-1 flex items-start flex-col items-stretch w-full min-h-screen ",children:[m.size==="none"?"":e.jsx(e.Fragment,{children:e.jsx("div",{className:`${m.position==="fixed"?"sticky top-0 z-20 w-full ":"z-10"}`,children:e.jsx(K9,{themeOptions:m,leftMenu:m.leftMenu,menuItems:m.menuItems,rightMenu:m.rightMenu})})}),e.jsx("div",{id:"content",className:"flex-1",children:e.jsx("div",{className:`${(p=r==null?void 0:r.page)==null?void 0:p.wrapper1}`,children:e.jsx("div",{className:`${(x=r==null?void 0:r.page)==null?void 0:x.wrapper2}`,children:e.jsx("div",{className:(h=r==null?void 0:r.page)==null?void 0:h.wrapper3,children:t})})})})]})]})};function i7({apiUpdate:t}){const[s,n]=C.useState({site_name:"",patterns:[]});function r(){var a;((a=s==null?void 0:s.site_name)==null?void 0:a.length)>3&&t({data:s})}return e.jsx("div",{className:"h-screen w-screen bg-slate-100 flex items-center justify-center",children:e.jsxs("div",{className:"w-[316px] h-[250px] -mt-[200px] bg-white shadow rounded p-4 flex flex-col justify-between",children:[e.jsx(J9,{label:"Create Your Site",placeholder:"Site Name",value:s.site_name,onChange:a=>n({...s,site_name:a.target.value})}),e.jsx("div",{children:e.jsx(X9,{onClick:r,children:"Create"})})]})})}function c7({item:t={},dataItems:s,attributes:n,updateAttribute:r,status:a,apiUpdate:l,format:i}){const{baseUrl:c,theme:d,user:u}=C.useContext(us)||{},m=(x,h)=>{l({data:{...t,[h]:x},config:{format:i}})};if(!t.id&&(s==null?void 0:s.length)>0&&(t=s[0]),!t.id)return e.jsx(i7,{apiUpdate:l});const p=[{name:e.jsx("div",{className:"",children:"Dashboard"}),className:""},{name:"manage sites",className:"px-6 pb-1 pt-4 uppercase text-xs text-blue-400"}];return t.patterns.forEach(x=>{p.push({name:e.jsx("div",{className:"w-full flex-1 flex items-center",children:e.jsx(ue,{to:`${x.base_url==="/"?"":x.base_url}/manage`,className:"flex-1",children:x.doc_type})})})}),e.jsx(e.Fragment,{children:Object.keys(n).map((x,h)=>{let f=n[x].EditComp;return e.jsx("div",{children:e.jsx(f,{value:t==null?void 0:t[x],onChange:g=>r(x,g),onSubmit:g=>{m(g,x)},format:i,attributes:n[x].attributes},`${x}-${h}`)},`${x}-${h}`)})})}const d7=({item:t,Component:s,attributes:n={},updateAttribute:r,status:a,submit:l,onChange:i,value:c=[],format:d,...u})=>{const[m,p]=b.useState({}),[x,h]=b.useState(void 0),[f,g]=b.useState(void 0),y=Object.keys(n).filter(S=>!["sections"].includes(S)),v=y.length,j=()=>{const S=[...c,m];i(S),l(S),p({})},N={1:"grid grid-cols-1",2:"grid grid-cols-2",3:"grid grid-cols-3",4:"grid grid-cols-4",5:"grid grid-cols-5",6:"grid grid-cols-6",7:"grid grid-cols-7",8:"grid grid-cols-8",9:"grid grid-cols-9",10:"grid grid-cols-10",11:"grid grid-cols-11"};return e.jsxs("div",{className:"w-full",children:[a?e.jsx("div",{children:JSON.stringify(a)}):"",e.jsxs("div",{className:`font-semibold ${N[v+1]}`,children:[y.map(S=>e.jsx("div",{children:S})),e.jsx("div",{children:"Actions"})]}),c.map((S,w)=>e.jsxs("div",{className:N[v+1],children:[y.filter(k=>k!=="config").map(k=>{let $=n[k].EditComp;return x===w?e.jsx($,{value:f==null?void 0:f[k],onChange:E=>g({...f,[k]:E}),...n[k]},`${k}-${w}`):e.jsx("div",{children:typeof S[k]=="object"?"Invalid state":S[k]})}),e.jsxs("div",{className:"w-full flex items-center justify-start",children:[e.jsx("button",{className:"bg-blue-100 hover:bg-blue-300 text-blue-800 px-2 py-0.5 m-1 rounded-lg w-fit h-fit",title:"edit item",onClick:()=>{h(x===w?void 0:w),g(x===w?void 0:S)},children:x===w?"cancel":"edit"}),x===w&&e.jsx("button",{className:"bg-blue-100 hover:bg-blue-300 text-blue-800 px-2 py-0.5 m-1 rounded-lg w-fit h-fit",title:"done editing",onClick:()=>{c.splice(w,1,f),i(c),h(x===w?void 0:w),g(x===w?void 0:S),l(c)},children:"done"}),e.jsx("button",{className:"bg-red-100 hover:bg-red-300 text-red-800 px-2 py-0.5 mx-1 rounded-lg w-fit h-fit",title:"remove item",onClick:()=>{const k=c.filter(($,E)=>E!==w);i(k),l(k)},children:" remove"})]})]},S.id)),e.jsxs("div",{className:`${N[v+1]}`,children:[y.map((S,w)=>{let k=n[S].EditComp;return e.jsx("div",{className:"w-full font-semibold",children:e.jsx(k,{value:m==null?void 0:m[S],onChange:$=>p({...m,[S]:$}),...n[S]},`${S}-${w}`)},`${S}-${w}`)}),e.jsx("button",{className:"bg-blue-100 hover:bg-blue-300 text-blue-800 px-2 py-0.5 m-1 rounded-lg w-fit h-fit",onClick:j,children:"add"})]})]},t==null?void 0:t.id)},u7=({status:t,attributes:s,dataItems:n,format:r,item:a,user:l,params:i,submit:c,...d})=>e.jsx("div",{className:"w-full",children:Object.keys(s).map((u,m)=>{let p=s[u].ViewComp;return e.jsx("div",{children:e.jsx(p,{value:a==null?void 0:a[u],format:r,...s[u]},`${u}-${m}`)},`${u}-${m}`)})},a.id),m7={EditComp:d7,ViewComp:u7},p7={app:"admin",type:"pattern",registerFormats:[],attributes:[{key:"pattern_type",type:"select",required:!0,default:"page",options:[{value:"page",label:"Page"},{value:"forms",label:"Forms"}]},{key:"doc_type",placeholder:"Doc Type",type:"text",required:!0},{key:"base_url",placeholder:"Base URL",type:"text",required:!0},{key:"subdomain",placeholder:"Subdomain",type:"text",required:!0},{key:"authLevel",placeholder:"-1",type:"text",required:!0},{key:"config",placeholder:"please select a type",type:"config"},{key:"description",placeholder:"Description",type:"lexical",required:!0},{key:"categories",placeholder:"Categories",type:"text",required:!0},{key:"theme",placeholder:"",type:"config"},{key:"templates",type:"dms-format",isArray:!0,format:"admin+template",DisplayComp:m7}]},x7={app:"admin",type:"pattern-admin",registerFormats:[p7],attributes:[{key:"site_name",placeholder:"Site Name",type:"text",hidden:!0},{key:"patterns",type:"dms-format",isArray:!0,format:"admin+pattern",DisplayComp:G9}]},h7=(t={})=>{let{color:s="white",size:n="compact",subMenuStyle:r="inline",responsive:a="top"}=t,l={top:"hidden md:block",side:"hidden md:block",none:""},i={white:{contentBg:"bg-slate-100 border-r",sideItemActive:"",contentBgAccent:"bg-neutral-100",accentColor:"blue-600",accentBg:"",borderColor:"border-slate-200",textColor:"text-slate-600",textColorAccent:"text-slate-800",highlightColor:"text-blue-800"},transparent:{contentBg:"",contentBgAccent:"bg-neutral-100",accentColor:"blue-600",accentBg:"hover:bg-blue-400",borderColor:"border-slate-100",textColor:"text-slate-600",textColorAccent:"text-slate-800",highlightColor:"text-slate-800"},dark:{contentBg:"bg-neutral-800",contentBgAccent:"bg-neutral-900",accentColor:"white",accentBg:"",borderColor:"border-neutral-700",textColor:"text-slate-300",textColorAccent:"text-slate-100",highlightColor:"text-slate-100",sideItem:"text-slate-300 hover:text-white",sideItemActive:"text-slate-300 hover:text-white"},bright:{contentBg:"bg-blue-700",accentColor:"blue-400",accentBg:"hover:bg-blue-400",borderColor:"border-blue-600",textColor:"text-white",highlightColor:"text-white-500"}},c={none:{wrapper:"w-0 overflow-hidden",sideItem:"flex mx-2 pr-4 py-2 text-base ",topItem:"flex items-center text-sm px-4 border-r h-12",icon:"mr-3 text-lg"},compact:{fixed:"ml-0 md:ml-44",wrapper:"w-44",itemWrapper:"pt-5",sideItem:"group flex px-3 py-1.5 text-[14px] font-light hover:bg-blue-100 rounded text-slate-700 mx-2 ",sideItemActive:"group flex px-3 py-1.5 text-[14px] font-light hover:bg-blue-100 text-slate-700  mx-2 ",topItem:"flex items-center text-sm px-4 border-r h-12",icon:"group w-6 mr-2 text-blue-500 ",iconActive:"group w-6 mr-2 text-blue-500 ",sideItemContent:" transition-transform duration-300 ease-in-out flex-1"},full:{fixed:"",wrapper:"w-full",sideItem:"group flex px-3 py-2 text-[14px] font-light hover:bg-blue-50 text-slate-700 mx-2 border-r-4 border-white",sideItemActive:"group flex px-3 py-2 text-[14px] font-light hover:bg-blue-50 text-slate-700 mx-2 border-r-4  border-white",topItem:"flex pr-4 py-2  font-",icon:"group w-6 mr-2 text-blue-500  ",iconActive:"group w-6 mr-2 text-blue-500",sideItemContent:" transition-transform duration-300 ease-in-out flex-1 w-full"},mini:{fixed:"ml-0 md:ml-20",wrapper:"w-20 overflow-x-hidden",sideItem:"text-white hover:bg-blue-100 hover:text-blue-100",sideItemActive:"text-blue-500 bg-blue-500  ",topItem:"flex px-4 items-center text-sm font-light ",icon:"w-20 h-10 text-xl text-blue-500",iconActive:"w-20 h-10 text-xl text-white",sideItemContent:"w-0"},micro:{fixed:"ml-0 md:ml-14",wrapper:"w-14 overflow-x-hidden",itemWrapper:"p-1",sideItem:"flex text-base font-base ",topItem:"flex mx-6 pr-4 py-2 text-sm font-light",icon:"w-12 text-2xl hover:bg-neutral-900 px-1 py-3 my-2 rounded-lg mr-4 hover:text-blue-500",sideItemContent:"hidden"}};c[n]||(n="none");let d={inline:{indicatorIcon:"fa fa-angle-right pt-2.5",indicatorIconOpen:"fal fa-angle-down pt-2.5",subMenuWrapper:"pl-2 w-full",subMenuParentWrapper:"flex flex-col w-full"},flyout:{indicatorIcon:"fal fa-angle-down",indicatorIconOpen:"fa fa-angle-right",subMenuWrapper:`absolute ml-${c[n].width-8}`,subMenuParentWrapper:"flex flex-row",subMenuWrapperTop:"absolute top-full"}};return{fixed:`md:${c[n].fixed}`,logoWrapper:`${c[n].wrapper} ${i[s].contentBgAccent} ${i[s].textColorAccent}`,sidenavWrapper:`${l[a]} ${i[s].contentBg} ${c[n].wrapper} h-full z-20`,menuIconSide:`${c[n].icon} group-hover:${i[s].highlightColor}`,menuIconSideActive:`${c[n].iconActive} group-hover:${i[s].highlightColor}`,itemsWrapper:`${i[s].borderColor} ${c[n].itemWrapper}  `,navItemContent:`${c[n].sideItemContent}`,navitemSide:`
        group  flex flex-col

        ${c[n].sideItem} ${i[s].sideItem}
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
        transition-all cursor-pointer
     `,navitemSideActive:`
        group  flex flex-col
         ${c[n].sideItemActive} ${i[s].sideItemActive} 
        
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
        transition-all cursor-pointer

      `,...d[r],vars:{colors:i,sizes:c,mobile:l}}},f7=({color:t="white",size:s="compact",menu:n="left",subMenuStyle:r="inline"})=>{let a={white:{contentBg:"bg-slate-100",accentColor:"blue-500",accentBg:"hover:bg-white",borderColor:"border-slate-100",textColor:"text-slate-700",highlightColor:"text-blue-500"},bright:{contentBg:"bg-blue-700",accentColor:"blue-400",accentBg:"hover:bg-blue-400",borderColor:"border-blue-600",textColor:"text-white",highlightColor:"text-white"}},l={compact:{menu:`hidden uppercase md:flex flex-1 ${n==="left"?"":"justify-end"} divide-x-2`,sideItem:"flex  mx-6 pr-4 py-2 text-sm font-light hover:pl-4",topItem:`flex font-medium tracking-widest items-center text-[14px] px-4 h-12 ${a[t].textColor} ${a[t].borderColor}
        ${a[t].accentBg} hover:${a[t].highlightColor}`,activeItem:`flex font-medium  tracking-widest bg-white items-center text-[14px] px-4 h-12 ${a[t].highlightColor} ${a[t].borderColor}
        ${a[t].accentBg} hover:${a[t].highlightColor}`,icon:"mr-3 text-lg",responsive:"md:hidden"},inline:{menu:"flex flex-1",sideItem:"flex mx-4 pr-4 py-4 text-base font-base border-b hover:pl-4",topItem:`flex px-4 py-2 mx-2 font-medium text-gray-400 border-b-2 ${a[t].textColor} ${a[t].borderColor}
      hover:border-gray-300 hover:text-gray-700 border-gray-100 `,activeItem:`flex px-4 py-2 mx-2 font-medium text-blue-600 border-b-2 ${a[t].textColor} ${a[t].borderColor} border-blue-600 `,icon:"mr-4 text-2xl",responsive:"hidden"}},i={inline:{subMenuWrapperChild:"",subMenuWrapper:"pl-2 w-full ",subMenuParentWrapper:"flex flex-col w-full  "},flyout:{indicatorIcon:"fal fa-angle-down pl-2 pt-1",indicatorIconOpen:"fal fa-angle-down pl-2",subMenuWrapper:`absolute ml-${l[s].width-8} `,subMenuParentWrapper:"flex flex-row  ",subMenuWrapperTop:"absolute top-full  "},row:{indicatorIcon:"fal fa-angle-down pl-2 pt-1",indicatorIconOpen:"fal fa-angle-down pl-2 pt-1",subMenuWrapper:`absolute bg-white ml-${l[s].width-8}`,subMenuParentWrapper:"flex flex-row  ",subMenuWrapperChild:"divide-x overflow-x-auto",subMenuWrapperTop:"absolute top-full left-0 border-y border-gray-200 w-full bg-white normal-case",subMenuWrapperInactiveFlyout:"absolute  mt-8 normal-case bg-white shadow-lg z-10 p-2",subMenuWrapperInactiveFlyoutBelow:" absolute ml-40 normal-case bg-white shadow-lg z-10 p-2",subMenuWrapperInactiveFlyoutDirection:"flex flex-col divide-y-2"}};return{topnavWrapper:`w-full ${a[t].contentBg} border-b border-gray-200`,topnavContent:"flex w-full h-full",topnavMenu:`${l[s].menu} h-full overflow-x-auto overflow-y-hidden scrollbar-sm`,menuIconTop:`text-${a[t].accentColor} ${l[s].icon} group-hover:${a[t].highlightColor}`,menuIconTopActive:`text-${a[t].accentColor} ${l[s].icon} group-hover:${a[t].highlightColor}`,menuOpenIcon:"fa-light fa-bars fa-fw",menuCloseIcon:'fa-light fa-xmark fa-fw"',navitemTop:`
        w-fit group font-display whitespace-nowrap
        ${l[s].topItem}
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
        transition cursor-pointer
    `,topmenuRightNavContainer:"hidden md:flex h-full",topnavMobileContainer:"bg-slate-50",navitemTopActive:` w-fit group font-display whitespace-nowrap
        ${l[s].activeItem}
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
        transition cursor-pointer 
      `,mobileButton:`${l[s].responsive} ${a[t].contentBg} inline-flex items-center justify-center pt-[12px] px-2 hover:text-blue-400  text-gray-400 hover:bg-gray-100 `,...i[r],vars:{colors:a,sizes:l}}},g7={navOptions:{logo:"",sideNav:{size:"compact",search:"none",logo:"top",dropdown:"none",nav:"main"},topNav:{size:"compact",dropdown:"right",search:"right",logo:"none",nav:"none"}},heading:{base:"p-2 w-full font-sans font-medium text-md bg-transparent",1:"text-blue-500 font-bold text-xl tracking-wider py-1 pl-1",2:"text-lg tracking-wider",3:"text-md tracking-wide",default:""},levelClasses:{1:" pt-2 pb-1 uppercase text-sm text-blue-400 hover:underline cursor-pointer border-r-2 mr-4",2:"pl-2 pt-2 pb-1 uppercase text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4",3:"pl-4 pt-2 pb-1 text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4",4:"pl-6 pt-2 pb-1 text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4"},page:{wrapper1:"w-full h-full flex-1 flex flex-col bg-slate-100",wrapper2:"w-full h-full flex-1 flex flex-row px-1 md:px-6 py-6",wrapper3:"flex flex-1 w-full  flex-col border shadow bg-white relative text-md font-light leading-7 p-4 min-h-[calc(100vh_-_102px)]",iconWrapper:"z-5 absolute right-[10px] top-[5px]",icon:"text-slate-400 hover:text-blue-500"},pageControls:{controlItem:"pl-6 py-0.5 text-md cursor-pointer hover:text-blue-500 text-slate-400 flex items-center",select:"bg-transparent border-none rounded-sm focus:ring-0 focus:border-0 pl-1",selectOption:"p-4 text-md cursor-pointer hover:text-blue-500 text-slate-400 hover:bg-blue-600"},navPadding:{1:"pt-0 ",2:"md:pt-12 pt-0",3:"md:pt-24 pt-0"},sidenav:h7,topnav:f7},us=C.createContext(void 0),b7={email:"user",authLevel:5,authed:!0,fake:!0},y7=({app:t="default-app",type:s="default-page",sideNav:n=null,logo:r=null,rightMenu:a=e.jsx("div",{}),baseUrl:l="/",checkAuth:i=()=>{},theme:c=g7})=>{const d=pe(x7);d.app=t,d.type=s,l=l==="/"?"":l;const u=e.jsxs(ue,{to:`${l}`,className:"h-12 flex px-4 items-center",children:[e.jsx("div",{className:"rounded-full h-8 w-8 bg-blue-500 border-2 border-blue-300 hover:bg-blue-600"}),e.jsx("div",{className:"p-2",children:"Admin"})]});c.navOptions.logo||(c.navOptions.logo=r||u);const m=[{name:"Dashboard",path:`${l}`},{name:"Datasets",path:`${l}/datasets`},{name:"Team",path:`${l}team`}];return d.registerFormats=Ur(d.registerFormats,t),d.attributes=Fo(d.attributes,t),{app:t,type:s,format:d,baseUrl:l,children:[{type:p=>e.jsx(us.Provider,{value:{baseUrl:l,user:p.user||b7,theme:c,app:t,type:s,parent},children:e.jsx(l7,{navItems:m,children:p.children})}),action:"list",path:"/*",children:[{type:p=>e.jsx(c7,{...p}),action:"edit",path:"/*"},{type:p=>e.jsx("div",{children:"Team"}),action:"view",path:"team"}]}]}},Ur=(t,s)=>(Array.isArray(t)&&(t=t.map(n=>(n.app=s,n.registerFormats=Ur(n.registerFormats,s),n.attributes=Fo(n.attributes,s),n))),t),Fo=(t,s)=>(Array.isArray(t)&&(t=t.map(n=>(n.format=n.format?`${s}+${n.format.split("+")[1]}`:void 0,Ur(n,s)))),t),v7=t=>t.split(".").length>2?window.location.host.split(".")[0].toLowerCase():!1,w7={page:V9,forms:o9};_j("selector",f9);function mf(t,s){let{dmsConfig:n,adminPath:r="/list",authWrapper:a=h=>h,themes:l={default:{}},pgEnvs:i=["hazmit_dama"],falcor:c,API_HOST:d="https://graph.availabs.org",damaBaseUrl:u}=s;const m=t.reduce((h,f)=>[...h,...(f==null?void 0:f.patterns)||[]],[])||[];let p=v7(window.location.host);p=p==="hazardmitigation"?"":p,l=l!=null&&l.default?l:{...l,default:{}};let x=pe(n);return x.registerFormats=Ur(x.registerFormats,n.app),x.attributes=Fo(x.attributes,n.app),[Ld({...x,siteType:x.type,baseUrl:p==="admin"?"/":r,authLevel:1,API_HOST:d,theme:l.default},a),...m.reduce((h,f)=>{if(f!=null&&f.pattern_type&&(!p||f.subdomain===p||f.subdomain==="*")){const g=w7[f.pattern_type];if(!g)return h;h.push(...g.map(y=>{var j,N,S,w;const v=y({app:((j=x==null?void 0:x.format)==null?void 0:j.app)||x.app,type:f.doc_type||((N=f==null?void 0:f.base_url)==null?void 0:N.replace(/\//g,"")),siteType:((S=x==null?void 0:x.format)==null?void 0:S.type)||x.type,baseUrl:`/${(w=f.base_url)==null?void 0:w.replace(/^\/|\/$/g,"")}`,adminPath:r,format:f==null?void 0:f.config,pattern:f,pattern_type:f==null?void 0:f.pattern_type,authLevel:+f.authLevel||-1,pgEnv:(i==null?void 0:i[0])||"",themes:l,useFalcor:Gt.useFalcor,API_HOST:d,damaBaseUrl:u});return{...Ld(v,a)}}))}return h},[])]}async function j7(t){let{dmsConfig:s,falcor:n,API_HOST:r="https://graph.availabs.org"}=t,a=pe(s);a.registerFormats=Ur(a.registerFormats,s.app),a.attributes=Fo(a.attributes,s.app),n=n||Gt.falcorGraph(r),console.time("load routes");let l=await St(n,a,"/");return console.timeEnd("load routes"),mf(l,t)}function C7({dmsConfig:t,defaultData:s,adminPath:n="/list",authWrapper:r=m=>m,themes:a={default:{}},falcor:l,pgEnvs:i=["hazmit_dama"],API_HOST:c="https://graph.availabs.org",damaBaseUrl:d,routes:u=[]}){const[m,p]=b.useState(s?mf(s,{dmsConfig:t,adminPath:n,themes:a,falcor:l,API_HOST:c,authWrapper:r,pgEnvs:i,damaBaseUrl:d}):[]);b.useEffect(()=>{(async function(){console.time("dmsSiteFactory");const h=await j7({dmsConfig:t,adminPath:n,themes:a,falcor:l,API_HOST:c,authWrapper:r,pgEnvs:i,damaBaseUrl:d});console.timeEnd("dmsSiteFactory"),p(h)})()},[]);const x={path:"/*",Component:()=>e.jsx("div",{className:"w-screen h-screen flex items-center bg-blue-50",children:"404"})};return console.log("routes",m,u),e.jsx(e1,{router:t1([...m,...u,x])})}const N7={children:[{type:"ams-login",path:"login",props:{title:"Design Site"}},{ype:"ams-reset-password",path:"reset-password",props:{title:"Design Site"}},{type:"ams-logout",path:"logout",props:{redirectTo:"/"}},{type:"ams-signup",path:"register",props:{title:"Design Site",addToGroup:"NPMRDS_PM3 New Users"}},{type:"ams-profile",path:"profile"},{type:"ams-verify-request",path:"verify-request"},{type:"ams-set-password",path:"set-password"},{type:"ams-accept-invite",path:"accept-invite"},{type:"ams-project-management",path:"project-management",props:{authLevel:5}}]},k7=Sn.amsFactory(N7,"/auth"),$7=()=>e.jsx(e.Fragment,{children:e.jsx(dp,{to:"/",className:"flex ",children:e.jsx("div",{className:"h-12 pl-3 w-64 pr-12 flex items-center ",children:"DMS"})})}),S7={navOptions:{logo:e.jsx($7,{}),sideNav:{size:"none",search:"none",logo:"top",position:"fixed",dropdown:"bottom",nav:"none"},topNav:{size:"compact",dropdown:"right",search:"right",logo:"left",position:"fixed",nav:"main"}},heading:{base:"p-2 w-full font-sans font-medium text-md bg-transparent",1:"text-blue-500 font-bold text-xl tracking-wider py-1 pl-1",2:"text-lg tracking-wider",3:"text-md tracking-wide",default:""},levelClasses:{1:" pt-2 pb-1 uppercase text-sm text-blue-400 hover:underline cursor-pointer border-r-2 mr-4",2:"pl-2 pt-2 pb-1 uppercase text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4",3:"pl-4 pt-2 pb-1 text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4",4:"pl-6 pt-2 pb-1 text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4"},layout:{wrapper:"relative isolate flex min-h-svh w-full max-lg:flex-col bg-white lg:bg-zinc-100 dark:bg-zinc-900 dark:lg:bg-zinc-950 overflow-hidden",childWrapper:"flex-1 h-full",topnavContainer1:"h-[50px] -mb-1",topnavContainer2:"fixed w-full z-20 ",sidenavContainer1:"border-r -mr-3",sidenavContainer2:"fixed inset-y-0 left-0 w-64 max-lg:hidden"},page:{wrapper1:"flex flex-1 flex-col lg:min-w-0 lg:py-2 h-full",wrapper2:"w-full h-full flex-1 flex flex-row lg:px-3",wrapper3:"grow p-6 lg:rounded-lg lg:bg-white lg:p-10 lg:shadow-sm lg:ring-1 lg:ring-zinc-950/5 dark:lg:bg-zinc-900 dark:lg:ring-white/10 relative ",iconWrapper:"z-5 absolute right-[10px] top-[5px]",icon:"text-slate-400 hover:text-blue-500"},pageControls:{controlItem:"pl-6 py-0.5 text-md cursor-pointer hover:text-blue-500 text-slate-400 flex items-center",select:"bg-transparent border-none rounded-sm focus:ring-0 focus:border-0 pl-1",selectOption:"p-4 text-md cursor-pointer hover:text-blue-500 text-slate-400 hover:bg-blue-600"},navPadding:{1:"",2:"",3:""},navLabel:"px-6 pb-1 pt-6 uppercase text-xs text-blue-400",bg:"bg-slate-100",button:{default:"relative isolate inline-flex items-center justify-center gap-x-2 border text-base/6 font-semibold px-[calc(theme(spacing[3.5])-1px)] py-[calc(theme(spacing[2.5])-1px)] sm:px-[calc(theme(spacing.3)-1px)] sm:py-[calc(theme(spacing[1.5])-1px)] sm:text-sm/6 focus:outline-none data-[focus]:outline data-[focus]:outline-2 data-[focus]:outline-offset-2 data-[focus]:outline-blue-500 data-[disabled]:opacity-50 [&>[data-slot=icon]]:-mx-0.5 [&>[data-slot=icon]]:my-0.5 [&>[data-slot=icon]]:size-5 [&>[data-slot=icon]]:shrink-0 [&>[data-slot=icon]]:text-[--btn-icon] [&>[data-slot=icon]]:sm:my-1 [&>[data-slot=icon]]:sm:size-4 forced-colors:[--btn-icon:ButtonText] forced-colors:data-[hover]:[--btn-icon:ButtonText] border-transparent bg-[--btn-border] dark:bg-[--btn-bg] before:absolute before:inset-0 before:-z-10 before:rounded-[calc(theme(borderRadius.lg)-1px)] before:bg-[--btn-bg] before:shadow dark:before:hidden dark:border-white/5 after:absolute after:inset-0 after:-z-10 after:rounded-[calc(theme(borderRadius.lg)-1px)] after:shadow-[shadow:inset_0_1px_theme(colors.white/15%)] after:data-[active]:bg-[--btn-hover-overlay] after:data-[hover]:bg-[--btn-hover-overlay] dark:after:-inset-px  before:data-[disabled]:shadow-none after:data-[disabled]:shadow-none text-white [--btn-bg:theme(colors.zinc.900)] [--btn-border:theme(colors.zinc.950/90%)] [--btn-hover-overlay:theme(colors.white/10%)] dark:text-white dark:[--btn-bg:theme(colors.zinc.600)] dark:[--btn-hover-overlay:theme(colors.white/5%)] [--btn-icon:theme(colors.zinc.400)] data-[active]:[--btn-icon:theme(colors.zinc.300)] data-[hover]:[--btn-icon:theme(colors.zinc.300)] cursor-default",active:"relative isolate inline-flex items-center justify-center gap-x-2 border text-base/6 font-semibold px-[calc(theme(spacing[3.5])-1px)] py-[calc(theme(spacing[2.5])-1px)] sm:px-[calc(theme(spacing.3)-1px)] sm:py-[calc(theme(spacing[1.5])-1px)] sm:text-sm/6 focus:outline-none data-[focus]:outline data-[focus]:outline-2 data-[focus]:outline-offset-2 data-[focus]:outline-blue-500 data-[disabled]:opacity-50 [&>[data-slot=icon]]:-mx-0.5 [&>[data-slot=icon]]:my-0.5 [&>[data-slot=icon]]:size-5 [&>[data-slot=icon]]:shrink-0 [&>[data-slot=icon]]:text-[--btn-icon] [&>[data-slot=icon]]:sm:my-1 [&>[data-slot=icon]]:sm:size-4 forced-colors:[--btn-icon:ButtonText] forced-colors:data-[hover]:[--btn-icon:ButtonText] border-transparent bg-[--btn-border] dark:bg-[--btn-bg] before:absolute before:inset-0 before:-z-10 before:rounded-[calc(theme(borderRadius.lg)-1px)] before:bg-[--btn-bg] before:shadow dark:before:hidden dark:border-white/5 after:absolute after:inset-0 after:-z-10 after:rounded-[calc(theme(borderRadius.lg)-1px)] after:shadow-[shadow:inset_0_1px_theme(colors.white/15%)] after:data-[active]:bg-[--btn-hover-overlay] after:data-[hover]:bg-[--btn-hover-overlay] dark:after:-inset-px  before:data-[disabled]:shadow-none after:data-[disabled]:shadow-none text-white [--btn-bg:theme(colors.zinc.900)] [--btn-border:theme(colors.zinc.950/90%)] [--btn-hover-overlay:theme(colors.white/10%)] dark:text-white dark:[--btn-bg:theme(colors.zinc.600)] dark:[--btn-hover-overlay:theme(colors.white/5%)] [--btn-icon:theme(colors.zinc.400)] data-[active]:[--btn-icon:theme(colors.zinc.300)] data-[hover]:[--btn-icon:theme(colors.zinc.300)] cursor-default",inactive:"relative isolate inline-flex items-center justify-center gap-x-2 border text-base/6 font-semibold px-[calc(theme(spacing[3.5])-1px)] py-[calc(theme(spacing[2.5])-1px)] sm:px-[calc(theme(spacing.3)-1px)] sm:py-[calc(theme(spacing[1.5])-1px)] sm:text-sm/6 focus:outline-none data-[focus]:outline data-[focus]:outline-2 data-[focus]:outline-offset-2 data-[focus]:outline-blue-500 data-[disabled]:opacity-50 [&>[data-slot=icon]]:-mx-0.5 [&>[data-slot=icon]]:my-0.5 [&>[data-slot=icon]]:size-5 [&>[data-slot=icon]]:shrink-0 [&>[data-slot=icon]]:text-[--btn-icon] [&>[data-slot=icon]]:sm:my-1 [&>[data-slot=icon]]:sm:size-4 forced-colors:[--btn-icon:ButtonText] forced-colors:data-[hover]:[--btn-icon:ButtonText] border-transparent bg-[--btn-border] dark:bg-[--btn-bg] before:absolute before:inset-0 before:-z-10 before:rounded-[calc(theme(borderRadius.lg)-1px)] before:bg-[--btn-bg] before:shadow dark:before:hidden dark:border-white/5 after:absolute after:inset-0 after:-z-10 after:rounded-[calc(theme(borderRadius.lg)-1px)] after:shadow-[shadow:inset_0_1px_theme(colors.white/15%)] after:data-[active]:bg-[--btn-hover-overlay] after:data-[hover]:bg-[--btn-hover-overlay] dark:after:-inset-px  before:data-[disabled]:shadow-none after:data-[disabled]:shadow-none text-white [--btn-bg:theme(colors.zinc.900)] [--btn-border:theme(colors.zinc.950/90%)] [--btn-hover-overlay:theme(colors.white/10%)] dark:text-white dark:[--btn-bg:theme(colors.zinc.600)] dark:[--btn-hover-overlay:theme(colors.white/5%)] [--btn-icon:theme(colors.zinc.400)] data-[active]:[--btn-icon:theme(colors.zinc.300)] data-[hover]:[--btn-icon:theme(colors.zinc.300)] cursor-default"},tabs:{tablist:"flex gap-4",tab:`
      py-1 px-3 font-semibold text-slate-600 focus:outline-none border-b-4 rounded-b border-white text-xs hover:text-slate-900
      data-[selected]:border-slate-500 data-[selected]:bg-white/10 data-[hover]:bg-white/5 data-[selected]:data-[hover]:bg-white/10 data-[focus]:outline-1 data-[focus]:outline-white
    `,tabpanels:"mt-1",tabpanel:"rounded-xl bg-white/5 "},sidenav:{fixed:"lg:ml-64",logoWrapper:"w-64 bg-neutral-100 text-slate-800",sidenavWrapper:"flex flex-col w-64 h-full z-20",menuItemWrapper:"flex flex-col ",menuIconSide:"group w-6 mr-2 text-blue-500  group-hover:text-blue-800",menuIconSideActive:"group w-6 mr-2 text-blue-500  group-hover:text-blue-800",itemsWrapper:"pt-5 flex-1 ",navItemContent:"transition-transform duration-300 ease-in-out",navitemSide:`
      group  flex flex-col
      group flex px-3 py-1.5 text-[14px] font-light hover:bg-blue-50 text-slate-700 mx-2  undefined
      focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
      transition-all cursor-pointer`,navitemSideActive:`
      group  flex flex-col
      px-3 py-1.5 text-[14px] font-light hover:bg-blue-50 text-slate-700  mx-2   
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
      transition-all cursor-pointer`,indicatorIcon:"fa fa-angle-right pt-2.5",indicatorIconOpen:"fal fa-angle-down pt-2.5",subMenuWrapper:"pl-2 w-full",subMenuParentWrapper:"flex flex-col w-full",bottomMenuWrapper:"border-t"},topnav:{fixed:"mt-12",topnavWrapper:"w-full h-[50px] flex items-center pr-1",topnavContent:"flex items-center w-full h-full bg-white lg:bg-zinc-100 dark:bg-zinc-900 dark:lg:bg-zinc-950",topnavMenu:"hidden  lg:flex items-center flex-1  h-full overflow-x-auto overflow-y-hidden scrollbar-sm",menuItemWrapper:"flex",menuIconTop:"text-blue-400 mr-3 text-lg group-hover:text-blue-500",menuIconTopActive:"text-blue-500 mr-3 text-lg group-hover:text-blue-500",menuOpenIcon:"fa-light fa-bars fa-fw",menuCloseIcon:'fa-light fa-xmark fa-fw"',navitemTop:`
          w-fit group font-display whitespace-nowrap
          flex tracking-widest items-center font-[Oswald] font-medium text-slate-700 text-[11px] px-2 h-12
          focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
          transition cursor-pointer
      `,navitemTopActive:` w-fit group font-display whitespace-nowrap
          flex tracking-widest items-center font-[Oswald] font-medium text-slate-700 text-[11px] px-2 h-12 text-blue
          focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
          transition cursor-pointer 
        `,topmenuRightNavContainer:"hidden md:flex h-full items-center",topnavMobileContainer:"bg-slate-50",mobileButton:"md:hidden bg-slate-100 inline-flex items-center justify-center pt-[12px] px-2 hover:text-blue-400  text-gray-400 hover:bg-gray-100 ",indicatorIcon:"fal fa-angle-down pl-2 pt-1",indicatorIconOpen:"fal fa-angle-down pl-2 pt-1",subMenuWrapper:"hidden",subMenuParentWrapper:"hidden",subMenuWrapperChild:"divide-x overflow-x-auto max-w-[1400px] mx-auto",subMenuWrapperTop:"hidden",subMenuWrapperInactiveFlyout:"absolute left-0 right-0  mt-8 normal-case bg-white shadow-lg z-10 p-2",subMenuWrapperInactiveFlyoutBelow:" absolute ml-40 normal-case bg-white shadow-lg z-10 p-2",subMenuWrapperInactiveFlyoutDirection:"grid grid-cols-4"}},_7=({sideNav:t})=>e.jsx(e.Fragment,{children:e.jsx(dp,{to:"/",className:"flex ",children:e.jsx("div",{className:"h-12 px-4 flex items-center font-['Oswald'] text-xl font-bold uppercase text-slate-600",children:"Hazard Data"})})}),I7={navOptions:{logo:e.jsx(_7,{}),sideNav:{size:"none",search:"none",logo:"top",dropdown:"none",nav:"none"},topNav:{size:"compact",dropdown:"right",search:"right",logo:"left",position:"fixed",nav:"main"}},heading:{base:"p-2 w-full font-sans font-medium text-md bg-transparent",1:"font-[500]  text-[#2D3E4C] text-[36px] leading-[36px] tracking-[-.02em] font-[500] underline-offset-8 underline decoration-4 decoration-[#EAAD43] uppercase font-['Oswald'] pb-[12px]",2:"font-[500]  text-[#2D3E4C] text-[24px] leading-[24px] scroll-mt-36 font-['Oswald'] pb-[12x]",3:"font-[500]  text-[#2D3E4C] text-[16px] leading-[16px] scroll-mt-36 font-['Oswald'] pb-[12x]",default:""},levelClasses:{1:" pt-2 pb-1 uppercase text-sm text-blue-400 hover:underline cursor-pointer border-r-2 mr-4",2:"pl-2 pt-2 pb-1 uppercase text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4",3:"pl-4 pt-2 pb-1 text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4",4:"pl-6 pt-2 pb-1 text-sm text-slate-400 hover:underline cursor-pointer border-r-2 mr-4"},layout:{wrapper:"max-w-[1440px] mx-auto",wrapper2:"flex-1 flex items-start flex-col items-stretch max-w-full",wrapper3:"flex flex-1 px-4 xl:px-[64px]",childWrapper:"h-full flex-1",topnavContainer2:"fixed top-0 z-20 max-w-[1440px] w-full px-4 pt-[32px] xl:px-[64px] pointer-events-none",sidenavContainer1:"pr-2  hidden lg:block min-w-[302px] max-w-[302px] pt-[88px]",sidenavContainer2:"hidden lg:block sticky top-[120px] h-[calc(100vh_-_125px)] bg-white rounded-lg shadow-md w-full overflow-y-auto overflow-x-hidden"},page:{container:"bg-[linear-gradient(0deg,rgba(244,244,244,0.96),rgba(244,244,244,0.96)),url('/themes/mny/topolines.png')]  bg-[size:500px] pb-[4px]",wrapper1:"w-full h-full flex-1 flex flex-col ",wrapper2:"w-full h-full flex-1 flex flex-row lg:pt-[118px] ",wrapper3:"flex flex-1 w-full border-2 flex-col border shadow-md bg-white rounded-lg relative text-md font-light leading-7 p-4 h-full min-h-[calc(100vh_-_102px)]",iconWrapper:"z-5 absolute right-[10px] top-[5px]",icon:"text-slate-400 hover:text-blue-500"},sectionArray:{container:"w-full grid grid-cols-6 md:grid-cols-12 ",layouts:{centered:"max-w-[1020px] mx-auto md:gap-[12px] px-0 lg:px-[56px]",fullwidth:""},sizes:{"1/4":{className:"col-span-6 md:col-span-3",iconSize:25},"1/3":{className:"col-span-6 md:col-span-4",iconSize:33},"1/2":{className:"col-span-6 md:col-span-6",iconSize:50},"2/3":{className:"col-span-6 md:col-span-8",iconSize:66},1:{className:"col-span-6 md:col-span-9",iconSize:75},2:{className:"col-span-6 md:col-span-12",iconSize:100}}},pageControls:{controlItem:"pl-6 py-0.5 text-md cursor-pointer hover:text-blue-500 text-slate-400 flex items-center",select:"bg-transparent border-none rounded-sm focus:ring-0 focus:border-0 pl-1",selectOption:"p-4 text-md cursor-pointer hover:text-blue-500 text-slate-400 hover:bg-blue-600"},navPadding:{1:"",2:"",3:""},dataCard:{columnControlWrapper:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-4 gap-x-1 gap-y-0.5",columnControlHeaderWrapper:"px-1 font-semibold border bg-gray-50 text-gray-500",mainWrapperCompactView:"grid",mainWrapperSimpleView:"flex flex-col",subWrapper:"w-full text-[#2D3E4C]",subWrapperCompactView:"flex flex-col flex-wrap rounded-[12px] divide-y",subWrapperSimpleView:"grid",headerValueWrapper:"w-full rounded-[12px] flex items-center gap-[8px] justify-center p-2",headerValueWrapperCompactView:"rounded-none py-[12px]",headerValueWrapperSimpleView:"",justifyTextLeft:"text-start justify-items-start",justifyTextRight:"text-end justify-items-end",justifyTextCenter:"text-center justify-items-center",textXS:"font-medium font-[Oswald] text-[12px] leading-[140%]",textXSReg:"font-normal font-[Proxima Nova] text-[12px] leading-[100%] uppercase",textSM:"font-medium font-[Oswald] text-[14px] leading-[100%] uppercase",textSMReg:"font-normal font-[Proxima Nova] text-[14px] leading-[140%]",textSMBold:"font-normal font-[Proxima Nova] text-[14px] leading-[140%]",textSMSemiBold:"font-semibold font-[Proxima Nova] text-[14px] leading-[140%]",textMD:"font-medium font-[Oswald] text-[16px] leading-[100%] uppercase",textMDReg:"font-normal font-[Proxima Nova] text-[16px] leading-[140%]",textMDBold:"font-bold font-[Proxima Nova] text-[16px] leading-[140%]",textMDSemiBold:"font-semibold font-[Proxima Nova] text-[16px] leading-[140%]",textXL:"font-medium font-[Oswald] text-[20px] leading-[100%] uppercase",textXLSemiBold:"font-semibold font-[Proxima Nova] text-[20px] leading-[120%]",text2XL:"font-medium font-[Oswald] text-[24px] leading-[100%] uppercase",text2XLReg:"font-regular font-[Oswald] text-[24px] leading-[120%] uppercase",text3XL:"font-medium font-[Oswald] text-[30px] leading-[100%] uppercase tracking-[-0.05em]",text3XLReg:"font-normal font-[Oswald] text-[30px] leading-[120%] uppercase",text4XL:"font-medium font-[Oswald] text-[36px] leading-[100%] uppercase tracking-[-0.05em]",text5XL:"font-medium font-[Oswald] text-[48px] leading-[100%] uppercase tracking-[-0.05em]",text6XL:"font-medium font-[Oswald] text-[60px] leading-[100%] uppercase",text7XL:"font-medium font-[Oswald] text-[72px] leading-[100%] uppercase tracking-normal",text8XL:"font-medium font-[Oswald] text-[96px] leading-[95%] uppercase tracking-normal ",imgXS:"max-w-16 max-h-16",imgSM:"max-w-24 max-h-24",imgMD:"max-w-32 max-h-32",imgXL:"max-w-40 max-h-40",img2XL:"max-w-48 max-h-48",img3XL:"max-w-56 max-h-56",img4XL:"max-w-64 max-h-64",img5XL:"max-w-72 max-h-72",img6XL:"max-w-80 max-h-80",img7XL:"max-w-96 max-h-96",img8XL:"max-w-128 max-h-128",header:"flex-1 uppercase text-[#37576B]",headerCompactView:"",headerSimpleView:"",value:"text-[#2D3E4C]",valueCompactView:"",valueSimpleView:""},sidenav:{fixed:"",logoWrapper:"bg-neutral-100 text-slate-800",sidenavWrapper:"hidden md:block bg-white w-full h-full z-20 pr-4",menuItemWrapper:"flex flex-col",menuIconSide:"group w-6 mr-2 text-blue-500",menuIconSideActive:"group w-6 mr-2 text-blue-500",itemsWrapper:"border-slate-200",navItemContent:"transition-transform duration-300 ease-in-out flex-1",navItemContents:["text-[16px] font-['Oswald'] font-[500] leading-[16px]  text-[#2D3E4C] pl-4 py-3","text-[16px] font-['Proxima_Nova'] font-[600] leading-[19.2px] text-[#37576B] pl-4 py-3","text-[14px] font-['Proxima_Nova'] font-[400] leading-[19.6px] text-[#37576B] pl-4 py-2","text-[14px] font-['Proxima_Nova'] font-[400] leading-[19.6px] text-[#37576B] pl-4 py-2","text-[14px] font-['Proxima_Nova'] font-[400] leading-[19.6px] text-[#37576B] pl-4 py-2"],navitemSide:`
        group  flex flex-col
        border-white 
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
        transition-all cursor-pointer 
     `,navitemSideActive:`
        group  flex flex-col
        focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
        transition-all cursor-pointer border-l-2 border-slate-600 

      `,indicatorIcon:"ArrowRight",indicatorIconOpen:"ArrowDown",subMenuWrapper:"pl-2 w-full",subMenuOuterWrappers:["pl-4"],subMenuWrappers:["w-full bg-[#F3F8F9] rounded-[12px] py-[12px]","w-full bg-[#E0EBF0]"],subMenuParentWrapper:"flex flex-col w-full",subMenuWrapperTop:""},topnav:{fixed:"mt-8",topnavWrapper:"px-[24px] py-[16px] w-full bg-white h-20 flex items-center rounded-lg shadow pointer-events-auto",topnavContent:"flex items-center w-full h-full  max-w-[1400px] mx-auto ",topnavMenu:"hidden  md:flex items-center flex-1  h-full overflow-x-auto overflow-y-hidden scrollbar-sm",mobileButton:"md:hidden bg-slate-100 inline-flex items-center justify-center pt-[12px] px-2 hover:text-blue-400  text-gray-400 hover:bg-gray-100 ",indicatorIcon:"fal fa-angle-down pl-2 pt-1",indicatorIconOpen:"fal fa-angle-down pl-2 pt-1",menuItemWrapper1:[" ",""],menuItemWrapper1Parent:[" ","bg-[#F3F8F9] p-4 rounded-lg"],menuItemWrapper2:["flex text-[#37576B] "," "],menuIconTop:"text-blue-400 mr-3 text-lg group-hover:text-blue-500",menuIconTopActive:"text-blue-500 mr-3 text-lg group-hover:text-blue-500",menuOpenIcon:"fa-light fa-bars fa-fw",menuCloseIcon:'fa-light fa-xmark fa-fw"',navitemTop:`
          w-fit group  whitespace-nowrap
          flex items-center 
          text-[16px] font-['Proxima_Nova'] font-[500] 
          px-2
          focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
          transition cursor-pointer
      `,navitemTopActive:` w-fit group  whitespace-nowrap
          flex  items-center 
          text-[16px] font-['Proxima_Nova'] font-[500] 
          px-2 text-blue
          focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300
          transition cursor-pointer 
        `,navItemDescription:["hidden","text-[16px] font-['Proxima_Nova'] font-[400] text-[#37576B] text-wrap"],topmenuRightNavContainer:"hidden md:flex h-full items-center",topnavMobileContainer:"bg-slate-50",subMenuWrapper1:["absolute left-0 right-0 normal-case mt-4 z-10 px-4 pt-[42px] px-[62px] cursor-default"],subMenuWrapper2:"bg-white flex items-stretch rounded-lg p-4 shadow",subMenuParentContent:"basis-1/3  text-wrap pr-[64px]",subMenuParentName:"text-[36px] font-['Oswald'] font-500 text-[#2D3E4C] uppercase pb-2",subMenuParentDesc:"text-[16px] font-['Proxima_Nova'] font-[400] text-[#37576B]",subMenuParentLink:"w-fit h-fit cursor-pointer uppercase border boder-[#E0EBF0] bg-white hover:bg-[#E0EBF0] text-[#37576B] font-[700] leading-[14.62px] rounded-full text-[12px] text-center py-[16px] px-[24px]",subMenuItemsWrapperParent:"grid grid-cols-2 gap-1 flex-1",subMenuItemsWrapper:"grid grid-cols-4 flex-1"},table:{tableContainer:"relative flex flex-col w-full h-full overflow-x-auto scrollbar-sm border rounded-t-[12px]",tableContainerNoPagination:"rounded-b-[12px]",tableContainer1:"flex flex-col no-wrap min-h-[200px] max-h-[calc(78vh_-_10px)] overflow-y-auto scrollbar-sm",headerContainer:"sticky top-0 grid ",thead:"flex justify-between",theadfrozen:"",thContainer:"w-full font-[500] py-4 pl-4 pr-0 font-[Oswald] text-[12px] uppercase text-[#2d3e4c] border-x",thContainerBg:"bg-[#F3F8F9] text-gray-900",thContainerBgSelected:"bg-gray-50 text-gray-900",cell:"relative flex items-center min-h-[36px]  border border-slate-50",cellInner:`
          w-full min-h-full flex flex-wrap items-center truncate py-1 px-2
          font-['Proxima_Nova'] font-[400] text-[14px] text-[#37576B] leading-[20px]
      `,cellBg:"bg-white",cellBgSelected:"bg-blue-50",cellFrozenCol:"",paginationContainer:"w-full p-2 rounded-b-[12px] bg-[#F3F8F9] flex items-center justify-between",paginationInfoContainer:"",paginationPagesInfo:"font-[500] font-[Oswald] text-[12px] uppercase text-[#2d3e4c] leading-[18px]",paginationRowsInfo:"text-xs font-[Proxima Nova] leading-[14px]",paginationControlsContainer:"flex flex-row items-center border rounded-[8px] overflow-hidden",pageRangeItem:"cursor-pointer px-[12px]  py-[7px] font-[Oswald] font-[500] text-[12px] border-r last:border-none uppercase leading-[18px]",pageRangeItemInactive:"bg-white text-[#2D3E4C]",pageRangeItemActive:"bg-[#2D3E4C] text-white",openOutContainerWrapper:"absolute inset-0 right-0 h-full w-full z-[100]",openOutHeader:"font-semibold font-[Proxima Nova] text-[#37576B] text-[14px] leading-[17.05px]",openOutValue:"font-normal font-[Proxima Nova] text-[#37576B] text-[14px] leading-[19.6px]",openOutTitle:"font-medium font-[Oswald] text-[24px] leading-[100%] uppercase text-[#2D3E4C]"},attribution:{wrapper:"w-full flex flex-col gap-[4px] text-[#2D3E4C] text-xs",label:"font-semibold text-[12px] leading-[14.62px] border-t pt-[14px]",link:"font-normal leading-[14.62px] text-[12px] underline"},label:{labelWrapper:"w-full px-[12px] pt-[9px] pb-[7px] bg-[#C5D7E0] hover:bg-[#E0EBF0] group rounded-[1000px]",labelWrapperDisabled:"px-[12px] pt-[9px] pb-[7px] bg-[#F3F8F9] group rounded-[1000px]",label:"text-[12px] text-[#37576B] font-bold leading-[14.62px]",labelDisabled:"text-[12px] text-[#C5D7E0] font-bold leading-[14.62px]"}},L7=()=>e.jsx(ue,{to:"/",className:" flex flex-col items-center justify-center",children:e.jsxs("div",{className:"flex items-center ",children:[e.jsx("img",{src:"/nys_logo_blue.svg",className:"w-full h-12 justify-between",alt:"New York State Logo"}),e.jsx("div",{className:"font-['Oswald'] font-[500]",children:" TransportNY "})]})}),E7={catalyst:S7,mny:I7,default:{navOptions:{logo:e.jsx(L7,{})}}},Xt={source_id:"source_id",name:"name",display_name:"display_name",type:"type",update_interval:"update_interval",category:"category",categories:"categories",description:"description",statistics:"statistics",metadata:"metadata"},Ot={view_id:"view_id",source_id:"source_id",data_type:"data_type",interval_version:"interval_version",geography_version:"geography_version",version:"version",source_url:"source_url",publisher:"publisher",table_schema:"table_schema",table_name:"table_name",data_table:"data_table",download_url:"download_url",tiles_url:"tiles_url",start_date:"start_date",end_date:"end_date",last_updated:"last_updated",statistics:"statistics",metadata:"metadata",user_id:"user_id",etl_context_id:"etl_context_id",view_dependencies:"view_dependencies",_created_timestamp:"_created_timestamp",_modified_timestamp:"_modified_timestamp"},ft=t=>Object.entries(t||{}).reduce((s,n)=>{const[r,a]=n;return typeof a.value<"u"?s[r]=a.value:s[r]=a,s},{}),ie=C.createContext(void 0),M7=({user:t})=>e.jsxs("div",{className:"flex justify-column align-middle py-1 px-4",children:[e.jsx("div",{className:"pt-[4px]",children:e.jsx("span",{className:`rounded-full border-2 border-blue-400
                    inline-flex items-center justify-center 
                    h-6 w-6 sm:h-8 sm:w-8 ring-white text-white 
                    bg-blue-500 overflow-hidden`,children:e.jsx("i",{className:"fa-duotone fa-user fa-fw pt-2 text-2xl","aria-hidden":"true"})})}),e.jsxs("span",{className:"pl-2",children:[e.jsx("div",{className:"text-md font-thin tracking-tighter  text-left text-blue-600 group-hover:text-white ",children:t.email?t.email:""}),e.jsx("div",{className:"text-xs font-medium -mt-1 tracking-widest text-left text-gray-500 group-hover:text-gray-200",children:t.groups[0]?t.groups[0]:""})]})]}),Pt=(t,s,n,r)=>r===void 0||r?e.jsx(ue,{to:t,children:e.jsx("div",{className:"px-6 py-1 bg-blue-500 text-white hover:text-blue-100",children:e.jsxs("div",{className:"hover:translate-x-2 transition duration-100 ease-out hover:ease-in",children:[e.jsx("i",{className:`${s} `}),e.jsx("span",{className:"pl-2",children:n})]})})}):null,A7=Lr(({title:t,shadowed:s=!0,user:n,children:r})=>{const a=De(),l=Ge();return e.jsx("div",{className:"h-full w-fit",children:n.authed?e.jsx(Li,{control:e.jsx(M7,{user:n}),className:"hover:bg-blue-500 group ",children:e.jsxs("div",{className:"p-1 bg-blue-500",children:[n.authLevel>=5?e.jsxs("div",{className:"py-2",children:[e.jsx("div",{className:"",children:Pt("/admin","fad fa-screwdriver-wrench fa-fw flex-shrink-0  pr-1","Admin")}),e.jsx("div",{className:"",children:Pt("/cenrep","fad fa-database fa-fw flex-shrink-0  pr-1","Cen Rep")}),e.jsx("div",{className:"",children:Pt("/playground/edit","fad fa-flask fa-fw flex-shrink-0  pr-1","Playground")}),e.jsx("div",{className:"",children:Pt("/edit","fad fa-money-check-pen fa-fw flex-shrink-0  pr-1","Edit Site")})]}):"",e.jsx("div",{className:"py-1 border-t border-blue-400",children:Pt("/auth/logout","fad fa-sign-out-alt pb-2 pr-1","Logout")})]})}):e.jsx(ue,{className:`${a.topnav({}).navitemTop}`,to:"/auth/login",state:{from:l==null?void 0:l.pathname},children:"Login"})})}),Ct=({children:t,fullWidth:s,hideBreadcrumbs:n,isListAll:r})=>e.jsx("div",{className:"w-full h-full bg-slate-100",children:e.jsxs("div",{className:`${s?"":"max-w-6xl mx-auto"} h-full flex flex-col`,children:[n?"":e.jsx("div",{className:"",children:e.jsx(O7,{fullWidth:s,isListAll:r})}),e.jsx("div",{className:"flex-1 flex flex-col",children:t})]})}),ze=({baseUrl:t=""})=>e.jsx("div",{className:"pt-[2px]",children:e.jsx("div",{className:"h-full z-50",children:e.jsx(Li,{control:e.jsxs("div",{className:"px-2 flex text-lg",children:[e.jsx("div",{className:" font-medium text-gray-800",children:" Data Manager"}),e.jsx("div",{className:"fal fa-angle-down px-3 mt-[6px] "})]}),className:"text-gray-800 group z-50",openType:"click",children:e.jsxs("div",{className:"p-1 bg-blue-500 text-base z-40",children:[e.jsx("div",{className:"py-1 ",children:Pt(`${t}/`,"fa fa-files flex-shrink-0  pr-1","Sources")},"Sources"),e.jsx("div",{className:"py-1 ",children:Pt(`${t}/mapeditor`,"fa fa-pen-to-square flex-shrink-0  pr-1","Map Editor")},"Map Editor"),e.jsx("div",{className:"py-1 ",children:Pt(`${t}/tasks`,"fa fa-list flex-shrink-0  pr-1","Activity")},"Activity"),e.jsx("div",{className:"py-1 ",children:Pt(`${t}/create/source`,"fa fa-file-plus flex-shrink-0  pr-1","Upload")},"Upload"),e.jsx("div",{className:"py-1 ",children:Pt(`${t}/schedules`,"fa fa-clock flex-shrink-0  pr-1","Schedule Tasks")},"Schedule Tasks")]})})})}),T7=()=>{const{baseUrl:t="/",user:s={}}={};return e.jsx("div",{className:"pt-[2px]",children:(s==null?void 0:s.authLevel)>=5?e.jsx("div",{className:"h-full",children:e.jsx(Li,{control:e.jsxs("div",{className:"px-2 flex text-lg",children:[e.jsx("div",{className:" font-medium text-gray-800",children:" Data Manager"}),e.jsx("div",{className:"fal fa-angle-down px-3 mt-[6px] "})]}),className:"text-gray-800 group",openType:"click",children:e.jsx("div",{className:"p-1 bg-blue-500 text-base",children:e.jsx("div",{className:"py-1 ",children:Pt(`${t}/create/source`,"fa fa-file-plus flex-shrink-0  pr-1","Add New Datasource")})})})}):e.jsx("div",{})})},O7=({fullWidth:t,isListAll:s})=>{const{sourceId:n,page:r,cat1:a,cat2:l}=Be(),{pgEnv:i,baseUrl:c,falcor:d,falcorCache:u}=C.useContext(ie);b.useEffect(()=>{async function p(){return n?await d.get(["dama",i,"sources","byId",n,"attributes",["categories","name","data_type"]]):Promise.resolve({})}p()},[d,n,i]);const m=b.useMemo(()=>{let p=ft(I(u,["dama",i,"sources","byId",n],{attributes:{}}).attributes),x=I(p,"categories[0]",!1)||[a,l].filter(f=>f),h=typeof x!="object"?[]:x.map((f,g)=>({name:f,href:`${c}${s?"/listall":""}/cat/${g>0?x[g-1]+"/":""}${f}`}));return h.push({name:p.name}),h},[u,n,i,a,l,c]);return e.jsx("nav",{className:"border-b border-gray-200 flex ","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:`${t?"w-full":"max-w-screen-xl w-full mx-auto"}  px-4 flex space-x-4 sm:px-6 lg:px-8`,children:[e.jsx("li",{className:"flex",children:e.jsx("div",{className:"flex items-center",children:e.jsxs(ue,{to:`${c||"/"}${s?"/listall":""}`,className:"hover:text-[#bbd4cb] text-[#679d89]",children:[e.jsx("i",{className:"fad fa-database flex-shrink-0 h-5 w-5","aria-hidden":"true"}),e.jsx("span",{className:"sr-only",children:"Data Sources"})]})})}),m.map((p,x)=>e.jsx("li",{className:"flex",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"flex-shrink-0 w-6 h-full text-gray-300",viewBox:"0 0 30 44",preserveAspectRatio:"none",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:e.jsx("path",{d:"M.293 0l22 22-22 22h1.414l22-22-22-22H.293z"})}),p.href?e.jsx(ue,{to:p.href,className:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700","aria-current":p.current?"page":void 0,children:p.name}):e.jsx("div",{className:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700","aria-current":p.current?"page":void 0,children:p.name})]})},x))]})})},uc=t=>{try{JSON.parse(t)}catch{return!1}return!0},mc=t=>{const s={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};return t?new Date(t).toLocaleDateString(void 0,s):""};let D7="https://graph.availabs.org",gt="https://graph1.availabs.org";const wa=t=>typeof t=="object"?t!=null&&t.value?wa(t.value):"N/A":t;function B7(...t){return t.filter(Boolean).join(" ")}async function F7({falcor:t,pgEnv:s,viewId:n}){const r=await t.get(["dama",s,"viewDependencySubgraphs","byViewId",n]),a=await t.get(["dama",s,"views","byId",n,"dependents"]),l=[],i=[];I(r,["json","dama",s,"viewDependencySubgraphs","byViewId",n,"dependencies"],[]).forEach(c=>{l.push(c.source_id),i.push(c.view_id)}),I(a,["json","dama",s,"views","byId",n,"dependents"],[]).forEach(c=>{l.push(c.source_id),i.push(c.view_id)}),await t.get(["dama",s,"sources","byId",l,"attributes",["type","name"]]),await t.get(["dama",s,"views","byId",[n,...i],"attributes",["version","metadata","_modified_timestamp","last_updated"]])}const z7=({dependencies:t={},viewId:s,srcMeta:n,viewMeta:r,baseUrl:a})=>{const[l,i]=b.useState(!1),c=I(t.dependencies.find(d=>d.view_id.toString()===s.toString()),"view_dependencies")||[];return c!=null&&c.length?e.jsxs("div",{className:"w-full my-2",children:[e.jsxs("div",{className:"w-full bg-blue-100 hover:bg-blue-200 text-lg rounded-md p-2",onClick:d=>i(!l),children:[e.jsx("i",{className:`fa fa-angle-${l?"down":"right"}`})," Dependencies"]}),e.jsxs("div",{className:l?"block shadow":"hidden",children:[e.jsx("div",{className:"py-4 sm:py-2 mt-2 sm:grid sm:grid-cols-5 sm:gap-4 sm:px-6 border-b-2",children:["Source Name","Type","Version","Last Updated"].map(d=>e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:typeof d=="object"?JSON.stringify(d):d},d))}),e.jsx("div",{className:"sm:divide-y sm:divide-gray-200",children:t.dependencies.filter(d=>c.includes(d.view_id)).map((d,u)=>e.jsxs("div",{className:"py-4 sm:py-5 sm:grid sm:grid-cols-5 sm:gap-4 sm:px-6",children:[e.jsx("div",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-midivle",children:e.jsx(ue,{to:`${a}/source/${d.source_id}/overview`,children:I(n,[d.source_id,"attributes","name"])})},`${u}_1`),e.jsx("div",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-midivle",children:e.jsx(ue,{to:`${a}/source/${d.source_id}/overview`,children:I(n,[d.source_id,"attributes","type"])})},`${u}_2`),e.jsx("div",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-midivle",children:e.jsx(ue,{to:`${a}/source/${d.source_id}/versions/${d.view_id}`,children:typeof I(r,[d.view_id,"attributes","version"])=="string"?I(r,[d.view_id,"attributes","version"]):""})},`${u}_3`),e.jsx("div",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-midivle",children:e.jsx(ue,{to:`${a}/source/${d.source_id}/versions/${d.view_id}`,children:typeof I(r,[d.view_id,"attributes","_modified_timestamp","value"])=="object"?"":I(r,[d.view_id,"attributes","_modified_timestamp","value"])})},`${u}_4`),e.jsx("div",{className:"mt-1 text-sm text-red-400 sm:mt-0",children:e.jsxs("span",{className:"float-right italic",children:[" ",I(r,[d.view_id,"attributes","metadata","value","authoritative"])==="true"?"":"outdated"]})},`${u}_5`)]},`${u}_0`))})]})]}):null},P7=({dependents:t=[],viewId:s,srcMeta:n,viewMeta:r})=>{const[a,l]=b.useState(!1),{baseUrl:i}=b.useContext(ie);return e.jsxs("div",{className:"w-full my-2",children:[e.jsxs("div",{className:"w-full bg-blue-100 hover:bg-blue-200 text-lg rounded-md p-2",onClick:c=>l(!a),children:[e.jsx("i",{className:`fa fa-angle-${a?"down":"right"}`})," Dependents"]}),e.jsxs("div",{className:a?"block shadow":"hidden",children:[e.jsx("div",{className:"py-4 sm:py-2 mt-2 sm:grid sm:grid-cols-5 sm:gap-4 sm:px-6 border-b-2",children:["Source Name","Type","Version","Last Updated"].map(c=>e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:c},c))}),e.jsx("div",{className:"sm:divide-y sm:divide-gray-200",children:t.map((c,d)=>e.jsxs("div",{className:"py-4 sm:py-5 sm:grid sm:grid-cols-5 sm:gap-4 sm:px-6",children:[e.jsx("div",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-midivle",children:e.jsx(ue,{to:`${i}/source/${c.source_id}/overview`,children:I(n,[c.source_id,"attributes","name"])})},`${d}_1`),e.jsx("div",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-midivle",children:e.jsx(ue,{to:`${i}/source/${c.source_id}/overview`,children:I(n,[c.source_id,"attributes","type"])})},`${d}_2`),e.jsx("div",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-midivle",children:e.jsx(ue,{to:`${i}/source/${c.source_id}/versions/${c.view_id}`,children:I(r,[c.view_id,"attributes","version"])})},`${d}_3`),e.jsx("div",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-midivle",children:e.jsx(ue,{to:`${i}/source/${c.source_id}/versions/${c.view_id}`,children:typeof I(r,[c.view_id,"attributes","_modified_timestamp","value"])=="object"?"":I(r,[c.view_id,"attributes","_modified_timestamp","value"])})},`${d}_4`),e.jsx("div",{className:"mt-1 text-sm text-red-400 sm:mt-0",children:e.jsxs("span",{className:"float-right italic",children:[" ",I(r,[c.view_id,"attributes","metadata","value","authoritative"])==="true"?"":"outdated"]})},`${d}_5`)]},`${d}_0`))})]})]})},R7=({startValue:t,attr:s,viewId:n,cancel:r=()=>{}})=>{const[a,l]=b.useState(""),{pgEnv:i,baseUrl:c,falcor:d}=b.useContext(ie);b.useEffect(()=>{l(t)},[t]);const u=(m,p)=>{n&&d.set({paths:[["dama",i,"views","byId",n,"attributes",m]],jsonGraph:{dama:{[i]:{views:{byId:{[n]:{attributes:{[m]:p}}}}}}}}).then(x=>{r()})};return e.jsxs("div",{className:"w-full flex",children:[e.jsx(Ns,{className:"flex-1 px-2 shadow bg-blue-100 focus:ring-blue-700 focus:border-blue-500  border-gray-300 rounded-none rounded-l-md",value:a,onChange:m=>l(m)}),e.jsx($e,{themeOptions:{size:"sm",color:"primary"},onClick:m=>u(s,a),children:" Save "}),e.jsx($e,{themeOptions:{size:"sm",color:"cancel"},onClick:m=>r(),children:" Cancel "})]})},H7=["CSV","ESRI Shapefile","GeoJSON","GPKG"],vl={open:!1,loading:!1,fileTypes:[],columns:[],enableGroupedBy:!1,groupedByColumn:""},W7=({inputName:t,checked:s,onChange:n})=>e.jsxs("div",{className:"mt-2 flex items-center",children:[e.jsx("input",{id:t,name:t,type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:s,onChange:()=>n(t)}),e.jsx("label",{htmlFor:t,className:"ml-2 text-sm text-gray-900",children:t})]}),V7=({children:t})=>e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[e.jsx("div",{className:"flex justify-between items-center w-1/2 text-md leading-6 text-gray-900",children:e.jsx("div",{className:"text-center h-fit",children:"Split data files"})}),e.jsx("div",{className:"flex mt-2 text-sm items-center",children:"Split up data based on a specified column"}),t]}),U7=({options:t,modalState:s,onChange:n})=>e.jsxs("div",{className:"mt-2 flex items-center",children:[e.jsx("div",{className:"flex mt-2 text-sm items-center",children:"Output will have 1 file per distinct value in:"}),e.jsx("select",{className:"w-full bg-blue-100 rounded mr-2 px-1 flex text-sm",value:s,onChange:r=>n(r.target.value),children:t.map((r,a)=>e.jsx("option",{className:"ml-2 truncate ",value:r,children:r},a))})]}),q7=({onChange:t,modalState:s})=>e.jsx("div",{className:"mt-3 text-center sm:mt-0 sm:text-left",children:e.jsxs("div",{className:"mt-2 flex items-center",children:[e.jsx("input",{id:"enableGroupedBy",name:"enableGroupedBy",value:!0,type:"radio",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:s,onChange:()=>t(!0)}),e.jsx("label",{htmlFor:"enableGroupedBy",className:"ml-2 text-sm text-gray-900",children:"Yes"}),e.jsx("input",{id:"disableGroupedBy",name:"disableGroupedBy",value:!0,type:"radio",className:"h-4 w-4 ml-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:!s,onChange:()=>t(!1)}),e.jsx("label",{htmlFor:"enableGroupedBy",className:"ml-2 text-sm text-gray-900",children:"No"})]})}),oi=({options:t,modalState:s,onChange:n,title:r})=>e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left max-h-[700px] overflow-y-auto",children:[e.jsxs("div",{className:"flex w-full justify-between items-center p-2 w-1/2 text-md leading-6 text-gray-900",children:[e.jsxs("div",{className:"text-center h-fit",children:[r,":"]}),e.jsx("div",{children:e.jsx($e,{themeOptions:{size:"sm"},onClick:()=>{s.length===t.length?n([]):n([...t])},children:"Toggle All"})})]}),e.jsxs("div",{className:"flex mt-2 text-sm items-center",children:["One or more must be selected",s.length>0?e.jsx(_i,{className:"ml-2 text-green-700 h-4 w-4"}):e.jsx(s1,{className:"ml-2 text-red-700 h-4 w-4"})]}),t==null?void 0:t.map(a=>e.jsx(W7,{inputName:a,checked:s.includes(a),onChange:n},`${a}_checkbox`))]});function G7({view:t}){const{viewId:s,sourceId:n}=Be(),{pgEnv:r,baseUrl:a,user:l,falcor:i,falcorCache:c}=b.useContext(ie),[d,u]=b.useState(vl),m=_=>{let L;Array.isArray(_)?L=_:d.fileTypes.includes(_)?L=d.fileTypes.filter(D=>D!==_):(L=[...d.fileTypes],L.push(_)),u({...d,fileTypes:L})},p=_=>{let L;Array.isArray(_)?L=_:d.columns.includes(_)?L=d.columns.filter(D=>D!==_):(L=[...d.columns],L.push(_)),u({...d,columns:L})},x=_=>u({...d,open:_}),h=_=>u({...d,enableGroupedBy:_}),f=_=>u({...d,groupedByColumn:_}),g=b.useMemo(()=>{let _=I(c,["dama",r,"sources","byId",t.source_id,"attributes","metadata","value"],[]);return _=_!=null&&_.columns?_.columns:_,Array.isArray(_)?_.map(L=>L.name):[]},[c,t]),y=b.useMemo(()=>g?{...vl,columns:g}:vl,[g]);b.useEffect(()=>{g&&u({...d,columns:g})},[g]);const v=()=>{(async()=>{try{const L={source_id:n,view_id:s,fileTypes:d.fileTypes,columns:d.columns,user_id:l.id,email:l.email,groupedByColumn:d.groupedByColumn};u({...d,loading:!0});const A=await(await fetch(`${gt}/dama-admin/${r}/gis-dataset/create-download`,{method:"POST",body:JSON.stringify(L),headers:{"Content-Type":"application/json"}})).json();u(y)}catch(L){console.log(L),u({...d,loading:!1,open:!0})}})()},[j,N]=C.useState({open:!1,selectedColumns:[],columnsHaveBeenInitialized:!1,etl_context_id:null,progress:"not-started"});C.useCallback(_=>{N(L=>({...L,..._}))},[]);const S=C.useCallback(_=>{_.stopPropagation(),N(L=>({...L,open:!0,etl_context_id:null,progress:"not-started"}))},[]),w=C.useCallback(()=>{N(_=>({..._,open:!1}))},[]),k=C.useCallback(_=>{Array.isArray(_)?N(L=>({...L,selectedColumns:_})):N(L=>({...L,selectedColumns:L.selectedColumns.includes(_)?L.selectedColumns.filter(D=>D!==_):[...L.selectedColumns,_]}))},[]);C.useEffect(()=>{g.length&&!j.columnsHaveBeenInitialized&&N(_=>({..._,selectedColumns:[...g],columnsHaveBeenInitialized:!0}))},[j.columnsHaveBeenInitialized,g]);const $=C.useCallback(()=>{fetch(`${gt}/dama-admin/${r}/cache-pmtiles`,{method:"POST",body:JSON.stringify({columns:[...j.selectedColumns],view_id:s,source_id:n}),headers:{"Content-Type":"application/json"}}).then(_=>_.json()).then(_=>{console.log("RES:",_),N(L=>({...L,etl_context_id:_.etl_context_id,progress:"started"}))})},[j,n,s,r,i]),E=C.useCallback(_=>{N(L=>({...L,progress:_}))},[]),M="w-full flex-1 text-center border shadow p-2 font-medium rounded-md hover:text-white";return e.jsxs("div",{className:"w-72 px-5",children:[l.authLevel>=10?e.jsxs("div",{className:"w-full flex flex-col p-1",children:[e.jsxs("button",{className:`${M} bg-blue-300 hover:bg-blue-600 mb-1`,onClick:()=>{u({...d,open:!0})},children:[e.jsx("i",{className:"fa fa-download"})," Create Download"]}),e.jsxs("button",{className:`${M} bg-green-300 hover:bg-green-600 mb-1`,onClick:S,children:[e.jsx("i",{className:"fa fa-download"})," Cache PM Tiles"]}),e.jsxs(ue,{className:`${M} bg-red-300 border-red-200 hover:bg-red-600`,to:`${a}/source/${n}/versions/${s}/delete`,children:[e.jsx("i",{className:"fad fa-trash"})," Delete View"]})]}):"",e.jsx(J7,{...j,close:w,columns:g.filter(_=>_!=="wkb_geometry"),setSelectedColumns:k,cachePmTiles:$,updateProgress:E}),e.jsxs(kp,{open:d.open,setOpen:x,themeOptions:{size:"large"},children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fad fa-layer-group text-blue-600","aria-hidden":"true"})}),e.jsx("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:e.jsx("div",{className:"text-lg align-center font-semibold leading-6 text-gray-900",children:"Create Data Download"})})]}),e.jsxs("div",{className:"pl-10 grid grid-cols-3",children:[e.jsx(oi,{title:"File Types",options:H7,modalState:d.fileTypes,onChange:m}),e.jsx(oi,{title:"Columns",options:g,modalState:d.columns,onChange:p}),e.jsxs(V7,{children:[e.jsx(q7,{onChange:h,modalState:d.enableGroupedBy}),d.enableGroupedBy&&e.jsx(U7,{options:d.columns,modalState:d.groupedByColumn,onChange:f})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",disabled:d.loading||d.fileTypes.length===0||d.columns.length===0,className:"disabled:bg-slate-300 disabled:cursor-warning inline-flex w-full justify-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 sm:ml-3 sm:w-auto",onClick:v,children:d.loading?"Sending request...":"Start download creation"}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>x(!1),children:"Cancel"})]})]})]})}const J7=t=>{const{close:s,columns:n,selectedColumns:r,setSelectedColumns:a,cachePmTiles:l,etl_context_id:i,progress:c,updateProgress:d,...u}=t;return e.jsx(kp,{...u,children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:`
            pb-2 border-b-2 border-black
          `,children:e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(oi,{title:"Columns",options:n,modalState:r,onChange:a}),e.jsx("div",{className:"col-span-2",children:i?e.jsx(X7,{etl_context_id:i,updateProgress:d}):null})]})}),e.jsxs("div",{className:"pt-2 grid grid-cols-12 gap-2",children:[e.jsx("div",{className:"col-start-7 col-span-3",children:e.jsx(Q7,{onClick:s,disabled:c==="started",children:"Close"})}),e.jsx("div",{className:"col-span-3",children:e.jsx(Y7,{onClick:l,disabled:!r.length||c!=="not-started",color:"green",children:"Cache PM Tiles"})})]})]})})},X7=({etl_context_id:t})=>{const{pgEnv:s,falcor:n,falcorCache:r,updateProgress:a}=b.useContext(ie),[l,i]=C.useState(0),[c,d]=C.useState([]),u=C.useCallback(()=>{t&&(n.invalidate(["dama",s,"etlContexts","byEtlContextId",t]),n.get(["dama",s,"etlContexts","byEtlContextId",t]).then(()=>{i(Date.now())}))},[n,s,t]),m=C.useRef(null),p=C.useCallback((x=5e3)=>{new Promise(h=>{clearTimeout(m.current),m.current=setTimeout(h,x)}).then(()=>{u()})},[u]);return C.useEffect(()=>{if(!c.length)p(1e3);else{const x=c[0],[h,f]=x.type.split(":"),g=c[c.length-1],[y,v]=g.type.split(":");h===y&&(v!=="ERROR"||v!=="FINAL")?p():a("completed")}},[c,u,p,l,a]),C.useEffect(()=>{if(!t)d([]);else{const x=I(r,["dama",s,"etlContexts","byEtlContextId",t,"value","events"],[]);d(x)}},[r,s,t]),e.jsxs("div",{className:"py-1 px-2 grid grid-cols-1",style:{fontSize:"0.8rem"},children:[e.jsxs("div",{className:"border-b-2 border-current flex",children:[e.jsx("div",{className:"font-medium text-sm flex-1",children:"Progress Window"}),e.jsxs("div",{children:["etl context id: ",t]})]}),c.map(x=>e.jsx(Z7,{damaEvent:x},x.event_id))]})},Z7=({damaEvent:t})=>{const s=C.useMemo(()=>I(t,["payload","data"],null),[t]);return e.jsxs("div",{className:"flex",children:[t.type,s?"==>":""," ",s]})},pf=({className:t="",onClick:s,disabled:n=!1,children:r})=>{const a=C.useCallback(l=>{l.stopPropagation(),typeof s=="function"&&s()},[s]);return e.jsx("button",{disabled:n,onClick:a,className:`
        w-full py-2 rounded cursor-pointer
        disabled:opacity-50 disabled:cursor-not-allowed
        text-sm text-black hover:text-white hover:disabled:text-black
        ${t}
      `,children:r})},Y7=t=>e.jsx(pf,{...t,className:"bg-green-300 hover:bg-green-600 hover:disabled:bg-green-300"}),Q7=t=>e.jsx(pf,{...t,className:"bg-slate-300 hover:bg-slate-600 hover:disabled:bg-slate-300"}),K7={source_url:"source url",_created_timestamp:"Created",_modified_timestamp:"Updated",geography_version:"Geography Version",interval_version:"Interval Version",data_type:"Data Type"},wl=({attr:t,editing:s,setEditing:n,user:r,val:a,view:l,display:i="row",valueClass:c="w-3/4 font-semibold"})=>e.jsxs("div",{className:"w-full flex justify-between group hover:bg-blue-50 rounded-lg items-middle",children:[e.jsxs("div",{className:`w-full flex flex-col sm:flex-${i} items-center pb-2 pt-5 px-1`,children:[e.jsx("dt",{className:"w-1/4 text-sm font-medium text-gray-500 capitalize",children:K7[t]||t}),e.jsx("dd",{className:"w-3/4 text-sm text-gray-900 sm:mt-0",children:s===t?e.jsx("div",{className:"pt-3 pr-8",children:e.jsx(R7,{startValue:a,attr:t,viewId:l.view_id,cancel:()=>n(null)})}):e.jsx("div",{className:c||"w-3/4 font-semibold",children:t==="source_url"?e.jsx(ue,{to:a||"#",children:a||"N/A"}):a||"N/A"})})]}),r.authLevel>5&&n?e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer p-2",onClick:d=>n(s===t?null:t),children:e.jsx("i",{className:"fad fa-pencil absolute p-2 -ml-4 rounded hover:bg-blue-500 hover:text-white "})}):""]}),xf=({view:t,columns:s=[],flexDir:n="col",showControls:r=!1})=>{var p,x;const[a,l]=b.useState(null),{user:i}=b.useContext(ie),c={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},d=new Date(wa((p=t._created_timestamp)==null?void 0:p.value)).toLocaleDateString(void 0,c),u=new Date(wa((x=t._modified_timestamp)==null?void 0:x.value)).toLocaleDateString(void 0,c),m="text-blue-600 font-semibold";return e.jsx("div",{className:"overflow-hidden",children:e.jsxs("div",{className:"flex justify-between border-t border-gray-200 px-4 py-5 sm:p-0",children:[e.jsx("div",{className:`w-full flex flex-${n}`,children:Object.keys(Ot).filter(h=>!(s!=null&&s.length)||s.includes(h)).filter(h=>!["view_id","source_id","description","statistics","category","table_schema","table_name","data_table","tiles_url","last_updated","view_dependencies","start_date","end_date","download_url","user_id","etl_context_id","_created_timestamp","_modified_timestamp","metadata"].includes(h)).map((h,f)=>{let g=wa(t[h]);return e.jsx(wl,{attr:h,val:g,editing:a,setEditing:l,view:t,user:i},f)})}),e.jsxs("div",{className:"w-fit flex flex-col space-between",children:[(!s.length||s.includes("_created_timestamp"))&&e.jsx(wl,{attr:"_created_timestamp",val:d,view:t,user:i,display:"col",valueClass:m}),(!s.length||s.includes("_modified_timestamp"))&&e.jsx(wl,{attr:"_modified_timestamp",val:u,view:t,user:i,display:"col",valueClass:m}),r&&e.jsx(G7,{view:t})]})]})})};function ek(){var h;const{viewId:t,sourceId:s}=Be(),{pgEnv:n,baseUrl:r,falcor:a,falcorCache:l}=b.useContext(ie);b.useEffect(()=>{F7({falcor:a,pgEnv:n,viewId:t})},[t,n,a]);const i=I(l,["dama",n,"viewDependencySubgraphs","byViewId",t,"value"],{dependencies:[]}),c=I(l,["dama",n,"views","byId",t,"dependents","value"],[]),d=I(l,["dama",n,"sources","byId"],{}),u=I(l,["dama",n,"views","byId"],{}),m=I(l,["dama",n,"views","byId",t,"attributes"],{}),p=I(l,["dama",n,"sources","byId",s,"attributes","name"],""),x=typeof(m==null?void 0:m.version)=="object"?null:m==null?void 0:m.version;return e.jsx("div",{className:"overflow-hidden flex flex-col md:flex-row",children:e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex justify-between",children:e.jsxs("div",{className:"flex-1 sm:px-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row justify-between overflow-hidden sm:mt-0 sm:col-span-3",children:e.jsxs("div",{className:"py-2 px-2 text-2xl text-gray-700 font-medium ",children:[p," - ",x||t]})}),e.jsxs("div",{children:[e.jsx(xf,{view:m,baseUrl:r,showControls:!0}),i!=null&&i.dependencies&&((h=i==null?void 0:i.dependencies)==null?void 0:h.length)>0?e.jsx(z7,{viewId:t,dependencies:i,srcMeta:d,viewMeta:u,baseUrl:r}):"",c&&c.length>0?e.jsx(P7,{viewId:t,dependents:c,srcMeta:d,viewMeta:u,baseUrl:r}):""]})]})})})})}function tk({view:t}){var s;return(s=t==null?void 0:t.metadata)!=null&&s.download?e.jsxs("div",{className:"inline-flex rounded-md shadow-sm",children:[e.jsx("button",{type:"button",className:"relative inline-flex items-center rounded-l-md bg-white px-10 py-[12px] text-md font-semibold text-blue-700 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-10",children:"Download"}),e.jsxs(ye,{as:"div",className:"absolute ml-32 block",children:[e.jsxs(ye.Button,{className:"relative inline-flex items-center rounded-r-md bg-white px-2 py-3 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-10",children:[e.jsx("span",{className:"sr-only",children:"Open options"}),e.jsx(up,{className:"h-5 w-5","aria-hidden":"true"})]}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx(ye.Items,{anchor:{to:"bottom start",gap:"4px"},className:"absolute z-20 right-0 -mr-1 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:e.jsx("div",{className:"py-1",children:Object.keys(t.metadata.download).map((n,r)=>e.jsx(ye.Item,{children:({active:a})=>e.jsx("a",{href:t.metadata.download[n].replace("$HOST",`${gt}`),className:B7(a?"bg-gray-100 text-gray-900":"text-gray-700","block px-4 py-2 text-sm"),children:n})},r))})})})]})]}):"Download Not Available"}async function sk({falcor:t,pgEnv:s,viewId:n}){const r=await t.get(["dama",s,"views","byId",n,"dependents"],["dama",s,"views","byId",n,"attributes","source_id"]),a=[],l=[];I(r,["json","dama",s,"views","byId",n,"dependents"]).forEach(c=>{a.push(c.source_id),l.push(c.view_id)}),await t.get(["dama",s,"sources","byId",a,"attributes",["type","name"]]),await t.get(["dama",s,"views","byId",l,"attributes",["version","metadata","_modified_timestamp","last_updated"]]);const i=t.getCache();return{dependents:I(i,["dama",s,"views","byId",n,"dependents","value"],[]),sourceId:I(r,["json","dama",s,"views","byId",n,"attributes","source_id"],[]),srcMeta:I(i,["dama",s,"sources","byId"],{}),viewMeta:I(i,["dama",s,"views","byId"],{})}}const hf=({text:t,viewId:s,sourceId:n,pgEnv:r,baseUrl:a,falcor:l})=>{const i=Le();return e.jsx("button",{className:"bg-red-50 hover:bg-red-400 hover:text-white p-2",onClick:async()=>{await fetch(`${gt}/dama-admin/${r}/deleteDamaView`,{method:"POST",body:JSON.stringify({view_id:s}),headers:{"Content-Type":"application/json"}}),await l.invalidate(["dama",r,"sources","byId",n,"views","length"]),i(`${a}/source/${n}/versions`)},children:t})},nk=({dependents:t,viewId:s,srcMeta:n,viewMeta:r})=>e.jsxs("div",{className:"w-full p-4 shadow mb-4",children:[e.jsx("label",{className:"text-lg",children:"Dependents"}),e.jsx("div",{className:"py-4 sm:py-2 mt-2 sm:grid sm:grid-cols-5 sm:gap-20 sm:px-6 border-b-2",children:["Source Name","Type","Version","Last Updated"].map(a=>e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:a},a))}),e.jsx("dl",{className:"sm:divide-y sm:divide-gray-200",children:t.map((a,l)=>e.jsxs("div",{className:"py-4 sm:py-5 sm:grid sm:grid-cols-5 sm:gap-20 sm:px-6",children:[e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:e.jsx(ue,{to:`/source/${a.source_id}/overview`,children:I(n,[a.source_id,"attributes","name"])})},`${l}_1`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:e.jsx(ue,{to:`/source/${a.source_id}/overview`,children:I(n,[a.source_id,"attributes","type"])})},`${l}_2`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:e.jsx(ue,{to:`/source/${a.source_id}/views/${a.view_id}`,children:I(r,[a.view_id,"attributes","version"])})},`${l}_3`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:e.jsx(ue,{to:`/source/${a.source_id}/views/${a.view_id}`,children:typeof I(r,[a.view_id,"attributes","_modified_timestamp","value"])=="object"?"":I(r,[a.view_id,"attributes","_modified_timestamp","value"])})},`${l}_4`),e.jsx("dd",{className:"mt-1 text-sm text-red-400 sm:mt-0",children:e.jsxs("span",{className:"float-right italic",children:[" ",I(r,[a.view_id,"attributes","metadata","value","authoritative"])==="true"?"":"outdated"]})},`${l}_5`)]},`${l}_0`))})]}),rk=(t,s,n,r,a,l,i,c)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-4 flex justify-between",children:[e.jsx("label",{children:"The View has following dependents:"}),e.jsx(hf,{text:"Delete anyway",viewId:n,sourceId:s,pgEnv:l,baseUrl:i,falcor:c})]}),e.jsx("div",{className:"bg-red-50",children:e.jsx(nk,{viewId:n,srcMeta:r,viewMeta:a,dependents:t})})]}),ak=(t,s,n,r,a)=>e.jsxs("div",{className:"pb-4 flex justify-between",children:[e.jsx("label",{children:"No dependents found."}),e.jsx(hf,{text:"Confirm Delete",viewId:t,sourceId:s,pgEnv:n,baseUrl:r,falcor:a})]});function ok(){const{sourceId:t,viewId:s}=Be(),{pgEnv:n,baseUrl:r,falcor:a,falcorCache:l}=C.useContext(ie);b.useEffect(()=>{sk({falcor:a,pgEnv:n,viewId:s})},[s,n,a]);const i=I(l,["dama",n,"views","byId",s,"dependents","value"],[]),c=I(l,["dama",n,"sources","byId"],{}),d=I(l,["dama",n,"views","byId"],{});return e.jsxs("div",{className:"w-full p-4 bg-white my-1 block border shadow",children:[e.jsxs("div",{className:"pb-4 font-bold",children:["Delete ",e.jsx("i",{children:s})]}),i.length?rk(i,t,s,c,d,n,r,a):ak(s,t,n,r,a)]})}const ff=({source:t,views:s,meta:n})=>{const{pgEnv:r,baseUrl:a,user:l}=C.useContext(ie),{sourceId:i,viewId:c,vPage:d}=Be();return d==="delete"?e.jsx(ok,{}):c?e.jsx(ek,{}):e.jsx("div",{children:e.jsx(Dn,{disableFilters:!0,disableSortBy:!0,sortBy:"_created_timestamp",data:s,columns:[{Header:"Version Id",accessor:u=>e.jsxs(ue,{className:"text-blue-500",to:`${a}/source/${i}/versions/${u.view_id}`,children:[" ",u.version||u.view_id]})},{Header:"User",accessor:"user_id"},{Header:"Uploaded",accessor:u=>mc(u._created_timestamp)},{Header:" Download",accessor:u=>e.jsx(tk,{view:u}),disableFilters:!0}],striped:!0})})},lk=(t,s)=>{t=I(t,"current",t),C.useEffect(()=>{if(!t)return;const n=r=>{t&&!t.contains(r.target)&&s(r)};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[t,s])},ik=({source:t,symbology:s={},entityType:n="sources"})=>{const[r,a]=C.useState([]),{pgEnv:l,falcor:i}=C.useContext(ie),c=n==="sources"?t.source_id:s.symbology_id,d=C.useCallback(m=>{i.set({paths:[["dama",l,n,"byId",c,"attributes","categories"]],jsonGraph:{dama:{[l]:{[n]:{byId:{[c]:{attributes:{categories:JSON.stringify(m)}}}}}}}}).then(()=>{})},[l,i,c]),u=n==="sources"?t:s;return C.useEffect(()=>{const m=I(u,"categories",[]);Array.isArray(m)?a(m):a([])},[u]),[r,d]},Lu=({children:t,remove:s,indices:n,editing:r,className:a=""})=>{const l=C.useCallback(i=>{s(...n)},[s,n]);return e.jsxs("div",{className:`
        overflow-hidden text-ellipsis whitespace-nowrap ${a}
        flex-1 flex items-center py-1 pl-2 pr-4 bg-blue-200 text-blue-600 font-light hover:bg-blue-50 mr-2 rounded-md my-1
      `,children:[e.jsx("div",{className:"flex-1",children:t}),r?e.jsx("button",{onClick:l,className:"hover:text-red-500 pl-2",children:e.jsx("span",{className:"fas fa-remove"})}):null]})},ck=()=>e.jsx("span",{className:"fas fa-caret-right mx-1"}),dk=t=>e.jsx("span",{...t,className:`
        fas fa-plus p-1 rounded cursor-pointer
        text-blue-500 hover:bg-blue-500 hover:text-white
      `}),uk=t=>{const{categories:s,parent:n,addNewCategory:r,removeCategory:a,editingCategories:l}=t,i=s.length,[c,d]=C.useState(!1),u=C.useCallback(x=>{x.stopPropagation(),d(!0)},[]),m=C.useCallback(x=>{x.stopPropagation(),d(!1)},[]),p=C.useCallback(x=>{r(x,n),d(!1)},[r,n,m]);return e.jsxs("div",{className:`flex flex-col border-current ${l?"border-b":""}`,children:[e.jsxs("div",{className:`flex ${l?"border-b":""}`,children:[e.jsx(Lu,{className:"font-bold flex-1",remove:a,indices:[n,0],editing:c||l,children:s[0]}),!l||c?null:e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(dk,{onClick:u})})]}),e.jsx("div",{className:"flex ml-4",children:s.slice(1).map((x,h)=>e.jsxs(Lu,{remove:a,indices:[n,h+1],editing:c||l,children:[e.jsx("span",{children:x}),h<i-2?e.jsx(ck,{}):null]},x))}),c?e.jsx(bf,{isSub:!0,stopEditing:m,addNewCategory:p}):null]})},gf=t=>{const{editingCategories:s,stopEditingCategories:n}=t,[r,a]=ik(t),l=C.useCallback((c,d=-1)=>{a(d===-1?[...r,[c]]:r.reduce((u,m,p)=>(p===d?u.push([...m,c]):u.push(m),u),[]))},[r,a]),i=C.useCallback((c,d=0)=>{if(d===0){const u=[...r];u.splice(c,1),a(u)}else r[c].splice(d,1),a(r)},[r,a]);return e.jsxs("div",{children:[r==null?void 0:r.map((c,d)=>e.jsx(uk,{categories:c,parent:d,editingCategories:s,addNewCategory:l,removeCategory:i},d)),s?e.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[e.jsx(bf,{addNewCategory:l}),e.jsx($e,{onClick:n,themeOptions:{size:"sm",color:"cancel"},children:"Stop editing categories"})]}):null]})},mk=({onChange:t,...s})=>{const n=C.useCallback(l=>{t(l.target.value)},[t]),[r,a]=C.useState(null);return C.useEffect(()=>{r&&r.focus()},[r]),e.jsx("input",{type:"text",ref:a,...s,className:"px-2 w-full",onChange:n})},bf=({addNewCategory:t,stopEditing:s,isSub:n=!1})=>{const[r,a]=C.useState(""),l=C.useCallback(m=>{m.stopPropagation(),t(r),a("")},[t,r]),i=C.useCallback(m=>{typeof s=="function"&&s(m),a("")},[s]),c=C.useCallback(m=>{m.key==="Enter"||m.keyCode===13?l(m):(m.key==="Escape"||m.keyCode===27)&&i(m)},[l,i]),[d,u]=C.useState(null);return lk(d,i),e.jsx("div",{ref:u,className:"px-2 py-1 bg-gray-100 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"mb-1",children:e.jsx(mk,{type:"text",value:r,onChange:a,onKeyDown:c})}),e.jsx("div",{className:"px-2 rounded bg-gray-200 text-center",children:r?"Press Enter to save or Esc to cancel":`Start typing to add new ${n?"subcategory":"category"}`})]})})},Eu=t=>(t.display_name?1:0)+(t.description?1:0),Mu=(t,s)=>Eu(s)-Eu(t),pk=({source:t,...s})=>{const{pgEnv:n,falcor:r,user:a}=C.useContext(ie),{authLevel:l}=a;t.source_id;const[i,c]=C.useState([]),[d,u]=C.useState(15),m=Ue.lexical.ViewComp;if(C.useEffect(()=>{const f=JSON.parse(JSON.stringify(I(t,"metadata",[])));if(Array.isArray(f))c(f.sort(Mu).map(g=>({display:"",...g})));else if(f&&"columns"in f){const g=I(f,"columns",[]);Array.isArray(g)?c(g.sort(Mu).map(y=>({display:"",...y}))):c([])}else c([])},[t]),!i||!i.map||i.length===0)return e.jsx("div",{children:" Metadata Not Available "});const p=["column","description"].map(f=>({Header:f,accessor:f,align:"left",width:f==="column"?"30%":"70%",minWidth:f==="column"?"30%":"70%",maxWidth:f==="column"?"30%":"70%"})),x=i==null?void 0:i.length,h=i.filter((f,g)=>g<d).map(f=>({column:e.jsxs("div",{className:"pr-8 font-bold",children:[I(f,"display_name",I(f,"name"))||"No Name",e.jsxs("span",{className:"italic pl-1 pt-3 pr-8 font-light",children:["(",I(f,"type"),")"]})]}),description:I(f,["desc","root"])?e.jsx(m,{value:I(f,"desc")}):e.jsx("div",{className:"pl-6",children:I(f,"desc")||"No Description"})}));return e.jsxs(e.Fragment,{children:[e.jsx(Dn,{columns:p,data:h,pageSize:d,striped:!0}),x>15?e.jsx("div",{className:"float-right text-blue-600 underline text-sm cursor-pointer",onClick:()=>u(d===15?x:15),children:d>15?"see less":"see more"}):null]})},xk=({source:t,pageSize:s,...n})=>e.jsx("div",{className:"w-full flex-1 sm:grid sm:grid-cols-2 sm:gap-4 sm:px-6",children:e.jsx("div",{className:"col-span-3",children:e.jsx(pk,{source:t,pageSize:s})})}),Rn=async({sourceId:t,pgEnv:s,falcor:n,metadata:r,setMetadata:a,col:l,value:i})=>{const c=r.map(d=>d.name===l?{...d,...i}:d);await a(c),await n.call(["dama","sources","metadata","update"],[s,t,{columns:c}])},yf=({value:t,setValue:s,save:n,cancel:r})=>e.jsxs("div",{className:"w-full flex flex-col h-full border border-lime-300",children:[e.jsx("div",{children:e.jsx("textarea",{className:"flex-1 w-full px-2 shadow bg-blue-100 min-h-[200px] focus:ring-blue-700 focus:border-blue-500  border-gray-300 rounded-none rounded-l-md",onChange:a=>s(a.target.value),children:t})}),e.jsxs("div",{className:"flex py-2",children:[e.jsx("div",{className:"flex-1"}),e.jsx($e,{themeOptions:{size:"sm",color:"primary"},onClick:a=>n(t),children:" Save "}),e.jsx($e,{themeOptions:{size:"sm",color:"cancel"},onClick:a=>r(),children:" Cancel "})]})]}),pc=({value:t,setValue:s,save:n,cancel:r})=>e.jsxs("div",{className:"w-full flex flex-1 flex-col",children:[e.jsx("input",{className:"p-2 flex-1 px-2 shadow bg-blue-100 focus:ring-blue-700 focus:border-blue-500  border-gray-300 rounded-none rounded-md",value:t,onChange:a=>s(a.target.value)}),e.jsxs("div",{className:"flex self-end",children:[e.jsx($e,{themeOptions:{size:"sm",color:"primary"},onClick:a=>n(t),children:" Save "}),e.jsx($e,{themeOptions:{size:"sm",color:"cancel"},onClick:a=>r(),children:" Cancel "})]})]}),vf=({Comp:t,value:s,setValue:n,save:r,cancel:a})=>e.jsxs("div",{className:"w-full flex flex-1 flex-col",children:[e.jsx(t,{value:s,onChange:n}),e.jsxs("div",{className:"flex self-end",children:[e.jsx($e,{themeOptions:{size:"sm",color:"primary"},onClick:l=>r(s),children:" Save "}),e.jsx($e,{themeOptions:{size:"sm",color:"cancel"},onClick:l=>a(),children:" Cancel "})]})]}),jl=({metadata:t,setMetadata:s,col:n,startValue:r,attr:a,sourceId:l,type:i="text",setEditing:c=()=>{},cancel:d=()=>{}})=>{const[u,m]=b.useState(r),{pgEnv:p,baseUrl:x,falcor:h}=C.useContext(ie),f=Ue.lexical.EditComp;b.useEffect(()=>{m(r)},[r]);const g=y=>{Rn({sourceId:l,pgEnv:p,falcor:h,metadata:t,setMetadata:s,col:n,value:{[a]:y}}).then(()=>c(null))};return i==="textarea"?e.jsx(yf,{value:u,setValue:m,save:g,cancel:d}):i==="lexical"?e.jsx(vf,{Comp:f,value:u,setValue:m,save:g,cancel:d}):e.jsx(pc,{value:u,setValue:m,save:g,cancel:d})},Cl=({metadata:t,setMetadata:s,col:n,startValue:r,attr:a,sourceId:l,type:i="text",setEditing:c=()=>{},cancel:d=()=>{}})=>{const[u,m]=b.useState(r&&uc(r)?JSON.parse(r):r),{pgEnv:p,baseUrl:x,falcor:h}=C.useContext(ie),f=Ue.lexical.EditComp;b.useEffect(()=>{m(r)},[r]);const g=()=>{console.log("saving",u),l&&h.set({paths:[["dama",p,"sources","byId",l,"attributes",a]],jsonGraph:{dama:{[p]:{sources:{byId:{[l]:{attributes:{[a]:i==="lexical"?JSON.stringify(u):u}}}}}}}}).then(y=>{d()})};return i==="textarea"?e.jsx(yf,{value:u,setValue:m,save:g,cancel:d}):i==="lexical"?e.jsx(vf,{Comp:f,value:u,setValue:m,save:g,cancel:d}):e.jsx(pc,{value:u,setValue:m,save:g,cancel:d})},da=({user:t,editing:s,setEditing:n,attr:r})=>(t==null?void 0:t.authLevel)<=5?null:e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:a=>n(s===r?null:r),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-12 mt-3 p-2.5 rounded hover:bg-blue-500 hover:text-white "})}),wf=t=>{var s,n;return(n=(s=uc(t)?JSON.parse(t):t)==null?void 0:s.root)!=null&&n.children?t:{root:{children:[{children:[{detail:0,format:0,mode:"normal",text:t||"No Description",type:"text",version:1},{detail:0,format:0,mode:"normal",text:`

`,type:"text",version:1}],tag:"",direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}}},hk=({source:t,views:s,activeViewId:n})=>{var j,N,S,w,k,$,E,M;const[r,a]=C.useState(null),l=C.useCallback(_=>{a(null)},[]),{pgEnv:i,baseUrl:c,user:d}=C.useContext(ie),u=n||((j=s[0])==null?void 0:j.view_id),m=(N=s[(s==null?void 0:s.length)-1])==null?void 0:N.view_id,p={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},x=new Date(((w=(S=s.filter(_=>_.view_id===u))==null?void 0:S[0])==null?void 0:w._created_timestamp)||"").toLocaleDateString(void 0,p),h=new Date((($=(k=s.filter(_=>_.view_id===m))==null?void 0:k[0])==null?void 0:$._modified_timestamp)||"").toLocaleDateString(void 0,p),f=Ue.lexical.ViewComp,g={update_interval:"update interval"},y=(E=I(t,["metadata","columns"],I(t,"metadata",[])))==null?void 0:E.length,v=t.description;return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsxs("div",{className:"flex flex-col w-full md:w-[70%]",children:[e.jsxs("div",{className:"flex justify-between group",children:[e.jsx("div",{className:"flex-1",children:e.jsx("dd",{className:"mt-1 text-2xl text-blue-600 font-medium overflow-hidden sm:mt-0 sm:col-span-3",children:r==="name"?e.jsx("div",{className:"pt-3 pr-8",children:e.jsx(Cl,{startValue:t.name,attr:"name",sourceId:t.source_id,cancel:l})}):e.jsx("div",{className:"py-2 px-2",children:t.name})})}),e.jsx(da,{attr:"name",user:d,editing:r,setEditing:a})]}),e.jsxs("div",{className:"w-full pl-4 py-2 sm:pl-6 flex justify-between group",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"text-sm text-gray-500 pr-14",children:r==="description"?e.jsx(Cl,{startValue:v,attr:"description",type:"lexical",sourceId:t==null?void 0:t.source_id,cancel:l}):e.jsx("div",{className:"pr-8",children:t.description?e.jsx(f,{value:wf(v)}):e.jsx("div",{className:"min-h-10",children:"No Description"})})})}),e.jsx(da,{attr:"description",user:d,editing:r,setEditing:a})]}),e.jsx("div",{className:"ml-4",children:e.jsx(xf,{view:((M=s.filter(_=>_.view_id===u))==null?void 0:M[0])||{},columns:["publisher","source_url"],flexDir:"col"})})]}),e.jsxs("div",{className:"w-full md:w-[30%]",children:[e.jsxs("div",{className:"mt-2 flex flex-col px-6 text-sm text-gray-600",children:["Created",e.jsx("span",{className:"text-l font-medium text-blue-600 ",children:x})]}),e.jsxs("div",{className:"mt-2 flex flex-col px-6 text-sm text-gray-600",children:["Updated",e.jsx("span",{className:"text-l font-medium text-blue-600 ",children:h})]}),e.jsxs("div",{className:"flex justify-between group",children:[e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-2 sm:gap-1 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 mt-1.5",children:"Categories"}),e.jsx("dd",{className:"text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.jsx("div",{className:"pb-2 px-2 relative",children:e.jsx(gf,{source:t,editingCategories:r==="categories",stopEditingCategories:l})})})]}),e.jsx(da,{attr:"categories",user:d,editing:r,setEditing:a})]},"categories"),e.jsx("div",{className:"mx-5",children:e.jsx("div",{className:"flex flex-row w-full",children:Object.keys(Xt).filter(_=>["type","update_interval"].includes(_)).map((_,L)=>{let D=typeof t[_]=="object"?JSON.stringify(t[_]):t[_];return e.jsxs("div",{className:"w-1/2 flex justify-between group hover:bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"w-full flex flex-col space-between items-left",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 px-1 capitalize",children:g[_]||_}),e.jsx("div",{className:"w-full text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:r===_?e.jsx("div",{className:"pt-3 pr-8 z-10",children:e.jsx(Cl,{startValue:D,attr:_,sourceId:t.source_id,cancel:l})}):e.jsx("div",{className:"w-full py-2 px-2 font-semibold truncate uppercase",children:D||"N/A"})})]}),e.jsx(da,{attr:_,user:d,editing:r,setEditing:a})]},_)})})})]})]}),e.jsxs("div",{className:"flex items-center p-2 mx-4 text-blue-600 hover:bg-blue-50 rounded-md",children:["Columns",e.jsx("span",{className:"bg-blue-200 text-blue-600 text-xs p-1 ml-2 shrink-0 grow-0 rounded-lg flex items-center justify-center border border-blue-300",children:y})]}),e.jsx(xk,{source:t}),e.jsxs("div",{className:"py-5 pr-2",children:[e.jsx("div",{className:"p-2 mx-4 text-blue-600 hover:bg-blue-50 rounded-md",children:"Versions"}),e.jsx("div",{className:"px-5",children:e.jsx(ff,{source:t,views:s})})]})]})},fk=({source:t})=>{const{pgEnv:s,baseUrl:n,falcor:r,falcorCache:a}=C.useContext(ie);b.useEffect(()=>{async function i(){const c=["dama",s,"sources","byId",t.source_id,"views","length"],d=await r.get(c);await r.get(["dama",s,"sources","byId",t.source_id,"views","byIndex",{from:0,to:I(d.json,c,0)-1},"attributes",Object.values(Ot)])}i()},[r,a,t,s]);const l=Ue.lexical.ViewComp;return e.jsx("div",{className:"w-full p-4 bg-white hover:bg-blue-50 block border shadow flex",children:e.jsxs("div",{children:[e.jsx(ue,{to:`${n}/source/${t.source_id}`,className:"text-xl font-medium w-full block",children:e.jsx("span",{children:t.name})}),e.jsx("div",{children:(I(t,"categories",[])||[]).map(i=>(typeof i=="string"?[i]:i).map((c,d)=>e.jsx(ue,{to:`${n}/cat/${d>0?i[d-1]+"/":""}${c}`,className:"text-xs p-1 px-2 bg-blue-200 text-blue-600 mr-2",children:c},d)))}),e.jsx(ue,{to:`${n}/source/${t.source_id}`,className:"py-2 block",children:e.jsx(l,{value:wf(t.description)})})]})})},gk=()=>{var j,N;const[t,s]=b.useState(""),{cat1:n,cat2:r,...a}=Be(),{pgEnv:l,baseUrl:i,falcor:c,falcorCache:d,user:u}=C.useContext(ie),[m,p]=b.useState("asc"),x=((N=(j=window.location.pathname.replace(`${i}/`,""))==null?void 0:j.split("/"))==null?void 0:N[0])==="listall";b.useEffect(()=>{async function S(){const w=["dama",l,"sources","length"],k=await c.get(w);await c.get(["dama",l,"sources","byIndex",{from:0,to:I(k.json,w,0)-1},"attributes",Object.values(Xt)],["dama-info",l,"settings"])}S()},[c,l]);const h=b.useMemo(()=>Object.values(I(d,["dama",l,"sources","byIndex"],{})).map(S=>ft(I(d,S.value,{attributes:{}}).attributes)),[d,l]),f=b.useMemo(()=>I(d,["dama-info",l,"settings","value","filtered_categories"],[]),[d,l]),g=[...new Set(h.filter(S=>{var w;return x||!x&&!((w=S.categories)!=null&&w.find(k=>f.find($=>k.includes($))))}).reduce((S,w)=>{var k;return[...S,...((k=w.categories)==null?void 0:k.map($=>$[0]))||[]]},[]))].sort(),y=g.reduce((S,w)=>{var k;return S[w]=(k=h.filter($=>{var E;return(E=$.categories)==null?void 0:E.find(M=>M.includes(w))}))==null?void 0:k.length,S},{}),v="bg-transparent hover:bg-blue-100 rounded-sm p-2 ml-0.5 border-2";return e.jsxs(Ct,{baseUrl:i,isListAll:x,children:[e.jsxs("div",{className:"py-4 flex flex-rows items-center",children:[e.jsx("input",{className:"w-full text-lg p-2 border border-gray-300 ",placeholder:"Search datasources",value:t,onChange:S=>s(S.target.value)}),e.jsx("button",{className:v,title:"Toggle Sort",onClick:()=>p(m==="asc"?"desc":"asc"),children:e.jsx("i",{className:`fa-solid ${m==="asc"?"fa-arrow-down-z-a":"fa-arrow-down-a-z"} text-xl text-blue-400`})}),e.jsx(ue,{to:x?`${i}`:`${i}/listall`,className:v,title:x?"View Key Sources":"View All Sources",children:e.jsx("i",{className:`fa-solid ${x?"fa-filter-list":"fa-list-ul"} text-xl text-blue-400`})}),(u==null?void 0:u.authed)&&u.authLevel===10&&e.jsx(ue,{to:`${i}/settings`,className:v,title:"Settings",children:e.jsx("i",{className:"fa-solid fa-gear text-xl text-blue-400"})})]}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx("div",{className:"w-1/4 flex flex-col space-y-1.5 max-h-[80dvh] overflow-auto scrollbar-sm",children:(g||[]).sort((S,w)=>S.localeCompare(w)).map(S=>e.jsxs(ue,{className:`${n===S||r===S?"bg-blue-100":"bg-white"} hover:bg-blue-50 p-2 rounded-md flex items-center`,to:`${i}${x?"/listall":""}/cat/${S}`,children:[e.jsx("i",{className:"fa fa-category"})," ",S,e.jsx("div",{className:"bg-blue-200 text-blue-600 text-xs w-5 h-5 ml-2 shrink-0 grow-0 rounded-lg flex items-center justify-center border border-blue-300",children:y[S]})]},S))}),e.jsx("div",{className:"w-3/4 flex flex-col space-y-1.5 ml-1.5 max-h-[80dvh] overflow-auto scrollbar-sm",children:h.filter(S=>{var w;return x||!x&&!((w=S.categories)!=null&&w.find(k=>f.find($=>k.includes($))))}).filter(S=>{let w=!0;return n&&(w=!1,(I(S,"categories",[])||[]).forEach(k=>{k[0]===n&&(!r||k[1]===r)&&(w=!0)})),w}).filter(S=>{let w=S.name+" "+((S==null?void 0:S.categories)||[]).reduce((k,$)=>(k+=Array.isArray($)?$.join(" "):typeof $=="string"?$:"",k),"");return!t.length>2||w.toLowerCase().includes(t.toLowerCase())}).sort((S,w)=>{var $;return(m==="asc"?1:-1)*(($=S.name)==null?void 0:$.localeCompare(w.name))}).map((S,w)=>e.jsx(fk,{source:S,baseUrl:i},w))})]})]})},bk=({sourceId:t,metadata:s,setMetadata:n,col:r,value:a})=>{const{pgEnv:l,falcor:i}=C.useContext(ie),c=C.useCallback(async d=>{await Rn({sourceId:t,pgEnv:l,falcor:i,metadata:s,setMetadata:n,col:r,value:{display:d.target.value}})},[r,s]);return e.jsx("div",{className:"border border-blue-100",children:e.jsxs("select",{className:"appearance-auto pl-3 pr-4 py-2.5 bg-blue-50 w-full bg-white mr-2 flex items-center justify-between text-sm",value:a,onChange:c,children:[e.jsx("option",{value:"",children:"none"}),e.jsx("option",{value:"meta-variable",children:"meta variable"}),e.jsx("option",{value:"data-variable",children:"data variable"}),e.jsx("option",{value:"geoid-variable",children:"fips variable"}),e.jsx("option",{value:"geom-variable",children:"geom variable"})]})})},yk=({metadata:t,setMetadata:s,col:n,startValue:r,sourceId:a,setEditing:l=()=>{}})=>{const{pgEnv:i,baseUrl:c,falcor:d}=C.useContext(ie),[u,m]=b.useState(!1),[p,x]=b.useState(r);b.useEffect(()=>{x(r)},[r]);const h=f=>{Rn({sourceId:a,pgEnv:i,falcor:d,metadata:t,setMetadata:s,col:n,value:{meta_lookup:f}}),m(!1),l(null)};return u?e.jsx(pc,{value:p,setValue:x,save:h,cancel:()=>m(!1)}):e.jsxs("div",{className:"text-xs font-thin flex flex-row mt-1",children:[e.jsx("div",{className:"border p-1 h-30 max-h-[300px] overflow-auto scrollbar-sm",children:e.jsx(n1,{data:uc(r)?JSON.parse(r):{},shouldExpandNode:a1,style:r1})}),e.jsx("div",{className:"-ml-10 mt-2 z-10",children:e.jsx($e,{themeOptions:{size:"xs",color:"transparent"},onClick:f=>m(!u),children:" Edit "})})]})},vk=({sourceId:t,pgEnv:s,falcor:n,metadata:r,setMetadata:a,col:l})=>{const i=[...r,l];a(i),n.set({paths:[["dama",s,"sources","byId",t,"attributes","metadata"]],jsonGraph:{dama:{[s]:{sources:{byId:{[t]:{attributes:{metadata:JSON.stringify(i)}}}}}}}}).then(c=>console.log("RES:",c))},wk=({metadata:t,setMetadata:s,sourceId:n})=>{const{pgEnv:r,baseUrl:a,falcor:l}=C.useContext(ie),[i,c]=b.useState();return e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsx("input",{placeholder:"enter column name",className:"p-2 w-full flex-1 px-2 border rounded-lg",value:i,onChange:d=>c(d.target.value)}),e.jsx($e,{themeOptions:{size:"sm",color:"primary"},onClick:d=>vk({sourceId:n,pgEnv:r,falcor:l,metadata:t,setMetadata:s,col:{name:i,origin:"calculated-column"}}),children:"Add Column"})]})},jk=({sourceId:t,pgEnv:s,falcor:n,metadata:r,setMetadata:a,col:l})=>{const i=r.filter(c=>c.name!==l);a(i),n.set({paths:[["dama",s,"sources","byId",t,"attributes","metadata"]],jsonGraph:{dama:{[s]:{sources:{byId:{[t]:{attributes:{metadata:JSON.stringify(i)}}}}}}}}).then(c=>console.log("RES:",c))},Ck=({col:t,metadata:s,setMetadata:n,sourceId:r})=>{const{pgEnv:a,falcor:l}=C.useContext(ie);return e.jsx("div",{className:"float-right",children:e.jsx($e,{themeOptions:{size:"xs",color:"cancel"},onClick:i=>jk({sourceId:r,pgEnv:a,falcor:l,metadata:s,setMetadata:n,col:t}),children:e.jsx("i",{className:"fad fa-trash p-2 pt-3 rounded"})})})},Nk=({sourceId:t,metadata:s,setMetadata:n,col:r,value:a})=>{const{pgEnv:l,falcor:i}=C.useContext(ie),c=C.useCallback(async d=>{await Rn({sourceId:t,pgEnv:l,falcor:i,metadata:s,setMetadata:n,col:r,value:{defaultFn:d.target.value}})},[r,s]);return e.jsx("div",{className:"border border-blue-100 h-fit",children:e.jsxs("select",{className:"appearance-auto pl-3 pr-4 py-2.5 bg-blue-50 w-full bg-white text-sm",value:a,onChange:c,children:[e.jsx("option",{value:null,children:"none"}),e.jsx("option",{value:"Sum",children:"sum"}),e.jsx("option",{value:"Count",children:"count"}),e.jsx("option",{value:"List",children:"list"})]})})},kk=({sourceId:t,metadata:s,setMetadata:n,col:r,value:a})=>{const{pgEnv:l,falcor:i}=C.useContext(ie),c=C.useCallback(async d=>{await Rn({sourceId:t,pgEnv:l,falcor:i,metadata:s,setMetadata:n,col:r,value:{type:d.target.value}})},[r,s]);return e.jsx("div",{className:"border border-blue-100",children:e.jsxs("select",{className:"appearance-auto pl-3 pr-4 py-2.5 h-fit w-full bg-white mr-2 text-sm",value:a,onChange:c,children:[e.jsx("option",{value:null,children:"none"}),e.jsx("option",{value:"integer",children:"integer"}),e.jsx("option",{value:"number",children:"number"}),e.jsx("option",{value:"string",children:"string"}),e.jsx("option",{value:"boolean",children:"boolean"}),e.jsx("option",{value:"object",children:"object"})]})})},$k=({sourceId:t,metadata:s,setMetadata:n,col:r,value:a})=>{const{pgEnv:l,falcor:i}=C.useContext(ie),c=C.useCallback(async d=>{await Rn({sourceId:t,pgEnv:l,falcor:i,metadata:s,setMetadata:n,col:r,value:{isDollar:d}})},[r,s]);return e.jsxs("div",{className:"block w-full flex mt-1 items-center",children:[e.jsx("label",{className:"align-bottom shrink py-2 my-1 text-sm",children:" Is Dollar: "}),e.jsx("div",{className:"align-bottom p-2 my-1 rounded-md shrink self-center",children:e.jsxs(sn,{checked:a,onChange:c,className:`
                         ${a?"bg-indigo-600":"bg-gray-200"}
                         relative inline-flex 
                         h-4 w-10 shrink
                         cursor-pointer rounded-full border-2 border-transparent 
                         transition-colors duration-200 ease-in-out focus:outline-none focus:ring-0.5
                         focus:ring-indigo-600 focus:ring-offset-2`,children:[e.jsx("span",{className:"sr-only",children:"toggle is dollar by"}),e.jsx("span",{"aria-hidden":"true",className:`
                            ${a?"translate-x-5":"translate-x-0"}
                            pointer-events-none inline-block 
                            h-3 w-4
                            transform rounded-full bg-white shadow ring-0
                            transition duration-200 ease-in-out
                            `})]},`isDollar-${r}`)})]})},Au=({source:t,colOrigin:s,...n})=>{const{user:r}=C.useContext(ie),[a,l]=C.useState([]),[i,c]=C.useState(null),d=Ue.lexical.ViewComp,{authLevel:u}=r,m=u<5?"grid-cols-6":"grid-cols-8",p=[{name:"Column",auth:!1,Comp:()=>e.jsx(e.Fragment,{}),width:2},{name:"Description",auth:!1,width:3},{name:"Type",auth:!1},{name:"Display",auth:!0,minAuthLevel:5},{name:"Default Fn",auth:!0,minAuthLevel:5}];return C.useEffect(()=>{const x=JSON.parse(JSON.stringify(I(t,["metadata","columns"],I(t,"metadata",[]))));if(Array.isArray(x)){const h=x.map(f=>({display:"",...f}));l(h)}else l([])},[t]),!a||!a.map||a.length===0?e.jsx("div",{children:" Metadata Not Available "}):e.jsxs("div",{className:"overflow-hidden",children:[u>5&&s==="calculated-column"&&e.jsx(wk,{sourceId:t.source_id,metadata:a,setMetadata:l}),e.jsx("div",{className:`py-4 sm:py-2 sm:grid sm:${m} sm:gap-4 sm:px-6 border-b-2`,children:p.filter(x=>(!x.auth||x.auth&&u>=x.minAuthLevel)&&(!x.hasOwnProperty("condition")||x.condition)).map((x,h)=>e.jsx("dd",{className:`text-sm font-medium text-gray-600 col-span-${x.width||1}`,children:x.name},h))}),e.jsx("div",{className:"border-t border-gray-200 px-4 py-5 sm:p-0",children:e.jsx("dl",{className:"sm:divide-y sm:divide-gray-200",children:a.filter(x=>x.origin===s).map((x,h)=>e.jsxs("div",{className:`py-4 sm:py-5 sm:grid sm:${m} sm:gap-4 sm:px-6`,children:[e.jsxs("dt",{className:"text-sm text-gray-900 col-span-2",children:[e.jsxs("div",{className:"flex flex-row justify-between group",children:[i===`${x.name}-columnName`?e.jsx("div",{className:"pt-3 pr-8",children:e.jsx(jl,{metadata:a,setMetadata:l,col:x.name,startValue:I(x,"name")||"No Display Name",attr:"name",sourceId:t.source_id,setEditing:c,cancel:()=>c(null)})}):e.jsx("div",{className:"pt-3 pr-8",children:I(x,"name")||"No Name"}),u>5&&x.origin==="calculated-column"?e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:f=>c(`${x.name}-columnName`),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-12 p-2 pt-3 hover:bg-blue-500 rounded focus:bg-blue-700 hover:text-white "})}):""]}),e.jsxs("div",{className:"flex flex-row justify-between group",children:[i===`${x.name}-displayName`?e.jsx("div",{className:"pt-3 pr-8",children:e.jsx(jl,{metadata:a,setMetadata:l,col:x.name,startValue:I(x,"display_name")||"No Display Name",attr:"display_name",sourceId:t.source_id,setEditing:c,cancel:()=>c(null)})}):e.jsx("div",{className:"pt-3 pr-8 font-bold",children:I(x,"display_name")||"No Display Name"}),u>5?e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:f=>c(`${x.name}-displayName`),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-12 p-2 pt-3 hover:bg-blue-500 rounded focus:bg-blue-700 hover:text-white "})}):""]})]}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 flex flex-row justify-between group col-span-3",children:[i===`${x.name}-description`?e.jsx("div",{className:"pr-8",children:e.jsx(jl,{type:"lexical",metadata:a,setMetadata:l,col:x.name,startValue:I(x,"desc")||"No Description",attr:"desc",sourceId:t.source_id,setEditing:c,cancel:()=>c(null)})}):e.jsx("div",{className:"pr-8",children:e.jsx(d,{value:I(x,"desc","No Desc")})}),u>5?e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:f=>c(`${x.name}-description`),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-12 p-2 hover:bg-blue-500 rounded focus:bg-blue-700 hover:text-white "})}):""]}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0",children:[u>5&&x.origin==="calculated-column"?e.jsx(kk,{metadata:a,setMetadata:l,col:x.name,value:x.type,sourceId:t.source_id}):e.jsx("div",{className:"text-gray-400 italic",children:x.type}),u>5&&["integer","number"].includes(x.type)?e.jsx($k,{metadata:a,setMetadata:l,col:x.name,value:x.isDollar,sourceId:t.source_id}):null]}),u>5&&e.jsxs("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0",children:[e.jsx(bk,{metadata:a,setMetadata:l,col:x.name,value:x.display,sourceId:t.source_id}),["meta-variable","geoid-variable"].includes(x.display)&&e.jsx(yk,{metadata:a,setMetadata:l,col:x.name,startValue:I(x,"meta_lookup")||"No Meta Lookup Available",attr:"meta_lookup",sourceId:t.source_id,setEditing:c,cancel:()=>c(null)})]}),u>5&&e.jsxs("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 flex flex-row",children:[e.jsx(Nk,{metadata:a,setMetadata:l,col:x.name,value:x.defaultFn,sourceId:t.source_id}),x.origin==="calculated-column"&&e.jsx(Ck,{metadata:a,setMetadata:l,col:x.name,sourceId:t.source_id})]})]},h))})})]})},Sk=({source:t,views:s,...n})=>e.jsxs("div",{className:"w-full flex-1 sm:px-6 divide-y-4 grid gap-y-6 ",children:[e.jsx(Au,{source:t,colOrigin:void 0}),e.jsx(Au,{source:t,colOrigin:"calculated-column"})]}),_k=({source:t,views:s,user:n,baseUrl:r})=>{const a=Math.max(...s.map(d=>parseInt(d.version)||0))+1,[l,i]=b.useState(a),c=C.useMemo(()=>{let d=I(t,"type","").substring(0,3)==="tl_"?"tiger_2017":t.type;return I(wt,`[${d}].sourceCreate.component`,()=>e.jsxs("div",{children:[" Cannot create new ",t.type," version. "]}))},[t]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6 text-sm font-medium text-gray-500 ",children:[e.jsx("label",{children:"Version Name:"}),e.jsx("input",{className:"p-2",placeholder:l,onChange:d=>i(d.target.value)},"versionName")]}),e.jsx(c,{source:t,existingSource:t,user:n,newVersion:l,baseUrl:r})]})},Ik=({uploads:t=[],sourceId:s=null})=>{const n=Le(),{baseUrl:r}=C.useContext(ie);return e.jsx("div",{className:"w-full p-4 bg-white shadow mb-4",children:t&&t.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"py-4 sm:py-2 mt-2 sm:grid sm:grid-cols-5 sm:gap-4 sm:px-6 border-b-2",children:["Id","Status","Initial Event Id","Latest Event Id","Last Updated"].map(a=>e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:a},a))}),e.jsx("dl",{className:"sm:divide-y sm:divide-gray-200 odd:bg-white even:bg-slate-50",children:(t||[]).map((a,l)=>{var i;return e.jsxs("div",{className:"py-4 sm:py-5 sm:grid sm:grid-cols-5 sm:gap-4 sm:px-6 cursor-pointer hover:bg-slate-200",onClick:()=>n(`${r}/source/${s}/uploads/${a==null?void 0:a.etl_context_id}`),children:[e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:a==null?void 0:a.etl_context_id},`${l}_1`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:typeof(a==null?void 0:a.etl_status)=="string"?a==null?void 0:a.etl_status:""},`${l}_2`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:typeof(a==null?void 0:a.initial_event_id)=="number"?a==null?void 0:a.initial_event_id:""},`${l}_3`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:typeof(a==null?void 0:a.latest_event_id)=="number"?a==null?void 0:a.latest_event_id:""},`${l}_4`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:(i=a==null?void 0:a._modified_timestamp)==null?void 0:i.value},`${l}_5`)]},`${l}_0`)})})]}):e.jsx("div",{className:"text-center",children:"No Actions found"})})},jf="gis-dataset",Cf=`${jf}:ogr_data`,Lk="upload",Ek=`${Lk}:GIS_FILE_UPLOAD_PROGRESS`,Mk="final",Ak=[Ek,Cf],Tk="gis_dataset";function Ok({ctxId:t}){var h,f,g;const{pgEnv:s,falcor:n,falcorCache:r}=C.useContext(ie),a=`${gt}/dama-admin/${s}`,[l,i]=b.useState(!1),[c,d]=b.useState(!1),[u,m]=b.useState();b.useEffect(()=>{async function y(){await n.get(["dama",s,"etlContexts","byEtlContextId",t])}y()},[n,s,t]);const p=b.useMemo(()=>I(r,["dama",s,"etlContexts","byEtlContextId",t,"value"]),[r]);b.useEffect(()=>{async function y(){var v,j;return(v=p==null?void 0:p.meta)!=null&&v.source_id?await n.get(["dama",s,"sources","byId",(j=p==null?void 0:p.meta)==null?void 0:j.source_id,"attributes","type"]):null}y()},[n,s,(h=p==null?void 0:p.meta)==null?void 0:h.source_id]);const x=b.useMemo(()=>{var y;return I(r,["dama",s,"sources","byId",(y=p==null?void 0:p.meta)==null?void 0:y.source_id,"attributes"])},[r]);return b.useEffect(()=>{var N;const y=p==null?void 0:p.events.some(S=>S.type.toLowerCase().includes(Mk)),v=p==null?void 0:p.events.find(S=>{var w;return(w=S.type)==null?void 0:w.toLowerCase().includes("initial")}),j=((N=v==null?void 0:v.type)==null?void 0:N.split(":")[0])===jf||(x==null?void 0:x.type)===Tk;if(p!=null&&p.events&&j&&!y){const w=(p==null?void 0:p.events.filter($=>$.type===Cf)).map($=>$.payload.data),k=w[w.length-1];m(k),i(!0)}else m(void 0),i(!1)},[p==null?void 0:p.events]),b.useEffect(()=>{const y=async()=>{n.invalidate(["dama",s,"etlContexts","byEtlContextId",t]),await n.get(["dama",s,"etlContexts","byEtlContextId",t])};if(l&&!c){let v=setInterval(y,3e3);d(v)}else c&&!l&&(clearInterval(c),y(),i(!1),d(null),m(void 0))},[l,c,a,u]),e.jsxs("div",{className:"w-full p-4 bg-white shadow mb-4",children:[u!==void 0&&e.jsx(Dk,{progress:u}),p&&(p!=null&&p.events)&&((f=p==null?void 0:p.events)!=null&&f.length)?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"py-4 sm:py-2 mt-2 sm:grid sm:grid-cols-5 sm:gap-4 sm:px-6 border-b-2",children:["Id","Event Type","Data","Timestamp"].map(y=>e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:y},y))}),e.jsx("dl",{className:"sm:divide-y sm:divide-gray-200 odd:bg-white even:bg-slate-50",children:(((g=p==null?void 0:p.events)==null?void 0:g.filter(y=>!Ak.includes(y.type)))||[]).map((y,v)=>{var j,N;return e.jsxs("div",{className:"py-4 sm:py-5 sm:grid sm:grid-cols-5 sm:gap-4 sm:px-6 cursor-pointer hover:bg-slate-200",children:[e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle break-words",children:y==null?void 0:y.event_id},`${v}_1`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle break-words",children:(j=y==null?void 0:y.type)==null?void 0:j.split(":").pop()},`${v}_2`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle break-words",children:JSON.stringify((N=y==null?void 0:y.payload)==null?void 0:N.data)},`${v}_3`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle break-words",children:y._created_timestamp},`${v}_4`)]},`${v}_0`)})})]}):e.jsx("div",{className:"text-center",children:"No Events found"})]})}const Dk=({progress:t})=>{const s={display:"inline-block",height:"100%",width:"100%",backgroundColor:"whitesmoke",borderRadius:40,margin:0},n={display:"inline-block",height:"84%",width:`${t}%`,backgroundColor:"#3b82f680",borderRadius:40,textAlign:"right"},r={padding:10,color:"black",fontWeight:900};return e.jsxs("div",{style:s,children:[e.jsxs("span",{style:{fontWeight:"bold",paddingLeft:"10px",paddingRight:"10px"},children:[" ","Proccessed:"]}),e.jsx("div",{style:n,children:e.jsx("span",{style:r,children:`${t}%`})})]})},Bk=({})=>{const{pgEnv:t,falcor:s,falcorCache:n}=C.useContext(ie),{viewId:r,page:a,sourceId:l}=Be();if(a==="uploads"&&r)return e.jsx(Ok,{ctxId:r});b.useEffect(()=>{async function c(){const d=["dama",t,"etlContextsbyDamaSourceId",[l],"length"],u=await s.get(d);await s.get(["dama",t,"etlContextsbyDamaSourceId",[l],"byIndex",{from:0,to:I(u.json,d,0)-1},["etl_context_id","_created_timestamp","etl_status","_modified_timestamp","initial_event_id","latest_event_id"]])}c()},[s,t,l]);const i=b.useMemo(()=>{let c=I(n,["dama",t,"etlContextsbyDamaSourceId",[l],"byIndex"]);return c&&Object.values(c).map(d=>I(n,d.value,{})).filter(d=>Object.keys(d).length>0)},[n,l]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex",children:e.jsx("div",{className:"flex-1 pl-3 pr-4 py-2",children:"Actions"})}),e.jsx(Ik,{uploads:i,sourceId:l})]})},li=["etl_status","etl_context_id","created_at","terminated_at","source_id","parent_context_id","type","payload","user"];function Fk(t){const s=t instanceof Date?t:new Date(t),n=new Intl.RelativeTimeFormat("en"),r={years:3600*24*365,months:3600*24*30,weeks:3600*24*7,days:3600*24,hours:3600,minutes:60,seconds:1},a=(s.getTime()-Date.now())/1e3;for(let l in r)if(r[l]<Math.abs(a)){const i=a/r[l];return n.format(Math.round(i),l)}}const zk=t=>{const{value:s}=t;return e.jsx("div",{children:Fk(s)})},Pk=t=>{const{value:s}=t;let n="";return parseInt(s)<2e3?n=`${s} ms`:parseInt(s)<6e5?n=`${Math.floor(s/1e3)} seconds`:parseInt(s)<36e5?n=`${Math.floor(s/1e3/60)} minutes`:n=`${Math.floor(s/1e3/60/60)} hours`,isNaN(n)&&(n=""),e.jsx("div",{children:n})},Nf=({value:t})=>typeof t=="string"&&(t!=null&&t.includes("@"))?t:typeof t!="object"?`User ${t}`:"",Rk=[{accessor:"etl_context_id",Header:"ETL Context ID"},{accessor:"type",Header:"Type",Cell:({value:t})=>{const s=t.split(":")[0].replace("-"," ");return e.jsx("div",{className:"capitalize",children:s})}},{accessor:"source_name",Header:"Source Name",Cell:({value:t})=>typeof t=="string"?t:""},{accessor:"user",Header:"User",Cell:Nf},{accessor:"created_at",Header:"Started",Cell:zk},{accessor:"duration",Header:"Duration",Cell:Pk},{accessor:"etl_status",Header:"ETL Status"}],Yn=10,kf=t=>{const{sourceId:s}=t,{pgEnv:n,falcor:r,falcorCache:a,baseUrl:l}=C.useContext(ie),[i,c]=C.useState(0),d=C.useMemo(()=>po(i*Yn,i*Yn+Yn),[i,Yn]),u=s?["dama",n,"latest","events","for","source",s,"length"]:["dama",n,"latest","events","length"],m=s?["dama",n,"latest","events","for","source",s,d,li]:["dama",n,"latest","events",d,li];C.useEffect(()=>{(async()=>{await r.get(u)})()},[r,n]);const p=C.useMemo(()=>I(a,u),[r,a,n]);C.useEffect(()=>{(async()=>{await r.get(m).then(y=>{const v=m.slice(0,m.length-2),j=Object.values(I(y,["json",...v])).map(N=>N.source_id).filter(N=>!!N);return r.get(["dama",n,"sources","byId",j,"attributes","name"])})})()},[r,n,d]);const x=C.useMemo(()=>{const g=m.slice(0,m.length-2);return d.map(y=>({...I(a,[...g,y])})).map(y=>{if(y.source_id){const v=I(a,["dama",n,"sources","byId",y.source_id,"attributes","name"]);y.source_name=typeof v=="string"?v:""}return y}).filter(y=>!!y.etl_context_id)},[d,a]),h=Le(),f=C.useCallback((g,y)=>{g.ctrlKey?window.open(`${l}/task/${y.values.etl_context_id}`,"_blank"):h(`${l}/task/${y.values.etl_context_id}`)},[h]);return e.jsx(Dn,{data:x,columns:Rk,pageSize:Yn,manualPagination:!0,numRecords:p,onPageChange:c,manualCurrentPage:i,onRowClick:f,sortBy:"created_at",sortOrder:"desc",disableFilters:!0,disableSortBy:!0})},Hk=Sn.wrappers["ams-redux"],Nl="Public",Wk=Hk(t=>{const{user:s}=b.useContext(ie),{groups:n,source:r,users:a,getGroups:l,getUsers:i,getUsersPreferences:c}=t;return b.useEffect(()=>{s&&(l(),i())},[s]),b.useEffect(()=>{if(!(a!=null&&a.some(d=>!!d.preferences))){const d=a==null?void 0:a.map(u=>u.email);c({userEmails:d})}},[a]),e.jsx(Vk,{groups:n,users:a,source:r,loggedInUser:s})}),Vk=({source:t,users:s,groups:n,loggedInUser:r})=>{const a=[...n],l=b.useContext(ho),{falcor:i,pgEnv:c,baseUrl:d}=b.useContext(ie),{auth:u}=(t==null?void 0:t.statistics)??{},m=b.useMemo(()=>async w=>{await i.set({paths:[["dama",c,"sources","byId",t.source_id,"attributes","statistics"]],jsonGraph:{dama:{[c]:{sources:{byId:{[t.source_id]:{attributes:{statistics:JSON.stringify(w)}}}}}}}})},[i,c,t.source_id]),p=b.useMemo(()=>async({rowKey:w})=>{const k={auth:{...u}};k.auth.users||(k.auth.users={}),k.auth.users[w]="1",console.log("newAuth, addUserAuth::",k),await m(k)},[u,m]),x=b.useMemo(()=>async({rowKey:w})=>{const k={auth:{...u}};delete k.auth.users[w],console.log("newAuth, removeUserAuth::",k),await m(k)},[u,m]),h=b.useMemo(()=>async({rowKey:w,authLevel:k})=>{const $={auth:{...u}};$.auth.users[w]=k,console.log("newAuth,setUserAuth::",$),await m($)},[u,m]),f=b.useMemo(()=>async({rowKey:w})=>{const k={auth:{...u}};k.auth.groups||(k.auth.groups={}),k.auth.groups[w]="1",console.log("newAuth, addGroupAuth::",k),await m(k)},[u,m]),g=b.useMemo(()=>async({rowKey:w})=>{const k={auth:{...u}};delete k.auth.groups[w],console.log("newAuth, removeGroupAuth::",k),await m(k)},[u,m]),y=b.useMemo(()=>async({rowKey:w,authLevel:k})=>{const $={auth:{...u}};$.auth.groups[w]=k,console.log("newAuth,setGroupAuth::",$),await m($)},[u,m]),v=u!=null&&u.users?Object.keys(u==null?void 0:u.users):[],j=s.filter(w=>!v.includes(JSON.stringify(w.id))),N=u!=null&&u.groups?Object.keys(u==null?void 0:u.groups):[],S=n.filter(w=>!N.includes(JSON.stringify(w.name)));return Object.keys((u==null?void 0:u.groups)??{}).includes(Nl)?a.push({name:Nl}):S.push({name:Nl,authLevel:-1}),e.jsxs("div",{className:`${l.background??"bg-grey-100"} h-full flex flex-wrap py-12 sm:px-6 lg:px-8 gap-3`,children:[e.jsx("div",{className:"w-full",children:e.jsx("h2",{className:"text-xl font-medium text-gray-900",children:"Admin"})}),e.jsxs(ua,{title:"User Access Controls",tileWidth:"w-2/3",children:[e.jsx("div",{className:"mb-4",children:e.jsx(zl,{searchable:!0,domain:j,accessor:w=>w.id,listAccessor:w=>w.email,placeholder:"Add user access...",onChange:w=>{p({rowKey:w.id})}})}),v.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[e.jsx("div",{className:"col-span-2 font-bold",children:"Name"}),e.jsx("div",{className:"col-span-2",children:"Authority Level"})]}),e.jsx("div",{className:"grid grid-cols-6 gap-2 items-center",children:v.map((w,k)=>e.jsx(Tu,{removeUserAuth:x,setUserAuth:h,user:(s==null?void 0:s.find($=>$.id===parseInt(w)))??{},authLevel:u.users[w],loggedInUser:r},w))})]})]}),e.jsxs(ua,{title:"Admin Actions",tileWidth:"w-[30%]",children:[e.jsx("div",{className:"w-full p-1 flex",children:e.jsxs(ue,{className:"w-full flex-1 text-center border shadow hover:bg-blue-100 p-4",to:`${d}/source/${t.source_id}/meta_advanced`,children:["Advanced Metadata ",e.jsx("i",{className:"fa fa-circle-info"})]})}),e.jsx("div",{className:"w-full p-1 flex",children:e.jsxs(ue,{className:"w-full flex-1 text-center border shadow hover:bg-blue-100 p-4",to:`${d}/source/${t.source_id}/add_version`,children:["Add Version ",e.jsx("i",{className:"fad fa-upload"})]})}),e.jsx("div",{className:"w-full p-1 flex",children:e.jsxs(ue,{className:"w-full flex-1 text-center bg-red-100 border border-red-200 shadow hover:bg-red-400 hover:text-white p-4",to:`${d}/delete/source/${t.source_id}`,children:["Delete ",e.jsx("i",{className:"fad fa-trash"})]})})]}),e.jsxs(ua,{title:"Group Access Controls",tileWidth:"w-2/3",children:[e.jsx("div",{className:"mb-4",children:e.jsx(zl,{searchable:!0,domain:S,accessor:w=>w.name,listAccessor:w=>w.name,displayAccessor:w=>w.name,placeholder:"Add group access...",onChange:w=>{f({rowKey:w.name})}})}),N.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[e.jsx("div",{className:"col-span-2 font-bold",children:"Name"}),e.jsx("div",{className:"col-span-2",children:"Authority Level"})]}),e.jsx("div",{className:"grid grid-cols-6 gap-2 items-center",children:N.map((w,k)=>e.jsx(Tu,{removeUserAuth:g,setUserAuth:y,user:(a==null?void 0:a.find($=>$.name===w))??{name:w},authLevel:u.groups[w],loggedInUser:r},w))})]})]}),e.jsx(ua,{title:"Events",tileWidth:"w-full",children:e.jsx(kf,{sourceId:t.source_id})})]})},Tu=t=>{var m;const{user:s,loggedInUser:n,removeUserAuth:r,setUserAuth:a,authLevel:l}=t,[i,c]=b.useState(l),d=s.name??((m=s==null?void 0:s.preferences)==null?void 0:m.display_name)??s.email,u=s.id?"id":"name";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-2",children:d}),e.jsx("div",{className:"col-span-2 grid",children:e.jsx(Ns,{type:"number",min:"1",max:n.authLevel,required:!0,value:i,onChange:p=>c(p)})}),e.jsx("div",{className:"col-span-1 grid",children:e.jsx($e,{themeOptions:{size:"sm"},type:"submit",disabled:l===i,onClick:async()=>{a({rowKey:s[u],authLevel:i})},children:"confirm"})}),e.jsx("div",{className:"col-span-1 grid",children:e.jsx($e,{themeOptions:{size:"sm",color:"cancel"},type:"submit",onClick:async()=>{r({rowKey:s[u]})},children:"remove"})})]})},ua=({children:t,title:s="",tileWidth:n="sm:max-w-md"})=>{const r=b.useContext(ho);return e.jsx("div",{className:`mt-8 ${n}`,children:e.jsx("div",{className:`${r.tile??"bg-white py-8 px-4 shadow-lg sm:rounded-md sm:px-10"} h-full min-height-[400px]`,children:e.jsxs("div",{className:"sm:w-full border-gray-200",children:[e.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:s}),t]})})})},Qn={overview:{name:"Overview",path:"",component:hk},versions:{name:"Versions",path:"/versions",hidden:"true",component:ff},uploads:{name:"Uploads",path:"/uploads",authLevel:5,hidden:!0,component:Bk},add_version:{name:"Add Version",path:"/add_version",authLevel:5,hidden:!0,component:_k},meta_advanced:{name:"Metadata",path:"/meta_advanced",hidden:!0,component:Sk},admin:{name:"Admin",path:"/admin",authLevel:10,component:Wk}},ja={},Ua={};for(const t in ls.schemeGroups)Ua[t]={},ls.schemeGroups[t].forEach(s=>{const n=ls[s];Ua[t][s]=n;for(const r in n)r in ja||(ja[r]=[]),ja[r].push({type:`${t[0].toUpperCase()}${t.slice(1)}`,name:s,category:"Colorbrewer",colors:n[r]})});const Uk=t=>{const{color:s,hoveringParent:n,onMouseEnter:r=null,onMouseLeave:a=null,isFirst:l,isLast:i}=t,[c,d]=C.useState(!1),u=C.useMemo(()=>typeof r!="function"?null:p=>{d(!0),r(s,p)},[s,r]),m=C.useMemo(p=>typeof a!="function"?null:x=>{d(!1),a(s,x)},[s,a]);return e.jsx("div",{className:`
        flex-1 relative
        ${r?"hover:outline hover:outline-1 outline-current":""}
        ${l&&i?"rounded":l?"rounded-l":i?"rounded-r":""}
      `,onMouseEnter:u,onMouseLeave:m,style:{backgroundColor:s,opacity:c||!n?"100%":"50%",zIndex:c?50:0}})},qr=({colors:t,onMouseEnter:s,onMouseLeave:n,height:r=4})=>{const[a,l]=C.useState(!1),i=C.useCallback(d=>{l(!!s)},[s]),c=C.useCallback(d=>{l(!1)},[]);return e.jsx("div",{className:"flex rounded w-full",style:{height:`${r*.25}rem`},onMouseEnter:i,onMouseLeave:c,children:t.map((d,u)=>e.jsx(Uk,{color:d,onMouseEnter:s,onMouseLeave:n,hoveringParent:a,isFirst:u===0,isLast:u===t.length-1},d))})},Ps=t=>t==null||typeof t=="string"&&!t.length?!1:Array.isArray(t)?t.reduce((s,n)=>s||Ps(n),!1):typeof t=="number"&&isNaN(t)?!1:typeof t=="object"?Object.values(t).reduce((s,n)=>s||Ps(n),!1):!0,qk=t=>{const s=I(t,"current",t);return s?s.getBoundingClientRect():{width:0,height:0,x:0,y:0}},Gk=(t,s=null)=>{const[n,r]=C.useState({width:0,height:0,x:0,y:0}),a=C.useCallback(()=>{const{width:l,height:i,x:c,y:d}=qk(t);(l!==n.width||i!==n.height)&&(typeof s=="function"&&s({width:l,height:i,x:c,y:d}),r({width:l,height:i,x:c,y:d}))},[t,n,s]);return C.useEffect(()=>(window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}),[a]),C.useEffect(()=>{a()},[a]),n},Jk=t=>t.split("s+").map(s=>s.split("").map((n,r)=>r===0?n.toUpperCase():n).join("")).join(" "),$f=[],Sf=()=>{},qa=t=>t,Xk=(t,s)=>Ae(t,s),_f=t=>{t.stopPropagation()},Ys=t=>{const{options:s=$f,value:n=null,onChange:r=Sf,isMulti:a=!1,displayAccessor:l=qa,valueAccessor:i=qa,valueComparator:c=Xk,xDirection:d=0,zIndex:u=5,placeholder:m="Select a value...",disabled:p=!1,DisplayItem:x=Ef,isDropdown:h=!1,searchable:f=!1,removable:g=!0,InputContainer:y=Lf,maxOptions:v=1/0,children:j}=t,N=C.useMemo(()=>Ps(n)?Array.isArray(n)?n:[n]:[],[n]),[S,w]=C.useState(null),[k,$]=C.useState(!1),E=C.useCallback(H=>{H.stopPropagation(),$(J=>!J)},[]);C.useCallback(H=>{H.stopPropagation(),$(!0)},[]);const M=C.useCallback(H=>{H.stopPropagation(),$(!1)},[]);xc(S,M);const[_,L]=C.useState(),[D,A]=C.useState(d),[T,O]=C.useState(0);C.useEffect(()=>{if(!_||!k){O(0);return}const H=_.getBoundingClientRect(),J=window.innerHeight,G=window.innerWidth;H.x+H.width>G&&A(se=>-se),H.y+H.height>J&&O(J-(H.y+H.height))},[_,k]);const[B,F]=C.useState(""),z=C.useCallback(H=>N.reduce((J,G)=>J||c(G,H),!1),[N,c]),P=C.useCallback((H,J,G,se=[])=>H.reduce((le,ce,je)=>(z(G(ce))&&le.push({display:J(ce),value:G(ce),key:je}),P(I(ce,"children",[]),J,G,le)),se),[z]),U=C.useCallback(H=>{const J=i(H);if(F(""),a)if(g&&z(J)){const G=N.filter(se=>!c(se,J));r(G)}else r([...N,J]);else g&&z(J)?r(null):r(J),Ps(J)&&$(!1)},[N,z,r,a,g,l,i,c]),R=C.useCallback(H=>{a&&z(H)?r(N.filter(J=>!Ae(J,H))):!a&&z(H)&&r(null)},[N,z,r,a]),W=C.useMemo(()=>P(s,l,i),[s,l,i,P]),V=C.useMemo(()=>s.reduce((H,J)=>H||!!I(J,["children","length"],0),!1),[s]),X=C.useMemo(()=>Af(s,{keys:[{name:"label",getFn:l}],threshold:.25}),[s,l]),q=C.useMemo(()=>X(B).slice(0,v),[X,B,v]),Q=C.useCallback(H=>I(H,"DisplayItem",x),[x]),Y=C.useMemo(()=>q.map((H,J)=>{const G=Q(H),se=i(H);return e.jsx(If,{...t,options:I(H,"children",[]),xDirection:1,zIndex:u+5,select:U,Value:N,includes:z,children:e.jsx(Mf,{disabled:!Ps(se),select:U,option:H,children:e.jsx(G,{value:se,active:z(se),hasChildren:!!I(H,["children","length"],0),children:l(H)})})},J)}),[q,Q,l,i,z]);return e.jsxs("div",{ref:w,className:"relative cursor-pointer",onClick:E,children:[h?j:e.jsx(Qk,{placeholder:m,disabled:p,removable:g,remove:R,displayValues:W}),e.jsxs("div",{ref:L,className:`absolute w-full max-w-full ${k?"h-fit":"hidden h-0"}`,style:{zIndex:u,top:`calc(100% + ${T}px)`,left:D===1?"100%":D==0?"0%":null,right:D===-1?"100%":null,paddingTop:"0.25rem"},children:[s.length?null:e.jsx(x,{children:"No options available..."}),e.jsxs("div",{className:"w-full min-w-fit relative",children:[!f||V||s.length<10?null:e.jsx("div",{className:"w-full",onClick:_f,children:e.jsx(y,{children:e.jsx(zo,{value:B,onChange:F,placeholder:"search options..."})})}),e.jsx("div",{className:"scrollbar-xs",style:{maxHeight:V?null:"20rem",overflow:V?null:"auto"},children:Y})]})]})]})},If=t=>{const{options:s=$f,Value:n=null,select:r=Sf,displayAccessor:a=qa,valueAccessor:l=qa,xDirection:i,zIndex:c,DisplayItem:d=Ef,searchable:u=!1,InputContainer:m=Lf,maxOptions:p=1/0,includes:x,children:h}=t,[f,g]=C.useState(!1),y=C.useCallback(B=>{g(!0)},[]),v=C.useCallback(B=>{g(!1)},[]),[j,N]=C.useState(),[S,w]=C.useState(i),[k,$]=C.useState(0);C.useEffect(()=>{if(!j||!f){$(0);return}const B=j.getBoundingClientRect(),F=window.innerHeight,z=window.innerWidth;B.x+B.width>z&&w(P=>-P),B.y+B.height>F&&$(F-(B.y+B.height))},[j,f]);const E=C.useMemo(()=>s.reduce((B,F)=>B||!!I(F,["children","length"],0),!1),[s]),[M,_]=C.useState(""),L=C.useCallback(B=>{r(B),_("")},[r]),D=C.useMemo(()=>Af(s,{keys:[{name:"label",getFn:a}],threshold:.25}),[s,a]),A=C.useMemo(()=>D(M).slice(0,p),[D,M,p]),T=C.useCallback(B=>I(B,"Item",d),[d]);_e();const O=C.useMemo(()=>A.map((B,F)=>{const z=T(B),P=l(B);return e.jsx(If,{...t,options:I(B,"children",[]),xDirection:S,zIndex:c+5,children:e.jsx(Mf,{select:L,option:B,children:e.jsx(z,{value:P,active:x(P),hasChildren:!!I(B,["children","length"],0),children:a(B)})})},F)}),[A,T,a,l,x]);return e.jsxs("div",{className:"relative cursor-pointer",onMouseEnter:s.length?y:null,onMouseLeave:s.length?v:null,children:[h,e.jsx("div",{ref:N,className:`absolute w-full ${f?"h-fit":"hidden h-0"}`,style:{zIndex:c,top:`${k}px`,left:S===1?"100%":S==0?"0%":null,right:S===-1?"100%":null},children:e.jsxs("div",{className:"w-full min-w-fit relative",children:[!u||E||s.length<10?null:e.jsx("div",{className:"w-full",style:{bottom:S?"100%":null,position:S?"absolute":"block"},onClick:_f,children:e.jsx(m,{className:"rounded-t",children:e.jsx(zo,{value:M,onChange:_,placeholder:"search options..."})})}),e.jsx("div",{className:"scrollbar-xs",style:{maxHeight:E?null:"20rem",overflow:E?null:"auto"},children:O})]})})]})},Lf=({className:t="",children:s})=>{const n=_e();return e.jsx("div",{className:`${n.bgAccent1} p-1 border-b ${t}`,children:s})},Zk=({display:t,value:s,remove:n,removable:r})=>{const a=C.useCallback(i=>{i.stopPropagation(),n(s)},[n,s]),l=_e();return e.jsxs("div",{className:`
        px-1 flex items-center rounded mt-1 ml-1
        ${r?l.bgAccent1:""}
      `,children:[t,r?e.jsx("span",{onClick:a,className:`
            fa fa-remove text-xs ml-2 px-1 rounded
            ${l.bgAccent3Hover}
          `}):null]})},Yk=({children:t})=>{const s=_e();return e.jsx("div",{className:`px-1 mt-1 ml-1 ${s.textDisabled}`,children:t})},Qk=t=>{const{displayValues:s,placeholder:n,disabled:r,remove:a,removable:l}=t,i=_e();return e.jsx("div",{tabIndex:-1,className:`
        ${i.bgInput} rounded pl-1 pb-1 pr-2 flex flex-wrap
        focus:outline-1 focus:outline focus:outline-current
        hover:outline-1 hover:outline hover:outline-gray-300
      `,children:s.length?s.map((c,d)=>e.jsx(Zk,{...c,removable:l,remove:a},c.key)):e.jsx(Yk,{children:n})})},Ef=({children:t,active:s,hasChildren:n})=>{const r=_e();return e.jsxs("div",{className:`
        py-1 px-2 flex items-center text-left min-w-fit w-full whitespace-nowrap
        ${s?r.bgAccent3:`${r.bgAccent2Hover} ${r.bgAccent1}`}
      `,children:[e.jsx("div",{className:"flex-1",children:t}),n?e.jsx("span",{className:"fa fa-caret-right ml-2"}):null]})},Mf=({select:t,option:s,disabled:n,children:r})=>{const a=C.useCallback(l=>{l.stopPropagation(),t(s)},[t,s]);return e.jsx("div",{onClick:n?null:a,children:r})},xc=(t,s)=>{t=I(t,"current",t),C.useEffect(()=>{if(!t)return;const n=r=>{t&&!t.contains(r.target)&&s(r)};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[t,s])},Af=(t,s)=>{const n=new o1(t,s);return r=>r?n.search(r).map(a=>a.item):t},Kk=(t,s)=>t.split(/\s+/).map(n=>{const[r,...a]=n.split(new RegExp("(?<!^)(?=[A-Z])"));return s.$compositions&&s.$compositions[r]?s.$compositions[r].reduce((l,i)=>{let c=i.$default||"";for(const d of a)d in i&&(c=i[d]);return l.push(c),l},[]).filter(Boolean).join(" "):s[r]||n}).filter(Boolean).join(" "),Tf=t=>{const s=JSON.parse(JSON.stringify(t)),n=/^.*[@](.+)\s*/;for(const r in s){if(r==="$compositions")continue;const a=s[r].split(/\s+/);s[r]=a.map(l=>{const i=n.exec(l);if(i){const[,c]=i;return o.replace(`@${c}`,s[c])}return l}).join(" ")}if(s.$compositions)for(const r in s.$compositions)s.$compositions[r].forEach(a=>{for(let l in a){a[l]=a[l].split(/\s+/).map(d=>{const u=n.exec(d);if(u){const[,m]=u;return d.replace(`@${m}`,s[m])}return d}).join(" ");const c=/^\$(.+)$/.exec(a[l]);if(c){const[,d]=c;d in s&&(a[l]=s[d])}}});return s},e$={get:(t,s,n)=>(s in t||(t[s]=Kk(s,t)),t[s])},Of=t=>new Proxy(t,e$),t$=[{$default:"rounded inline-block @transition disabled:cursor-not-allowed",Text:"rounded inline-flex items-center justify-center @transition disabled:cursor-not-allowed"},{$default:"@bgInput",Text:"@bg"},{$default:"@textButton",Primary:"@textPrimary",Success:"@textSuccess",Danger:"@textDanger",Info:"@textInfo",Dark:"@text"},{$default:"outline outline-1 @outlineButton",Primary:"outline outline-1 @outlinePrimary",Success:"outline outline-1 @outlineSuccess",Danger:"outline outline-1 @outlineDanger",Info:"outline outline-1 @outlineInfo",Dark:"outline outline-1 @outline",Text:""},{$default:"@bgButtonHover @textContrastHover",Primary:"@bgPrimaryHover @textContrastHover",Success:"@bgSuccessHover @textContrastHover",Danger:"@bgDangerHover @textContrastHover",Info:"@bgInfoHover @textContrastHover",Dark:"@bgContrastHover @textContrastHover",Text:"@bgInputHover"},{$default:"disabled:bg-opacity-50 disabled:hover:@bgInput disabled:hover:bg-opacity-50",Text:"disabled:bg-opacity-50 disabled:hover:@bg disabled:hover:bg-opacity-50"},{$default:"@paddingBase @textBase",Large:"@paddingLarge @textLarge",Small:"@paddingSmall @textSmall"},{Block:"w-full"}],s$=[{$default:`w-full block rounded @transition @text
							cursor-pointer disabled:cursor-not-allowed
							focus:outline-1 focus:outline focus:outline-current
							hover:outline-1 hover:outline hover:outline-gray-300`},{$default:"@paddingBase @textBase",Large:"@paddingLarge @textLarge",Small:"@paddingSmall @textSmall"}],Df={button:t$,input:s$},n$={bgInput:"bg-white",bgInputHover:"hover:bg-white",bgLegend:"bg-gray-300",bgLegendHover:"hover:bg-gray-300",bgContrast:"bg-gray-800",bgContrastHover:"hover:bg-gray-800",textContrast:"text-white",textContrastHover:"hover:text-white",text:"text-gray-800 disabled:text-gray-400 placeholder:text-gray-400",textDisabled:"text-gray-400 disabled:text-gray-400 placeholder:text-gray-400",bg:"bg-gray-100",border:"border-gray-800",outline:"outline-gray-800",textButton:"text-gray-400 disabled:text-gray-400 placeholder:text-gray-400",bgButton:"bg-gray-400",bgButtonHover:"hover:bg-gray-400",borderButton:"border-gray-400",outlineButton:"outline-gray-400",textInfo:"text-blue-400 disabled:text-blue-400 placeholder:text-blue-400",bgInfo:"bg-blue-400",bgInfoHover:"hover:bg-blue-400",borderInfo:"border-blue-400",outlineInfo:"outline-blue-400",textSuccess:"text-green-400 disabled:text-green-400 placeholder:text-green-400",bgSuccess:"bg-green-400",bgSuccessHover:"hover:bg-green-400",borderSuccess:"border-green-400",outlineSuccess:"outline-green-400",textPrimary:"text-blue-400 disabled:text-blue-400 placeholder:text-blue-400",bgPrimary:"bg-blue-400",bgPrimaryHover:"hover:bg-blue-400",borderPrimary:"border-blue-400",outlinePrimary:"outline-blue-400",textDanger:"text-red-400 disabled:text-red-400 placeholder:text-red-400",bgDanger:"bg-red-400",bgDangerHover:"hover:bg-red-400",borderDanger:"border-red-400",outlineDanger:"outline-red-400",textWarning:"text-yellow-400 disabled:text-yellow-400 placeholder:text-yellow-400",bgWarning:"bg-yellow-400",bgWarningHover:"hover:bg-yellow-400",borderWarning:"border-yellow-400",outlineWarning:"outline-yellow-400",textSmall:"text-sm",textBase:"text-base",textLarge:"text-lg",paddingSmall:"py-0 px-1",paddingBase:"py-1 px-2",paddingLarge:"py-2 px-4",bgAccent1:"bg-gray-200",bgAccent2:"bg-gray-300",bgAccent3:"bg-gray-400",bgAccent4:"bg-gray-500",bgAccent1Hover:"hover:bg-gray-200",bgAccent2Hover:"hover:bg-gray-300",bgAccent3Hover:"hover:bg-gray-400",bgAccent4Hover:"hover:bg-gray-500",textHighlight:"text-blue-500",textHighlightHover:"hover:text-blue-500",borderHighlight:"border-blue-500",borderHighlightHover:"hover:border-blue-500",bgHighlight:"bg-blue-500",bgHighlightHover:"hover:bg-blue-500",transition:"transition ease-in-out duration-150",$compositions:Df},r$=Tf(n$),a$=Of(r$),Bf=C.createContext(a$),_e=()=>C.useContext(Bf),o$=({theme:t,children:s})=>e.jsx(Bf.Provider,{value:t,children:s}),Ga=({className:t="button",children:s,...n})=>{const r=_e();return e.jsx("button",{className:r[t],...n,children:s})},zo=C.forwardRef(({onChange:t,className:s="input",...n},r)=>{const a=C.useCallback(i=>{t(i.target.value,i)},[t]),l=_e();return e.jsx("input",{ref:r,...n,onChange:a,className:l[s]})}),Ja=(t,s,n)=>{switch(t){case"quantize":return ym().domain(yi(s)).range(n);case"quantile":return bm().domain(s).range(n);case"threshold":return bi().domain(s).range(n);case"ordinal":return vm().domain(s).range(n)}},l$=({domain:t,range:s,format:n})=>{const r=C.useMemo(()=>Ja("ordinal",t,s),[t,s]);return C.useMemo(()=>typeof n=="function"?n:vi(n),[n]),e.jsxs("div",{children:[e.jsx("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${t.length}, minmax(0, 1fr))`},children:t.map(a=>e.jsx(qr,{colors:[r(a)],height:3},a))}),e.jsx("div",{className:"grid gap-1 text-right",style:{gridTemplateColumns:`repeat(${t.length}, minmax(0, 1fr))`},children:t.map(a=>e.jsx("div",{className:"pr-1",children:a},a))})]})},i$=({children:t})=>{const s=_e();return e.jsx("div",{className:`
        ${s.bgAccent2} ${s.border}
        border-b border-x rounded-b px-1
      `,children:t})},c$=({range:[t,s],color:n,format:r,isFirst:a,isLast:l})=>t?s?l?e.jsxs("div",{children:[e.jsxs("div",{children:["greater than or equal to ",r(t)]}),e.jsxs("div",{children:["less than or equal to ",r(s)]})]}):e.jsxs("div",{children:[e.jsxs("div",{children:["greater than or equal to ",r(t)]}),e.jsxs("div",{children:["less than ",r(s)]})]}):e.jsx("div",{children:e.jsxs("div",{children:["greater than or equal to ",r(t)]})}):e.jsx("div",{children:e.jsxs("div",{children:["less than ",r(s)]})}),d$=({type:t,domain:s,range:n,showHover:r=!0,format:a=",d"})=>{const l=C.useMemo(()=>Ja(t,s,n),[t,s,n]),i=C.useMemo(()=>typeof a=="function"?a:vi(a),[a]),[c,d]=C.useState(!1),u=C.useCallback((p,x)=>{d(p)},[]),m=C.useCallback(()=>{d(!1)},[]);return _e(),e.jsxs("div",{children:[e.jsx(qr,{colors:n,height:3,onMouseEnter:r?u:null,onMouseLeave:r?m:null}),e.jsx(m$,{type:t,scale:l,format:i}),e.jsx("div",{className:"w-full relative",children:!c||!r?null:e.jsx("div",{className:"absolute w-full left-0 top-0",children:e.jsx(i$,{children:e.jsx(c$,{color:c,range:l.invertExtent(c),format:i,isFirst:c===n[0],isLast:c===n[n.length-1]})})})})]})},u$=({type:t,...s})=>t==="ordinal"?e.jsx(l$,{...s}):e.jsx(d$,{type:t,...s}),m$=({type:t,scale:s,format:n})=>{const r=s.range().length;return t==="threshold"?e.jsxs("div",{className:"flex text-left",children:[e.jsx("div",{style:{width:`${100/r}%`}}),s.domain().map((a,l)=>e.jsx("div",{className:"pl-1",style:{width:`${100/r}%`},children:n(a)},a))]}):e.jsx("div",{className:"flex text-right",children:s.range().map((a,l)=>e.jsx("div",{className:"pr-1",style:{width:`${100/r}%`},children:n(s.invertExtent(a)[1])},a))})},p$=({value:t,onChange:s})=>{const n=C.useCallback(a=>{s(!t)},[s,t]),r=_e();return e.jsx("div",{onClick:n,className:`
        ${r.bgInput} ${r.input}
      `,children:e.jsx("div",{className:"h-6 w-full flex items-center px-2",children:e.jsx("div",{className:`
            rounded h-2 relative flex flex-1 items-center
            ${r.bgAccent2}
          `,children:e.jsx("div",{className:`
              w-4 h-4 rounded absolute
              ${t?r.bgHighlight:r.bgAccent3}
            `,style:{left:t?"100%":"0%",transform:"translateX(-50%)",transition:"left 150ms"}})})})})},x$=({maplibreMap:t,layer:s,...n})=>null,kl=()=>null,h$=t=>{const s=_e();return e.jsxs("div",{className:`px-2 py-1 ${s.bg} rounded`,children:[e.jsx("div",{children:"Broke-ass default hover component..."}),e.jsxs("div",{className:"flex items-center flex-col",children:[e.jsx("span",{className:"fa fa-face-sad-tear text-6xl"}),e.jsx("span",{children:"...so sad..."})]}),e.jsx("div",{className:"whitespace-pre-wrap",children:JSON.stringify(t.data,null,3)})]})},Ou=750,f$=t=>{const{maplibreMap:s,layer:n,isActive:r,isVisible:a,updateHover:l,styleIndex:i,MapActions:c,resourcesLoaded:d,containerId:u,Protocols:m}=t,{sources:p,layers:x,onClick:h,onHover:f,onBoxSelect:g,RenderComponent:y}=n,v=C.useCallback(A=>{c.updateLayerState(n.id,A)},[c.updateLayerState,n.id]),j=C.useCallback(()=>{c.startLayerLoading(n.id)},[c.startLayerLoading,n.id]),N=C.useCallback(()=>{c.stopLayerLoading(n.id)},[c.stopLayerLoading,n.id]),S=C.useCallback(A=>{c.setResourcesLoaded(n.id,A)},[c.setResourcesLoaded,n.id]),[w,k]=C.useState(0),$=C.useCallback(()=>{k(A=>A+1)},[]),E=C.useCallback(()=>{k(A=>A-1)},[]);C.useEffect(()=>{if(!s||!r)return;S(!1),$(),j(),p.forEach(({id:B,source:F,protocol:z})=>{if(!s.getSource(B)){if(z in m){const{sourceInit:P,Protocol:U}=m[z];P(U,F,s)}s.addSource(B,F)}});const A=()=>{p.forEach(({id:B,source:F})=>{s.getSource(B)&&s.removeSource(B,F)})};x.forEach(B=>{s.getLayer(B.id)||(B.beneath&&s.getLayer(B.beneath)?s.addLayer(B,B.beneath):s.addLayer(B))});const T=()=>{x.forEach(B=>{s!=null&&s.getLayer(B.id)&&(s==null||s.removeLayer(B.id))})};return setTimeout(()=>{E(),N()},Ou),()=>{!s||!s.loaded()||(S(!1),T(),A())}},[s,p,x,m,r,$,E,S,j,N]);const M=C.useRef(i);C.useEffect(()=>{if(!s||!r||M.current===i)return;S(!1),$(),j(),p.forEach(({id:T,source:O})=>{s.getSource(T)||s.addSource(T,O)}),x.forEach(T=>{s.getLayer(T.id)||(T.beneath&&s.getLayer(T.beneath)?s.addLayer(T,T.beneath):s.addLayer(T))}),M.current=i,setTimeout(()=>{E(),N()},Ou)},[s,p,x,r,$,E,j,N,i,S]),C.useEffect(()=>{if(!s||!r||!h)return;const{layers:A,callback:T=kl}=h;function O(F,{point:z,features:P,lngLat:U}){T.call(n,F,P,U,z)}const B=A.map(F=>{const z=O.bind(null,F);return F==="maplibreMap"?(s.on("click",z),{action:"click",callback:z,layerId:F}):(s.on("click",F,z),{action:"click",callback:z,layerId:F})});return()=>{!s||!s.loaded()||B.forEach(({action:F,callback:z,layerId:P})=>{P==="maplibreMap"?s.off(F,z):s.off(F,P,z)})}},[s,n,h,r]),C.useEffect(()=>{if(!s||!r||!f)return;const{layers:A=[],callback:T=kl,hoverEnter:O=null,hoverMove:B=null,hoverLeave:F=null,Component:z=h$,property:P=null,filterFunc:U=null,isPinnable:R=!1,zIndex:W=-1}=f,V=new Map;function X(J,{point:G,features:se,lngLat:le}){const ce=V.get(J)||new Map;V.set(J,new Map);const je=ve=>{ve.forEach(({id:ae,source:de,sourceLayer:te})=>{if(ae!=null)if(ce.has(ae))V.get(J).set(ae,ce.get(ae)),ce.delete(ae);else{const re={id:ae,source:de,sourceLayer:te};V.get(J).set(ae,re),s.setFeatureState(re,{hover:!0})}})},Ce=new Map;if(P){const ve=se.reduce((ae,de)=>{const te=I(de,["properties",P],null);return te&&(ae[te]=!0),ae},{});s.queryRenderedFeatures({layers:[J],filter:["in",["get",P],["literal",Object.keys(ve)]]}).forEach(ae=>{ae.id&&Ce.set(ae.id,ae)})}if(U){const ve=U.call(n,J,se,le,G);Ps(ve)&&s.queryRenderedFeatures({layers:[J],filter:ve}).forEach(ae=>{ae.id&&Ce.set(ae.id,ae)})}se.forEach(ve=>{ve.id&&Ce.set(ve.id,ve)}),je([...Ce.values()]),ce.forEach(ve=>{s.setFeatureState(ve,{hover:!1})});const oe=T(J,se,le,G);Ps(oe)&&l({type:"hover-layer-move",lngLat:le,Component:z,layer:n,layerId:J,isPinnable:R,zIndex:W,data:oe})}const q=(J,G)=>{V.has(G)&&(V.get(G).forEach(se=>{J.setFeatureState(se,{hover:!1})}),V.delete(G))};function Q(J,G){q(s,J),l({type:"hover-layer-leave",layerId:J})}const Y=J=>({point:G,features:se,lngLat:le})=>J(se,le,G),H=A.reduce((J,G)=>{let se=X.bind(n,G);if(J.push({action:"mousemove",callback:se,layerId:G}),s.on("mousemove",G,se),se=Q.bind(n,G),J.push({action:"mouseleave",callback:se,layerId:G}),s.on("mouseleave",G,se),typeof O=="function"){const le=Y(O.bind(n,Ca));J.push({action:"mouseenter",callback:le,layerId:G}),s.on("mouseenter",G,le)}if(typeof B=="function"){const le=Y(B.bind(n,Ca));J.push({action:"mousemove",callback:le,layerId:G}),s.on("mousemove",G,le)}if(typeof F=="function"){const le=Y(F.bind(n,Ca));J.push({action:"mouseleave",callback:le,layerId:G}),s.on("mouseleave",G,le)}return J},[]);return()=>{!s||!s.loaded()||(H.forEach(({action:J,callback:G,layerId:se})=>{s.off(J,se,G)}),V.forEach(J=>{J.forEach(G=>{s.setFeatureState(G,{hover:!1})})}))}},[s,n,f,r,l]),C.useEffect(()=>{if(!s||!r||!g)return;const{callback:A=kl,className:T="bg-black bg-opacity-25 border-2 border-black rounded",layers:O,filter:B}=g;let F=[],z,P,U;const R=document.getElementById(u),W=document.getElementById(`${u}-box-select-blocker`),V=H=>{const J=R.getBoundingClientRect();return new gn.Point(H.clientX-J.left-R.clientLeft,H.clientY-J.top-R.clientTop)},X=H=>{if(document.removeEventListener("mousemove",q),document.removeEventListener("mouseup",Q),s.dragPan.enable(),W.classList.add("pointer-events-none"),W.classList.remove("pointer-events-auto"),U&&(U.remove(),U=null),H){F.forEach(se=>{s.setFeatureState(se,{select:!1})});const J=s.queryRenderedFeatures(H,{layers:O,filter:B}),G=new Set;F=J.reduce((se,le)=>{if(!G.has(le.id)){G.add(le.id);const ce={id:le.id,source:le.source,sourceLayer:le.sourceLayer,properties:le.properties};se.push(ce),s.setFeatureState(ce,{select:!0})}return se},[]),A(F)}},q=H=>{H.preventDefault(),P=V(H),U||(U=document.createElement("div"),U.className="absolute top-0 left-0 w-0 h-0 "+T,R.appendChild(U));var J=Math.min(z.x,P.x),G=Math.max(z.x,P.x),se=Math.min(z.y,P.y),le=Math.max(z.y,P.y);U.style.transform=`translate( ${J}px, ${se}px)`,U.style.width=`${G-J}px`,U.style.height=`${le-se}px`},Q=H=>{X([z,V(H)])},Y=H=>{H.shiftKey&&H.button===0&&(document.addEventListener("mousemove",q),document.addEventListener("mouseup",Q),s.dragPan.disable(),W.classList.remove("pointer-events-none"),W.classList.add("pointer-events-auto"),z=V(H))};return R.addEventListener("mousedown",Y,!0),s.boxZoom.disable(),()=>{R.removeEventListener("mousedown",Y),!(!s||!s.loaded())&&s.boxZoom.enable()}},[s,x,n,g,r,u]),C.useEffect(()=>{if(!s||d)return;const A=p.reduce((B,F)=>B&&!!s.getSource(F.id),!0),T=x.reduce((B,F)=>B&&!!s.getLayer(F.id),!0);S(!w&&A&&T)},[s,n.id,p,x,S,w,d]);const[_,L]=C.useState({}),D=C.useCallback((A,T)=>{L(typeof A=="object"?O=>({...O,...A}):O=>{const B={...O,[A]:T};return Ae(O,B)?O:B})},[]);return C.useEffect(()=>{const A=x.reduce((T,O)=>(T[O.id]=I(O,["layout","visibility"],"visible"),T),{});L(A)},[x]),C.useEffect(()=>{s&&d&&x.forEach(({id:A})=>{a&&_[A]!=="none"?s.setLayoutProperty(A,"visibility","visible"):s.setLayoutProperty(A,"visibility","none")})},[s,x,a,d,_]),e.jsx(y,{...t,setLayerVisibility:D,updateLayerState:v,startLayerLoading:j,stopLayerLoading:N})};let Ca=-1;const g$=()=>`avl-layer-${++Ca}`,b$={sources:[],layers:[],toolbar:["toggle-visibility"],startActive:!0,startVisible:!0,startState:{},filters:{},modals:{},mapActions:[],loadingIndicator:{},isDynamic:!1};class Po{constructor(s={}){Wt(this,"RenderComponent",x$);const n={...b$,...s};for(const r in n)this[r]=n[r];this.id=this.id||g$(),this._initialized=!1}onFilterChange(s,n,r){}}const y$=({children:t})=>e.jsx("div",{className:"grid grid-cols-1 gap-1",children:t}),v$=({children:t})=>{const s=_e();return e.jsx("div",{className:(s==null?void 0:s.LayerSidebarPanelContainer)!=="LayerSidebarPanelContainer"?s.LayerSidebarPanelContainer:`w-80 h-full max-h-full p-1 ${s.bg} rounded-b pointer-events-auto overflow-auto scrollbar-sm`,children:t})},w$=({open:t,children:s})=>{const n=_e();return e.jsx("div",{className:`
        w-full h-full relative ${t?"p-0":"pr-8"}
      `,style:{transition:"padding 150ms"},children:e.jsx("div",{className:(n==null?void 0:n.LayerSidebarContainer)!=="LayerSidebarContainer"?n.LayerSidebarContainer:"w-full h-full max-h-full relative",children:s})})},j$=({toggle:t,open:s})=>{const n=_e();return e.jsx("div",{className:"pointer-events-auto",children:e.jsx("div",{onClick:t,className:(n==null?void 0:n.LayerSidebarToggle)!="LayerSidebarToggle"?n.LayerSidebarToggle:`
          h-8 w-8 ${n.bg} text-2xl
          flex items-center justify-center
          cursor-pointer ${s?"rounded-t":"rounded"}
          pointer-events-auto absolute
          ${n.textHighlightHover}
        `,style:{right:s?"0rem":"-2rem",transition:"right 150ms"},children:e.jsx("span",{className:`fa fa-caret-${s?"left":"right"}`})})})},C$=({icon:t,active:s,setTabIndex:n,index:r})=>{const a=C.useCallback(i=>{n(r)},[n,r]),l=_e();return e.jsx("div",{onClick:a,className:s?(l==null?void 0:l.LayerSidebarTabActive)!="LayerSidebarTabActive"?l==null?void 0:l.LayerSidebarTabActive:` h-8 w-10 rounded-t mr-1 cursor-pointer pointer-events-auto relative ${l.bg} ${l.textHighlight}`:(l==null?void 0:l.LayerSidebarTab)!="LayerSidebarTab"?l==null?void 0:l.LayerSidebarTab:` h-8 w-10 rounded-t mr-1 cursor-pointer pointer-events-auto relative ${l.bgAccent1} ${l.textHighlight}`,children:s?e.jsx("div",{className:"absolute inset-0 flex justify-center items-center",children:e.jsx("span",{className:`${t} `})}):e.jsxs("div",{className:"absolute inset-0 flex justify-center items-center",children:[e.jsx("span",{className:`${t} `}),e.jsx("span",{className:`
            absolute inset-0 flex justify-center items-center
            opacity:100 hover:opacity-25 ${l.text} ${t}
          `})]})})},N$=({children:t})=>{const s=_e();return e.jsx("div",{className:`border ${s.border} rounded`,children:t})},k$=({children:t,...s})=>{const n=_e();return e.jsx("span",{className:`${n.bgAccent3Hover} relative px-2 py-1 rounded cursor-pointer`,...s,children:t})},$$=({toggleOpen:t,open:s,children:n})=>{const r=_e();return e.jsx("div",{onClick:t,className:`
        p-1 w-full rounded-t ${s?"border-b":"rounded-b"}
        ${r.border} ${r.bgAccent2} cursor-pointer
      `,children:n})},S$=({name:t="Unnamed Filter",lastFilter:s,children:n})=>e.jsxs("div",{className:"flex-1 p-1",children:[e.jsx("div",{children:t}),e.jsx("div",{children:n})]}),_$=({mapStyle:t,isActive:s})=>{const n=_e();return e.jsx("div",{className:`
        flex items-center p-1 border ${n.border} rounded ${n.bgAccent2}
        ${s?`border-r-8 ${n.borderHighlight}`:`cursor-pointer ${n.bgAccent3Hover}`}
      `,children:e.jsx("div",{className:"ml-1 flex-1 h-full flex items-center",children:t.name})})},I$=({open:t,toggleOpen:s,children:n})=>{const r=_e();return e.jsxs("div",{onClick:s,className:`
        p-1 font-bold flex rounded-t cursor-pointer
        ${r.bgAccent1} ${r.bgAccent2Hover}
        ${t?`border-b ${r.border}`:"rounded-b"}
      `,children:[e.jsx("div",{className:"flex-1",children:n}),e.jsx("div",{children:e.jsx("span",{className:"px-2 py-1",children:e.jsx("span",{className:`fa fa-${t?"minus":"plus"}`})})})]})},L$=({children:t})=>e.jsx("div",{className:"p-1",children:t}),E$=({children:t})=>{const s=_e();return e.jsx("div",{className:`rounded border ${s.border}`,children:t})},M$=({name:t,title:s,children:n})=>{const r=_e();return e.jsx("div",{className:`p-1 sticky top-0 ${r.bg}`,children:e.jsxs("div",{className:`
          p-1 relative border rounded pointer-events-auto
          ${r.bgLegend} ${r.bgLegendHover} ${r.border}
        `,children:[e.jsx("div",{children:t||s}),e.jsx("div",{children:n})]})})},A$=({open:t,children:s})=>{const n=_e();return e.jsx("div",{className:"relative h-full",children:e.jsx("div",{className:`
          w-96 ${n.bg} rounded pointer-events-auto
          max-h-full scrollbar-sm overflow-auto
        `,children:s})})},T$=({layer:t})=>{const s=_e(),{icon:n="fa-solid fa-spinner",color:r=s.textHighlight}=t.loadingIndicator;return e.jsxs("div",{className:`w-fit flex items-center rounded-l ${s.bg} p-2`,style:{borderTopRightRadius:"2rem",borderBottomRightRadius:"2rem",minWidth:"16rem"},children:[e.jsx("div",{className:"flex-1 font-bold mr-4",children:t.name}),e.jsx("div",{className:"flex items-center",style:{fontSize:"2rem"},children:e.jsx("span",{className:`${n} ${r} fa-spin`})})]})},O$=({children:t})=>{const s=_e();return e.jsx("div",{className:`p-1 rounded ${s.bg} w-fit`,children:e.jsx("div",{className:`border ${s.border} rounded whitespace-nowrap`,children:t})})},D$=({children:t,closeModal:s,dragHandle:n,bringModalToFront:r})=>{const a=_e();return e.jsxs("div",{id:n,onClick:r,className:`
        p-1 font-bold ${a.bgAccent2} rounded-t flex
        border-b ${a.border} cursor-grabbing
      `,children:[e.jsx("div",{className:"flex-1",children:t}),e.jsx("div",{children:e.jsx("span",{onClick:s,className:"px-2 py-1 hover:bg-gray-400 rounded cursor-pointer",children:e.jsx("span",{className:"fa fa-close"})})})]})},B$=({children:t})=>e.jsx("div",{className:"p-1",children:t}),F$={HoverComponentContainer:y$,LoadingIndicator:T$,LayerSidebarContainer:w$,LayerSidebarToggle:j$,LayerSidebarTab:C$,LayerSidebarPanelContainer:v$,LayerPanelContainer:N$,LayerPanelHeaderButton:k$,LayerPanelHeaderContainer:$$,LayerPanelFilterContainer:S$,MapStylePanel:_$,ModalContainer:O$,ModalHeaderContainer:D$,ModalContentContainer:B$,InfoBoxContainer:E$,InfoBoxHeaderContainer:I$,LegendContainer:M$,InfoBoxSidebarContainer:A$,InfoBoxContentContainer:L$},z$=C.createContext(F$),Dt=()=>C.useContext(z$),P$=({destroyDynamicLayer:t})=>{const[s,n]=C.useState(0),r=C.useRef();C.useEffect(()=>{s>0&&(r.current=setTimeout(n,1e3,s-1))},[s]);const a=C.useCallback(i=>{i.stopPropagation(),s===0?n(3):(n(0),clearTimeout(r.current),t())},[t,s]),{LayerPanelHeaderButton:l}=Dt();return e.jsxs(l,{onClick:a,children:[s?e.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-white font-bold",children:s}):null,e.jsx("span",{className:"fa fa-trash text-red-500"})]})},R$=({layer:t,MapActions:s,children:n})=>{const r=C.useCallback(i=>{i.stopPropagation(),s.deactivateLayer(t.id)},[s.deactivateLayer,t.id]),a=C.useCallback(i=>{s.destroyDynamicLayer(t.id)},[s.destroyDynamicLayer,t.id]),{LayerPanelHeaderButton:l}=Dt();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1 font-bold",children:t.name||"AVL Layer"}),e.jsxs("div",{className:"flex-0",children:[t.isDynamic?e.jsx(P$,{destroyDynamicLayer:a}):null,e.jsx(l,{onClick:r,children:e.jsx("span",{className:"fa fa-close"})})]})]}),e.jsx("div",{className:"flex",children:e.jsx("div",{className:"flex-0 flex",children:n})})]})},$l=t=>({MapActions:s,layer:n,id:r,...a})=>{const l=C.useCallback(i=>{s.updateFilter(n,r,i)},[s.updateFilter,n,r]);return e.jsx(t,{...a,layer:n,id:r,MapActions:s,onChange:l})},H$=({type:t})=>{const s=_e();return e.jsxs("div",{className:`px-2 py-1 rounded outline outline-1 ${s.outline}`,children:['Unknown filter type: "',t,'"']})},W$=({layer:t,MapActions:s,filterUpdate:n,...r})=>{const[a,l]=C.useState(!1),i=C.useCallback(f=>{f.stopPropagation(),l(g=>!g)},[]);C.useEffect(()=>{Object.keys(t.filters).forEach(f=>{const{type:g,wrapper:y,Component:v}=t.filters[f];switch(g){case"select":{y?t.filters[f].Filter=$l(y(Ys)):t.filters[f].Filter=$l(Ys);break}default:v?t.filters[f].Filter=$l(v):t.filters[f].Filter=H$}})},[t]);const[c,d]=C.useState([]),u=C.useCallback(()=>{d(Object.keys(t.filters).reduce((f,g)=>{const{Filter:y,isActive:v=!0,...j}=t.filters[g];return y&&v&&f.push({Filter:y,id:g,...j}),f},[]))},[t.filters]);C.useEffect(()=>{u()},[u]),C.useEffect(()=>{if(n){const{filterId:f,prevValue:g,value:y}=n;for(const v in t.filters)v===f&&(t.filters[f].prevValue=g,t.filters[f].value=y);typeof t.onFilterChange=="function"&&t.onFilterChange.call(t,f,y,g),u()}},[t,u,n]);const{LayerPanelContainer:m,LayerPanelHeaderContainer:p,LayerPanelFilterContainer:x}=Dt(),h=!!(a&&c.length);return e.jsxs(m,{children:[e.jsx(p,{toggleOpen:i,open:h,children:e.jsx(R$,{layer:t,...r,MapActions:s,open:h,children:I(t,"toolbar",[]).map((f,g)=>e.jsx("div",{className:"",children:e.jsx(q$,{...r,MapActions:s,layer:t,tool:f})},g))})}),e.jsx("div",{className:`${h?"block":"h-0 overflow-hidden invisible"}`,children:c.map(({Filter:f,id:g,name:y,...v},j)=>e.jsx(x,{name:y,lastFilter:j===c.length-1,children:e.jsx(f,{...v,...r,id:g,layer:t,MapActions:s})},g))})]})},V$=t=>{const{activeLayers:s,inactiveLayers:n,MapActions:r,filterUpdate:a,mapName:l,...i}=t,c=_e();return e.jsxs(e.Fragment,{children:[l?e.jsx("div",{className:`mb-1 font-bold text-lg text-center ${c.bg} sticky top-0`,children:l}):null,n.length?e.jsx(Ys,{isDropdown:!0,options:n,onChange:r.activateLayer,displayAccessor:d=>d.name,valueAccessor:d=>d.id,children:e.jsx("div",{className:`border ${c.border} rounded px-2 py-1 mb-1`,children:"Select a layer..."})}):null,e.jsx("div",{className:"grid grid-cols-1 gap-1",children:s.map(d=>e.jsx(W$,{layer:d,...i,MapActions:r,filterUpdate:a.layerId===d.id?a:null},d.id))})]})},U$=t=>{if(typeof t!="string")return t;switch(t){case"toggle-visibility":return{tooltip:"Toogle Visibility",Icon:({isVisible:s})=>e.jsx("span",{className:`fa fa-eye${s?"":"-slash"}`}),action:({toggleLayerVisibility:s},n)=>s(n.id)};default:return{tooltip:`Unknown Tool "${t}"`,Icon:"fa fa-frown",action:null}}},q$=({tool:t,MapActions:s,layer:n,layerVisibility:r,...a})=>{const l=C.useMemo(()=>U$(t),[t]),i=C.useMemo(()=>typeof l.Icon=="function"?l.Icon:()=>e.jsx("span",{className:l.Icon}),[l]),c=C.useCallback(u=>{u.stopPropagation(),typeof l.action=="function"&&l.action(s,n)},[l,s,n]),{LayerPanelHeaderButton:d}=Dt();return e.jsx(d,{onClick:c,children:e.jsx(i,{layer:n,isVisible:I(r,n.id)})})},G$=({legend:t,MapActions:s})=>{const n=C.useCallback(u=>{s.updateLegend({...t,type:u})},[s.updateLegend,t]),r=C.useCallback(u=>{s.updateLegend({...t,range:u})},[s.updateLegend,t]),[a,l]=C.useState(-1),i=_e(),[c,d]=C.useState(!1);return e.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[e.jsx("div",{className:"font-bold text-lg text-center",children:"Legend Controls"}),e.jsxs("div",{className:`rounded ${i.bgAccent2} border ${i.border}`,children:[e.jsxs("div",{className:`border-b ${i.border}`,children:[e.jsx("div",{className:"px-2 py-1",children:"Current:"}),e.jsx("div",{className:"px-2 pb-2",children:e.jsx(qr,{height:3,colors:t.range})})]}),e.jsxs("div",{className:"p-1 flex items-center",children:[e.jsx("div",{className:"w-32 text-right",children:"Type:"}),e.jsx("div",{className:"flex-1 ml-1",children:e.jsx(X$,{type:t.type,updateLegend:n})})]}),e.jsxs("div",{className:"p-1 flex items-center",children:[e.jsx("div",{className:"w-32 text-right",children:"Reverse Colors:"}),e.jsx("div",{className:"flex-1 ml-1",children:e.jsx(p$,{value:c,onChange:d})})]})]}),Object.keys(Ua).map((u,m)=>e.jsx(Y$,{type:u,startSize:t.range.length,colors:Ua[u],updateLegend:r,isOpen:a===m,setOpen:l,index:m,current:t.range,reverseColors:c},u))]})},J$=[{value:"quantize",name:"Quantize"},{value:"quantile",name:"Quantile"},{value:"threshold",name:"Threshold"},{value:"ordinal",name:"Ordinal"}],X$=({type:t,updateLegend:s})=>{const n=C.useCallback(r=>{s(r)},[s]);return e.jsx(Ys,{removable:!1,options:J$,displayAccessor:r=>r.name,valueAccessor:r=>r.value,onChange:n,value:t})};po(3,13);const Z$=({size:t,sizes:s,setSize:n})=>{const r=_e();return e.jsxs("div",{className:`flex items-center p-1 rounded border ${r.border}`,children:[e.jsx("div",{className:"flex-0 mr-1",children:"Size:"}),e.jsx("div",{className:"flex-1",children:e.jsx(Ys,{removable:!1,options:s,onChange:n,value:t})})]})},Y$=t=>{const{type:s,colors:n,startSize:r,updateLegend:a,isOpen:l,setOpen:i,index:c,current:d,reverseColors:u=!1}=t,[m,p]=C.useState(r),x=C.useCallback(()=>{i(y=>y===c?-1:c)},[c]),h=C.useMemo(()=>Object.keys(n).reduce((y,v)=>{const j=I(n,[v,m],null);return j&&y.push({name:v,colors:u?[...j].reverse():j}),y},[]),[n,m,u]),f=C.useMemo(()=>{const y=new Set;return Object.keys(n).forEach(v=>{Object.keys(n[v]).forEach(j=>y.add(+j))}),[...y]},[n]);C.useEffect(()=>{f.includes(r)&&p(r)},[r,f]);const g=_e();return e.jsxs("div",{className:`rounded ${g.bgAccent2} border ${g.border}`,children:[e.jsxs("div",{onClick:x,className:`
          flex items-center ${g.border} cursor-pointer px-1
          ${l?"border-b":""}
        `,children:[e.jsx("span",{className:"flex-1",children:Jk(s)}),e.jsx("span",{className:"px-2 py-1 flex-0",children:e.jsx("span",{className:`fa fa-${l?"minus":"plus"}`})})]}),l?e.jsxs("div",{className:"grid grid-cols-1 gap-2 p-2",children:[e.jsx(Z$,{size:m,sizes:f,setSize:p}),h.map(({name:y,colors:v},j)=>e.jsx(Q$,{name:y,colors:v,select:a,isActive:Ae(d,v),reverseColors:u},j))]}):null]})},Q$=({colors:t,name:s,select:n,isActive:r,reverseColors:a})=>{const l=C.useCallback(()=>{n(t,s,a)},[n,t,s,a]);return e.jsx("div",{onClick:l,className:`
        cursor-pointer rounded outline outline-2 overflow-hidden
        ${r?"outline-current":"outline-transparent"}
      `,children:e.jsx(qr,{colors:t,height:3})})},K$=({styleIndex:t,setMapStyle:s,isActive:n,children:r})=>{const a=C.useCallback(l=>{s(t)},[t,s]);return e.jsx("div",{onClick:n?null:a,children:r})},eS=({mapStyles:t,styleIndex:s,MapActions:n})=>{const{MapStylePanel:r}=Dt();return e.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[e.jsx("div",{className:"font-bold text-lg text-center",children:"Map Style Selector"}),t.map((a,l)=>e.jsx(K$,{styleIndex:l,setMapStyle:n.setMapStyle,isActive:l===s,children:e.jsx(r,{mapStyle:a,isActive:l===s})},l))]})},Du={LayersPanel:{icon:"fa-solid fa-layer-group",Panel:V$},StylesPanel:{icon:"fa-solid fa-palette",Panel:eS},LegendPanel:{icon:"fa-sharp fa-solid fa-chart-simple",Panel:G$}},tS=({startOpen:t=!0,Panels:s=[],...n})=>{const[r,a]=C.useState(null),[l,i]=C.useState("fit-content");C.useEffect(()=>{if(!r)return;const{width:v}=r.getBoundingClientRect();i(`${v}px`)},[r]);const[c,d]=C.useState(t),u=C.useCallback(()=>{d(v=>!v)},[]),[m,p]=C.useState(0),x=C.useMemo(()=>s.reduce((v,j)=>(typeof j=="string"&&j in Du?v.push(Du[j]):typeof j.Panel=="function"&&typeof j.icon=="string"&&v.push(j),v),[]),[s]),{LayerSidebarContainer:h,LayerSidebarPanelContainer:f,LayerSidebarTab:g,LayerSidebarToggle:y}=Dt();return e.jsx("div",{className:"h-full w-full relative",children:e.jsx("div",{className:"h-full w-full relative",children:e.jsxs(h,{open:c,children:[e.jsxs("div",{className:"flex relative",children:[e.jsx("div",{className:`flex flex-1 ${c?"overflow-visible":"overflow-hidden"}`,style:{width:c?l:"0px",transition:"width 150ms",animation:c?"open 150ms":null},children:x.map(({icon:v},j)=>e.jsx(g,{icon:v,active:m===j,setTabIndex:p,index:j},j))}),e.jsx(y,{open:c,toggle:u})]}),e.jsx("div",{className:`
              absolute top-8 bottom-0
              ${c?"overflow-visible":"overflow-hidden"}
            `,style:{width:c?l:"0px",transition:"width 150ms",animation:c?"open 150ms":null},children:e.jsx("div",{ref:a,className:"w-fit h-full",children:e.jsx(f,{children:x.map(({Panel:v},j)=>e.jsx("div",{className:m===j?"block h-full":"h-0 overflow-hidden invisible",children:e.jsx(v,{...n},j)},j))})})})]})})})},sS=({Component:t,Header:s,startOpen:n=!0,...r})=>{const[a,l]=C.useState(n),i=C.useCallback(()=>{l(m=>!m)},[]),{InfoBoxContainer:c,InfoBoxHeaderContainer:d,InfoBoxContentContainer:u}=Dt();return e.jsxs(c,{...r,children:[s?e.jsx(d,{open:a,toggleOpen:i,children:typeof s=="function"?e.jsx(s,{...r}):s}):null,e.jsx("div",{className:a?"block":"h-0 overflow-hidden invisible",children:e.jsx(u,{children:e.jsx(t,{...r})})})]})},nS=t=>{const{activeLayers:s,legend:n,...r}=t,a=C.useMemo(()=>s.reduce((d,u)=>(I(u,["infoBoxes","length"],0)&&d.push(u),d),[]),[s]),{InfoBoxSidebarContainer:l,LegendContainer:i}=Dt(),c=C.useCallback(({isActive:d=!0},u)=>typeof d=="function"?d({...t,layer:u}):!!d,[t]);return e.jsxs(l,{children:[n.isActive?e.jsx(i,{...n,children:e.jsx(u$,{...n})}):null,a.length?e.jsx("div",{className:`${n.isActive?"px-1 pb-1":"p-1"} grid grid-cols-1 gap-1`,children:a.reduce((d,u)=>(d.push(...u.infoBoxes.filter(m=>c(m,u)).map((m,p)=>e.jsx(sS,{...r,...m,legend:n,layer:u},`${u.id}-${p}`))),d),[])}):null]})},Ff=(t,s,n)=>{const{x:l,y:i}=t,c=n,d=`max(
      10px,
      min(calc(${i}px - 50%), calc(${c-10}px - 100%))
    )`;return l<s*.5?`translate(
      ${l+30}px,
      ${d}
    )`:`translate(
    calc(-100% + ${l-30}px),
    ${d}
  )`},rS=({x:t,y:s},n,r)=>r==="left"?`translate(calc(${t}px - 175%), max(50%, min(calc(${n}px - 150%), calc(${s}px - 50%)))) rotate(45deg) skew(-15deg, -15deg)`:`translate(calc(${t}px + 75%), max(50%, min(calc(${n}px - 150%), calc(${s}px - 50%)))) rotate(45deg) skew(-15deg, -15deg)`,aS=({orientation:t,onClick:s,children:n})=>{const r=_e();return e.jsx("div",{onClick:s,style:{zIndex:1,transform:t==="left"?"translate(-0.75rem, -0.75rem)":"translate(0.75rem, -0.75rem)"},className:`
        rounded absolute inline-block top-0
        ${r.bg} ${r.textHighlightHover} cursor-pointer
        ${t==="left"?"left-0":"right-0"}
      `,children:e.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:e.jsx("span",{className:"fa fa-close"})})})},oS=({children:t,remove:s,id:n,lngLat:r,project:a,width:l,height:i})=>{const c=a(r),d=C.useMemo(()=>c.x<l*.5?"right":"left",[c,l]),u=C.useMemo(()=>({transform:rS(c,i,d)}),[c,d]),m=C.useCallback(h=>{s(n)},[s,n]),p=_e(),{HoverComponentContainer:x}=Dt();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`
          absolute top-0 left-0 z-20
          pointer-events-auto
        `,style:{transform:Ff(c,l,i)},children:[e.jsx(x,{children:t}),e.jsx(aS,{orientation:d,onClick:m})]}),e.jsx("div",{style:u,className:`
          absolute w-6 h-6 rounded-bl rounded-tr ${p.bg} top-0 left-0 z-10
        `})]})},lS=({children:t,lngLat:s,project:n,width:r,height:a})=>{const{HoverComponentContainer:l}=Dt();return e.jsx("div",{className:`
        absolute top-0 left-0 z-20
        pointer-events-none
      `,style:{transform:Ff(n(s),r,a),transition:"transform 0.05s ease-out"},children:e.jsx(l,{children:t})})},iS=t=>({topLeft:I(t,"startPos",[500,500]),dragPos:[0,0],dragging:!1}),cS=(t,s)=>{const{type:n,...r}=s;switch(n){case"drag-start":return{...t,dragPos:[...r.pos],dragging:!0};case"drag-move":{const{topLeft:[a,l],dragPos:[i,c]}=t,{pos:[d,u]}=r;return{...t,dragPos:[d,u],topLeft:[a+(d-i),l+(u-c)]}}case"drag-stop":return{...t,topLeft:[...r.pos],dragging:!1};default:return t}},dS=({padding:t="1rem",dragHandle:s=null,children:n,...r})=>{const[a,l]=C.useReducer(cS,r,iS),i=C.useCallback(p=>{p.stopPropagation(),p.preventDefault(),l({type:"drag-move",pos:[p.clientX,p.clientY]})},[]);C.useEffect(()=>()=>{window.removeEventListener("mousemove",i)},[i]);const[c,d]=C.useState(null),u=C.useMemo(()=>c?typeof s=="string"&&document.getElementById(s)||c:null,[s,c]),m=C.useCallback(p=>{if(!c)return;const x=h=>{window.removeEventListener("mousemove",i);const f=c.getBoundingClientRect(c);l({type:"drag-stop",pos:[f.x,f.y]})};window.addEventListener("mousemove",i),window.addEventListener("mouseup",x,{once:!0}),l({type:"drag-start",pos:[p.clientX,p.clientY]})},[i,c]);return C.useEffect(()=>{if(u)return u.addEventListener("mousedown",m),()=>{u.removeEventListener("mousedown",m)}},[m,u]),C.useEffect(()=>{u&&(a.dragging?(u.classList.remove("cursor-grab"),u.classList.add("cursor-grabbing")):(u.classList.add("cursor-grab"),u.classList.remove("cursor-grabbing")))},[u,a.dragging]),e.jsx("div",{className:`
        fixed inset-0 z-50
        ${a.dragging?"pointer-events-auto":"pointer-events-none"}
      `,children:e.jsx("div",{ref:d,className:`
          fixed inline-block left-0 top-0 z-10 pointer-events-auto
        `,style:{transform:`
            translate(
              MIN(CALC(${window.innerWidth}px - 100% - ${t}), MAX(${t}, ${a.topLeft[0]}px)),
              MIN(CALC(${window.innerHeight}px - 100% - ${t}), MAX(${t}, ${a.topLeft[1]}px))
            )
          `},children:n})})},uS=t=>{const{Header:s=null,startPos:n,MapActions:r,layerId:a,modalId:l,children:i,...c}=t,d=C.useMemo(()=>`modal-drag-handle-${a}-${l}`,[a,l]),u=C.useCallback(()=>{r.closeModal(a,l)},[a,l,r.closeModal]),m=C.useCallback(()=>{r.bringModalToFront(a,l)},[a,l,r.bringModalToFront]),{ModalContainer:p,ModalHeaderContainer:x,ModalContentContainer:h}=Dt();return e.jsx(dS,{startPos:n,dragHandle:d,children:e.jsxs(p,{children:[e.jsx(x,{closeModal:u,bringModalToFront:m,dragHandle:d,children:typeof s=="function"?e.jsx(s,{...c,closeModal:u,bringModalToFront:m,MapActions:r,dragHandle:d}):s}),e.jsx(h,{children:i})]})})},Bu="/assets/default-map-D9CzXC8n.png";let mS=0;const zf=()=>`avl-thing-${++mS}`,pS=[],Kn={},Pf="pin_outline",xS=[{name:"Dark",style:"https://api.maptiler.com/maps/dataviz-dark/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Light",style:"https://api.maptiler.com/maps/dataviz-light/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Streets",style:"https://api.maptiler.com/maps/streets-v2/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Satellite Streets",style:"https://api.maptiler.com/maps/hybrid/style.json?key=mU28JQ6HchrQdneiq6k9"}],hS={center:[-74.180647,42.58],minZoom:2,zoom:10,preserveDrawingBuffer:!0,styles:xS,attributionControl:!1,navigationControl:!1,protocols:[]},fS={Component:tS,startOpen:!0,Panels:["LayersPanel","StylesPanel","LegendPanel"]},gS={Component:nS},hc=({children:t,onClick:s})=>{const n=_e();return e.jsx("div",{onClick:s,className:`
        rounded ${n.bg} h-10 w-10
        flex items-center justify-center
        cursor-pointer pointer-events-auto text-2xl
        ${n.textHighlightHover}
      `,children:t})},Rf=({action:t,icon:s,MapActions:n})=>{const r=C.useCallback(()=>{typeof t=="function"&&t(n)},[t,n]);return e.jsx(hc,{onClick:r,children:e.jsx("span",{className:s})})},bS=({MapActions:t,maplibreMap:s})=>{const[n,r]=C.useState(0);C.useEffect(()=>{s&&r(s.getBearing())},[s]),C.useEffect(()=>{if(!s)return;const i=c=>{r(s.getBearing())};return s.on("rotate",i),()=>{s.off("rotate",i)}},[s]);const a=C.useCallback(i=>{t.resetView()},[t.resetView]),l=_e();return e.jsx(hc,{onClick:a,children:e.jsx("span",{className:`
          fa-solid fa-arrow-up w-10 py-1 flex justify-center
          ${l.textHighlightHover}
        `,style:{transform:`rotate(${n}deg)`}})})},yS=({showLayerSelect:t,mapStyles:s,styleIndex:n,MapActions:r,maplibreMap:a,...l})=>{const[i,c]=C.useState(0),[d,u]=C.useState(!1);C.useEffect(()=>{a&&c(a.getBearing())},[a]),C.useEffect(()=>{if(!a)return;const f=g=>{c(a.getBearing())};return a.on("rotate",f),()=>{a.off("rotate",f)}},[a]);const m=C.useCallback(f=>{if(!a)return;const g=a.getZoom();a.zoomTo(g*1.1)},[a]),p=C.useCallback(f=>{r.resetView()},[r.resetView]),x=C.useCallback(f=>{if(!a)return;const g=a.getZoom();a.zoomTo(g/1.1)},[a]),h=_e();return e.jsxs("div",{className:`
        flex flex-row cursor-pointer pointer-events-auto
      `,children:[t&&s&&s.length>1&&e.jsxs("div",{className:"hover:bg-slate-100/50 h-10 w-10 flex items-center justify-center rounded relative",children:[e.jsx("div",{className:"border border-slate-400 rounded shadow",onClick:()=>u(!d),children:e.jsx("img",{className:"w-8 h-8 rounded border",src:Bu})}),e.jsx("div",{className:`w-36 bg-slate-100 absolute bottom-10 right-0 rounded ${d?"":"hidden"}`,children:s.map((f,g)=>e.jsxs("div",{className:"flex items-center p-1 hover:bg-blue-100",onClick:()=>{u(!1),r.setMapStyle(g)},children:[e.jsxs("div",{className:"h-8 w-8 ",children:[" ",e.jsx("img",{className:"w-8 h-8 rounded ",src:Bu})," "]}),e.jsxs("div",{className:"text-sm px-2",children:[" ",f.name]})]},g))})]}),e.jsx("div",{onClick:x,className:"hover:bg-slate-100/50 h-10 w-10 flex items-center justify-center rounded",children:e.jsx("span",{className:`
            fa fa-minus fa-fw  py-1 w-8  flex items-center justify-center
            text-slate-600
            ${h.textHighlightHover}
          `})}),e.jsx("div",{onClick:m,className:"hover:bg-slate-100/50 h-10 w-10 flex items-center justify-center rounded",children:e.jsx("span",{className:`
            fa fa-plus fa-fw py-1 w-8  flex items-center  justify-center
            text-slate-600
            ${h.textHighlightHover}
          `})}),e.jsx("div",{className:"hover:bg-slate-100/50 h-10 w-10 flex items-center justify-center rounded",children:e.jsx("div",{onClick:p,className:`
            w-8 py-1
            flex justify-center
            items-center 
            text-slate-600
            ${h.textHighlightHover}
          `,children:e.jsx("span",{className:"fa fa-location-arrow fa-fw",style:{transform:`rotate(${i-45}deg)`}})})})]})},vS=({action:t,icon:s,layer:n,MapActions:r})=>{const a=C.useCallback(()=>{typeof t=="function"&&t(n,r)},[t,n,r]);return e.jsx(hc,{onClick:a,children:e.jsx("span",{className:s})})},Fu={"reset-view":{Component:bS},"go-home":{Component:Rf,icon:"fa-solid fa-house",action:({goHome:t})=>{t()}},"navigation-controls":{Component:yS}},Hf={maplibreMap:null,moving:!1,mapStyles:[],styleIndex:0,layerVisibility:{},layerState:{},dynamicLayers:[],activeLayers:{},resourcesLoaded:{},hoverData:{data:[],lngLat:{lng:0,lat:0},hovering:!1},pinnedHoverComps:[],pinnedHoverCompIds:[],filterUpdate:{layerId:null},layersLoading:{},legend:{type:"quantize",domain:[0,1],range:["red","yellow","green"],format:",.2f",name:"Unnamed Legend",isActive:!1},openedModals:[],Protocols:{},initializedLayers:[]},wS=(t,s)=>{var a,l,i,c,d;const{type:n,...r}=s;switch(n){case"toggle-layer-visibility":return{...t,layerVisibility:{...t.layerVisibility,[r.layerId]:!t.layerVisibility[r.layerId]}};case"update-layer-state":{const{layerId:m,layerState:p}=r,x=I(t,["layerState",m],{});return typeof p=="function"?{...t,layerState:{...t.layerState,[m]:{...x,...p(x)}}}:{...t,layerState:{...t.layerState,[m]:{...x,...p}}}}case"create-dynamic-layer":{const{layer:m}=r;return t.dynamicLayers.reduce((x,h)=>x||h.id===m.id,!1)?t:(m.isDynamic=!0,{...t,dynamicLayers:[...t.dynamicLayers,m]})}case"destroy-dynamic-layer":return{...t,dynamicLayers:t.dynamicLayers.filter(m=>m.id!==r.layerId)};case"open-modal":{const{layerId:m,modalId:p}=r,x=t.openedModals.filter(h=>!(h.layerId===m&&h.modalId===p));return{...t,openedModals:[...x,{layerId:m,modalId:p}]}}case"close-modal":{const{layerId:m,modalId:p}=r,x=t.openedModals.filter(h=>!(h.layerId===m&&h.modalId===p));return{...t,openedModals:x}}case"bring-modal-to-front":{const{layerId:m,modalId:p}=r,x=[...t.openedModals].sort((h,f)=>h.layerId===m&&h.modalId===p?1:f.layerId===m&&f.modalId===p?-1:0);return{...t,openedModals:x}}case"update-filter":return{...t,filterUpdate:{...r}};case"hover-layer-move":{const{data:m,layer:p,layerId:x,Component:h,isPinnable:f,zIndex:g,...y}=r;return{...t,hoverData:{data:[...t.hoverData.data.filter(v=>v.layerId!==x),{data:m,Component:h,layer:p,layerId:x,isPinnable:f,zIndex:g}],...y,hovering:!0}}}case"hover-layer-leave":{const{layerId:m}=r,p=t.hoverData.data.filter(x=>x.layerId!==m);return{...t,hoverData:{...t.hoverData,data:p,hovering:!!p.length}}}case"pin-hover-comp":{if(!t.hoverData.hovering)return t;const{lngLat:m,marker:p}=r,x=[...t.hoverData.data].filter(({layerId:h})=>!h.includes(Pf)).filter(({isPinnable:h})=>h).sort((h,f)=>f.zIndex-h.zIndex);if(x.length){p.addTo(t.maplibreMap);const h={id:zf(),lngLat:m,marker:p,HoverComps:x},f=[...t.pinnedHoverComps,h],g=(d=(c=(i=(l=(a=f[0])==null?void 0:a.HoverComps[0])==null?void 0:l.layer)==null?void 0:i.filters)==null?void 0:c.geometry)==null?void 0:d.value,y=f.map(v=>{const j=v.HoverComps.length>1?v.HoverComps.find(N=>N.data[1].includes(g)):v.HoverComps[0];return j==null?void 0:j.data[2]}).filter(v=>v!==void 0);return{...t,pinnedHoverCompIds:y,pinnedHoverComps:f}}return t}case"remove-pinned":const u=[];return t.pinnedHoverComps.forEach(m=>{if(m.id!==r.id)return;const p=m.HoverComps[0].data[0];u.push(p)}),{...t,pinnedHoverComps:t.pinnedHoverComps.filter(m=>m.id!==r.id?!0:(m.marker.remove(),!1)),pinnedHoverCompIds:t.pinnedHoverCompIds.filter(m=>!u.includes(m.ogc_fid))};case"layer-loading-start":{const{layerId:m}=r;let p=I(t,["layersLoading",m,"start"],0),x=I(t,["layersLoading",m,"loading"],0);return{...t,layersLoading:{...t.layersLoading,[m]:{start:p||performance.now(),loading:++x}}}}case"layer-loading-stop":{const{layerId:m}=r;let p=I(t,["layersLoading",m,"start"],0),x=I(t,["layersLoading",m,"loading"],0);return{...t,layersLoading:{...t.layersLoading,[m]:{start:x>1?p:0,loading:Math.max(--x,0)}}}}case"activate-layer":return{...t,activeLayers:{...t.activeLayers,[r.layerId]:!0}};case"deactivate-layer":return{...t,activeLayers:{...t.activeLayers,[r.layerId]:!1}};case"update-legend":return{...t,legend:{...t.legend,...r.update}};case"set-resources-loaded":{const{layerId:m,loaded:p}=r;return{...t,resourcesLoaded:{...t.resourcesLoaded,[m]:p}}}case"initialize-layers":{const{layerVisibility:m,layerState:p,activeLayers:x,resourcesLoaded:h,initializedLayers:f}=r;return{...t,initializedLayers:[...t.initializedLayers,...f],layerVisibility:{...t.layerVisibility,...m},layerState:{...t.layerState,...p},activeLayers:{...t.activeLayers,...x},resourcesLoaded:{...t.resourcesLoaded,...h}}}case"update-state":return{...t,...r};case"map-loaded":{const{legend:m,...p}=r;return{...t,...p,initializedLayers:[],legend:{...t.legend,...m}}}case"map-removed":return{...Hf};default:return t}},Hn=t=>{const{accessToken:s,mapOptions:n=Kn,id:r,layers:a=pS,layerProps:l=Kn,leftSidebar:i=Kn,rightSidebar:c=Kn,legend:d=Kn,styleIndex:u=0,showLayerSelect:m=!1,mapActions:p=["navigation-controls"],...x}=t,h=C.useRef({containerId:r||zf(),...hS,...n,accessToken:s,legend:d}),[f,g]=C.useReducer(wS,Hf);C.useEffect(()=>{const{styles:te,navigationControl:re,legend:ee,protocols:xe=[],containerId:ke,...he}=h.current,we=xe.reduce((Me,Ve)=>{const{type:Xe,protocolInit:yt,..._t}=Ve;return Me[Xe]={..._t,Protocol:yt(gn)},Me},{}),be=new gn.Map({container:ke,...he,style:te[0].style});return re&&be.addControl(new gn.NavigationControl,re),be.on("move",Me=>{g({type:"update-state",moving:!0})}),be.on("moveend",Me=>{g({type:"update-state",moving:!1})}),be.once("load",Me=>{g({type:"map-loaded",maplibreMap:be,mapStyles:te,styleIndex:u,legend:ee,Protocols:we})}),()=>{g({type:"map-removed"}),be.remove()}},[]),C.useEffect(()=>{if(!f.maplibreMap)return;const re=[...a,...f.dynamicLayers].filter(ee=>!f.initializedLayers.includes(ee));if(re.length){const ee={},xe={},ke={},he={};re.forEach(we=>{ee[we.id]=I(we,"startVisible",!0),xe[we.id]=I(we,"startState",{}),ke[we.id]=I(we,"startActive",!0),he[we.id]=!1;function be(Me){g({type:"update-layer-state",layerId:we.id,layerState:Me})}we.updateState=be.bind(we)}),g({type:"initialize-layers",layerVisibility:ee,layerState:xe,activeLayers:ke,resourcesLoaded:he,initializedLayers:re})}},[f.maplibreMap,a,f.dynamicLayers,f.initializedLayers]),C.useEffect(()=>{a.forEach(te=>{te.props=I(l,te.id,{})})},[a,l,f.pinnedHoverCompIds]),C.useEffect(()=>{a.forEach(te=>{te.state=I(f,["layerState",te.id],{}),te.state={...te.state,pinnedHoverCompIds:f.pinnedHoverCompIds}})},[a,f.layerState,f.pinnedHoverCompIds]);const y=C.useCallback(te=>{g({type:"create-dynamic-layer",layer:te})},[]),v=C.useCallback(te=>{g({type:"destroy-dynamic-layer",layerId:te})},[]),j=C.useCallback((te,re)=>{g({type:"set-resources-loaded",layerId:te,loaded:re})},[]),N=C.useCallback(te=>{g({type:"toggle-layer-visibility",layerId:te})},[]),S=C.useCallback((te,re)=>{g({type:"update-layer-state",layerId:te,layerState:re})},[]),w=C.useCallback(te=>{if(!f.maplibreMap||te===f.styleIndex)return;const re=f.mapStyles[te];re&&(f.maplibreMap.once("styledata",ee=>{g({type:"update-state",styleIndex:te})}),f.maplibreMap.setStyle(re.style))},[f.maplibreMap,f.mapStyles,f.styleIndex]),k=C.useCallback(te=>{g({type:"update-legend",update:te})},[]),$=C.useCallback(te=>{g(te)},[]),E=C.useCallback(({lngLat:te})=>{const re=new gn.Marker().setLngLat(te);g({type:"pin-hover-comp",lngLat:te,marker:re})},[]),M=C.useCallback(te=>{g({type:"remove-pinned",id:te})},[]),_=C.useCallback(te=>{g({type:"layer-loading-start",layerId:te})},[]),L=C.useCallback(te=>{g({type:"layer-loading-stop",layerId:te})},[]),D=C.useCallback((te,re,ee)=>{if(!I(te,["filters",re],null))return;const xe=te.filters[re].value;g({type:"update-filter",layerId:te.id,filterId:re,prevValue:xe,value:ee})},[]),A=C.useCallback(te=>{g({type:"activate-layer",layerId:te})},[]),T=C.useCallback(te=>{g({type:"deactivate-layer",layerId:te})},[]),O=C.useCallback((te,re)=>{g({type:"open-modal",layerId:te,modalId:re})},[]),B=C.useCallback((te,re)=>{g({type:"close-modal",layerId:te,modalId:re})},[]),F=C.useCallback((te,re)=>{g({type:"bring-modal-to-front",layerId:te,modalId:re})},[]),z=C.useCallback(()=>{if(!f.maplibreMap)return;const{center:te,zoom:re}=h.current;f.maplibreMap.easeTo({pitch:0,bearing:0,center:te,zoom:re})},[f.maplibreMap]),P=C.useCallback((te={})=>{f.maplibreMap&&f.maplibreMap.easeTo({pitch:0,bearing:0,...te})},[f.maplibreMap]),[U,R]=C.useMemo(()=>[...a,...f.dynamicLayers].reduce((te,re)=>(f.activeLayers[re.id]&&f.initializedLayers.includes(re)?te[0].push(re):te[1].push(re),te),[[],[]]),[a,f.dynamicLayers,f.activeLayers,f.initializedLayers]);C.useEffect(()=>{f.maplibreMap&&(f.hoverData.hovering?f.maplibreMap.getCanvas().style.cursor="pointer":f.maplibreMap.getCanvas().style.cursor="")},[f.maplibreMap,f.hoverData.hovering]);const W=C.useMemo(()=>U.filter(te=>I(f,["layersLoading",te.id,"loading"],0)).sort((te,re)=>{const ee=I(f,["layersLoading",te.id,"start"],0),xe=I(f,["layersLoading",re.id,"start"],0);return ee-xe}),[f.layersLoading,U]),[V,X]=C.useMemo(()=>{if(!i)return[null,{}];const{Component:te,...re}={...fS,...i};return[te,re]},[i]),[q,Q]=C.useMemo(()=>{if(!c)return[null,{}];const{Component:te,...re}={...gS,...c};return[te,re]},[c]),Y=C.useMemo(()=>U.reduce((te,re)=>te||I(re,["onHover","isPinnable"],!1),!1),[U]);C.useEffect(()=>{if(Y)return f.maplibreMap.on("click",E),()=>{f.maplibreMap.off("click",E)}},[f.maplibreMap,E,Y]);const{HoverComps:H,...J}=C.useMemo(()=>{if(!f.maplibreMap)return{hovering:!1};const{data:te,...re}=f.hoverData;return{HoverComps:[...te].sort((xe,ke)=>ke.zIndex-xe.zIndex),...re}},[f.hoverData]),G=C.useMemo(()=>U.reduce((te,re)=>(f.openedModals.forEach(({layerId:ee,modalId:xe})=>{ee===re.id&&I(re,["modals",xe],null)&&te.push({layer:re,key:`${ee}-${xe}`,layerId:ee,modalId:xe,...I(re,["modals",xe],{})})}),te),[]),[U,f.openedModals]),se=C.useMemo(()=>{const te=(p||[]).reduce((re,ee)=>(ee in Fu?re.push(Fu[ee]):typeof ee=="object"&&re.push({Component:Rf,icon:"fa-solid fa-gear",...ee}),re),[]);return U.reduce((re,ee)=>(I(ee,"layerActions",[]).forEach(({Component:xe=vS,wrapper:ke=null,...he})=>{re.push({layer:ee,Component:ke?ke(xe):xe,...he})}),re),te)},[p,U]),le=C.useCallback(te=>f.maplibreMap?f.maplibreMap.project(te):{x:0,y:0},[f.maplibreMap]),[ce,je]=C.useState(null),Ce=Gk(ce),oe=C.useMemo(()=>({toggleLayerVisibility:N,updateLayerState:S,activateLayer:A,deactivateLayer:T,updateFilter:D,startLayerLoading:_,stopLayerLoading:L,setMapStyle:w,setResourcesLoaded:j,updateLegend:k,openModal:O,closeModal:B,bringModalToFront:F,createDynamicLayer:y,destroyDynamicLayer:v,resetView:P,goHome:z}),[N,S,A,T,D,_,L,w,j,k,O,B,F,y,v,P,z]),ve=_e(),{LoadingIndicator:ae}=Dt(),{current:{containerId:de}}=h;return e.jsxs("div",{className:`block relative w-full h-full max-w-full max-h-full overflow-visible ${ve.text}`,children:[e.jsx("div",{ref:je,id:de,className:"w-full h-full relative"}),e.jsx("div",{id:`${de}-box-select-blocker`,className:"absolute inset-0 z-50 pointer-events-none"}),G.map(({Component:te,key:re,startPos:ee,...xe})=>e.jsx(uS,{...xe,startPos:ee,legend:f.legend,maplibreMap:f.maplibreMap,MapActions:oe,activeLayers:U,inactiveLayers:R,mapStyles:f.mapStyles,styleIndex:f.styleIndex,layerVisibility:f.layerVisibility,layerProps:l,layerState:f.layerState,filterUpdate:f.filterUpdate,layersLoading:f.layersLoading,loadingLayers:W,resourcesLoaded:f.resourcesLoaded,openedModals:f.openedModals,children:e.jsx(te,{...xe,legend:f.legend,maplibreMap:f.maplibreMap,MapActions:oe,activeLayers:U,inactiveLayers:R,mapStyles:f.mapStyles,styleIndex:f.styleIndex,layerVisibility:f.layerVisibility,layerProps:l,layerState:f.layerState,filterUpdate:f.filterUpdate,layersLoading:f.layersLoading,loadingLayers:W,resourcesLoaded:f.resourcesLoaded,openedModals:f.openedModals})},re)),e.jsxs("div",{className:"flex absolute inset-0 pointer-events-none p-2",children:[i?e.jsx("div",{className:"h-full relative pr-4",children:e.jsx(V,{...X,legend:f.legend,maplibreMap:f.maplibreMap,MapActions:oe,activeLayers:U,inactiveLayers:R,mapStyles:f.mapStyles,styleIndex:f.styleIndex,layerVisibility:f.layerVisibility,layerProps:l,layerState:f.layerState,filterUpdate:f.filterUpdate,hideLoading:x.hideLoading,layersLoading:f.layersLoading,loadingLayers:W,resourcesLoaded:f.resourcesLoaded,openedModals:f.openedModals})}):null,e.jsxs("div",{className:"flex-1 relative",children:[[...U].reverse().map((te,re)=>e.jsx(f$,{layer:te,legend:f.legend,isActive:I(f,["activeLayers",te.id],!0),isVisible:I(f,["layerVisibility",te.id],!0),isLoading:!!I(f,["layersLoading",te.id,"loading"],!1),resourcesLoaded:!!I(f,["resourcesLoaded",te.id],!1),maplibreMap:f.maplibreMap,updateHover:$,containerId:de.current,MapActions:oe,activeLayers:U,inactiveLayers:R,layerProps:I(l,te.id,{}),layerState:I(f,["layerState",te.id],{}),allLayerProps:l,allLayerState:f.layerState,styleIndex:f.styleIndex,mapStyles:f.mapStyles,layersLoading:f.layersLoading,loadingLayers:W,filterUpdate:f.filterUpdate,openedModals:f.openedModals,Protocols:f.Protocols},te.id)),e.jsx("div",{className:"absolute bottom-0 left-0 grid grid-cols-1 gap-4",children:!x.hideLoading&&W.map(te=>e.jsx(ae,{layer:te},te.id))})]}),se.length?e.jsx("div",{className:"relative pl-4",children:e.jsx("div",{className:"flex flex-col h-full justify-end flex-end",children:se.map(({Component:te,...re},ee)=>e.jsx(te,{...re,legend:f.legend,maplibreMap:f.maplibreMap,MapActions:oe,activeLayers:U,inactiveLayers:R,mapStyles:f.mapStyles,styleIndex:f.styleIndex,showLayerSelect:m,layerVisibility:f.layerVisibility,layerProps:l,layerState:f.layerState,filterUpdate:f.filterUpdate,hideLoading:x.hideLoading,layersLoading:f.layersLoading,loadingLayers:W,resourcesLoaded:f.resourcesLoaded,openedModals:f.openedModals},ee))})}):null,!c||!U.length?null:e.jsx("div",{className:"h-full relative pl-4",children:e.jsx(q,{...Q,legend:f.legend,maplibreMap:f.maplibreMap,MapActions:oe,activeLayers:U,inactiveLayers:R,mapStyles:f.mapStyles,styleIndex:f.styleIndex,layerVisibility:f.layerVisibility,layerProps:l,layerState:f.layerState,filterUpdate:f.filterUpdate,layersLoading:f.layersLoading,loadingLayers:W,resourcesLoaded:f.resourcesLoaded,openedModals:f.openedModals})})]}),f.pinnedHoverComps.map(({HoverComps:te,data:re,id:ee,...xe})=>b.createElement(oS,{...xe,...Ce,remove:M,project:le,id:ee,key:ee},te.map(({Component:ke,data:he,layer:we,layerId:be})=>e.jsx(ke,{isPinned:!0,legend:f.legend,layer:we,data:he,maplibreMap:f.maplibreMap,MapActions:oe,activeLayers:U,inactiveLayers:R,mapStyles:f.mapStyles,styleIndex:f.styleIndex,layerVisibility:f.layerVisibility,layerProps:l,layerState:f.layerState,filterUpdate:f.filterUpdate,layersLoading:f.layersLoading,loadingLayers:W,resourcesLoaded:f.resourcesLoaded,openedModals:f.openedModals},be)))),J.hovering?e.jsx(lS,{...J,...Ce,project:le,children:H.filter(({layerId:te})=>!te.includes(Pf)).map(({Component:te,layerId:re,...ee})=>e.jsx(te,{...ee,legend:f.legend,maplibreMap:f.maplibreMap,MapActions:oe,activeLayers:U,inactiveLayers:R,mapStyles:f.mapStyles,styleIndex:f.styleIndex,layerVisibility:f.layerVisibility,layerProps:l,layerState:f.layerState,filterUpdate:f.filterUpdate,layersLoading:f.layersLoading,loadingLayers:W,resourcesLoaded:f.resourcesLoaded,openedModals:f.openedModals},re))}):null]})};function jS(t){return t.slice().sort(function(s,n){return s-n})}function CS(t){for(var s=0,n,r=0;r<t.length;r++)(r===0||t[r]!==n)&&(n=t[r],s++);return s}function zu(t,s){for(var n=[],r=0;r<t;r++){for(var a=[],l=0;l<s;l++)a.push(0);n.push(a)}return n}function ii(t,s,n,r){var a;if(t>0){var l=(n[s]-n[t-1])/(s-t+1);a=r[s]-r[t-1]-(s-t+1)*l*l}else a=r[s]-n[s]*n[s]/(s+1);return a<0?0:a}function ci(t,s,n,r,a,l,i){if(!(t>s)){var c=Math.floor((t+s)/2);r[n][c]=r[n-1][c-1],a[n][c]=c;var d=n;t>n&&(d=Math.max(d,a[n][t-1]||0)),d=Math.max(d,a[n-1][c]||0);var u=c-1;s<r[0].length-1&&(u=Math.min(u,a[n][s+1]||0));for(var m,p,x,h,f=u;f>=d&&(m=ii(f,c,l,i),!(m+r[n-1][d-1]>=r[n][c]));--f)p=ii(d,c,l,i),x=p+r[n-1][d-1],x<r[n][c]&&(r[n][c]=x,a[n][c]=d),d++,h=m+r[n-1][f-1],h<r[n][c]&&(r[n][c]=h,a[n][c]=f);ci(t,c-1,n,r,a,l,i),ci(c+1,s,n,r,a,l,i)}}function NS(t,s,n){var m;for(var r=((m=s[0])==null?void 0:m.length)||0,a=new Array(r),l=new Array(r),i=t[Math.floor(r/2)],c=0;c<r;++c)c===0?(a[0]=t[0]-i,l[0]=(t[0]-i)*(t[0]-i)):(a[c]=a[c-1]+t[c]-i,l[c]=l[c-1]+(t[c]-i)*(t[c]-i)),s[0][c]=ii(0,c,a,l),n[0][c]=0;for(var d,u=1;u<s.length;++u)u<s.length-1?d=u:d=r-1,ci(d,r-1,u,s,n,a,l)}function Xa(t,s){var p;if(s>t.length)return console.log("Ckmeans cannot generate more classes than there are data values"),[];var n=t.length,r=jS(t),a=CS(r);if(a===1)return[r[0]];s=Math.min(a,s);var l=zu(s,n),i=zu(s,n);NS(r,l,i);for(var c=[],d=(((p=i[0])==null?void 0:p.length)||0)-1,u=i.length-1;u>=0;u--){var m=i[u][d];c[u]=r[m],u>0&&(d=m-1)}return c}function kS(t,s){if(t.length<2)return t;const n=Math.min(...t),r=Math.max(...t),a=[n],l=(r-n)/s;for(let i=1;i<s;i++)a.push(a[0]+l*i);return a.push(r),a}function $S(t,s){const n=Math.min(...t),r=Math.max(...t);let a=[];if(s<1)return a.push(r),a;let l=parseInt(s/3),i=.75,c=1.5,d=.5+1.5*c,u=parseInt(s),m=c,p,x=!1,h=r-n;if(Pu(h,0)&&Pu(r,0))p=1,x=!0;else{let w=1;p=Math.abs(r)>=Math.abs(n)?Math.abs(r):Math.abs(n),w=parseInt(1+1/(1+m));let k=1>=u?1:u;x=h<p*w*k*1e-7*3}x?(p>10&&(p=9+p/10,p=p*i),l>1&&(p=p/l)):(p=h,u>1&&(p=p/u)),p<20*1e-7&&(p=20*1e-7);let f=Math.pow(10,Math.floor(Math.log10(p))),g=f;2*f-p<m*(p-g)&&(g=2*f,5*f-p<d*(p-g)&&(g=5*f,10*f-p<m*(p-g)&&(g=10*f)));let y=parseInt(Math.floor(n/g+1e-7)),v=parseInt(Math.ceil(r/g-1e-7));for(;y*g>n+1e-7*g;)y=y-1;for(;v*g<r-1e-7*g;)v=v+1;let j=parseInt(Math.floor(.5+v-y));j<l&&(j=l-j,y>=0?(v=v+j/2,y=y-j/2+j%2):(y=y-j/2,v=v+j/2+j%2));let N=y*g,S=parseInt(v-y);a=[];for(let w=1;w<S+1;w++)a.push(N+w*g);if(a.length===0)return a;if(a[0]<n&&a.splice(0,1,n),a[a.length-1]>r&&a.splice(a.length-1,1,r),n<0&&r>0){let w=[];for(let $=0;$<=a.length;$++)w.push(a[$]-0);let k=0;for(let $=1;$<=a.length;$++)Math.abs(w[$])<Math.abs(w[$-1])&&(k=$);a[k]=0}return a}function Pu(t,s){return t>1||s>1?!1:t>=0&&t<1&&s<1}const Na={};for(const t in ls.schemeGroups)ls.schemeGroups[t].forEach(s=>{const n=ls[s];for(const r in n)r in Na||(Na[r]=[]),Na[r].push({type:`${t[0].toUpperCase()}${t.slice(1)}`,name:s,category:"Colorbrewer",colors:n[r]})});const ka=(t,s)=>I(Na,[t],[]).reduce((n,r)=>r.name===s?r.colors:n,[]).slice(),Ru="pin_outline",SS="static",_S=({data:t,layer:s})=>{const{attributes:n,activeViewId:r,filters:a}=s,{pgEnv:l,falcor:i,falcorCache:c}=C.useContext(ie),d=C.useMemo(()=>I(t,"[0]",null),[t]);let u=(typeof(n==null?void 0:n[0])=="string"?n:n.map(p=>p.name)).filter(p=>!["wkb_geometry"].includes(p));C.useEffect(()=>{i.get(["dama",l,"viewsbyId",r,"databyId",d,u])},[i,l,r,d,n]);const m=C.useMemo(()=>I(c,["dama",l,"viewsbyId",r,"databyId",d],{}),[d,c,r,l]);return e.jsxs("div",{className:"bg-white p-4 max-h-64 max-w-lg scrollbar-xs overflow-y-scroll",children:[e.jsx("div",{className:"font-medium pb-1 w-full border-b ",children:s.source.display_name}),Object.keys(m).length===0?`Fetching Attributes ${d}`:"",Object.keys(m).filter(p=>typeof m[p]!="object").map((p,x)=>e.jsxs("div",{className:"flex border-b pt-1",children:[e.jsx("div",{className:"flex-1 font-medium text-sm pl-1",children:p}),e.jsx("div",{className:"flex-1 text-right font-thin pl-4 pr-1",children:m==null?void 0:m[p]})]},x))]})},IS=({domain:t,range:s,title:n})=>{const a=(i=>{const c=[];if(!(i&&i.length))return s;c.push(`0 - ${new Intl.NumberFormat().format(i[0])}`);for(let d=0;d<i.length-1;d++)c.push(`${new Intl.NumberFormat().format(i[d])} - ${new Intl.NumberFormat().format(i[d+1])}`);return c})(t),l=C.useMemo(()=>Math.min(t.length,s.length),[t.length,s.length]);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"shadow-lg box-content min-h-32 min-w-48 w-fit p-1 border-2 bg-slate-50 bg-opacity-55",children:[e.jsx("div",{className:"flex mb-1",children:e.jsx("div",{className:"flex-1 font-medium",children:n})}),Array.from({length:l}).map((i,c)=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex m-2",children:[e.jsx("div",{className:"flex-none w-16",children:e.jsx("div",{className:"h-8 w-[2px] rounded dark:ring-1 dark:ring-inset dark:ring-white/10 sm:w-full",style:{backgroundColor:s[c],transition:"background-color 0.5s"}})}),e.jsx("div",{className:"flex-initial ml-6 w-32",children:e.jsx("div",{className:"h-6 w-2 ml-1 p-[2px] sm:w-full text-left",children:a[c]})})]})}))]})})},LS=({name:t,title:s,toggle:n,isOpen:r,children:a})=>{const l=_e();return e.jsx("div",{className:`p-1 rounded ${l.bg}`,children:e.jsxs("div",{className:`
          p-1 relative rounded border pointer-events-auto
          
        `,children:[e.jsx("div",{className:"flex mb-1",children:e.jsx("div",{className:"flex-1 font-medium",children:t||s})}),e.jsx("div",{children:a})]})})},ES=t=>t===null||isNaN(t),MS=(t,s)=>String(t).localeCompare(String(s)),AS=(t,s,n)=>{const r=s.map(a=>ES(a.value)?a.value:+a.value);switch(t){case"quantize":return yi(r);case"threshold":return Xa(r.filter(Boolean),n?n-1:6);case"ordinal":return[...new Set(r)].sort(MS);default:return r}},TS=(t,s,n,r)=>{switch(t){case"threshold":return ka(s?s+1:7,n);case"ordinal":return ka(Math.min(12,s),n);default:return ka(7,n)}},OS=t=>{const{layerProps:s,resourcesLoaded:n,maplibreMap:r,activeLayers:a}=t,{filters:l,activeViewId:i,symbology:c,updateLegend:d,sourceId:u,layers:m}=s,p=a[0].state.pinnedHoverCompIds,x=I(l,["activeVar","value"],""),[h,f]=C.useState(null),[g,y]=C.useState(null),{pgEnv:v,falcor:j,falcorCache:N,...S}=C.useContext(ie),w=C.useCallback((T={})=>{const{domain:O=[],range:B=[],format:F=".2s",name:z,title:P,type:U="threshold",data:R=[],color:W="BrBG",reverse:V=!1,height:X=3,direction:q="vertical",customLegendScale:Q}=T,Y={domain:O,range:B,format:F,name:z,title:P,type:U,data:R,color:W,reverse:V,height:X,direction:q,customLegendScale:Q};O.length||(Y.domain=AS(U,R,B.length)),B.length||(Y.range=TS(U,Y.domain.length,W)),f(Y)},[]),k=C.useRef(null);C.useEffect(()=>{if(!h)return;const{data:T,domain:O,...B}=h;if(h&&!k.current){k.current=B;return}if(!Ae(B,k.current)){k.current=B;const F=JSON.parse(JSON.stringify(c));m.forEach(({id:z,type:P})=>{K(F,`${z}.${P}-color.${x}.settings`,{...B})}),j.call(["dama","sources","metadata","update"],[v,u,{symbology:F}]).then(z=>console.log("SAVE RESPONSE:",z))}},[j,v,u,h,c,x,m]),C.useEffect(()=>{const T=p==null?void 0:p.map(B=>B.ogc_fid),O=m.find(B=>B.id.includes(Ru));if(O){const B=O.id;T.length===0&&T.push(-666666666);const F=["match",["get","ogc_fid"],T,!0,!1];r.getLayer(B)&&(r.setFilter(B,F),T!=null&&T.length?r.setPaintProperty(B,"line-opacity",1):r.setPaintProperty(B,"line-opacity",0))}},[r,c,p]),C.useEffect(()=>{async function T(){if(!r)return;const O=I(c,"sources",[]),B=I(c,"layers",[]),F=I(c,"images",[]);Array.isArray(F)&&await Promise.all(F.filter(z=>!r.hasImage(z.id)&&z.url).map(z=>new Promise((P,U)=>{r.loadImage(z.url,function(R,W){if(R)throw R;r.hasImage(z.id)||r.addImage(z.id,W),P()})}))),Array.isArray(O)&&O.forEach(z=>{r.getSource(z.id)||r.addSource(z.id,z.source)}),Array.isArray(B)&&B.forEach(z=>{r.getLayer(z.id)?z.layout&&z.layout.visibility!==void 0&&r.setLayoutProperty(z.id,"visibility",z.layout.visibility):r.addLayer(z)})}T()},[r,c]);const $=I(l,["activeVar","value"],"");C.useEffect(()=>{if(r&&n){if(!$||$==="none"){y(null);return}(Object.keys(c||{})||[]).forEach(T=>{(Object.keys(c[T]||{}).filter(O=>I(c,`[${O}][${$}]`,!1)||I(c,`[${O}][default]`,!1)||I(c,`[${T}][${O}][${$}]`,!1)||I(c,`[${T}][${O}][default]`,!1))||[]).forEach(O=>{var P;const B=I(c,`[${O}][${$}]`,"")||I(c,`[${O}][default]`,"")||I(c,`[${T}][${O}][${$}]`,"")||I(c,`[${T}][${O}][default]`,"");let{value:F,settings:z}=B;if(!F&&z){const{type:U,domain:R,range:W,data:V}=z,X=Ja(U,R,W),q=V.reduce((Q,Y)=>(Q[Y.id]=X(Y.value),Q),{});F=["get",["to-string",["get","geoid"]],["literal",q]]}(P=r.getLayer(T))!=null&&P.id&&(["visibility"].includes(O)?r.setLayoutProperty(T,O,F):T.includes(Ru)||r.setPaintProperty(T,O,F)),B.settings&&w(B.settings)})})}},[r,n,c,$,w]),C.useEffect(()=>{c.legend&&w(c.legend)},[c==null?void 0:c.legend]),C.useEffect(()=>{if(!h||!g)return;const{layer_id:T,paintProperty:O}=g;let{value:B}=g;if(!B){const{type:F,domain:z,range:P,data:U}=h,R=Ja(F,z,P),W=U.reduce((V,X)=>(V[X.id]=R(X.value),V),{});B=["get",["to-string",["get","ogc_fid"]],["literal",W]]}r.getLayer(T)&&r.setPaintProperty(T,O,B)},[h,g]),C.useEffect(()=>{var T;(T=c==null?void 0:c.layers)==null||T.forEach(O=>{r.getLayer(O.id)&&O.paint&&Object.keys(O.paint).forEach(F=>{const z=r.getPaintProperty(O.id,F);Ae(z,O.paint[F])||r.setPaintProperty(O.id,F,O.paint[F])})})},[c]),C.useEffect(()=>{r&&c&&c.fitToBounds&&r.fitBounds(c.fitToBounds,{duration:400,zoom:c.fitZoom||13})},[r,c]),C.useEffect(()=>{var T,O,B,F;if(r&&c.filter){const z=((T=c.filter)==null?void 0:T.dataKey)??"ogc_fid",P=((O=c.filter)==null?void 0:O.dataIds)??c.filter,U=["match",["get",z],P,!0,!1];(B=c==null?void 0:c.layers)==null||B.forEach(R=>{r.getLayer(R.id)&&!R.id.includes(SS)&&(R.filter?r.setFilter(R.id,["all",R.filter[1],U]):r.setFilter(R.id,U))})}!c.filter&&r&&((F=c==null?void 0:c.layers)==null||F.forEach(z=>{const P=r.getLayer(z.id);P&&z.filter?r.setFilter(z.id,["all",z.filter[1]]):P&&r.setFilter(z.id,["all"])}))},[r,c.filter]);const[E,M]=C.useState(!1),_=C.useCallback(T=>{M(!1)},[]),L=C.useCallback(T=>{M(O=>!O)},[]),[D,A]=C.useState();return xc(D,_),h?e.jsxs("div",{ref:A,className:"absolute top-0 left-0 w-96 grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"z-10",children:(h==null?void 0:h.type)==="custom"?e.jsx(LS,{...h,toggle:L,isOpen:E,children:e.jsx(_y,{...h})}):e.jsx(IS,{...h})}),e.jsx("div",{className:"z-0",children:e.jsx(RS,{legend:h,updateLegend:d,isOpen:E,close:_})})]}):null},DS=({value:t,remove:s})=>{const n=C.useCallback(a=>{a.stopPropagation(),s(t)},[t,s]),r=_e();return e.jsx("span",{onClick:n,className:`
        fa-solid fa-remove px-2 flex items-center
        ${r.bgAccent3Hover} rounded cursor-pointer
      `})},BS=({domain:t,index:s,disabled:n,remove:r,edit:a})=>{const[l,i]=C.useState(!1),[c,d]=C.useState(""),u=C.useCallback(v=>{v.stopPropagation(),i(!0),d(t)},[t]),m=C.useCallback(v=>{v.stopPropagation(),i(!1),d("")},[t]),p=C.useCallback(v=>{v.stopPropagation(),a(c,s),i(!1),d("")},[s,c,a]),[x,h]=C.useState();C.useEffect(()=>{x&&l&&(x.focus(),x.select())},[x,l]);const[f,g]=C.useState();xc(f,m);const y=_e();return e.jsxs("div",{ref:g,className:`
        flex px-2 py-1 rounded cursor-pointer
        ${y.bgAccent2Hover}
      `,onClick:u,children:[e.jsxs("div",{className:"w-8 mr-1 py-1",children:["(",s+1,")"]}),e.jsx("div",{className:"flex-1 mr-1",children:l?e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1 mr-1",children:e.jsx(zo,{ref:h,value:c,onChange:d})}),e.jsx(Ga,{onClick:p,className:"buttonPrimary",children:"Edit"})]}):e.jsx("div",{className:"px-2 py-1",children:t})}),n?null:l?e.jsx(Ga,{onClick:m,className:"buttonDanger",children:"Stop"}):e.jsx(DS,{remove:r,value:t})]})},FS=({domain:t,range:s,updateLegend:n})=>{const r=C.useCallback(p=>{n(t.filter(x=>x!==p))},[t,n]),[a,l]=C.useState(""),i=C.useCallback(p=>{n([...t,+a].sort((x,h)=>x-h)),l("")},[t,a,n]),c=C.useCallback((p,x)=>{const h=[...t];h.splice(x,1,p),n(h.sort((f,g)=>f-g))},[t,n]),d=C.useCallback(()=>{n(void 0),l("")},[n]),u=C.useMemo(()=>t.length<=2,[t.length]),m=_e();return e.jsx("div",{className:"absolute left-full top-0",style:{left:"CALC(100% + 1rem)"},children:e.jsx("div",{className:`
          ${m.bg} p-1 pointer-events-auto rounded w-96
        `,children:e.jsxs("div",{className:"border rounded border-current relative",children:[e.jsx("div",{className:`
              p-1 border-b border-current rounded-t flex font-bold
              ${m.bgAccent2}
            `,children:"Threshold Editor"}),e.jsx("div",{className:"p-1",children:e.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[e.jsx("div",{children:"Current Thresholds:"}),t.map((p,x)=>e.jsx(BS,{domain:p,index:x,remove:r,disabled:u,edit:c},p)),e.jsxs("div",{className:`flex border-t pt-1 ${m.border}`,children:[e.jsx("div",{className:"mr-1 flex-1",children:e.jsx(zo,{type:"number",placeholder:"enter a threshold value...",onChange:l,value:a})}),e.jsx(Ga,{onClick:i,disabled:!a,className:"buttonPrimary",children:"Add"})]}),e.jsx("div",{children:e.jsx(Ga,{onClick:d,className:"buttonPrimaryBlock",children:"Reset with 6 bins"})})]})})]})})})},zS=({value:t,onChange:s})=>{const n=C.useCallback(r=>{s(!t)},[s,t]);return _e(),e.jsx("div",{onClick:n,className:"px-4 py-1 h-8 rounded flex items-center w-full cursor-pointer",children:e.jsx("div",{className:`
          rounded flex-1 h-2 relative flex items-center bg-blue-100
        `,children:e.jsx("div",{className:`
            w-4 h-4 rounded absolute
            ${t?"bg-blue-500":"bg-gray-500"}
          `,style:{left:t?"100%":"0%",transform:"translateX(-50%)",transition:"left 150ms"}})})})},PS=({colors:t,name:s,reverse:n,range:r,updateLegend:a,test:l})=>{const i=C.useMemo(()=>Ae(t,r),[t,r]),c=C.useCallback(()=>{a(t,s,n)},[a,s,t,n]);return e.jsx("div",{onClick:i?null:c,className:`
        outline outline-2 rounded-lg my-2
        ${i?"outline-black":"outline-transparent cursor-pointer"}
      `,children:e.jsx(qr,{colors:t,height:3})},s)},RS=({legend:t,updateLegend:s,isOpen:n,close:r})=>{const a=C.useCallback(g=>{s({...t,type:g,domain:void 0})},[t,s]),l=C.useCallback((g,y,v)=>{s({...t,range:g,color:y,reverse:v,domain:void 0})},[t,s]),i=C.useCallback((g,y=void 0)=>{s({...t,domain:g,range:y})},[t,s]),[c,d]=C.useState(-1),[u,m]=C.useState(I(t,["range","length"],7)),[p,x]=C.useState(t.reverse),h=C.useMemo(()=>I(ja,u,[]).map(({colors:g,...y})=>({...y,colors:p?[...g].reverse():[...g]})),[u,p]),f=_e();return n?e.jsxs("div",{className:`
        ${f.bg} p-1 pointer-events-auto rounded w-96 relative
      `,children:[e.jsxs("div",{className:"border rounded border-current relative",children:[e.jsxs("div",{className:`
            p-1 border-b border-current rounded-t flex font-bold
            ${f.bgAccent2}
          `,children:[e.jsx("div",{className:"flex-1",children:"Legend Controls"}),e.jsx("div",{className:"flex-0",children:e.jsx("span",{onClick:r,className:`
                px-2 py-1 rounded cursor-pointer
                ${f.bgAccent3Hover}
              `,children:e.jsx("span",{className:"fa fa-remove"})})})]}),e.jsxs("div",{className:"p-1 grid grid-cols-1 gap-1",children:[e.jsxs("div",{className:"flex items-center px-1",children:[e.jsx("div",{className:"w-40 text-right",children:"Scale Type:"}),e.jsx("div",{className:"flex-1 ml-1",children:e.jsx(US,{...t,updateLegend:a})})]}),e.jsxs("div",{className:"flex items-center px-1",children:[e.jsx("div",{className:"w-40 text-right",children:"Number of Colors:"}),e.jsx("div",{className:"flex-1 ml-1",children:e.jsx(WS,{size:u,onChange:m})})]}),e.jsxs("div",{className:"flex items-center px-1",children:[e.jsx("div",{className:"w-40 text-right",children:"Reverse Colors:"}),e.jsx("div",{className:"flex-1",children:e.jsx(zS,{value:p,onChange:x})})]}),e.jsx("div",{className:"border-b-2 border-current",children:"Available Legend Colors:"}),e.jsx("div",{className:`
              overflow-auto px-2 rounded ${f.bgAccent2}
              scrollbar-sm scrollbar-blue
            `,style:{height:"30rem"},children:h.map(g=>e.jsx(PS,{...g,range:t.range,updateLegend:l,reverse:p},g.name))})]})]}),t.type!=="threshold"?null:e.jsx(FS,{...t,updateLegend:i})]}):null},HS=po(3,13),Hu=t=>t,WS=({size:t,onChange:s})=>e.jsx(Ys,{removable:!1,options:HS,displayAccessor:Hu,valueAccessor:Hu,onChange:s,value:t}),VS=[{value:"quantile",name:"Quantile"},{value:"threshold",name:"Threshold"},{value:"ordinal",name:"Ordinal"}],US=({type:t,updateLegend:s})=>{const n=C.useCallback(r=>{s(r)},[s]);return e.jsx(Ys,{removable:!1,options:VS,displayAccessor:r=>r.name,valueAccessor:r=>r.value,onChange:n,value:t})};var pm;class qS extends Po{constructor(){super(...arguments);Wt(this,"onHover",{layers:(pm=this.layers)==null?void 0:pm.map(n=>(console.log("on hover map",n.id),n.id)),callback:(n,r,a)=>[r[0].id,n,(r[0]||{}).properties],Component:this.hoverComp||_S,isPinnable:this.isPinnable||!0});Wt(this,"RenderComponent",OS)}getColorScale(n,r=5,a="Reds"){let l=[0,25,50,75,100];return n.length>r&&(l=Xa(n,r)),bi().domain(l).range(ka(r,a))}}const GS=(t={})=>new qS(t),JS={bgInput:"bg-white",bgInputHover:"hover:bg-white",bgContrast:"bg-gray-800",bgContrastHover:"hover:bg-gray-800",textContrast:"text-white",textContrastHover:"hover:text-white",text:"text-gray-800 disabled:text-gray-400 placeholder:text-gray-400",textDisabled:"text-gray-400 disabled:text-gray-400 placeholder:text-gray-400",bg:"bg-white",border:"border-gray-800",outline:"outline-gray-800",textButton:"text-gray-400 disabled:text-gray-400 placeholder:text-gray-400",bgButton:"bg-gray-400",bgButtonHover:"hover:bg-gray-400",borderButton:"shadow",outlineButton:"outline-gray-400",textInfo:"text-teal-400 disabled:text-teal-400 placeholder:text-teal-400",bgInfo:"bg-teal-400",bgInfoHover:"hover:bg-teal-400",borderInfo:"border-teal-400",outlineInfo:"outline-teal-400",textSuccess:"text-green-400 disabled:text-green-400 placeholder:text-green-400",bgSuccess:"bg-green-400",bgSuccessHover:"hover:bg-green-400",borderSuccess:"border-green-400",outlineSuccess:"outline-green-400",textPrimary:"text-blue-400 disabled:text-blue-400 placeholder:text-blue-400",bgPrimary:"bg-blue-400",bgPrimaryHover:"hover:bg-blue-400",borderPrimary:"border-blue-400",outlinePrimary:"outline-blue-400",textDanger:"text-red-400 disabled:text-red-400 placeholder:text-red-400",bgDanger:"bg-red-400",bgDangerHover:"hover:bg-red-400",borderDanger:"border-red-400",outlineDanger:"outline-red-400",textWarning:"text-yellow-400 disabled:text-yellow-400 placeholder:text-yellow-400",bgWarning:"bg-yellow-400",bgWarningHover:"hover:bg-yellow-400",borderWarning:"border-yellow-400",outlineWarning:"outline-yellow-400",textSmall:"text-sm",textBase:"text-base",textLarge:"text-lg",paddingSmall:"py-0 px-1",paddingBase:"py-1 px-2",paddingLarge:"py-2 px-4",bgAccent1:"bg-white",bgAccent2:"bg-white",bgAccent3:"bg-white",bgAccent4:"bg-gray-500",bgAccent1Hover:"hover:bg-gray-200",bgAccent2Hover:"hover:bg-gray-300",bgAccent3Hover:"hover:bg-gray-400",bgAccent4Hover:"hover:bg-gray-500",textHighlight:"text-blue-500",textHighlightHover:"hover:text-blue-500",borderHighlight:"border-blue-500",borderHighlightHover:"hover:border-blue-500",bgHighlight:"bg-blue-500",bgHighlightHover:"hover:bg-blue-500",transition:"transition ease-in-out duration-150",$compositions:Df},XS=Tf(JS),ZS=Of(XS),Wf=(t,s)=>t*Math.pow(2,s),er=(t,s)=>Math.floor(t/Math.pow(2,s)),Za=(t,s)=>Wf(t.getUint16(s+1,!0),8)+t.getUint8(s),Vf=(t,s)=>Wf(t.getUint32(s+2,!0),16)+t.getUint16(s,!0),YS=(t,s,n,r,a)=>{if(t!=r.getUint8(a))return t-r.getUint8(a);const l=Za(r,a+1);if(s!=l)return s-l;const i=Za(r,a+4);return n!=i?n-i:0},QS=(t,s,n,r)=>{const a=Uf(t,s|128,n,r);return a?{z:s,x:n,y:r,offset:a[0],length:a[1],is_dir:!0}:null},Wu=(t,s,n,r)=>{const a=Uf(t,s,n,r);return a?{z:s,x:n,y:r,offset:a[0],length:a[1],is_dir:!1}:null},Uf=(t,s,n,r)=>{let a=0,l=t.byteLength/17-1;for(;a<=l;){const i=l+a>>1,c=YS(s,n,r,t,i*17);if(c>0)a=i+1;else if(c<0)l=i-1;else return[Vf(t,i*17+7),t.getUint32(i*17+13,!0)]}return null},KS=(t,s)=>t.is_dir&&!s.is_dir?1:!t.is_dir&&s.is_dir?-1:t.z!==s.z?t.z-s.z:t.x!==s.x?t.x-s.x:t.y-s.y,qf=(t,s)=>{const n=t.getUint8(s*17);return{z:n&127,x:Za(t,s*17+1),y:Za(t,s*17+4),offset:Vf(t,s*17+7),length:t.getUint32(s*17+13,!0),is_dir:n>>7===1}},Vu=t=>{const s=[],n=new DataView(t);for(let r=0;r<n.byteLength/17;r++)s.push(qf(n,r));return e_(s)},e_=t=>{t.sort(KS);const s=new ArrayBuffer(17*t.length),n=new Uint8Array(s);for(let r=0;r<t.length;r++){const a=t[r];let l=a.z;a.is_dir&&(l=l|128),n[r*17]=l,n[r*17+1]=a.x&255,n[r*17+2]=a.x>>8&255,n[r*17+3]=a.x>>16&255,n[r*17+4]=a.y&255,n[r*17+5]=a.y>>8&255,n[r*17+6]=a.y>>16&255,n[r*17+7]=a.offset&255,n[r*17+8]=er(a.offset,8)&255,n[r*17+9]=er(a.offset,16)&255,n[r*17+10]=er(a.offset,24)&255,n[r*17+11]=er(a.offset,32)&255,n[r*17+12]=er(a.offset,48)&255,n[r*17+13]=a.length&255,n[r*17+14]=a.length>>8&255,n[r*17+15]=a.length>>16&255,n[r*17+16]=a.length>>24&255}return s},t_=(t,s)=>{if(t.byteLength<17)return null;const n=t.byteLength/17,r=qf(t,n-1);if(r.is_dir){const a=r.z,l=s.z-a,i=Math.trunc(s.x/(1<<l)),c=Math.trunc(s.y/(1<<l));return{z:a,x:i,y:c}}return null};async function s_(t){const s=await t.getBytes(0,512e3),n=new DataView(s.data),r=n.getUint32(4,!0),a=n.getUint16(8,!0),l=new TextDecoder("utf-8"),i=JSON.parse(l.decode(new DataView(s.data,10,r)));let c=$a.Unknown;i.compression==="gzip"&&(c=$a.Gzip);let d=0;"minzoom"in i&&(d=+i.minzoom);let u=0;"maxzoom"in i&&(u=+i.maxzoom);let m=0,p=0,x=0,h=-180,f=-85,g=180,y=85;if(i.bounds){const j=i.bounds.split(",");h=+j[0],f=+j[1],g=+j[2],y=+j[3]}if(i.center){const j=i.center.split(",");m=+j[0],p=+j[1],x=+j[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:a*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:$a.None,tileCompression:c,tileType:fc.Mvt,minZoom:d,maxZoom:u,minLon:h,minLat:f,maxLon:g,maxLat:y,centerZoom:x,centerLon:m,centerLat:p,etag:s.etag}}async function n_(t,s,n,r,a,l,i){let c=await n.getArrayBuffer(s,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(c=Vu(c));const d=Wu(new DataView(c),r,a,l);if(d){let p=(await s.getBytes(d.offset,d.length,i)).data;const x=new DataView(p);return x.getUint8(0)==31&&x.getUint8(1)==139&&(p=_n(new Uint8Array(p))),{data:p}}const u=t_(new DataView(c),{z:r,x:a,y:l});if(u){const m=QS(new DataView(c),u.z,u.x,u.y);if(m){let p=await n.getArrayBuffer(s,m.offset,m.length,t);t.specVersion===1&&(p=Vu(p));const x=Wu(new DataView(p),r,a,l);if(x){let f=(await s.getBytes(x.offset,x.length,i)).data;const g=new DataView(f);return g.getUint8(0)==31&&g.getUint8(1)==139&&(f=_n(new Uint8Array(f))),{data:f}}}}}const Gf={getHeader:s_,getZxy:n_};let Jf=class{constructor(){this.tile=(s,n)=>{if(s.type=="json"){const r=s.url.substr(10);let a=this.tiles.get(r);return a||(a=new Ya(r),this.tiles.set(r,a)),a.getHeader().then(l=>{const i={tiles:[s.url+"/{z}/{x}/{y}"],minzoom:l.minZoom,maxzoom:l.maxZoom,bounds:[l.minLon,l.minLat,l.maxLon,l.maxLat]};n(null,i,null,null)}).catch(l=>{n(l,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),a=s.url.match(r);if(!a)throw new Error("Invalid PMTiles protocol URL");const l=a[1];let i=this.tiles.get(l);i||(i=new Ya(l),this.tiles.set(l,i));const c=a[2],d=a[3],u=a[4],m=new AbortController,p=m.signal;let x=()=>{m.abort()};return i.getHeader().then(h=>{i.getZxy(+c,+d,+u,p).then(f=>{f?n(null,new Uint8Array(f.data),f.cacheControl,f.expires):h.tileType==fc.Mvt?n(null,new Uint8Array,null,null):n(null,null,null,null)}).catch(f=>{f.name!=="AbortError"&&n(f,null,null,null)})}),{cancel:x}}},this.tiles=new Map}add(s){this.tiles.set(s.source.getKey(),s)}get(s){return this.tiles.get(s)}};function dn(t,s){return(s>>>0)*4294967296+(t>>>0)}function r_(t,s){const n=s.buf;let r,a;if(a=n[s.pos++],r=(a&112)>>4,a<128||(a=n[s.pos++],r|=(a&127)<<3,a<128)||(a=n[s.pos++],r|=(a&127)<<10,a<128)||(a=n[s.pos++],r|=(a&127)<<17,a<128)||(a=n[s.pos++],r|=(a&127)<<24,a<128)||(a=n[s.pos++],r|=(a&1)<<31,a<128))return dn(t,r);throw new Error("Expected varint not more than 10 bytes")}function tr(t){const s=t.buf;let n,r;return r=s[t.pos++],n=r&127,r<128||(r=s[t.pos++],n|=(r&127)<<7,r<128)||(r=s[t.pos++],n|=(r&127)<<14,r<128)||(r=s[t.pos++],n|=(r&127)<<21,r<128)?n:(r=s[t.pos],n|=(r&15)<<28,r_(n,t))}function a_(t,s,n,r){if(r==0){n==1&&(s[0]=t-1-s[0],s[1]=t-1-s[1]);const a=s[0];s[0]=s[1],s[1]=a}}const o_=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function l_(t,s,n){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(s>Math.pow(2,t)-1||n>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const r=o_[t],a=Math.pow(2,t);let l=0,i=0,c=0;const d=[s,n];let u=a/2;for(;u>0;)l=(d[0]&u)>0?1:0,i=(d[1]&u)>0?1:0,c+=u*u*(3*l^i),a_(u,d,l,i),u=u/2;return r+c}var $a=(t=>(t[t.Unknown=0]="Unknown",t[t.None=1]="None",t[t.Gzip=2]="Gzip",t[t.Brotli=3]="Brotli",t[t.Zstd=4]="Zstd",t))($a||{});async function Xf(t,s){if(s===1||s===0)return t;if(s===2){if(typeof globalThis.DecompressionStream>"u")return _n(new Uint8Array(t));{let r=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(r).arrayBuffer()}}else throw Error("Compression method not supported")}var fc=(t=>(t[t.Unknown=0]="Unknown",t[t.Mvt=1]="Mvt",t[t.Png=2]="Png",t[t.Jpeg=3]="Jpeg",t[t.Webp=4]="Webp",t[t.Avif=5]="Avif",t))(fc||{});const i_=127;function c_(t,s){let n=0,r=t.length-1;for(;n<=r;){const a=r+n>>1,l=s-t[a].tileId;if(l>0)n=a+1;else if(l<0)r=a-1;else return t[a]}return r>=0&&(t[r].runLength===0||s-t[r].tileId<t[r].runLength)?t[r]:null}let d_=class{constructor(s){this.url=s.includes("localhost")?"http://"+s:"https://"+s}getKey(){return this.url}async getBytes(s,n,r){let a;r||(a=new AbortController,r=a.signal);let l=await fetch(this.url,{signal:r,headers:{Range:"bytes="+s+"-"+(s+n-1)}});if(l.status===416&&s===0){const d=l.headers.get("Content-Range");if(!d||!d.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const u=+d.substr(8);l=await fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(u-1)}})}if(l.status>=300)throw Error("Bad response code: "+l.status);const i=l.headers.get("Content-Length");if(l.status===200&&(!i||+i>n))throw a&&a.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:await l.arrayBuffer(),etag:l.headers.get("ETag")||void 0,cacheControl:l.headers.get("Cache-Control")||void 0,expires:l.headers.get("Expires")||void 0}}};function Ft(t,s){const n=t.getUint32(s+4,!0),r=t.getUint32(s+0,!0);return n*Math.pow(2,32)+r}function u_(t,s){const n=new DataView(t),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:Ft(n,8),rootDirectoryLength:Ft(n,16),jsonMetadataOffset:Ft(n,24),jsonMetadataLength:Ft(n,32),leafDirectoryOffset:Ft(n,40),leafDirectoryLength:Ft(n,48),tileDataOffset:Ft(n,56),tileDataLength:Ft(n,64),numAddressedTiles:Ft(n,72),numTileEntries:Ft(n,80),numTileContents:Ft(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:s}}function Zf(t){const s={buf:new Uint8Array(t),pos:0},n=tr(s),r=[];let a=0;for(let l=0;l<n;l++){const i=tr(s);r.push({tileId:a+i,offset:0,length:0,runLength:1}),a+=i}for(let l=0;l<n;l++)r[l].runLength=tr(s);for(let l=0;l<n;l++)r[l].length=tr(s);for(let l=0;l<n;l++){const i=tr(s);i===0&&l>0?r[l].offset=r[l-1].offset+r[l-1].length:r[l].offset=i-1}return r}function m_(t){const s=new DataView(t);return s.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):s.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}let yn=class extends Error{};async function p_(t,s,n,r){const a=await t.getBytes(0,16384),l=new DataView(a.data);if(l.getUint16(0,!0)!==19792)throw new Error(`Wrong magic number for PMTiles archive got ${l.getUint16(0,!0)} not 19729`);if(m_(a.data)<3)return[await Gf.getHeader(t)];const i=a.data.slice(0,i_);let c=a.etag;r&&a.etag!=r&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),c=void 0);const d=u_(i,c);if(n){const u=a.data.slice(d.rootDirectoryOffset,d.rootDirectoryOffset+d.rootDirectoryLength),m=t.getKey()+"|"+(d.etag||"")+"|"+d.rootDirectoryOffset+"|"+d.rootDirectoryLength,p=Zf(await s(u,d.internalCompression));return[d,[m,p.length,p]]}return[d,void 0]}async function x_(t,s,n,r,a){const l=await t.getBytes(n,r);if(a.etag&&a.etag!==l.etag)throw new yn(l.etag);const i=await s(l.data,a.internalCompression),c=Zf(i);if(c.length===0)throw new Error("Empty directory is invalid");return c}let h_=class{constructor(s=100,n=!0,r=Xf){this.cache=new Map,this.maxCacheEntries=s,this.counter=1,this.prefetch=n,this.decompress=r}async getHeader(s,n){const r=s.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,await this.cache.get(r).data;const a=new Promise((l,i)=>{p_(s,this.decompress,this.prefetch,n).then(c=>{c[1]&&this.cache.set(c[1][0],{lastUsed:this.counter++,data:Promise.resolve(c[1][2])}),l(c[0]),this.prune()}).catch(c=>{i(c)})});return this.cache.set(r,{lastUsed:this.counter++,data:a}),a}async getDirectory(s,n,r,a){const l=s.getKey()+"|"+(a.etag||"")+"|"+n+"|"+r;if(this.cache.has(l))return this.cache.get(l).lastUsed=this.counter++,await this.cache.get(l).data;const i=new Promise((c,d)=>{x_(s,this.decompress,n,r,a).then(u=>{c(u),this.prune()}).catch(u=>{d(u)})});return this.cache.set(l,{lastUsed:this.counter++,data:i}),i}async getArrayBuffer(s,n,r,a){const l=s.getKey()+"|"+(a.etag||"")+"|"+n+"|"+r;if(this.cache.has(l))return this.cache.get(l).lastUsed=this.counter++,await this.cache.get(l).data;const i=new Promise((c,d)=>{s.getBytes(n,r).then(u=>{if(a.etag&&a.etag!==u.etag)throw new yn(u.etag);c(u.data),this.cache.has(l),this.prune()}).catch(u=>{d(u)})});return this.cache.set(l,{lastUsed:this.counter++,data:i}),i}prune(){if(this.cache.size>=this.maxCacheEntries){let s=1/0,n;this.cache.forEach((r,a)=>{r.lastUsed<s&&(s=r.lastUsed,n=a)}),n&&this.cache.delete(n)}}async invalidate(s,n){this.cache.delete(s.getKey()),await this.getHeader(s,n)}},Ya=class{constructor(s,n,r){typeof s=="string"?this.source=new d_(s):this.source=s,r?this.decompress=r:this.decompress=Xf,n?this.cache=n:this.cache=new h_}async getHeader(){return await this.cache.getHeader(this.source)}async getZxyAttempt(s,n,r,a){const l=l_(s,n,r),i=await this.cache.getHeader(this.source);if(i.specVersion<3)return Gf.getZxy(i,this.source,this.cache,s,n,r,a);if(s<i.minZoom||s>i.maxZoom)return;let c=i.rootDirectoryOffset,d=i.rootDirectoryLength;for(let u=0;u<=3;u++){const m=await this.cache.getDirectory(this.source,c,d,i),p=c_(m,l);if(p)if(p.runLength>0){const x=await this.source.getBytes(i.tileDataOffset+p.offset,p.length,a);if(i.etag&&i.etag!==x.etag)throw new yn(x.etag);return{data:await this.decompress(x.data,i.tileCompression),cacheControl:x.cacheControl,expires:x.expires}}else c=i.leafDirectoryOffset+p.offset,d=p.length;else return}throw Error("Maximum directory depth exceeded")}async getZxy(s,n,r,a){try{return await this.getZxyAttempt(s,n,r,a)}catch(l){if(l instanceof yn)return this.cache.invalidate(this.source,l.message),await this.getZxyAttempt(s,n,r,a);throw l}}async getMetadataAttempt(){const s=await this.cache.getHeader(this.source),n=await this.source.getBytes(s.jsonMetadataOffset,s.jsonMetadataLength);if(s.etag&&s.etag!==n.etag)throw new yn(n.etag);const r=await this.decompress(n.data,s.internalCompression),a=new TextDecoder("utf-8");return JSON.parse(a.decode(r))}async getMetadata(){try{return await this.getMetadataAttempt()}catch(s){if(s instanceof yn)return this.cache.invalidate(this.source,s.message),await this.getMetadataAttempt();throw s}}};const Ro={type:"pmtiles",protocolInit:t=>{const s=new Jf;return t.addProtocol("pmtiles",s.tile),s},sourceInit:(t,s,n)=>{const r=new Ya(s.url);t.add(r)}};fp(7,"Reds");fp(12,"Set3");const Uu="_pin_outline",f_=[{name:"Streets",style:"https://api.maptiler.com/maps/streets-v2/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Light",style:"https://api.maptiler.com/maps/dataviz-light/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Dark",style:"https://api.maptiler.com/maps/dataviz-dark/style.json?key=mU28JQ6HchrQdneiq6k9"}],g_=t=>t+"/tiles",qu=g_(gt),b_=({views:t})=>{const{viewId:s,sourceId:n,page:r}=Be(),a=Le(),{baseUrl:l}=C.useContext(ie);return e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"py-3.5 px-2 text-sm text-gray-400",children:"Version : "}),e.jsx("div",{className:"flex-1",children:e.jsx("select",{className:"pl-3 pr-4 py-2.5 border border-blue-100 bg-blue-50 w-full bg-white mr-2 flex items-center justify-between text-sm",value:s,onChange:i=>a(`${l}/source/${n}/${r}/${i.target.value}`),children:t.sort((i,c)=>c.view_id-i.view_id).map((i,c)=>e.jsx("option",{className:"ml-2  truncate",value:i.view_id,children:i.version?i.version:i.view_id},c))})})]})},y_=({source:t,views:s,HoverComp:n,showViewSelector:r=!0,displayPinnedGeomBorder:a=!1,mapStyles:l})=>{const[i]=Rt(),c=i.get("variable"),{viewId:d}=Be(),{pgEnv:u,baseUrl:m,user:p}=C.useContext(ie),[x,h]=C.useState(null),f=c&&!d?c:d,g=C.useMemo(()=>{let $=(s||[]).filter(E=>E.view_id===+f);return I($,"[0]",s[0])},[s,f]),y=b.useMemo(()=>{var E;let $=I(g,"metadata.tiles",{sources:[],layers:[]});return(E=$==null?void 0:$.sources)==null||E.forEach(M=>{var _;(_=M==null?void 0:M.source)!=null&&_.url&&(M.source.url=M.source.url.replace("$HOST",qu),M.source.url+="?cols=ogc_fid",M.source.url.includes(".pmtiles")&&(M.source.url=M.source.url.replace("https://","pmtiles://").replace("http://","pmtiles://")))}),$},[g]);b.useMemo(()=>{let $=I(g,"metadata",{tiles:{sources:[],layers:[]}});return I($,"tiles.sources",[]).forEach(E=>{var M;(M=E==null?void 0:E.source)!=null&&M.url&&(E.source.url=E.source.url.replace("$HOST",qu))}),$},[g]);const v=C.useMemo(()=>I(g,"view_id",null),[g]),[j,N]=C.useState(I(y,"symbology",{})),{sources:S,layers:w}=j,k=C.useMemo(()=>{var _,L,D,A,T;const $=S||I(y,"sources",[]),E=w||I(y,"layers",[]);if($.length===0||E.length===0)return null;let M=I(t,["metadata","columns"],I(t,"metadata",[]))||[];if(M=Array.isArray(M)?M:[],a&&!E.find(O=>O.id.includes(Uu))){const O=(_=E==null?void 0:E[0])==null?void 0:_.id,B={id:O+Uu,type:"line",paint:{"line-color":"black","line-width":3,"line-opacity":0},"line-color":"black","line-opacity":0,"line-width":3,source:(L=E==null?void 0:E[0])==null?void 0:L.source,"source-layer":O};E.push(B)}return(T=(A=(D=$==null?void 0:$[0])==null?void 0:D.source)==null?void 0:A.tiles)!=null&&T[0]&&!$[0].source.tiles[0].includes("?")&&($[0].source.tiles[0]=$[0].source.tiles[0]+"?cols=ogc_fid"),{name:t.name,pgEnv:u,source:t,activeView:g,hoverComp:(n==null?void 0:n.Component)||!1,isPinnable:(n==null?void 0:n.isPinnable)||!1,attributes:M,activeViewId:v,sources:$,layers:E,symbology:I(y,"symbology",{})}},[t,s,y,v,S,w,a]);return e.jsxs("div",{children:[e.jsx("div",{className:"flex",children:r?e.jsx(b_,{views:s}):""}),e.jsx("div",{className:"w-full h-[900px]",children:e.jsx(w_,{layers:[k],layer:k,source:t,tempSymbology:j,setTempSymbology:N,mapStyles:l},d)}),p.authLevel>=5?e.jsx("div",{className:"border-t border-gray-200 px-4 py-5 sm:p-0",children:e.jsx("dl",{className:"sm:divide-y sm:divide-gray-200",children:["sources","layers"].map(($,E)=>{let M=JSON.stringify(I(k,$,[]),null,3);return e.jsxs("div",{className:"flex justify-between group",children:[e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-5 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 py-5",children:$}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-4",children:x===$?e.jsx("div",{className:"pt-3 pr-8",children:e.jsx(j_,{startValue:M,attr:$,viewId:v,parentData:I(g,"metadata",{tiles:{}}),cancel:()=>h(null)})}):e.jsx("div",{className:"py-3 pl-2 pr-8",children:e.jsx("pre",{className:"bg-gray-100 tracking-tighter overflow-auto scrollbar-xs",children:M})})})]}),e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:_=>h(x===$?null:$),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-12 mt-3 p-2.5 rounded hover:bg-blue-500 hover:text-white "})})]},E)})})}):""]})},v_={type:"pmtiles",protocolInit:t=>{const s=new Jf;return t.addProtocol("pmtiles",s.tile),s},sourceInit:(t,s,n)=>{const r=new Ya(s.url);t.add(r)}},w_=({layers:t,layer:s,tempSymbology:n,setTempSymbology:r,source:a,mapStyles:l})=>{const[i,c]=C.useState(!1);C.useEffect(()=>(c(!0),()=>c(!1)),[]);const{falcor:d}=C.useContext(ie),[u,m]=C.useState([]);C.useEffect(()=>{i&&m(g=>{var j;let y=(j=g==null?void 0:g.map(N=>N.activeViewId))==null?void 0:j.filter(Boolean),v=t==null?void 0:t.filter(Boolean).filter(N=>!y.includes(N.activeViewId)).map(N=>GS(N));return[...g==null?void 0:g.filter(N=>y.includes(N.activeViewId)),...v]})},[i,t]);const p=C.useMemo(()=>l&&(l==null?void 0:l.length)>0?l:f_,[l]),h=C.useCallback(g=>{},[n,r,s,"none"]),f=C.useMemo(()=>{let g=t.filter(Boolean).map(y=>y.activeViewId);return u.reduce((y,v)=>{const j=g.indexOf(v.activeViewId);return j!==-1&&(y[v.id]=jt(t[j]),y[v.id].symbology=jt(n),y[v.id].updateLegend=h,y[v.id].sourceId=a.source_id),y},{})},[t,u,n,h,a.source_id]);return e.jsx("div",{className:"w-full h-full",children:e.jsx(o$,{theme:ZS,children:e.jsx(Hn,{mapOptions:{protocols:[v_],zoom:7.3,navigationControl:!1,center:[-73.8,40.79],styles:p},layers:u,layerProps:f,leftSidebar:!1,rightSidebar:!1,mapActions:["navigation-controls"]})})})},j_=({startValue:t,attr:s,viewId:n,parentData:r,cancel:a=()=>{}})=>{const[l,i]=b.useState(""),{pgEnv:c,baseUrl:d,falcor:u}=C.useContext(ie),m=b.useRef(null);b.useEffect(()=>{i(t),m.current.focus()},[t]),b.useEffect(()=>{m.current.style.height="inherit",m.current.style.height=`${m.current.scrollHeight}px`},[l]);const p=async(x,h)=>{console.log("click save 222",x,h,r);let f=JSON.parse(h),g=r||{tiles:{}};if(g.tiles||(g.tiles={}),g.tiles[x]=f,n)try{let y=await u.set({paths:[["dama",c,"views","byId",n,"attributes","metadata"]],jsonGraph:{dama:{[c]:{views:{byId:{[n]:{attributes:{metadata:JSON.stringify(g)}}}}}}}});console.log("set run response",y),a()}catch(y){console.log("error stuff",y,h,r)}};return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"w-full flex",children:e.jsx("textarea",{ref:m,className:"flex-1 px-2 shadow text-base bg-blue-100 focus:ring-blue-700 focus:border-blue-500  border-gray-300 rounded-none rounded-l-md",value:l,onChange:x=>i(x.target.value)})}),e.jsxs("div",{children:[e.jsx($e,{themeOptions:{size:"sm",color:"primary"},onClick:x=>p(s,l),children:" Save "}),e.jsx($e,{themeOptions:{size:"sm",color:"cancel"},onClick:x=>a(),children:" Cancel "})]})]})};function C_(t,s){if(s.type==="update")return{...t,...s.payload};if(s.type==="update_dbColName"){const{rowIdx:n,colName:r}=s.payload,{tableDescriptor:a}=t,l=I(a,["columnTypes",n,"col"]);if(console.log("update_dbColName",s.payload),l===r)return t;const i=jt(a);return i.columnTypes=a.columnTypes.slice(),i.columnTypes[n]={...i.columnTypes[n],col:r},{...t,tableDescriptor:i}}return t}function N_({progress:t}){const s={display:"inline-block",height:"100%",width:"100%",backgroundColor:"whitesmoke",borderRadius:40,margin:50},r={display:"inline-block",height:"84%",width:`${t*.9}%`,backgroundColor:"#3b82f680",borderRadius:40,textAlign:"right"},a={padding:10,color:"black",fontWeight:900};return e.jsxs("div",{style:s,children:[e.jsxs("span",{style:{fontWeight:"bold",paddingLeft:"10px",paddingRight:"10px"},children:[" ","Sent:"]}),e.jsx("div",{style:r,children:e.jsx("span",{style:a,children:`${t}%`})})]})}function k_({fileUploadStatus:t}){let s;if(!t)s=e.jsx("td",{className:"py-4 text-center",children:"Sending GIS File to server"});else{const{type:n,payload:r}=t;/GIS_FILE_UPLOAD_PROGRESS$/.test(n)?s=e.jsx(N_,{progress:r==null?void 0:r.data}):/GIS_FILE_RECEIVED$/.test(n)?s=e.jsx("td",{className:"py-4 text-center",children:"File Received"}):/START_GIS_FILE_UPLOAD_ANALYSIS$/.test(n)?s=e.jsx("td",{className:"py-4 text-center",children:"Server Analyzing the GIS File"}):/FINISH_GIS_FILE_UPLOAD$/.test(n)?s=e.jsx("td",{className:"py-4 text-center",children:"GIS File Analysis Complete"}):s=e.jsx("td",{className:"py-4 text-center",children:"Processing"})}return e.jsxs("tr",{children:[e.jsx("td",{className:"py-4 text-left",children:"File Upload Status"}),s]})}function $_({uploadedFile:t,fileUploadStatus:s}){return t?e.jsxs("div",{children:[e.jsx("div",{className:"font-bold",children:e.jsx("span",{children:"File Metadata"})}),e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-4 text-left",children:"Name"}),e.jsx("td",{className:"text-center  p-2",children:t.name})]},"uploaded-file-meta--name"),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-4 text-left",children:"Last Modified"}),e.jsx("td",{className:"text-center  p-2",children:I(t,"lastModifiedDate","").toLocaleString()})]},"uploaded-file-meta--last-mod-ts"),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-4 text-left",children:"Size"}),e.jsx("td",{className:"text-center  p-2",children:l1(t.size)})]},"uploaded-file-meta--size"),e.jsx(k_,{fileUploadStatus:s})]})})]}):""}function S_({etlContextId:t,uploadErrMsg:s}){return e.jsxs("table",{className:"w-2/3 mx-auto text-center",style:{margin:"40px auto",textAlign:"center",border:"1px solid",borderColor:"back"},children:[e.jsx("thead",{style:{color:"black",backgroundColor:"red",fontWeight:"bolder",textAlign:"center",marginTop:"40px",fontSize:"20px",border:"1px solid",borderColor:"black"},children:e.jsxs("tr",{children:[e.jsxs("th",{style:{border:"1px solid",borderColor:"black"},children:[" ","GIS Dataset Upload Error"]}),e.jsxs("th",{style:{border:"1px solid",borderColor:"black"},children:[" ","ETL Context ID"]})]})}),e.jsx("tbody",{style:{border:"1px solid"},children:e.jsxs("tr",{style:{border:"1px solid"},children:[e.jsx("td",{style:{border:"1px solid",padding:"10px",backgroundColor:"white",color:"darkred"},children:s}),e.jsx("td",{style:{border:"1px solid",backgroundColor:"white"},children:t})]})})]})}function __({state:t,dispatch:s}){const{etlContextId:n,userId:r,email:a,damaServerPath:l,polling:i,pollingInterval:c,uploadErrMsg:d,uploadedFile:u,fileUploadStatus:m,damaSourceName:p,dataType:x}=t,h=async f=>{try{const g=new FormData;g.append("etlContextId",n),g.append("user_id",r),g.append("email",a),g.append("name",p),g.append("type",x),g.append("fileSizeBytes",f.size),g.append("file",f),s({type:"update",payload:{polling:!0,uploadedFile:f}}),console.log("sending upload");const y=await fetch(`${l}/gis-dataset/upload`,{method:"POST",body:g});console.log("sending upload finished ");const v=await y.json();if(Array.isArray(v)){const[{id:j}]=v;s({type:"update",payload:{polling:!1,gisUploadId:j,processPolling:!0}})}else throw v}catch(g){s({type:"update",payload:{polling:!1,uploadErrMsg:g==null?void 0:g.message,uploadedFile:null}})}};return b.useEffect(()=>{const f=async()=>{const g=`${l}/events/query?etl_context_id=${n}&event_id=-1`,v=await(await fetch(g)).json();s({type:"update",payload:{fileUploadStatus:v[v.length-1]}})};if(i&&!c){let g=setInterval(f,3e3);s({type:"update",payload:{pollingInterval:g}})}else c&&!i&&(clearInterval(c),f(),s({type:"update",payload:{pollingInterval:null}}))},[i,c,l,n,s]),n?u?e.jsx($_,{uploadedFile:u,fileUploadStatus:m}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full border border-dashed border-gray-300 bg-gray-100",children:e.jsx("div",{className:"p-4",children:e.jsx("button",{children:e.jsx("input",{type:"file",onChange:f=>h(f.target.files[0])})})})}),d?e.jsx(S_,{etlContextId:n,uploadErrMsg:d}):""]}):"no context Id no upload"}const I_=({state:t})=>{const{etlContextId:s,layerName:n,lyrAnlysErrMsg:r,layerAnalysis:a}=t;if(!n)return"";if(r)return e.jsx(L_,{etlContextId:s,errorMsg:r});if(!a)return e.jsx("div",{children:"Analyzing Layer... please wait."});const{layerGeometriesAnalysis:l}=a,{countsByPostGisType:i={}}=l,c=Object.keys(i).sort((d,u)=>i[u]-i[d]);return e.jsxs("div",{children:[e.jsx("span",{className:"py-4 font-bold",children:" Layer Analysis "}),e.jsx("div",{className:"w-full",children:e.jsx("div",{style:{width:"50%",margin:"10px auto"},children:e.jsxs("table",{className:"pt-10 mx-auto border",children:[e.jsx("thead",{style:{backgroundColor:"black",color:"white"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center",style:{padding:"10px",borderRight:"1px solid white"},children:"Geometry Type"}),e.jsx("th",{className:"text-center",style:{padding:"10px"},children:"Feature Count"})]})}),e.jsx("tbody",{children:c.map((d,u)=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-4 text-center",style:{padding:"10px",border:"1px solid"},children:d}),e.jsx("td",{className:"text-center  p-2",style:{padding:"10px",border:"1px solid"},children:i[d]})]},u))})]})})})]})},L_=({etlContextId:t,errorMsg:s})=>e.jsxs("table",{className:"w-2/3 mx-auto mt-10 text-center border border-gray-300",children:[e.jsx("thead",{className:"bg-red-500 font-bold text-lg",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Layer Analysis Error"}),e.jsx("th",{children:"ETL Context ID"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-red-800 p-4",children:s}),e.jsx("td",{children:t})]})})]});function E_({state:t,dispatch:s}){const n=Ge(),{damaServerPath:r,gisUploadId:a,uploadedFile:l,layerNames:i,layerName:c,userId:d,email:u,etlContextId:m,analysisContextId:p,analysisPolling:x,analysisPollingInterval:h,processPolling:f,processPollingInterval:g,layerAnalysisReady:y}=t;return b.useEffect(()=>{if(a&&l&&!f)try{(async j=>{const N=`${r}/gis-dataset/${j}/layerNames`,w=await(await fetch(N)).json();s({type:"update",payload:{layerNames:w,layerName:w[0]}})})(a)}catch(v){s({type:"update",payload:{lyrAnlysErrMsg:v.message}})}},[a,l,r,s,f]),b.useEffect(()=>{if(a&&c)try{(async(j,N)=>{const w=await(await fetch(`${r}/gis-dataset/${j}/${N}/layerAnalysis`,{method:"POST",body:JSON.stringify({user_id:d,email:u,parent_context_id:m}),headers:{"Content-Type":"application/json"}})).json();Object.keys(w).includes("GEODATASET_ANALYSIS_VERSION")?s({type:"update",payload:{layerAnalysis:w,layerAnalysisReady:!0}}):(window.history.replaceState(null,"",`${n.pathname}/${w.etl_context_id}`),s({type:"update",payload:{analysisPolling:!0,analysisContextId:w.etl_context_id}}))})(a,c)}catch(v){s({type:"update",payload:{lyrAnlysErrMsg:v.message}})}},[a,c,r,s]),b.useEffect(()=>{const v=async()=>{const j=`${r}/events/query?etl_context_id=${m}&event_id=-1`,S=await(await fetch(j)).json(),w=S.some(k=>k.type==="upload:FINAL");if(w&&s({type:"update",payload:{processPolling:!1}}),!w){const k=S.find($=>$.type.includes("upload")&&$.error);k&&(console.error("Error with layer upload processing::",k),s({type:"update",payload:{processPolling:!1}}))}};if(f&&!g){let j=setInterval(v,3e3);s({type:"update",payload:{processPollingInterval:j}})}else g&&!f&&(clearInterval(g),v(),s({type:"update",payload:{processPollingInterval:null}}))},[f,g,r,m,s]),b.useEffect(()=>{const v=async()=>{const j=`${r}/events/query?etl_context_id=${p}&event_id=-1`,S=await(await fetch(j)).json(),w=S.some(k=>k.type==="analysis:FINAL");if(w&&s({type:"update",payload:{analysisPolling:!1,layerAnalysisReady:!0}}),!w){const k=S.find($=>$.type.includes("analysis")&&$.error);k&&(console.error("Error with layer analysis::",k),s({type:"update",payload:{analysisPolling:!1}}))}};if(x&&!h){let j=setInterval(v,3e3);s({type:"update",payload:{analysisPollingInterval:j}})}else h&&!x&&(clearInterval(h),v(),s({type:"update",payload:{analysisPollingInterval:null}}))},[x,h,r,p,s]),b.useEffect(()=>{y&&(async()=>{const N=await(await fetch(`${r}/gis-dataset/${a}/${c}/layerAnalysis`)).json();s({type:"update",payload:{layerAnalysis:N}})})()},[y]),i?e.jsxs("div",{className:"border-t border-gray-200 w-full",children:[e.jsx("table",{className:"w-full ",children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"py-4 text-left",children:"Select Layer"}),e.jsx("td",{className:"py-4 text-center",children:e.jsx("select",{className:"text-center w-1/2 bg-white p-2 shadow bg-grey-50 focus:bg-blue-100 border-gray-300",value:c||"",onChange:v=>s({type:"update",payload:{layerName:v.target.value}}),children:["",...i].map(v=>e.jsx("option",{value:v,children:v},v))})})]})})}),e.jsx(I_,{state:t})]}):""}const M_=({publishStatus:t,field:s,col:n,onChange:r})=>e.jsx("input",{className:"w-full p-2 flex-1 shadow bg-grey-50 focus:bg-blue-100 border-gray-300",disabled:t!=="AWAITING",id:s,defaultValue:n||"",onChange:r}),A_=({publishStatus:t,field:s,col:n,availableDbColNames:r,onChange:a})=>{if(!r)return"";const l=n&&r.includes(n),i=`col-names-dropdown-for-${s}`,c=r.filter(Boolean).length>0;return r.length?l&&r.length===1?e.jsx("span",{className:"text-center",children:n}):e.jsxs("select",{className:"w-full p-2 flex-1 shadow bg-grey-50 focus:bg-blue-100 border-gray-300",onChange:d=>a(d.target.value),value:l?n:"",placeholder:"Select the db column name",disabled:!c||t!=="AWAITING",children:[e.jsx("option",{children:"Choose db column "}),r.map((d,u)=>e.jsx("option",{value:d,children:d},u))]},i):e.jsx("span",{style:{color:"darkgray"},children:"All table columns have been assigned."})},T_=({state:t,dispatch:s})=>{const{layerName:n,tableDescriptor:r,publishStatus:a,databaseColumnNames:l,mbtilesOptions:i}=t,[c,d]=b.useState(null),[u,m]=b.useState(null),[p,x]=b.useState(null),[h,f]=b.useState(!0),[g,y]=b.useState(!0),v=r&&r.columnTypes,j=v&&v.reduce((E,{key:M,col:_})=>(E[M]=_||null,E),{});if(b.useEffect(()=>{p===null&&j&&x(j)},[p,j]),b.useEffect(()=>{j&&!c&&d(Qr(j,E=>E===null))},[j,c]),b.useEffect(()=>{if(j&&!u){const E=v.reduce((M,{key:_,col:L})=>(M[L]=_||null,M),{});m(Qr(E,M=>M===null))}},[j,u]),!n)return"";if(!j)return e.jsxs("span",{className:"w-full p-10 text-center",children:["Please wait... the server is analyzing the ",n," layer. This may take a few moments."]});if(!c)return null;const N=l&&l.length>0?A_:M_,S=new Set(Object.values(j).filter(Boolean).filter(E=>l&&l.includes(E))),w=E=>{d(Qr(c,()=>E.target.checked)),f(!E.target.checked)},k=E=>{const M=Qr(u,()=>E.target.checked);m(M),y(!E.target.checked),s({type:"update",payload:{mbtilesOptions:{...i,preserveColumns:M}}})},$=l&&l.length>0&&l.filter(E=>!S.has(E)).filter(Boolean);return e.jsxs("div",{children:[e.jsx("span",{className:"text-lg font-bold",children:"Field Names Mappings"}),e.jsx("div",{children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center",style:{paddingRight:"40px"},children:"Upload File Columns"}),e.jsx("th",{className:"text-center",children:"Database Column Name"}),e.jsxs("th",{className:"text-center",children:["Omit",e.jsx("input",{className:"ml-2",type:"checkbox",checked:!h,onChange:w})]}),e.jsxs("th",{className:"text-center",children:["Mbtile",e.jsx("input",{className:"ml-2",type:"checkbox",checked:!g,onChange:k})]})]})}),e.jsx("tbody",{children:v.map(({key:E,col:M},_)=>{let L;Array.isArray($)&&(L=S.has(M)?[M,...$]:$);const D=c[E]?e.jsx("span",{}):e.jsx(N,{availableDbColNames:L,publishStatus:a,field:E,col:M,onChange:A=>{const T=A.target?A.target.value:A;s({type:"update_dbColName",payload:{rowIdx:_,colName:T}})}});return e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-4 text-left",children:E}),e.jsx("td",{className:"text-center  p-2",children:D}),e.jsx("td",{className:"text-center",children:e.jsx("input",{type:"checkbox",checked:c[E],disabled:L&&L.length===0,onChange:()=>{const A={...c,[E]:!c[E]};d(A);const T=Object.values(A).some(O=>O===!1);f(T),M?s({type:"update_dbColName",payload:{rowIdx:_,colName:""}}):L||s({type:"update_dbColName",payload:{rowIdx:_,colName:p[E]}})}})}),e.jsx("td",{className:"text-center",children:e.jsx("input",{type:"checkbox",checked:u[M],disabled:L&&L.length===0,onChange:()=>{const A={...u,[M]:!u[M]};m(A);const T=Object.values(A).some(O=>O===!1);y(T),s({type:"update",payload:{mbtilesOptions:{...i,preserveColumns:A}}})}})})]},E)})})]})})]})};function O_({state:t,dispatch:s}){const{damaSourceId:n,damaServerPath:r,databaseColumnNames:a,gisUploadId:l,layerName:i,layerAnalysisReady:c}=t;return b.useEffect(()=>{(async()=>{if(!c||n&&!a||!l||!i)return;const u=await(await fetch(`${r}/staged-geospatial-dataset/${l}/${i}/tableDescriptor`)).json();if(n){const m=new Set(a);for(const p of u.columnTypes)m.has(p.col)||(p.col="")}return s({type:"update",payload:{tableDescriptor:u}})})()},[c,n,a,l,i,r,s]),n&&!a?"":e.jsx(T_,{state:t,dispatch:s})}const Gu={AWAITING:{text:"Publish",color:"bg-blue-500"},IN_PROGRESS:{text:"Publishing...",color:"bg-amber-500"},PUBLISHED:{text:"Publishing...",color:"bg-amber-500"},ERROR:{text:"Error...",color:"bg-red-500"}};function D_({state:t,dispatch:s}){const{layerName:n,publishStatus:r,uploadErrMsg:a,lyrAnlysErrMsg:l,tableDescriptor:i,damaSourceName:c,damaSourceId:d,damaServerPath:u,etlContextId:m,gisUploadId:p,userId:x,email:h,customViewAttributes:f,sourceType:g,mbtilesOptions:y,useMbTiles:v}=t,{text:j,color:N}=b.useMemo(()=>I(Gu,r,Gu.AWAITING),[r]);if(!n||a||l||!i)return"";const S=()=>{(async()=>{try{s({type:"update",payload:{publishStatus:"IN_PROGRESS"}}),y&&(y!=null&&y.preserveColumns)&&(Object.keys((y==null?void 0:y.preserveColumns)||{})||[]).length?y.preserveColumns=(Object.keys((y==null?void 0:y.preserveColumns)||{})||[]).filter(D=>(y==null?void 0:y.preserveColumns[D])===!0):y.preserveColumns=[];const k={source_id:d||null,source_values:{name:c,type:g||"gis_dataset"},parent_context_id:m,user_id:x,email:h,tableDescriptor:i,gisUploadId:p,layerName:n,etlContextId:m,customViewAttributes:f,mbtilesOptions:y,useMbTiles:v},$=g==="csv_dataset"?"csv-dataset":"gis-dataset",M=await(await fetch(`${t.damaServerPath}/${$}/publish`,{method:"POST",body:JSON.stringify(k),headers:{"Content-Type":"application/json"}})).json();console.log("publishFinalEvent",M);const{etl_context_id:_,source_id:L}=M;s({type:"update",payload:{publishStatus:"PUBLISHED",damaSourceId:L,etlContextId:_}})}catch(k){s({type:"update",payload:{publishStatus:"ERROR",publishErrMsg:k.message}}),console.error("==>",k)}})()};return e.jsxs("div",{children:[e.jsx("div",{children:e.jsx("button",{className:`cursor-pointer py-4 px-8 ${N} border-none my-2`,onClick:()=>{console.log("onClick publush",r),(r==="AWAITING"||r==="ERROR")&&S()},children:j})}),e.jsx(B_,{state:t})]})}function B_({state:t}){const{etlContextId:s,publishStatus:n,publishErrMsg:r}=t;return n!=="ERROR"?"":e.jsxs("table",{className:"w-2/3",style:{margin:"40px auto",textAlign:"center",border:"1px solid",borderColor:"back"},children:[e.jsx("thead",{style:{color:"black",backgroundColor:"red",fontWeight:"bolder",textAlign:"center",marginTop:"40px",fontSize:"20px",border:"1px solid",borderColor:"black"},children:e.jsxs("tr",{children:[e.jsxs("th",{style:{border:"1px solid",borderColor:"black"},children:[" ","Publish Error"]}),e.jsxs("th",{style:{border:"1px solid",borderColor:"black"},children:[" ","ETL Context ID"]})]})}),e.jsx("tbody",{style:{border:"1px solid"},children:e.jsxs("tr",{style:{border:"1px solid"},children:[e.jsx("td",{style:{border:"1px solid",padding:"10px",backgroundColor:"white",color:"darkred"},children:r}),e.jsx("td",{style:{border:"1px solid",backgroundColor:"white"},children:s})]})})]})}const F_=()=>e.jsx(e.Fragment,{});function Yf({source:t={},user:s={},dataType:n="gis_dataset",CustomAttributes:r=F_,tippecanoeOptions:a={},customRules:l={},databaseColumnNames:i=null,useMbTiles:c=!1}){var k,$;const{name:d,source_id:u,type:m,uploadedFile:p,gisUploadId:x,analysisContextId:h}=t,{pgEnv:f,baseUrl:g,falcor:y,user:v}=C.useContext(ie),j=Le(),[N,S]=b.useReducer(C_,{damaSourceId:u,databaseColumnNames:i||(((k=t==null?void 0:t.metadata)==null?void 0:k.columns)||(t==null?void 0:t.metadata)||[]).map(E=>E.name),damaSourceName:d,userId:(s==null?void 0:s.id)??v.id,email:(s==null?void 0:s.email)??v.email,etlContextId:null,analysisContextId:h||null,customViewAttributes:{years:[]},dataType:n,damaServerPath:`${gt}/dama-admin/${f}`,gisUploadId:x||null,fileUploadStatus:null,uploadedFile:p||null,uploadErrMsg:null,processPolling:!1,processPollingInterval:null,polling:!1,pollingInterval:null,layerNames:null,layerName:null,lyrAnlysErrMsg:null,layerAnalysis:null,layerAnalysisReady:!1,analysisPolling:!1,analysisPollingInterval:null,tableDescriptor:null,mbtilesOptions:{preserveColumns:{},...a},useMbTiles:c,publishStatus:"AWAITING",publishErrMsg:null,sourceType:m});if(b.useEffect(()=>{S({type:"update",payload:{damaSourceName:d}})},[d]),b.useEffect(()=>{S({type:"update",payload:{sourceType:m}})},[m]),b.useEffect(()=>{N.publishStatus==="PUBLISHED"&&(N.damaSourceId&&N.etlContextId?y.invalidate(["dama",f,"sources","byId",N.damaSourceId,"views","length"]):y.invalidate(["dama",f,"sources","length"]),console.log("publish done",N,N.damaSourceId),j(`${g}/source/${N.damaSourceId}/uploads/${N.etlContextId}`))},[N.publishStatus,N.damaSourceId,f,j]),b.useEffect(()=>{async function E(){const _=+await(await fetch(`${N.damaServerPath}/etl/new-context-id`)).text();S({type:"update",payload:{etlContextId:_}})}N.analysisContextId||E()},[f,N.damaServerPath]),!u&&!d)return e.jsx("div",{children:" Please enter a datasource name."});const w=($=Object.keys(l))==null?void 0:$.reduce((E,M)=>(l[M](N)!=="canUpload"&&(E=l[M](N)),E),"canUpload");return e.jsxs("div",{children:[e.jsx(r,{state:N,dispatch:S}),w==="canUpload"?e.jsx(__,{state:N,dispatch:S}):w,e.jsx(E_,{state:N,dispatch:S}),e.jsx(O_,{state:N,dispatch:S}),e.jsx(D_,{state:N,dispatch:S})]})}const z_=({views:t})=>{const{viewId:s,sourceId:n,page:r}=Be(),[a]=Rt(),l=a.get("variable"),i=Le(),{baseUrl:c}=C.useContext(ie),d=l&&!s?l:s;return e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"py-3.5 px-2 text-sm text-gray-400",children:"Version:"}),e.jsx("div",{className:"flex-1",children:e.jsx("select",{className:"pl-3 pr-4 py-2.5 border border-blue-100 bg-blue-50 w-full bg-white mr-2 flex items-center justify-between text-sm",value:d,onChange:u=>i(`${c}/source/${n}/${r}/${u.target.value}`),children:t==null?void 0:t.sort((u,m)=>m.view_id-u.view_id).map((u,m)=>e.jsx("option",{className:"ml-2  truncate",value:u.view_id,children:u.version?u.version:u.view_id},m))})})]})},P_=()=>e.jsx("div",{}),R_=(t,s)=>({data:t,columns:s==null?void 0:s.map(n=>({Header:n,accessor:n}))}),Qf=({source:t,views:s,transform:n=R_,filterData:r={},TableFilter:a=P_,showViewSelector:l=!0,fullWidth:i=!1,striped:c=!1,userHighestAuth:d=0})=>{const{viewId:u}=Be(),[m,p]=b.useState(r),x=C.useCallback(A=>{p(T=>({...T,...A}))},[]),{pgEnv:h,falcor:f,falcorCache:g,user:y}=C.useContext(ie),v=C.useMemo(()=>I(s==null?void 0:s.filter(A=>A.view_id===parseInt(u)),"[0]",s[0]),[s,u]),j=C.useMemo(()=>I(v,"view_id",null),[v]);C.useEffect(()=>{console.time("getviewLength"),f.get(["dama",h,"viewsbyId",j,"data","length"]).then(A=>{console.timeEnd("getviewLength")})},[h,j]);const N=C.useMemo(()=>I(g,["dama",h,"viewsbyId",j,"data","length"],"No Length"),[h,j,g]),S=C.useMemo(()=>{let A=I(t,["metadata","columns"],I(t,"metadata",[]));return Array.isArray(A)||(A=[]),A.filter(T=>["integer","string","number"].includes(T.type)).map(T=>T.name)},[t]);C.useEffect(()=>{if(N>0){console.log("dataLength",N);let A=Math.min(N,250);console.time("getViewData",A),f.chunk(["dama",h,"viewsbyId",j,"databyIndex",Array.from(Array(A).keys()),S]).then(T=>{console.timeEnd("getViewData",A)})}},[h,j,N,S]);const w=C.useMemo(()=>{let A=Object.values(I(g,["dama",h,"viewsbyId",j,"databyIndex"],[])).map(T=>I(g,T.value,{}));return console.log("attr data from cache",A),A},[h,j,g,N]);let k=I(v,["metadata","years"],[]);console.log({tableData:w});const{data:$,columns:E}=C.useMemo(()=>n(w,S,m,k,t),[w,S,n,m,k,t]),[M,_]=C.useMemo(()=>{var T;const A=(T=E.filter(O=>O.sortBy))==null?void 0:T[0];return console.log("the col",A),[(A==null?void 0:A.accessor)||"",(A==null?void 0:A.sortBy)||"asc"]},[E]);console.log("sort",M,E);const[L,D]=C.useMemo(()=>i?[{width:"96vw",position:"relative",left:"calc(-50vw + 50%)"},"mt-2 mx-12"]:[{},"max-w-6xl"],[i]);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex",children:[e.jsx(a,{filters:m,setFilters:x,source:t,data:w,columns:E,userHighestAuth:d}),l?e.jsx(z_,{views:s}):""]}),e.jsx("div",{className:D,style:L,children:e.jsx(Dn,{striped:c,data:$,columns:E,sortBy:M,sortOrder:_,pageSize:50})})]})},H_={map:{name:"Map",path:"/map",component:y_},table:{name:"Table",path:"/table",component:Qf},sourceCreate:{name:"Create",component:Yf}},W_={table:{name:"Table",path:"/table",component:Qf},sourceCreate:{name:"Create",component:Yf}},wt={gis_dataset:H_,csv_dataset:W_};function V_(t,s){wt[t]=s}const Kf=()=>e.jsx("div",{className:"h-screen flex-1 flex flex-col text-gray-900 bg-gray-100",children:e.jsxs("div",{className:"flex-1 flex items-center justify-center flex-col",children:[e.jsx("div",{className:"text-8xl font-bold",children:"404"}),e.jsx("div",{className:"text-2xl",children:"Page not Found"}),e.jsx("div",{className:"text-2xl",children:"Oops, Something went missing..."})]})}),U_="Public",q_=({sourceAuth:t,user:s})=>{const{authUsers:n,authGroups:r}={authUsers:I(t,["users"],{}),authGroups:I(t,["groups"],{})},a=Object.keys(r).reduce((i,c)=>{let d=i;return(s.groups.includes(c)||c===U_)&&parseInt(r[c])>d&&(d=parseInt(r[c])),d},-1),l=n[s.id]??-1;return Math.max(a,l)},G_=({})=>{var $,E;const{sourceId:t,page:s,viewId:n}=Be(),[r,a]=b.useState(Qn||[]),[l,i]=b.useState(n),{pgEnv:c,baseUrl:d,falcor:u,falcorCache:m,user:p}=C.useContext(ie);b.useEffect(()=>{async function M(){try{console.log("fetching data");const _=["dama",c,"sources","byId",t,"views","length"],L=await u.get(_);return await u.get(["dama",c,"sources","byId",t,"views","byIndex",{from:0,to:I(L.json,_,0)-1},"attributes",Object.values(Ot)],["dama",c,"sources","byId",t,"attributes",Object.values(Xt)],["dama",c,"sources","byId",t,"meta"])}catch(_){console.log("e from fetching source::",_)}}M()},[t,u,c]);const x=b.useMemo(()=>Object.values(I(m,["dama",c,"sources","byId",t,"views","byIndex"],{})).map(M=>ft(I(m,M.value,{attributes:{}}).attributes)),[m,t,c]);b.useEffect(()=>{if(l&&l!==n&&i(n),!l&&x.length>0){let M=x.filter(_=>{var L;return(L=_==null?void 0:_.metadata)==null?void 0:L.authoritative}).length>0?x.filter(_=>{var L;return(L=_==null?void 0:_.metadata)==null?void 0:L.authoritative}):x;i(M.sort((_,L)=>_._created_timestamp-L._created_timestamp)[0].view_id)}},[x,n]);const h=b.useMemo(()=>{let M=ft(I(m,["dama",c,"sources","byId",t],{attributes:{}}).attributes);if(wt[M.type]){let _=Object.keys(wt[M.type]).reduce((D,A)=>((wt[M.type][A].path||A==="overview")&&(D[A]=wt[M.type][A]),D),{}),L={...Qn,..._};a(L)}else a(Qn);return M},[m,t,c]),f=($=h==null?void 0:h.statistics)==null?void 0:$.auth,[g,y]=Rt(),v=C.useCallback(M=>{const _=[];return g.forEach((L,D)=>{_.push(`${D}=${L}`)}),`${d}/source/${t}${M.path}${l&&M.path?"/"+l:""}${_.length?`?${_.join("&")}`:""}`},[d,t,l,g]),j=C.useMemo(()=>{let M=!0;return Object.keys(h).some(_=>h[_]?Object.keys(h[_]).includes("message"):!1)&&(M=!1),M},[h]),N=b.useMemo(()=>s?I(r,`[${s}].component`,r.overview.component):r.overview.component,[s,r,Qn,f]),S=q_({sourceAuth:f,user:p}),w=b.useMemo(()=>Object.keys(I(m,["dama",c,"sources","byId",t],{})).length>0,[m]),k=w?(((E=Qn[s])==null?void 0:E.authLevel)??1)<=S:!1;return!w||p.isAuthenticating?e.jsx(e.Fragment,{}):!j||!k?e.jsx(Kf,{}):e.jsxs(Ct,{baseUrl:d,children:[e.jsx(Ei,{menuItems:Object.values(r).filter(M=>{const _=(M==null?void 0:M.authLevel)||-1,L=p.authLevel||-1;return!M.hidden&&_<=L&&_<=S}).sort((M,_)=>((M==null?void 0:M.authLevel)||-1)-((_==null?void 0:_.authLevel)||-1)).map(M=>({name:M.name,path:v(M)})),themeOptions:{size:"inline"}}),e.jsx("div",{className:"w-full flex-1 bg-white shadow",children:e.jsx(N,{userHighestAuth:S,searchParams:g,setSearchParams:y,source:h,views:x,user:p,baseUrl:d,activeViewId:l})})]})},J_=({baseUrl:t})=>{const{analysisContextId:s}=Be(),[n,r]=b.useState(Object.keys(Xt).filter(d=>!["source_id","metadata","statistics"].includes(d)).reduce((d,u)=>(d[u]="",d),{})),[a,l]=b.useState(null),{pgEnv:i}=C.useContext(ie);b.useEffect(()=>{(async()=>{const u=(await Promise.all(Object.keys(wt).map(async m=>wt[m].getIsAlreadyCreated&&await wt[m].getIsAlreadyCreated(i)?null:m))).filter(Boolean).reduce((m,p)=>(m[p]=wt[p],m),{});l(u)})()},[i]);const c=b.useMemo(()=>I(a,`[${n.type}].sourceCreate.component`,()=>e.jsx("div",{})),[a,n.type]);return b.useEffect(()=>{s&&(async()=>{const u=`${gt}/dama-admin/${i}/events/query?etl_context_id=${s}&event_id=-1`,p=await(await fetch(u)).json(),x=p.find(v=>v.type==="upload:INITIAL"),{type:h,name:f}=x.payload,g=p.find(v=>v.type==="analysis:INITIAL"),{fileId:y}=g.payload;r({...n,type:h,name:f,uploadedFile:x.payload,gisUploadId:y,analysisContextId:s})})()},[s]),a===null?e.jsx("div",{children:"Requesting data types statuses"}):e.jsx("div",{children:e.jsxs(Ct,{children:[e.jsx("div",{className:"p-4 font-medium",children:" Create New Source "}),e.jsxs("div",{className:"border-t border-gray-200 px-4 py-5 sm:p-0",children:[e.jsxs("dl",{className:"sm:divide-y sm:divide-gray-200",children:[Object.keys(Xt).filter(d=>!["source_id","metadata","description","type","statistics","category","update_interval","categories","display_name"].includes(d)).map((d,u)=>e.jsx("div",{className:"flex justify-between group",children:e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 py-5",children:d}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.jsx("div",{className:"pt-3 pr-8",children:e.jsx(Ns,{className:"w-full p-2 flex-1 px-2 shadow bg-grey-50 focus:bg-blue-100  border-gray-300 ",value:I(n,d,""),onChange:m=>{r({...n,[d]:m})}})})})]})},u)),e.jsx("div",{className:"flex justify-between group",children:e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 pt-5 pb-3",children:"Data Type"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.jsx("div",{className:"pt-3 pr-8",children:e.jsxs("select",{className:"w-full bg-white p-3 flex-1 shadow bg-grey-50 focus:bg-blue-100  border-gray-300",value:I(n,"type",""),onChange:d=>{r({...n,type:d.target.value})},children:[e.jsx("option",{value:"",disabled:!0,children:"Select your option"}),Object.keys(a||[]).filter(d=>a[d].sourceCreate).map(d=>e.jsx("option",{value:d,className:"p-2",children:d},d))]})})})]})})]}),e.jsx(c,{source:n,baseUrl:t})]})]})})};async function X_({falcor:t,pgEnv:s,sourceId:n}){const r=await t.get(["dama",s,"sources","byId",n,"dependents"]),a=[],l=[];I(r,["json","dama",s,"sources","byId",n,"dependents"]).forEach(i=>{a.push(i.source_id),l.push(i.view_id)}),await t.get(["dama",s,"sources","byId",[...a,n],"attributes",["type","name","display_name"]]),await t.get(["dama",s,"views","byId",l,"attributes",["version","metadata","_modified_timestamp","last_updated"]])}const Z_=({text:t})=>{const{falcor:s,baseUrl:n,pgEnv:r,user:a}=C.useContext(ie),{sourceId:l}=Be(),i=Le();async function c(){const u=await(await fetch(`${gt}/dama-admin/${r}/deleteDamaSource`,{method:"POST",body:JSON.stringify({source_id:l,token:a.token}),headers:{"Content-Type":"application/json"}})).json();console.log("delete response",u),s.invalidate(["dama",r,"sources","length"],["dama",r,"sources","byIndex"],["dama",r,"sources","byId",l]),console.log("navigate to",n),i(n||"/")}return e.jsx("button",{className:"bg-red-50 hover:bg-red-400 hover:text-white p-2",onClick:c,children:"Confirm Delete"})},Y_=()=>e.jsxs("div",{className:"pb-4 flex justify-between",children:[e.jsx("label",{children:"No dependents found."}),e.jsx(Z_,{text:"Confirm Delete"})]});function Q_(){const{pgEnv:t,baseUrl:s,falcor:n,falcorCache:r}=C.useContext(ie),{sourceId:a}=Be();console.log("delete page",a),b.useEffect(()=>{X_({falcor:n,pgEnv:t,sourceId:a})},[a,t,n]),I(r,["dama",t,"sources","byId",a,"dependents","value"],[]);const l=I(r,["dama",t,"sources","byId",a,"attributes","name"],"");return I(r,["dama",t,"sources","byId"],{}),I(r,["dama",t,"views","byId"],{}),e.jsx("div",{children:e.jsx(Ct,{children:e.jsxs("div",{className:"w-full p-4 bg-white my-1 block border shadow",children:[e.jsxs("div",{className:"pb-4 font-bold",children:["Delete ",e.jsx("i",{children:l})]}),Y_()]})})})}const vr={collection_id:"collection_id",name:"name",description:"description",metadata:"metadata",categories:"categories",source_dependencies:"source_dependencies",user_id:"user_id",_created_timestamp:"_created_timestamp",_modified_timestamp:"_modified_timestamp"},En={symbology_id:"symbology_id",name:"name",collection_id:"collection_id",description:"description",symbology:"symbology",categories:"categories",_created_timestamp:"_created_timestamp",_modified_timestamp:"_modified_timestamp"},Qs=t=>Object.entries(t||{}).reduce((s,n)=>{const[r,a]=n;return typeof a.value<"u"?s[r]=a.value:s[r]=a,s},{}),K_=({collection:t})=>{const{pgEnv:s,baseUrl:n,falcor:r,falcorCache:a}=C.useContext(ie);return b.useEffect(()=>{async function l(){const i=["dama",s,"collections","byId",t.collection_id,"symbologies","length"],c=await r.get(i);await r.get(["dama",s,"collections","byId",t.collection_id,"symbologies","byIndex",{from:0,to:I(c.json,i,0)-1},"attributes",Object.values(En)])}l()},[r,a,t,s]),e.jsx("div",{className:"w-full p-4 bg-white my-1 hover:bg-blue-50 block border shadow flex justify-between",children:e.jsxs("div",{children:[e.jsx(ue,{to:`${n}/collection/${t.collection_id}`,className:"text-xl font-medium w-full block",children:e.jsx("span",{children:t.name})}),e.jsx("div",{children:(I(t,"categories",[])||[]).map(l=>l.map((i,c)=>e.jsx(ue,{to:`${n}collections/cat/${c>0?l[c-1]+"/":""}${i}`,className:"text-xs p-1 px-2 bg-blue-200 text-blue-600 mr-2",children:i},c)))}),e.jsx(ue,{to:`${n}/collection/${t.collection_id}`,className:"py-2 block",children:t.description})]})})},Sl=()=>{const[t,s]=b.useState(""),{cat1:n,cat2:r}=Be(),{pgEnv:a,baseUrl:l,falcor:i,falcorCache:c}=C.useContext(ie);b.useEffect(()=>{async function u(){const m=["dama",a,"collections","length"],p=await i.get(m);await i.get(["dama",a,"collections","byIndex",{from:0,to:I(p.json,m,0)-1},"attributes",Object.values(vr)])}u()},[i,a]);const d=b.useMemo(()=>Object.values(I(c,["dama",a,"collections","byIndex"],{})).map(u=>Qs(I(c,u.value,{attributes:{}}).attributes)),[c,a]);return e.jsxs(Ct,{baseUrl:l,children:[e.jsxs("div",{className:"flex py-4 justify-between	",children:[e.jsx("div",{className:"flex flex-1 mr-8",children:e.jsx("input",{className:"w-full text-lg p-2 border border-gray-300 ",placeholder:"Search existing collections...",value:t,onChange:u=>s(u.target.value)})}),e.jsx("div",{className:"flex w-36",children:e.jsxs(ue,{className:"flex items-center p-3 text-center bg-green-300 border border-green-200 shadow hover:bg-green-500 hover:text-white",to:`${l}/create/collection`,children:["Create new collection",e.jsx("i",{className:"ml-1 fad fa-plus fa-2x"})]})})]}),d.filter(u=>{let m=!0;return n&&(m=!1,(I(u,"categories",[])||[]).forEach(p=>{p[0]===n&&(!r||p[1]===r)&&(m=!0)})),m}).filter(u=>{let m=u.name+" "+I(u,"categories[0]",[]).join(" ");return!t.length>2||m.toLowerCase().includes(t.toLowerCase())}).map((u,m)=>e.jsx(K_,{collection:u,baseUrl:l},m))]})},_l=({startValue:t,attr:s,collectionId:n,type:r="text",cancel:a=()=>{}})=>{const[l,i]=b.useState(""),{pgEnv:c,baseUrl:d,falcor:u}=C.useContext(ie);b.useEffect(()=>{i(t)},[t]);const m=(p,x)=>{n&&u.set({paths:[["dama",c,"collections","byId",n,"attributes",p]],jsonGraph:{dama:{[c]:{collections:{byId:{[n]:{attributes:{[p]:x}}}}}}}}).then(h=>{a()})};return r==="textarea"?e.jsxs("div",{className:"w-full flex flex-col h-full border border-lime-300",children:[e.jsx("div",{children:e.jsx("textarea",{className:"flex-1 w-full px-2 shadow bg-blue-100 min-h-[200px] focus:ring-blue-700 focus:border-blue-500  border-gray-300 rounded-none rounded-l-md",onChange:p=>i(p.target.value),children:l})}),e.jsxs("div",{className:"flex py-2",children:[e.jsx("div",{className:"flex-1"}),e.jsx($e,{themeOptions:{size:"sm",color:"primary"},onClick:p=>m(s,l),children:" Save "}),e.jsx($e,{themeOptions:{size:"sm",color:"cancel"},onClick:p=>a(),children:" Cancel "})]})]}):e.jsxs("div",{className:"w-full flex flex-1",children:[e.jsx(Ns,{className:"flex-1 px-2 shadow bg-blue-100 focus:ring-blue-700 focus:border-blue-500  border-gray-300 rounded-none rounded-l-md",value:l,onChange:p=>i(p)}),e.jsx($e,{themeOptions:{size:"sm",color:"primary"},onClick:p=>m(s,l),children:" Save "}),e.jsx($e,{themeOptions:{size:"sm",color:"cancel"},onClick:p=>a(),children:" Cancel "})]})},eI=({collection:t,symbologies:s,activeViewId:n})=>{const[r,a]=C.useState(null),l=C.useCallback(u=>{u.stopPropagation(),a(null)},[]),{pgEnv:i,baseUrl:c,user:d}=C.useContext(ie);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:" flex flex-col md:flex-row",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between group",children:[e.jsx("div",{className:"flex-1 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:e.jsx("dd",{className:"mt-1 text-2xl text-gray-700 font-medium overflow-hidden sm:mt-0 sm:col-span-3",children:r==="name"?e.jsx("div",{className:"pt-3 pr-8",children:e.jsx(_l,{startValue:t.name,attr:"name",collectionId:t.collection_id,cancel:l})}):e.jsx("div",{className:"py-2 px-2",children:t.name})})}),d.authLevel>5?e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:u=>a(r==="name"?null:"name"),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-12 mt-3 p-2.5 rounded hover:bg-blue-500 hover:text-white "})}):""]}),e.jsxs("div",{className:"w-full pl-4 py-6 hover:py-6 sm:pl-6 flex justify-between group",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"mt-1 text-sm text-gray-500 pr-14",children:r==="description"?e.jsx(_l,{startValue:I(t,"description",""),attr:"description",type:"textarea",collectionId:t==null?void 0:t.collection_id,cancel:l}):I(t,"description",!1)||"No Description"})}),d.authLevel>5?e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:u=>a("description"),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-12  p-2 hover:bg-blue-500 rounded focus:bg-blue-700 hover:text-white "})}):""]})]}),e.jsx("div",{className:"border-t border-gray-200 px-4 py-5 sm:p-0",children:e.jsx("dl",{className:"sm:divide-y sm:divide-gray-200",children:Object.keys(vr).filter(u=>!["collection_id","metadata","description","statistics","category","display_name","name"].includes(u)).map((u,m)=>{let p=typeof t[u]=="object"?JSON.stringify(t[u]):t[u];return u==="categories"?e.jsxs("div",{className:"flex justify-between group",children:[e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 py-5",children:u}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.jsx("div",{className:"py-5 px-2 relative"})})]}),d.authLevel>5&&r!==u?e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:x=>a(u),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-12 mt-3 p-2.5 rounded hover:bg-blue-500 hover:text-white "})}):null]},u):e.jsxs("div",{className:"flex justify-between group",children:[e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 py-5",children:u}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:r===u?e.jsx("div",{className:"pt-3 pr-8",children:e.jsx(_l,{startValue:p,attr:u,collectionId:t.collection_id,cancel:l})}):e.jsx("div",{className:"py-5 px-2",children:p})})]}),d.authLevel>5?e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:x=>a(r===u?null:u),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-12 mt-3 p-2.5 rounded hover:bg-blue-500 hover:text-white "})}):""]},u)})})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-6 items-center  px-4 py-5 mr-5 sm:p-0",children:[e.jsx("div",{className:"col-span-1 text-xl text-gray-700 font-medium",children:"Symbologies:"}),e.jsx("div",{className:"col-end-7",children:e.jsxs(ue,{className:"flex items-center p-1 text-center bg-green-300 border border-green-200 shadow hover:bg-green-500 hover:text-white",to:`${c}/create/collection`,children:["Create new symbology",e.jsx("i",{className:"ml-1 fad fa-plus fa-2x"})]})}),e.jsx("div",{className:"col-span-6"})]})]})};function tI(...t){return t.filter(Boolean).join(" ")}async function sI({falcor:t,pgEnv:s,viewId:n}){const r=await t.get(["dama",s,"viewDependencySubgraphs","byViewId",n]),a=await t.get(["dama",s,"views","byId",n,"dependents"]),l=[],i=[];I(r,["json","dama",s,"viewDependencySubgraphs","byViewId",n,"dependencies"],[]).forEach(c=>{l.push(c.source_id),i.push(c.view_id)}),I(a,["json","dama",s,"views","byId",n,"dependents"],[]).forEach(c=>{l.push(c.source_id),i.push(c.view_id)}),await t.get(["dama",s,"sources","byId",l,"attributes",["type","name"]]),await t.get(["dama",s,"views","byId",[n,...i],"attributes",["version","metadata","_modified_timestamp","last_updated"]])}const nI=({startValue:t,attr:s,viewId:n,cancel:r=()=>{}})=>{const[a,l]=b.useState(""),{pgEnv:i,baseUrl:c,falcor:d}=C.useContext(ie);b.useEffect(()=>{l(t)},[t]);const u=(m,p)=>{n&&d.set({paths:[["dama",i,"views","byId",n,"attributes",m]],jsonGraph:{dama:{[i]:{views:{byId:{[n]:{attributes:{[m]:p}}}}}}}}).then(x=>{console.log("set run",x),r()})};return e.jsxs("div",{className:"w-full flex",children:[e.jsx(Ns,{className:"flex-1 px-2 shadow bg-blue-100 focus:ring-blue-700 focus:border-blue-500  border-gray-300 rounded-none rounded-l-md",value:a,onChange:m=>l(m)}),e.jsx($e,{themeOptions:{size:"sm",color:"primary"},onClick:m=>u(s,a),children:" Save "}),e.jsx($e,{themeOptions:{size:"sm",color:"cancel"},onClick:m=>r(),children:" Cancel "})]})},rI=({view:t,columns:s=null})=>{const[n,r]=C.useState(null),{pgEnv:a,baseUrl:l,user:i}=C.useContext(ie);return e.jsx("div",{className:"overflow-hidden",children:e.jsx("div",{className:"border-t border-gray-200 px-4 py-5 sm:p-0",children:e.jsx("dl",{className:"sm:divide-y sm:divide-gray-200",children:Object.keys(Ot).filter(c=>!s||s.includes(c)).filter(c=>!["view_id","source_id","description","statistics","category","table_schema","table_name","data_table","tiles_url","last_updated","view_dependencies","start_date","end_date","download_url","user_id","etl_context_id"].includes(c)).map((c,d)=>{var m;let u=typeof t[c]=="object"?JSON.stringify((m=t[c])==null?void 0:m.value):t[c];return e.jsxs("div",{className:"flex justify-between group",children:[e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 py-5",children:c}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:n===c?e.jsx("div",{className:"pt-3 pr-8",children:e.jsx(nI,{startValue:u,attr:c,viewId:t.view_id,cancel:()=>r(null)})}):e.jsx("div",{className:"py-5 px-2",children:u})})]}),i.authLevel>5?e.jsx("div",{className:"hidden group-hover:block text-blue-500 cursor-pointer",onClick:p=>r(n===c?null:c),children:e.jsx("i",{className:"fad fa-pencil absolute -ml-12 mt-3 p-2.5 rounded hover:bg-blue-500 hover:text-white "})}):""]},d)})})})})};function aI({view:t}){const{viewId:s,sourceId:n}=Be(),{pgEnv:r,baseUrl:a,user:l}=C.useContext(ie),i=()=>{(async()=>{try{const d={source_id:n,view_id:s};console.log("creating download");const m=await(await fetch(`${gt}/dama-admin/${r}/gis-dataset/createDownload`,{method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json"}})).json();console.log("createDownload",m)}catch(d){console.error("==>",d)}})()};return e.jsx("div",{className:"w-72 ",children:l.authLevel>=10?e.jsxs("div",{className:"w-full",children:[e.jsx("div",{children:" Admin Actions "}),e.jsx("div",{className:"w-full p-1 flex",children:e.jsx(ue,{className:"w-full flex-1 text-center border shadow hover:bg-blue-100 p-4",onClick:i,children:"Create Download"})}),e.jsx("div",{className:"w-full p-1 flex",children:e.jsxs(ue,{className:"w-full flex-1 text-center bg-red-100 border border-red-200 shadow hover:bg-red-400 hover:text-white p-4",to:`${a}/source/${n}/versions/${s}/delete`,children:["Delete View ",e.jsx("i",{className:"fad fa-trash"})]})})]}):""})}function oI({view:t}){var s;return(s=t==null?void 0:t.metadata)!=null&&s.download?e.jsxs("div",{className:"inline-flex rounded-md shadow-sm",children:[e.jsx("button",{type:"button",className:"relative inline-flex items-center rounded-l-md bg-white px-10 py-[12px] text-md font-semibold text-blue-700 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-10",children:"Download"}),e.jsxs(ye,{as:"div",className:"absolute ml-32 block",children:[e.jsxs(ye.Button,{className:"relative inline-flex items-center rounded-r-md bg-white px-2 py-3 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-10",children:[e.jsx("span",{className:"sr-only",children:"Open options"}),e.jsx(up,{className:"h-5 w-5","aria-hidden":"true"})]}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx(ye.Items,{className:"absolute z-20 right-0 -mr-1 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:e.jsx("div",{className:"py-1",children:Object.keys(t.metadata.download).map((n,r)=>e.jsx(ye.Item,{children:({active:a})=>e.jsx("a",{href:t.metadata.download[n].replace("$HOST",`${gt}`),className:tI(a?"bg-gray-100 text-gray-900":"text-gray-700","block px-4 py-2 text-sm"),children:n})},r))})})})]})]}):"Download Not Available"}function lI(){const{viewId:t,sourceId:s}=Be(),{pgEnv:n,baseUrl:r,falcor:a,falcorCache:l}=C.useContext(ie);b.useEffect(()=>{sI({falcor:a,pgEnv:n,viewId:t})},[t,n,a]),I(l,["dama",n,"viewDependencySubgraphs","byViewId",t,"value"],{dependencies:[]}),I(l,["dama",n,"views","byId",t,"dependents","value"],[]);const i=I(l,["dama",n,"sources","byId",s,"attributes"],{});I(l,["dama",n,"views","byId"],{});const c=I(l,["dama",n,"views","byId",t,"attributes"],{}),d=typeof(c==null?void 0:c.version)=="object"?null:c==null?void 0:c.version;return e.jsx("div",{className:"overflow-hidden flex flex-col md:flex-row",children:e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex justify-between",children:e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dd",{className:"mt-1 text-2xl text-gray-700 font-medium overflow-hidden sm:mt-0 sm:col-span-2",children:e.jsxs("div",{className:"py-2 px-2",children:[i==null?void 0:i.name," - ",d||t]})}),e.jsx("dd",{className:"sm:mt-0 sm:col-span-2",children:e.jsx(rI,{view:c,baseUrl:r})}),e.jsx(aI,{view:c})]})})})})}async function iI({falcor:t,pgEnv:s,viewId:n}){const r=await t.get(["dama",s,"views","byId",n,"dependents"],["dama",s,"views","byId",n,"attributes","source_id"]),a=[],l=[];I(r,["json","dama",s,"views","byId",n,"dependents"]).forEach(c=>{a.push(c.source_id),l.push(c.view_id)}),await t.get(["dama",s,"sources","byId",a,"attributes",["type","name"]]),await t.get(["dama",s,"views","byId",l,"attributes",["version","metadata","_modified_timestamp","last_updated"]]);const i=t.getCache();return{dependents:I(i,["dama",s,"views","byId",n,"dependents","value"],[]),sourceId:I(r,["json","dama",s,"views","byId",n,"attributes","source_id"],[]),srcMeta:I(i,["dama",s,"sources","byId"],{}),viewMeta:I(i,["dama",s,"views","byId"],{})}}const eg=({text:t,viewId:s,sourceId:n,pgEnv:r,baseUrl:a,falcor:l})=>{const i=Le();return e.jsx("button",{className:"bg-red-50 hover:bg-red-400 hover:text-white p-2",onClick:async()=>{console.log("I am deleteing the view id ",s),await fetch(`${gt}/dama-admin/${r}/deleteDamaView`,{method:"POST",body:JSON.stringify({view_id:s}),headers:{"Content-Type":"application/json"}}),await l.invalidate(["dama",r,"sources","byId",n,"views","length"]),i(`${a}/source/${n}/versions`)},children:t})},cI=({dependents:t,viewId:s,srcMeta:n,viewMeta:r})=>e.jsxs("div",{className:"w-full p-4 shadow mb-4",children:[e.jsx("label",{className:"text-lg",children:"Dependents"}),e.jsx("div",{className:"py-4 sm:py-2 mt-2 sm:grid sm:grid-cols-5 sm:gap-20 sm:px-6 border-b-2",children:["Source Name","Type","Version","Last Updated"].map(a=>e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:a},a))}),e.jsx("dl",{className:"sm:divide-y sm:divide-gray-200",children:t.map((a,l)=>e.jsxs("div",{className:"py-4 sm:py-5 sm:grid sm:grid-cols-5 sm:gap-20 sm:px-6",children:[e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:e.jsx(ue,{to:`/source/${a.source_id}/overview`,children:I(n,[a.source_id,"attributes","name"])})},`${l}_1`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:e.jsx(ue,{to:`/source/${a.source_id}/overview`,children:I(n,[a.source_id,"attributes","type"])})},`${l}_2`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:e.jsx(ue,{to:`/source/${a.source_id}/views/${a.view_id}`,children:I(r,[a.view_id,"attributes","version"])})},`${l}_3`),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 align-middle",children:e.jsx(ue,{to:`/source/${a.source_id}/views/${a.view_id}`,children:typeof I(r,[a.view_id,"attributes","_modified_timestamp","value"])=="object"?"":I(r,[a.view_id,"attributes","_modified_timestamp","value"])})},`${l}_4`),e.jsx("dd",{className:"mt-1 text-sm text-red-400 sm:mt-0",children:e.jsxs("span",{className:"float-right italic",children:[" ",I(r,[a.view_id,"attributes","metadata","value","authoritative"])==="true"?"":"outdated"]})},`${l}_5`)]},`${l}_0`))})]}),dI=(t,s,n,r,a,l,i,c)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-4 flex justify-between",children:[e.jsx("label",{children:"The View has following dependents:"}),e.jsx(eg,{text:"Delete anyway",viewId:n,sourceId:s,pgEnv:l,baseUrl:i,falcor:c})]}),e.jsx("div",{className:"bg-red-50",children:e.jsx(cI,{viewId:n,srcMeta:r,viewMeta:a,dependents:t})})]}),uI=(t,s,n,r,a)=>e.jsxs("div",{className:"pb-4 flex justify-between",children:[e.jsx("label",{children:"No dependents found."}),e.jsx(eg,{text:"Confirm Delete",viewId:t,sourceId:s,pgEnv:n,baseUrl:r,falcor:a})]});function mI(){const{sourceId:t,viewId:s}=Be(),{pgEnv:n,baseUrl:r,falcor:a,falcorCache:l}=C.useContext(ie);b.useEffect(()=>{iI({falcor:a,pgEnv:n,viewId:s})},[s,n,a]);const i=I(l,["dama",n,"views","byId",s,"dependents","value"],[]),c=I(l,["dama",n,"sources","byId"],{}),d=I(l,["dama",n,"views","byId"],{});return e.jsxs("div",{className:"w-full p-4 bg-white my-1 block border shadow",children:[e.jsxs("div",{className:"pb-4 font-bold",children:["Delete ",e.jsx("i",{children:s})]}),i.length?dI(i,t,s,c,d,n,r,a):uI(s,t,n,r,a)]})}const pI=({source:t,views:s,meta:n})=>{const{pgEnv:r,baseUrl:a,user:l}=C.useContext(ie);Le();const{sourceId:i,viewId:c,vPage:d}=Be();return d==="delete"?e.jsx(mI,{}):c?e.jsx(lI,{}):e.jsx("div",{className:"",children:e.jsx(Dn,{data:s,columns:[{Header:"Version Id",accessor:u=>e.jsxs(ue,{to:`${a}/source/${i}/versions/${u.view_id}`,children:[" ",u.version||u.view_id," "]})},{Header:"User",accessor:"user_id"},{Header:"Uploaded",accessor:u=>mc(u._created_timestamp)},{Header:" Download",accessor:u=>e.jsx(oI,{view:u}),disableFilters:!0}]})})},Gr=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:e.jsx("path",{d:"M10.5858 12L4.92898 17.6569L6.3432 19.0711L12 13.4143L17.6569 19.0711L19.0711 17.6569L13.4142 12L19.0711 6.34317L17.6569 4.92896L12 10.5858L6.34317 4.92897L4.92896 6.34319L10.5858 12Z"})}),xI=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",className:t,children:e.jsx("path",{d:"M7 0H5V5H0V7H5V12H7V7H12V5H7V0Z"})}),Ho=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 13.5C7.82843 13.5 8.5 12.8284 8.5 12C8.5 11.1716 7.82843 10.5 7 10.5C6.17157 10.5 5.5 11.1716 5.5 12C5.5 12.8284 6.17157 13.5 7 13.5ZM13.5 12C13.5 12.8284 12.8284 13.5 12 13.5C11.1716 13.5 10.5 12.8284 10.5 12C10.5 11.1716 11.1716 10.5 12 10.5C12.8284 10.5 13.5 11.1716 13.5 12ZM18.5 12C18.5 12.8284 17.8284 13.5 17 13.5C16.1716 13.5 15.5 12.8284 15.5 12C15.5 11.1716 16.1716 10.5 17 10.5C17.8284 10.5 18.5 11.1716 18.5 12Z"})}),tg=({className:t="fill-gray-900"})=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:[e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.1278 12C15.1278 13.6863 13.7274 15.0533 12 15.0533C10.2726 15.0533 8.8722 13.6863 8.8722 12C8.8722 10.3137 10.2726 8.94664 12 8.94664C13.7274 8.94664 15.1278 10.3137 15.1278 12ZM13.3717 12C13.3717 12.7395 12.7576 13.339 12 13.339C11.2424 13.339 10.6283 12.7395 10.6283 12C10.6283 11.2604 11.2424 10.6609 12 10.6609C12.7576 10.6609 13.3717 11.2604 13.3717 12Z"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 18C7.90486 18 4.40498 15.512 3 12C4.40498 8.48798 7.90475 6 11.9999 6C16.095 6 19.595 8.48798 21 12C19.595 15.512 16.0951 18 12 18ZM11.9999 7.71429C15.1026 7.71429 17.7877 9.45991 19.0808 12C17.7877 14.5401 15.1027 16.2857 12 16.2857C8.89726 16.2857 6.21206 14.5401 4.91897 12C6.21206 9.45991 8.89715 7.71429 11.9999 7.71429Z"})]}),sg=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:e.jsx("path",{d:"M3 12C3.34629 12.8656 3.81984 13.669 4.3982 14.3883L3.1051 15.6814L4.51932 17.0956L5.80754 15.8074C6.60111 16.4553 7.50288 16.9811 8.48252 17.3552L8.01453 19.1018L9.94638 19.6194L10.4142 17.8735C10.9301 17.9567 11.4599 18 12 18C12.5413 18 13.0722 17.9565 13.5892 17.873L14.0572 19.6194L15.989 19.1018L15.5207 17.354C16.4999 16.9796 17.4012 16.4537 18.1944 15.8058L19.4842 17.0956L20.8984 15.6814L19.6034 14.3863C20.181 13.6676 20.654 12.8648 21 12H19.0808C17.7877 14.5401 15.1027 16.2857 12 16.2857C8.89725 16.2857 6.21206 14.5401 4.91897 12H3Z"})}),hI=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.75146 15.1306V15.1306C6.7516 15.5448 6.41592 15.8807 6.0017 15.8808C5.58749 15.881 5.2516 15.5453 5.25146 15.1311C5.25142 14.9906 5.29183 13.8577 5.72195 12.7308C6.15161 11.6052 7.07875 10.2542 8.93625 10.2542C10.6713 10.2542 11.7208 10.8779 12.6242 11.4218L12.6343 11.4279C13.5029 11.9509 14.2064 12.3744 15.4163 12.3744C15.9048 12.3744 16.2194 12.1925 16.4573 11.9172C16.7183 11.6151 16.9063 11.1726 17.0283 10.6575C17.1484 10.1509 17.1911 9.63239 17.2023 9.23237C17.2078 9.03445 17.2055 8.87034 17.2019 8.75742C17.2001 8.70106 17.198 8.65774 17.1964 8.62967L17.1946 8.59935L17.1942 8.59372C17.1628 8.18088 17.4718 7.82024 17.8847 7.78861C18.2977 7.75696 18.6582 8.06611 18.6898 8.47911L17.942 8.53641C18.6898 8.47911 18.6898 8.47911 18.6898 8.47911L18.69 8.48178L18.6903 8.48614L18.6913 8.4998L18.6941 8.54621C18.6963 8.58534 18.6989 8.64059 18.7011 8.70969C18.7055 8.84767 18.7082 9.042 18.7017 9.27419C18.6888 9.73442 18.6397 10.3629 18.4879 11.0033C18.3382 11.6352 18.0746 12.3396 17.5923 12.8979C17.0869 13.4828 16.3665 13.8744 15.4163 13.8744C13.7881 13.8744 12.7801 13.267 11.9056 12.74C11.8871 12.7289 11.8688 12.7179 11.8505 12.7068C10.993 12.1906 10.2412 11.7542 8.93625 11.7542C8.00391 11.7542 7.46363 12.3742 7.12334 13.2657C6.95675 13.7022 6.86216 14.1544 6.80996 14.5155C6.78413 14.6942 6.76931 14.8461 6.76102 14.9566C6.75321 15.0608 6.75168 15.1221 6.75146 15.1306Z"})}),fI=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.6289 16.4087C18.7672 16.1958 18.7885 15.9274 18.6854 15.6954L14.6854 6.6954C14.5242 6.3327 14.1083 6.15839 13.7367 6.29775L5.73666 9.29775C5.44393 9.40753 5.25 9.68737 5.25 10L5.25 16C5.25 16.4142 5.58578 16.75 6 16.75L18 16.75C18.2539 16.75 18.4905 16.6216 18.6289 16.4087ZM16.8459 15.25L6.75 15.25L6.75 10.5197L13.6017 7.95038L16.8459 15.25Z"})}),gI=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 14.5C13.3807 14.5 14.5 13.3807 14.5 12C14.5 10.6193 13.3807 9.5 12 9.5C10.6193 9.5 9.5 10.6193 9.5 12C9.5 13.3807 10.6193 14.5 12 14.5ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z"})}),Wo=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",className:t,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.64645 4.64645C2.84171 4.45118 3.15829 4.45118 3.35355 4.64645L6 7.29289L8.64645 4.64645C8.84171 4.45118 9.15829 4.45118 9.35355 4.64645C9.54882 4.84171 9.54882 5.15829 9.35355 5.35355L6.35355 8.35355C6.15829 8.54882 5.84171 8.54882 5.64645 8.35355L2.64645 5.35355C2.45118 5.15829 2.45118 4.84171 2.64645 4.64645Z"})}),ws=["rgb(80, 149, 127)","rgb(159, 161, 69)","rgb(128, 182, 109)","rgb(122, 168, 36)","rgb(96, 117, 159)","rgb(55, 124, 164)","rgb(78, 139, 212)","rgb(104, 198, 222)","rgb(136, 154, 221)","rgb(143, 125, 191)","rgb(158, 101, 179)","rgb(191, 105, 162)","rgb(204, 98, 92)","rgb(235, 147, 96)","rgb(213, 176, 42)","rgb(242, 218, 58)","rgb(173, 122, 103)","rgb(130, 100, 100)","rgb(128, 128, 128)","rgb(204, 204, 204)"],Qa=t=>((!t||typeof t!="string")&&(t=ws[Vo(0,ws.length-1)]),"#"+t.match(/\d+/g).map(n=>(+n).toString(16).padStart(2,0)).join``),bI=t=>{const{style:s}=new Option;return s.color=t,s.color},wr=t=>Qa(bI(t));function yI(t,s){const n=ws[Vo(0,ws.length-1)];return[{id:t,type:"circle",layout:{visibility:"visible"},paint:{"circle-color":n,"circle-radius":4,"circle-stroke-color":gc(-.4,n),"circle-stroke-width":1},source:`${s.source}_${t}`,"source-layer":s["source-layer"]}]}function vI(t,s){const n=ws[Vo(0,ws.length-1)];return[{id:`${t}_case`,type:"line",layout:{visibility:"visible"},paint:{"line-color":gc(-.4,n),"line-width":3},source:`${s.source}_${t}`,"source-layer":s["source-layer"]},{id:t,type:"line",layout:{visibility:"visible"},paint:{"line-color":n,"line-width":3},source:`${s.source}_${t}`,"source-layer":s["source-layer"]}]}function wI(t,s){const n=ws[Vo(0,ws.length-1)];return[{id:`${t}_case`,type:"line",layout:{visibility:"visible"},paint:{"line-color":gc(-.4,n),"line-width":1},source:`${s.source}_${t}`,"source-layer":s["source-layer"]},{id:t,type:"fill",layout:{visibility:"visible"},paint:{"fill-color":n,"fill-opacity":.75},source:`${s.source}_${t}`,"source-layer":s["source-layer"]}]}const jI=(t,s)=>{const n={fill:wI,line:vI,circle:yI};return n[s==null?void 0:s.type]?n[s==null?void 0:s.type](t,s):[s]},gc=(t,i)=>{var n=parseInt,r=Math.round,[a,l,i,c]=i.split(","),u=t<0,d=u?0:t*255**2,u=u?1+t:1-t;return"rgb"+(c?"a(":"(")+r((u*n(a[3]=="a"?a.slice(5):a.slice(4))**2+d)**.5)+","+r((u*n(l)**2+d)**.5)+","+r((u*n(i)**2+d)**.5)+(c?","+c:")")};function Vo(t=0,s=100){return Math.floor(Math.random()*(s-t))+t}const CI=t=>{const s=b.useRef();return b.useEffect(()=>{s.current=t}),s.current},bc={cat1:["rgb(107, 184, 199)","rgb(229, 102, 102)","rgb(172, 114, 165)","rgb(114, 172, 120)","rgb(234, 147, 97)","rgb(166, 140, 217)","rgb(237, 190, 94)","rgb(103, 203, 148)","rgb(209, 152, 77)","rgb(168, 169, 96)"],cat2:["rgb(234, 147, 97)","rgb(136, 154, 221)","rgb(198, 150, 88)","rgb(139, 193, 168)","rgb(225, 184, 81)","rgb(206, 126, 168)","rgb(184, 203, 128)","rgb(152, 135, 196)","rgb(223, 215, 129)","rgb(148, 209, 152)"],cat3:["rgb(119, 170, 221)","rgb(238, 136, 102)","rgb(238, 221, 136)","rgb(255, 170, 187)","rgb(153, 221, 255)","rgb(68, 187, 153)","rgb(187, 204, 51)","rgb(112, 128, 207)","rgb(170, 170, 0)","rgb(170, 68, 153)"],cat4:["rgb(155, 201, 69)","rgb(138, 81, 158)","rgb(228, 136, 7)","rgb(195, 75, 143)","rgb(46, 137, 194)","rgb(60, 175, 154)","rgb(249, 122, 113)","rgb(223, 173, 22)","rgb(116, 116, 205)","rgb(179, 136, 86)"],cat5:["rgb(92, 107, 192)","rgb(255, 167, 38)","rgb(236, 64, 122)","rgb(66, 165, 245)","rgb(255, 112, 67)","rgb(102, 187, 106)","rgb(255, 213, 79)","rgb(38, 166, 154)","rgb(255, 138, 101)","rgb(126, 87, 194)"],cat6:["rgb(204, 102, 119)","rgb(51, 34, 136)","rgb(221, 204, 119)","rgb(17, 119, 51)","rgb(136, 204, 238)","rgb(136, 34, 85)","rgb(68, 170, 153)","rgb(153, 153, 51)","rgb(170, 68, 153)","rgb(238, 119, 51)"],cat7:["rgb(129, 144, 71)","rgb(93, 106, 42)","rgb(172, 114, 165)","rgb(107, 71, 128)","rgb(114, 127, 192)","rgb(76, 89, 154)","rgb(179, 126, 117)","rgb(141, 87, 78)","rgb(166, 140, 43)","rgb(76, 141, 154)"],cat8:["rgb(255, 115, 87)","rgb(255, 142, 66)","rgb(255, 173, 41)","rgb(249, 203, 21)","rgb(147, 208, 83)","rgb(40, 189, 140)","rgb(7, 166, 171)","rgb(64, 142, 191)","rgb(107, 127, 184)","rgb(138, 111, 165)"],cat9:["rgb(201, 63, 54)","rgb(219, 96, 51)","rgb(233, 125, 43)","rgb(242, 154, 38)","rgb(248, 187, 42)","rgb(191, 202, 88)","rgb(139, 179, 111)","rgb(103, 158, 125)","rgb(69, 130, 124)","rgb(40, 109, 128)"]};function ng({open:t,setOpen:s,width:n="sm:my-8 sm:w-full sm:max-w-lg sm:p-6",initialFocus:r,children:a}){return e.jsx(Oe.Root,{show:t,as:b.Fragment,children:e.jsxs(Je,{as:"div",className:"relative z-30 ",initialFocus:r,onClose:s,children:[e.jsx(Oe.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),e.jsx("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:e.jsx("div",{onClick:()=>{s(!1)},className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:e.jsx(Oe.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:e.jsx(Je.Panel,{className:`relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all ${n}`,children:a})})})})]})})}function NI({open:t,setOpen:s}){var x;const n=b.useRef(null),{pgEnv:r,falcor:a,baseUrl:l}=C.useContext(ie),{state:i}=C.useContext(Ee),{collectionId:c}=Be(),d=Le(),[u,m]=C.useState({name:"",loading:!1}),p=async()=>{var y;const h={name:u.name,collection_id:c,description:"map",symbology:{layers:{}}};console.log("newSymbology",h);let f=await a.call(["dama","symbology","symbology","create"],[r,h]),g=((y=Object.keys(I(f,["json","dama",r,"symbologies","byId"],{})))==null?void 0:y[0])||!1;await a.invalidate(["dama",r,"collections","byId",c,"symbologies","length"]),console.log("created symbology",f,g),g&&(s(!1),d(`${l}/collection/${c}/mapeditor/${g}`))};return e.jsxs(ng,{open:t,setOpen:s,initialFocus:n,children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fad fa-layer-group text-blue-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:[e.jsx(Je.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Create New Map"}),e.jsx("div",{className:"mt-2 w-full",children:e.jsx("input",{value:u.name,onChange:h=>m({...i,name:h.target.value}),className:"p-2 bg-slate-100 text-lg font-medium w-full",placeholder:"Map Name"})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{type:"button",disabled:u.loading||((x=u.name)==null?void 0:x.length)<4,className:"disabled:bg-slate-300 disabled:cursor-warning inline-flex w-full justify-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 sm:ml-3 sm:w-auto",onClick:p,children:["Creat",u.loading?"ing...":"e"]}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>s(!1),ref:n,children:"Cancel"})]})]})}function kI({button:t}){const{state:s,setState:n,symbologies:r,collection:a}=C.useContext(Ee),{baseUrl:l}=C.useContext(ie),[i,c]=C.useState(!1),d=Le();return e.jsxs("div",{children:[e.jsx(NI,{open:i,setOpen:c}),e.jsxs(ye,{as:"div",className:"relative inline-block text-left",children:[e.jsx(ye.Button,{children:t}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx(ye.Items,{className:"absolute z-40 -left-[238px]  w-[270px] origin-top-right divide-y divide-gray-100 bg-slate-100 shadow-lg ring-1 ring-black/5 focus:outline-none",children:e.jsxs("div",{className:"px-1 py-1 ",children:[e.jsx(ye.Item,{children:({active:u})=>e.jsx("div",{onClick:()=>c(!0),className:`${u?"bg-blue-50 ":""} group flex w-full items-center hover:bg-pink-100 text-slate-600 rounded-md px-2 py-2 text-sm`,children:"New Map"})}),e.jsx("div",{className:"w-full border"}),r.map(u=>e.jsx(ye.Item,{children:e.jsx("div",{onClick:()=>d(`${l}/collection/${a.collection_id}/mapeditor/${u.symbology_id}`),className:"group flex w-full items-center hover:bg-pink-100 text-slate-600 rounded-md px-2 py-2 text-sm",children:u.name})},u.symbology_id))]})})})]})]})}function $I({button:t}){const{state:s,setState:n}=C.useContext(Ee);return e.jsxs(ye,{as:"div",className:"relative inline-block text-left",children:[e.jsx(ye.Button,{children:t}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx(ye.Items,{className:"absolute right-0 w-36 origin-top-right divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none",children:e.jsx("div",{className:" py-1 ",children:e.jsx(ye.Item,{children:({active:r})=>e.jsx("div",{className:`${r?"bg-pink-50 ":""} group flex w-full items-center text-red-400 rounded-md px-2 py-2 text-sm`,onClick:()=>{},children:"Delete"})})})})})]})}function SI(){const{state:t,setState:s}=C.useContext(Ee);return e.jsx("div",{className:"p-1",children:e.jsxs("div",{className:"flex bg-slate-100 border border-transparent hover:border-slate-300 group rounded-md shadow-sm ring-1 ring-inset ring-slate-100 focus-within:ring-2 focus-within:ring-inset focus-within:ring-pink-600 sm:max-w-md",children:[e.jsx("input",{type:"text",className:"block w-[220px] flex-1 outline-0  bg-transparent p-2 text-slate-800 placeholder:text-gray-400  focus:border-0  sm:leading-6",placeholder:"Select / Create New Map",value:t.name,onChange:n=>s(r=>{r.name=n.target.value})}),t.symbology_id&&e.jsx("div",{className:"flex items-center pt-1.5",children:e.jsx($I,{button:e.jsx(Ho,{className:"cursor-pointer fill-none group-hover:fill-gray-400 group-hover:hover:fill-pink-700"})})}),e.jsx("div",{className:"flex items-center ",children:e.jsx(kI,{button:e.jsxs("div",{className:"flex items-center p-2  border-2 border-transparent h-10  hover fill-slate-400 hover:fill-slate-800 cursor-pointer",children:[" ",e.jsx(Wo,{className:""})," "]})})})]})})}const _I=({source:t,selectedSource:s,setSource:n,cat1:r,setCat1:a})=>{const{pgEnv:l,baseUrl:i,falcor:c,falcorCache:d}=C.useContext(ie),u=s.viewId,m=(s==null?void 0:s.sourceId)===t.source_id,p=["dama",l,"sources","byId",t.source_id,"views","length"],x=b.useMemo(()=>parseInt(I(d,p,0)),[d]);b.useEffect(()=>{async function f(){const g=await c.get(p);await c.get(["dama",l,"sources","byId",t.source_id,"views","byIndex",{from:0,to:I(g.json,p,0)-1},"attributes",Object.values(Ot)])}f()},[c,d,t,l]);const h=b.useMemo(()=>Object.values(I(d,["dama",l,"sources","byId",t.source_id,"views","byIndex"],{})).map(f=>{var g;return ft((g=I(d,f.value,{}))==null?void 0:g.attributes)}).sort((f,g)=>new Date(g==null?void 0:g._modified_timestamp)-new Date(f==null?void 0:f._modified_timestamp)),[d]);return e.jsxs("div",{children:[e.jsx("div",{className:`w-full p-4 ${m?"bg-blue-100 hover:bg-blue-200":"bg-white hover:bg-blue-50"} block border shadow flex`,onClick:()=>{if(s.sourceId!==t.source_id){const f={...t,add:!0,sourceId:t.source_id};x===1&&h.length===1&&(f.viewId=h[0].view_id),n(f)}else n({...di,add:!0})},children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-medium w-full block",children:e.jsx("span",{children:t.name})}),e.jsx("div",{children:(I(t,"categories",[])||[]).map(f=>(typeof f=="string"?[f]:f).map((g,y)=>{const v=g===r;let j="bg-blue-100 text-blue-400 hover:bg-blue-400";return(m||v)&&(j="bg-blue-300 text-blue-500 hover:bg-blue-400",m&&v&&(j="bg-blue-400 text-blue-600 hover:bg-blue-500")),e.jsx("div",{onClick:N=>{N.stopPropagation(),a(v?"":g)},className:`inline hover:cursor-pointer text-xs p-1 px-2 ${j}  mr-2`,children:g},y)}))}),e.jsx("div",{className:"py-2 block",children:t.description})]})}),m&&e.jsx("div",{className:"bg-gray-200 shadow",children:h.map(f=>{const g=u===f.view_id;return e.jsxs("div",{onClick:()=>{n(g?{...s,viewId:void 0}:{...s,viewId:f.view_id})},className:`flex items-center ${g?"bg-gray-300 hover:bg-gray-400":"hover:bg-gray-300"} px-2`,children:[e.jsx("div",{className:"mx-2",children:f.version??f.view_id}),g&&e.jsx(_i,{className:"ml-2 text-green-700 h-4 w-4"})]},f.view_id)})})]})},II=({selectedSource:t,setSource:s})=>{var S,w;const[n,r]=b.useState(""),[a,l]=b.useState(),[i,c]=b.useState(),{pgEnv:d,baseUrl:u,falcor:m,falcorCache:p}=C.useContext(ie),[x,h]=b.useState("asc"),f="Unknown",g=((w=(S=window.location.pathname.replace(`${u}/`,""))==null?void 0:S.split("/"))==null?void 0:w[0])==="listall";b.useEffect(()=>{async function k(){const $=["dama",d,"sources","length"],E=await m.get($);await m.get(["dama",d,"sources","byIndex",{from:0,to:I(E.json,$,0)-1},"attributes",Object.values(Xt)])}k()},[m,d]);const y=b.useMemo(()=>Object.values(I(p,["dama",d,"sources","byIndex"],{})).map(k=>ft(I(p,k.value,{attributes:{}}).attributes)),[p,d]),v=[...new Set(y.filter(k=>{var $;return g||!g&&!(($=k.categories)!=null&&$.find(E=>E.includes(f)))}).reduce((k,$)=>{var E;return[...k,...((E=$.categories)==null?void 0:E.map(M=>M[0]))||[]]},[]))].sort(),j=v.reduce((k,$)=>{var E;return k[$]=(E=y.filter(M=>{var _;return(_=M.categories)==null?void 0:_.find(L=>L.includes($))}))==null?void 0:E.length,k},{}),N="bg-transparent hover:bg-blue-100 rounded-sm p-2 ml-0.5 border-2";return e.jsxs(Ct,{baseUrl:u,isListAll:g,hideBreadcrumbs:!0,children:[e.jsxs("div",{className:"py-4 flex flex-rows items-center",children:[e.jsx("input",{className:"w-full text-lg p-2 border border-gray-300 ",placeholder:"Search datasources",value:n,onChange:k=>r(k.target.value)}),e.jsx("button",{className:N,title:"Toggle Sort",onClick:()=>h(x==="asc"?"desc":"asc"),children:e.jsx("i",{className:`fa-solid ${x==="asc"?"fa-arrow-down-z-a":"fa-arrow-down-a-z"} text-xl text-blue-400`})}),e.jsx("div",{onClick:()=>{l(""),r("")},className:N,title:g?"View Key Sources":"View All Sources",children:e.jsx("i",{className:`fa-solid ${g?"fa-filter-list":"fa-list-ul"} text-xl text-blue-400`})})]}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx("div",{className:"w-1/4 flex flex-col space-y-1.5 max-h-[80dvh] overflow-auto scrollbar-sm",children:(v||[]).filter(k=>k!==f).sort((k,$)=>k.localeCompare($)).map(k=>e.jsxs("div",{className:`${a===k||i===k?"bg-blue-100 hover:bg-blue-200":"bg-white hover:bg-blue-50"}  hover:cursor-pointer p-2 rounded-md flex items-center`,onClick:()=>{l(k===a?"":k)},children:[e.jsx("i",{className:"fa fa-category"}),k,e.jsx("div",{className:"bg-blue-200 text-blue-600 text-xs w-5 h-5 ml-2 shrink-0 grow-0 rounded-lg flex items-center justify-center border border-blue-300",children:j[k]})]},k))}),e.jsx("div",{className:"w-3/4 flex flex-col space-y-1.5 ml-1.5 max-h-[80dvh] overflow-auto scrollbar-sm",children:y.filter(k=>{var $;return g||!g&&!(($=k.categories)!=null&&$.find(E=>E.includes(f)))}).filter(k=>{let $=!0;return a&&($=!1,(I(k,"categories",[])||[]).forEach(E=>{E[0]===a&&(!i||E[1]===i)&&($=!0)})),$}).filter(k=>{let $=k.name+" "+((k==null?void 0:k.categories)||[]).reduce((E,M)=>(E+=Array.isArray(M)?M.join(" "):typeof M=="string"?M:"",E),"");return!n.length>2||$.toLowerCase().includes(n.toLowerCase())}).sort((k,$)=>{var M;return(x==="asc"?1:-1)*((M=k.name)==null?void 0:M.localeCompare($.name))}).map((k,$)=>e.jsx(_I,{cat1:a,setCat1:l,source:k,baseUrl:u,selectedSource:t,setSource:s},$))})]})]})},di={active:!1,sourceId:null,viewId:null,add:!1};function LI(){const{state:t,setState:s}=C.useContext(Ee),{pgEnv:n,baseUrl:r,falcor:a,falcorCache:l}=C.useContext(ie),[i,c]=C.useState(di);b.useEffect(()=>{async function x(){const h=["dama",n,"sources","length"],f=await a.get(h);await a.get(["dama",n,"sources","byIndex",{from:0,to:I(f.json,h,0)-1},"attributes",Object.values(Xt)])}x()},[a,n]);const d=b.useMemo(()=>Object.values(I(l,["dama",n,"sources","byIndex"],{})).map(x=>ft(I(l,x.value,{attributes:{}}).attributes)),[l,n]);b.useEffect(()=>{async function x(){const{sourceId:h}=i,f=["dama",n,"sources","byId",h,"views","length"],g=await a.get(f);return await a.get(["dama",n,"sources","byId",h,"views","byIndex",{from:0,to:I(g.json,f,0)-1},"attributes",Object.values(Ot)])}i.sourceId&&x()},[i.sourceId,a,n]);const u=b.useMemo(()=>Object.values(I(l,["dama",n,"sources","byId",i.sourceId,"views","byIndex"],{})).map(x=>ft(I(l,x.value,{attributes:{}}).attributes)),[l,i.sourceId,n]);b.useMemo(()=>{var x;return((x=t.symbology)==null?void 0:x.layers)||[]},[t.symbology]);const m=()=>{var v,j,N,S,w,k,$,E,M;const x=((v=d.filter(_=>_.source_id===+i.sourceId))==null?void 0:v[0])||{},h=((j=u.filter(_=>_.view_id===+i.viewId))==null?void 0:j[0])||{},f=Math.random().toString(36).replace(/[^a-z]+/g,""),g=(w=(S=(N=h==null?void 0:h.metadata)==null?void 0:N.tiles)==null?void 0:S.layers)==null?void 0:w[0],y={id:f,name:`${x.display_name||x.name} ${h.version||h.view_id}`,source_id:x.source_id,view_id:i.viewId,"layer-type":"simple",type:g.type,sources:((($=(k=h==null?void 0:h.metadata)==null?void 0:k.tiles)==null?void 0:$.sources)||[]).map(_=>{const L={..._};return L.id=`${_.id}_${f}`,L}),layers:jI(f,g),isVisible:!0,order:((M=Object.keys(((E=t==null?void 0:t.symbology)==null?void 0:E.layers)||{}))==null?void 0:M.length)||0};s(_=>{var L;_!=null&&_.symbology||(_.symbology={}),(L=_==null?void 0:_.symbology)!=null&&L.layers||(_.symbology.layers={}),K(_,`symbology.layers[${f}]`,y)}),c({add:!1,sourceId:null,viewId:null})},p=(i==null?void 0:i.sourceId)&&(i==null?void 0:i.viewId);return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"p-1 rounded hover:bg-slate-100 m-1",onClick:()=>c({...i,add:!i.add}),children:i.add?e.jsx(Gr,{className:"fill-slate-500"}):e.jsx(xI,{className:"fill-slate-500"})}),e.jsxs(ng,{open:i.add,setOpen:()=>c({...i,add:!i.add}),width:"w-[1200px]",children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fad fa-layer-group text-blue-600","aria-hidden":"true"})}),e.jsx("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:e.jsx(Je.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Create New Map"})})]}),e.jsx("div",{className:"mt-2 w-full max-h-[calc(100vh_-_200px)]",children:e.jsx(II,{selectedSource:i,setSource:c})}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex justify-end",children:[e.jsx("div",{className:"mr-1",children:e.jsx($e,{type:"button",themeOptions:{color:"cancel"},className:"inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>c({...di}),children:"Cancel"})}),e.jsx("div",{children:e.jsx($e,{type:"button",themeOptions:p?{color:"primary"}:{color:"transparent"},disabled:!p,className:"inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>m(),children:"Add layer"})})]})]})]})}const EI={fill:fI,circle:gI,line:hI};function yc({layer:t,button:s,location:n="left-0"}){const{state:r,setState:a}=C.useContext(Ee);return e.jsxs(ye,{as:"div",className:"relative inline-block text-left",children:[e.jsx(ye.Button,{children:s}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx(ye.Items,{className:`absolute ${n} mt-1 w-36 origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none`,children:e.jsxs("div",{className:"px-1 py-1 ",children:[e.jsx(ye.Item,{children:({active:l})=>e.jsx("div",{className:`${l?"bg-blue-50 ":""} group flex w-full items-center text-slate-600 rounded-md px-2 py-2 text-sm`,children:"Zoom to Fit"})}),e.jsx(ye.Item,{children:({active:l})=>e.jsx("div",{className:`${l?"bg-pink-50 ":""} group flex w-full items-center text-red-400 rounded-md px-2 py-2 text-sm`,onClick:()=>{a(i=>{delete i.symbology.layers[t.id],Object.values(i.symbology.layers).sort((c,d)=>c.order-d.order).forEach((c,d)=>c.order=d)})},children:"Remove"})})]})})})]})}function MI({index:t,layer:s,i:n}){const{state:r,setState:a}=C.useContext(Ee),{activeLayer:l}=r.symbology,i=()=>{a(u=>{u.symbology.activeLayer=l===s.id?"":s.id})},c=EI[s.type]||e.jsx("span",{}),d=s.visible;return e.jsxs("div",{className:`w-full ${l==s.id?"bg-pink-100":""} p-2 py-1 flex border-white/85 border hover:border-pink-500 group items-center`,children:[e.jsx("div",{className:"px-1",children:e.jsx(c,{className:"fill-slate-400"})}),e.jsx("div",{onClick:i,className:"text-sm text-slate-600 font-medium truncate flex-1",children:s.name}),e.jsx("div",{className:"text-sm pt-1 px-0.5 flex items-center",children:e.jsx(yc,{layer:s,button:e.jsx(Ho,{className:` ${l==s.id?"fill-pink-100":"fill-white"} cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`})})}),e.jsx("div",{onClick:()=>{a(u=>{u.symbology.layers[s.id].visible=!u.symbology.layers[s.id].visible})},children:d?e.jsx(tg,{className:` ${l==s.id?"fill-pink-100":"fill-white"} cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`}):e.jsx(sg,{className:` ${l==s.id?"fill-pink-100":"fill-white"} cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`})})]})}function AI(t){const{state:s,setState:n}=C.useContext(Ee),r=b.useMemo(()=>{var l;return((l=s.symbology)==null?void 0:l.layers)||{}},[s]),a=C.useCallback((l,i)=>{n(c=>{const d=Object.values(c.symbology.layers);let u=Object.values(c.symbology.layers).length-1,m=u-l,p=u-i;const[x]=d.splice(m,1);d.splice(p,0,x),d.forEach((h,f)=>{h.order=f}),c.symbology.layers=d.reduce((h,f)=>(h[f.id]=f,h),{})})},[]);return e.jsx(e.Fragment,{children:e.jsx("div",{className:"min-h-20 relative",children:e.jsx(Qt,{onDrop:a,offset:{x:16,y:45},children:Object.values(r).sort((l,i)=>i.order-l.order).map((l,i)=>e.jsx(MI,{layer:l,i},l.id))})})})}function TI({layer:t}){const{state:s,setState:n}=C.useContext(Ee),{activeLayer:r}=s.symbology,a=t.isVisible;return e.jsx("div",{onClick:()=>{n(l=>{l.symbology.layers[t.id].isVisible=!l.symbology.layers[t.id].isVisible,l.symbology.layers[t.id].layers.forEach((i,c)=>{let u=I(s,`symbology.layers[${t.id}].layers[${c}].layout.visibility`,"")==="visible"?"none":"visible";l.symbology.layers[t.id].layers[c].layout={visibility:u}})})},children:a?e.jsx(tg,{className:` ${r==t.id?"fill-pink-100":"fill-white"} cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`}):e.jsx(sg,{className:` ${r==t.id?"fill-pink-100":"fill-white"} cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`})})}const Mn={fill:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-4 rounded ",style:{backgroundColor:s}})}),circle:({layer:t,color:s})=>{let n=I(t,"layers[0].paint['circle-stroke-color']","#ccc");return e.jsx("div",{className:"pl-0.5 pr-2",children:e.jsx("div",{className:"w-3 h-3 rounded-full ",style:{backgroundColor:s,borderColor:n}})})},line:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-1",style:{backgroundColor:s}})})},jr={fill:t=>I(t,"layers[1].paint['fill-color']","#ccc"),circle:t=>I(t,"layers[0].paint['circle-color']","#ccc"),line:t=>I(t,"layers[1].paint['line-color']","#ccc")};function OI({layer:t}){const s=Mn[t.type]||Mn.fill;let n=(t==null?void 0:t["legend-data"])||[];return typeof jr[t.type](t)=="object"&&jr[t.type](t),(!n||n.length===0)&&(n=[]),e.jsx("div",{className:"w-full max-h-[250px] overflow-x-auto",children:n.map((r,a)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-pink-50",children:[e.jsx("div",{className:"flex items-center h-6 w-10 justify-center  ",children:e.jsx(s,{color:r.color})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-500 h-6 text-sm truncate",children:r.label})]},a))})}function DI({layer:t}){const{state:s,setState:n}=C.useContext(Ee);let{choroplethdata:r,legenddata:a}=b.useMemo(()=>({choroplethdata:I(t,"['choropleth-data']",[]),legenddata:I(t,"['legend-data']",[])}),[s]);const l=Mn[t.type]||Mn.fill;let i=typeof jr[t.type](t)=="object"?jr[t.type](t):[];const c=Math.max(...r);return(!a||a.length===0)&&(a=[...(i||[]).filter((d,u)=>u>2).map((d,u)=>u%2===1?{color:i[u+1],label:`${i[u+2]} - ${i[u+4]||c}`}:null).filter(d=>d)]),e.jsx("div",{className:"w-full max-h-[250px] overflow-x-auto scrollbar-sm",children:a.map((d,u)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-pink-50",children:[e.jsx("div",{className:"flex items-center h-6 w-10 justify-center  ",children:e.jsx(l,{color:d.color})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-500 h-6 text-sm truncate",children:d.label})]},u))})}function BI({index:t,layer:s,i:n}){const{state:r,setState:a}=C.useContext(Ee),{activeLayer:l}=r.symbology,i=()=>{a(m=>{m.symbology.activeLayer=l===s.id?"":s.id})},c=Mn[s.type]||Mn.fill;let d=jr[s.type](s);const u=s["layer-type"];return e.jsxs("div",{onClick:i,className:`${l==s.id?"bg-pink-100":""} hover:border-pink-500 group border`,children:[e.jsxs("div",{className:"w-full  p-2 py-1 flex border-blue-50/50 border  items-center",children:[(u==="simple"||!u)&&e.jsx("div",{className:"px-1",children:e.jsx(c,{layer:s,color:d})}),e.jsx("div",{className:"text-sm text-slate-600 font-medium truncate flex-1",children:s.name}),e.jsx("div",{className:"text-sm pt-1 px-0.5 flex items-center",children:e.jsx(yc,{layer:s,button:e.jsx(Ho,{className:` ${l==s.id?"fill-pink-100":"fill-white"} cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`})})}),e.jsx(TI,{layer:s})]}),u==="categories"&&e.jsx(OI,{layer:s}),u==="choropleth"&&e.jsx(DI,{layer:s})]})}function FI(t){const{state:s,setState:n}=C.useContext(Ee),r=b.useMemo(()=>{var l;return((l=s.symbology)==null?void 0:l.layers)||{}},[s]),a=C.useCallback((l,i)=>{n(c=>{const d=Object.values(c.symbology.layers);let u=Object.values(c.symbology.layers).length-1,m=u-l,p=u-i;const[x]=d.splice(m,1);d.splice(p,0,x),d.forEach((h,f)=>{h.order=f}),c.symbology.layers=d.reduce((h,f)=>(h[f.id]=f,h),{})})},[]);return e.jsx(e.Fragment,{children:e.jsx("div",{className:"min-h-20 relative max-h-[calc(100vh_-_220px)] overflow-x-auto scrollbar-sm ",children:e.jsx(Qt,{onDrop:a,offset:{x:16,y:45},children:Object.values(r).sort((l,i)=>i.order-l.order).map((l,i)=>e.jsx(BI,{layer:l,i},l.id))})})})}function zI(){const{state:t}=C.useContext(Ee),s=["Legend","Layers"];return e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-white/95 w-[340px] rounded-lg drop-shadow-lg pointer-events-auto min-h-[400px] max-h-[calc(100vh_-_111px)] scroll-xs",children:[e.jsx(SI,{}),t.symbology_id&&e.jsxs(Te.Group,{children:[e.jsxs("div",{className:"flex justify-between items-center border-b",children:[e.jsx(Te.List,{children:s.map(n=>e.jsx(Te,{as:b.Fragment,children:({selected:r})=>e.jsx("button",{className:`
                        ${r?"text-slate-600 border-b font-medium border-slate-600":"text-slate-400"} mx-1 text-sm p-2 cursor-pointer
                      `,children:n})},n))}),e.jsx(LI,{})]}),e.jsxs(Te.Panels,{children:[e.jsx(Te.Panel,{children:e.jsx(FI,{})}),e.jsx(Te.Panel,{children:e.jsx(AI,{})})]})]})]})})}const rg={fill:[{label:"Type",type:"inline",controls:[{type:"selectType",params:{options:[{name:"Simple",value:"simple"},{name:"Categories",value:"categories"},{name:"Color Range",value:"choropleth"}]},path:"['layer-type']",datapath:"layers[1].paint['fill-color']"}]},{label:"Color By",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth"]},controls:[{type:"selectViewColumn",params:{options:[{name:"Column Select",value:"simple"}]},path:"['data-column']"}]},{label:"Categories",type:"popover",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoryControl",params:{options:[{name:"Column Select",value:"simple"}],format:t=>`${((t==null?void 0:t.length)-3||0)/2||"10"} Categories`},path:"layers[1].paint['fill-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoricalColor",path:"['color-set']"}]},{label:"Scale",type:"popover",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"choroplethControl",params:{format:t=>`${((t==null?void 0:t.length)-3||0)/2||"10"} Categories`},path:"layers[1].paint['fill-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"rangeColor",path:"['color-range']"}]},{label:"Fill",type:"popover",conditional:{path:"['layer-type']",conditions:["simple"]},controls:[{type:"color",path:"layers[1].paint['fill-color']"}]},{label:"Stroke",type:"popover",controls:[{type:"color",path:"layers[0].paint['line-color']"},{type:"range",unit:"px",path:"layers[0].paint['line-width']",params:{min:"0",max:"10",step:"0.5",default:"3",units:"px"}}]},{label:"Opacity",type:"inline",controls:[{type:"range",unit:"%",path:"layers[1].paint['fill-opacity']",params:{min:"0",max:"1",step:"0.01",default:"0.75",units:"%",format:t=>Math.round(t*100)}}]}],circle:[{label:"Type",type:"inline",controls:[{type:"selectType",params:{options:[{name:"Simple",value:"simple"},{name:"Categories",value:"categories"},{name:"Color Range",value:"choropleth"}]},path:"['layer-type']",datapath:"layers[0].paint['circle-color']"}]},{label:"Color By",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth"]},controls:[{type:"selectViewColumn",params:{options:[{name:"Column Select",value:"simple"}]},path:"['data-column']",datapath:"['category-data']"}]},{label:"Categories",type:"popover",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoryControl",params:{options:[{name:"Column Select",value:"simple"}],format:t=>`${((t==null?void 0:t.length)||0)/2||"10"} Categories`},path:"layers[0].paint['circle-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoricalColor",path:"['color-set']"}]},{label:"Scale",type:"popover",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"choroplethControl",params:{format:t=>`${((t==null?void 0:t.length)-3||0)/2||"10"} Categories`},path:"layers[1].paint['circle-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"rangeColor",path:"['color-range']"}]},{label:"Fill",type:"popover",conditional:{path:"['layer-type']",conditions:["simple"]},controls:[{type:"color",path:"layers[0].paint['circle-color']"}]},{label:"Size",type:"inline",controls:[{type:"range",unit:"%",path:"layers[0].paint['circle-radius']",params:{min:"0",max:"20",step:"0.5",default:"3",units:"px"}}]},{label:"Stroke",type:"popover",controls:[{type:"color",path:"layers[0].paint['circle-stroke-color']"},{type:"range",unit:"px",path:"layers[0].paint['circle-stroke-width']",params:{min:"0",max:"20",step:"0.5",default:"3",units:"px"}}]},{label:"Opacity",type:"inline",controls:[{type:"range",unit:"%",path:"layers[0].paint['circle-opacity']",params:{min:"0",max:"1",step:"0.01",default:"0.75",units:"%",format:t=>Math.round(t*100)}}]}],line:[{label:"Type",type:"inline",controls:[{type:"selectType",params:{options:[{name:"Simple",value:"simple"},{name:"Categories",value:"categories"},{name:"Color Range",value:"choropleth"}]},path:"['layer-type']",datapath:"layers[1].paint['line-color']"}]},{label:"Color By",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth"]},controls:[{type:"selectViewColumn",params:{options:[{name:"Column Select",value:"simple"}]},path:"['data-column']",datapath:"['category-data']"}]},{label:"Categories",type:"popover",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoryControl",params:{options:[{name:"Column Select",value:"simple"}],format:t=>`${((t==null?void 0:t.length)-3||0)/2||"10"} Categories`},path:"layers[1].paint['line-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoricalColor",path:"['color-set']"}]},{label:"Scale",type:"popover",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"choroplethControl",params:{format:t=>`${((t==null?void 0:t.length)-3||0)/2||"10"} Categories`},path:"layers[1].paint['line-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"rangeColor",path:"['color-range']"}]},{label:"Fill",type:"popover",conditional:{path:"['layer-type']",conditions:["simple"]},controls:[{type:"color",path:"layers[1].paint['line-color']"}]},{label:"Size",type:"inline",controls:[{type:"range",unit:"%",path:"layers[1].paint['line-width']",params:{min:"0",max:"20",step:"0.5",default:"3",units:"px"}}]},{label:"Offset",type:"inline",controls:[{type:"range",unit:"%",path:"layers[1].paint['line-offset']",params:{min:"-10",max:"10",step:"0.5",default:"0",units:"px"}}]},{label:"Casing",type:"popover",controls:[{type:"color",path:"layers[0].paint['line-color']"},{type:"range",unit:"px",path:"layers[0].paint['line-width']",params:{min:"0",max:"20",step:"0.5",default:"3",units:"px"}},{type:"range",unit:"px",path:"layers[0].paint['line-offset']",params:{min:"-10",max:"10",step:"0.5",default:"0",units:"px"}}]},{label:"Opacity",type:"inline",controls:[{type:"range",unit:"%",path:"layers[1].paint['line-opacity']",params:{min:"0",max:"1",step:"0.01",default:"0.75",units:"%",format:t=>Math.round(t*100)}}]}]};function PI(t,s,n,r=10,a="#ccc",l){var m,p;let i=JSON.parse(((p=((m=l.filter(x=>x.name===t))==null?void 0:m[0])||{})==null?void 0:p.meta_lookup)||"{}"),d=["match",["to-string",["get",(t||"").includes("AS ")?t.split("AS ")[1]:t]]];Array.from(Array(+r).keys()).forEach((x,h)=>{var g,y;let f=""+((g=s==null?void 0:s[h])==null?void 0:g[t]);f&&f!="[object Object]"&&(d.push(""+((y=s==null?void 0:s[h])==null?void 0:y[t])),d.push(wr(n[h%n.length])))}),d.push(a);const u=(d||[]).filter((x,h)=>h>2).map((x,h)=>h%2===0?{color:x,label:I(i,d[h+2],d[h+2])}:null).filter(x=>x);return{paint:d,legend:u}}function RI(t){let s=typeof t=="object"&&Array.isArray(t);return s&&(t.forEach(n=>{(!n||n==="undefined")&&(s=!1)}),s)}let HI={ckmeans:Xa,equalInterval:kS,jenks:Xa,pretty:$S},WI=(t,s=2)=>(n=>Math.round(t*n)/n)(Math.pow(10,s));function VI(t,s,n,r=10,a="ckmeans"){let l=["step",["get",t]];if(!Array.isArray(s))return!1;let i=HI[a](s,r).map(u=>WI(u,2));const c=Math.max(...s);if(!Array.isArray(i)||i.length===0)return!1;console.log("max",c),i.forEach((u,m)=>{l.push(n[m]),l.push(+u)}),l.push(n[r-1]);const d=[...(l||[]).filter((u,m)=>m>2).map((u,m)=>m%2===1?{color:l[m+1],label:`${Ju(l[m+2])} - ${Ju(l[m+4]||c)}`}:null).filter(u=>u)];return console.log("legend",d),{paint:l,legend:d}}const Ju=(t,s=2,n=!1)=>t>=1e12?`${n?"$":""} ${(t/1e12).toFixed(s)} T`:t>=1e9?`${n?"$":""} ${(t/1e9).toFixed(s)} B`:t>=1e6?`${n?"$":""} ${(t/1e6).toFixed(s)} M`:t>=1e3?`${n?"$":""} ${(t/1e3).toFixed(s)} K`:typeof t=="object"?"":`${n?"$":""} ${parseInt(t)}`,kt={seq1:{2:["#f7e76e","#ce141f"],3:["#f7e76e","#ec962a","#ce141f"],4:["#f7e76e","#f1b33d","#e5751d","#ce141f"],5:["#f7e76e","#f3c048","#ec962a","#e1631a","#ce141f"],6:["#f7e76e","#f4c94f","#efa835","#e88321","#de581a","#ce141f"],7:["#f7e76e","#f4ce54","#f1b33d","#ec962a","#e5751d","#dc501a","#ce141f"],8:["#f7e76e","#f5d157","#f2bb43","#eea331","#e98823","#e36b1b","#da491b","#ce141f"],9:["#f7e76e","#f5d45a","#f3c048","#f0ac38","#ec962a","#e77e1f","#e1631a","#d9451b","#ce141f"]},seq2:{2:["#fde89b","#4d53b3"],3:["#fde89b","#f37b8a","#4d53b3"],4:["#fde89b","#ff9e81","#d4629b","#4d53b3"],5:["#fde89b","#ffb080","#f37b8a","#bd5aa4","#4d53b3"],6:["#fde89b","#ffbc82","#fe8f83","#e36a94","#ad57a9","#4d53b3"],7:["#fde89b","#ffc385","#ff9e81","#f37b8a","#d4629b","#a056ac","#4d53b3"],8:["#fde89b","#ffc887","#ffa880","#fb8985","#e86f91","#c85da0","#9755ad","#4d53b3"],9:["#fde89b","#ffcc88","#ffb080","#ff9582","#f37b8a","#de6797","#bd5aa4","#9055af","#4d53b3"]},seq3:{2:["#f2e68c","#035d6d"],3:["#f2e68c","#59a884","#035d6d"],4:["#f2e68c","#87bf84","#319082","#035d6d"],5:["#f2e68c","#a0ca84","#59a884","#1f837f","#035d6d"],6:["#f2e68c","#afd084","#74b684","#409984","#147b7d","#035d6d"],7:["#f2e68c","#bad485","#87bf84","#59a884","#319082","#0e767b","#035d6d"],8:["#f2e68c","#c2d785","#95c584","#6cb284","#479e84","#268881","#097379","#035d6d"],9:["#f2e68c","#c8d986","#a0ca84","#7bb984","#59a884","#3a9683","#1f837f","#077078","#035d6d"]},seq4:{2:["#e8e873","#4b5899"],3:["#e8e873","#2cbaa8","#4b5899"],4:["#e8e873","#62d198","#209eb0","#4b5899"],5:["#e8e873","#84d98c","#2cbaa8","#2d8eaf","#4b5899"],6:["#e8e873","#98dd85","#4ac9a0","#1caaae","#3483ad","#4b5899"],7:["#e8e873","#a5e081","#62d198","#2cbaa8","#209eb0","#397cab","#4b5899"],8:["#e8e873","#afe17e","#75d691","#41c5a2","#1eafad","#2795af","#3d77a9","#4b5899"],9:["#e8e873","#b6e27c","#84d98c","#53cc9d","#2cbaa8","#1ca5af","#2d8eaf","#3f74a8","#4b5899"]},seq5:{2:["#f3cdb4","#c33c3c"],3:["#f3cdb4","#dd8a6c","#c33c3c"],4:["#f3cdb4","#e5a182","#d57259","#c33c3c"],5:["#f3cdb4","#e8ac8d","#dd8a6c","#d16651","#c33c3c"],6:["#f3cdb4","#eab395","#e29879","#d87c61","#ce5e4c","#c33c3c"],7:["#f3cdb4","#ecb79a","#e5a182","#dd8a6c","#d57259","#cc5949","#c33c3c"],8:["#f3cdb4","#edba9d","#e7a788","#e09475","#da8064","#d36b54","#cb5547","#c33c3c"],9:["#f3cdb4","#eebda0","#e8ac8d","#e39b7c","#dd8a6c","#d7785e","#d16651","#ca5246","#c33c3c"]},seq6:{2:["#f6e389","#cd4c71"],3:["#f6e389","#f49566","#cd4c71"],4:["#f6e389","#f7af6b","#ec7b66","#cd4c71"],5:["#f6e389","#f8bc70","#f49566","#e66e68","#cd4c71"],6:["#f6e389","#f8c474","#f6a568","#ef8566","#e26769","#cd4c71"],7:["#f6e389","#f8c976","#f7af6b","#f49566","#ec7b66","#df626b","#cd4c71"],8:["#f6e389","#f8cd79","#f8b76d","#f6a067","#f18a66","#e87467","#dd5f6b","#cd4c71"],9:["#f6e389","#f8d07a","#f8bc70","#f7a869","#f49566","#ee8166","#e66e68","#db5c6c","#cd4c71"]},seq7:{2:["#f2e9a6","#344e31"],3:["#f2e9a6","#8a9968","#344e31"],4:["#f2e9a6","#abb47c","#6b8055","#344e31"],5:["#f2e9a6","#bcc186","#8a9968","#5d734c","#344e31"],6:["#f2e9a6","#c6c98c","#9da974","#778a5c","#546b46","#344e31"],7:["#f2e9a6","#cdce90","#abb47c","#8a9968","#6b8055","#4e6643","#344e31"],8:["#f2e9a6","#d3d293","#b4bb81","#98a570","#7c8e60","#637850","#4b6340","#344e31"],9:["#f2e9a6","#d6d596","#bcc186","#a2ad77","#8a9968","#73865a","#5d734c","#48603e","#344e31"]},seq8:{2:["#d2e2a6","#096b6d"],3:["#d2e2a6","#6ba888","#096b6d"],4:["#d2e2a6","#8cbc91","#4d9480","#096b6d"],5:["#d2e2a6","#9dc596","#6ba888","#3e897b","#096b6d"],6:["#d2e2a6","#a7cb98","#7fb48d","#599c83","#358379","#096b6d"],7:["#d2e2a6","#aecf9b","#8cbc91","#6ba888","#4d9480","#2f7f77","#096b6d"],8:["#d2e2a6","#b3d29c","#95c193","#79b08c","#5e9f85","#448e7d","#2a7c76","#096b6d"],9:["#d2e2a6","#b7d49d","#9dc596","#84b78f","#6ba888","#549982","#3e897b","#277a75","#096b6d"]},seq9:{2:["#ebdbad","#27859c"],3:["#ebdbad","#7eb699","#27859c"],4:["#ebdbad","#a2c39a","#5ba79b","#27859c"],5:["#ebdbad","#b4ca9c","#7eb699","#4b9f9c","#27859c"],6:["#ebdbad","#c0cd9e","#93be99","#68ad9a","#429a9c","#27859c"],7:["#ebdbad","#c7d0a0","#a2c39a","#7eb699","#5ba79b","#3c979d","#27859c"],8:["#ebdbad","#ccd1a1","#adc79b","#8dbc99","#6eb099","#51a29b","#38949d","#27859c"],9:["#ebdbad","#d0d2a3","#b4ca9c","#99c099","#7eb699","#63ab9a","#4b9f9c","#35929d","#27859c"]},seq10:{2:["#d0f0da","#274c72"],3:["#d0f0da","#609fa8","#274c72"],4:["#d0f0da","#82bab7","#438398","#274c72"],5:["#d0f0da","#95c8bf","#609fa8","#387590","#274c72"],6:["#d0f0da","#a0d0c4","#74afb1","#4e8e9f","#336d8b","#274c72"],7:["#d0f0da","#a8d5c7","#82bab7","#609fa8","#438398","#306887","#274c72"],8:["#d0f0da","#aed9ca","#8dc2bb","#6eabae","#5393a1","#3d7b94","#2e6484","#274c72"],9:["#d0f0da","#b2dccc","#95c8bf","#79b3b3","#609fa8","#4a8a9c","#387590","#2c6182","#274c72"]},seq11:{2:["#ffcdc6","#513a8d"],3:["#f3c0b9","#bd6f95","#513a8d"],4:["#f3c0b9","#d3899c","#a15991","#513a8d"],5:["#f3c0b9","#dc96a1","#bd6f95","#915090","#513a8d"],6:["#f3c0b9","#e19ea5","#cb7e99","#ad6293","#864a90","#513a8d"],7:["#f3c0b9","#e5a4a8","#d3899c","#bd6f95","#a15991","#7f478f","#513a8d"],8:["#f3c0b9","#e7a8aa","#d8909f","#c77a98","#b26593","#985491","#79458f","#513a8d"],9:["#f3c0b9","#e8abac","#dc96a1","#ce829a","#bd6f95","#a95e92","#915090","#75438f","#513a8d"]},seq12:{2:["#e9c5ed","#663b91"],3:["#e9c5ed","#aa7dbd","#663b91"],4:["#e9c5ed","#bf94cc","#9466ae","#663b91"],5:["#e9c5ed","#caa0d4","#aa7dbd","#895ba7","#663b91"],6:["#e9c5ed","#d0a7d9","#b78bc6","#9d6fb4","#8255a2","#663b91"],7:["#e9c5ed","#d4acdc","#bf94cc","#aa7dbd","#9466ae","#7d509f","#663b91"],8:["#e9c5ed","#d7b0df","#c59bd1","#b387c4","#a173b6","#8e60aa","#7a4d9d","#663b91"],9:["#e9c5ed","#dab2e1","#caa0d4","#ba8ec9","#aa7dbd","#996cb2","#895ba7","#784b9c","#663b91"]},div1:{2:["#2b8bab","#dc565f"],3:["#2b8bab","#eff4c8","#dc565f"],4:["#2b8bab","#a4d5b5","#e8c68b","#dc565f"],5:["#2b8bab","#7fc4b2","#eff4c8","#e7ac74","#dc565f"],6:["#2b8bab","#69bab1","#c2e2ba","#e9d9a2","#e79c6a","#dc565f"],7:["#2b8bab","#5cb2b1","#a4d5b5","#eff4c8","#e8c68b","#e69165","#dc565f"],8:["#2b8bab","#52adb0","#8fccb3","#cfe7bd","#eae1ac","#e7b87d","#e58962","#dc565f"],9:["#2b8bab","#4ca9b0","#7fc4b2","#b7ddb8","#eff4c8","#e9d299","#e7ac74","#e58360","#dc565f"]},div2:{2:["#448480","#c54b3e"],3:["#448480","#f9dd35","#c54b3e"],4:["#448480","#a0b169","#e9932f","#c54b3e"],5:["#448480","#a0b169","#f9dd35","#e9932f","#c54b3e"],6:["#448480","#82a373","#bec05c","#f0ac30","#e07b31","#c54b3e"],7:["#448480","#82a373","#bec05c","#f9dd35","#f0ac30","#e07b31","#c54b3e"],8:["#448480","#729b77","#a0b169","#cdc755","#f2b830","#e9932f","#db6e32","#c54b3e"],9:["#448480","#729b77","#a0b169","#cdc755","#f9dd35","#f2b830","#e9932f","#db6e32","#c54b3e"]},div3:{3:["#3166aa","#efefef","#c73d4b"],4:["#3166aa","#b6bfd9","#eab7b5","#c73d4b"],5:["#3166aa","#98a8cd","#efefef","#e49a99","#c73d4b"],6:["#3166aa","#869ac6","#cdd2e2","#edcdcc","#e08989","#c73d4b"],7:["#3166aa","#7a91c1","#b6bfd9","#efefef","#eab7b5","#dc7d7e","#c73d4b"],8:["#3166aa","#718bbe","#a5b2d2","#d7dbe6","#eed7d6","#e7a6a5","#da7576","#c73d4b"],9:["#3166aa","#6a86bc","#98a8cd","#c4cbde","#efefef","#ecc5c4","#e49a99","#d86e71","#c73d4b"]},div4:{2:["#518646","#d74528"],3:["#518646","#f8dea0","#d74528"],4:["#518646","#a6b26e","#e8995b","#d74528"],5:["#518646","#a6b26e","#f8dea0","#e8995b","#d74528"],6:["#518646","#8ba35d","#c1c07e","#eeb072","#e38042","#d74528"],7:["#518646","#8ba35d","#c1c07e","#f8dea0","#eeb072","#e38042","#d74528"],8:["#518646","#7d9c56","#a6b26e","#cfc887","#f0bc7e","#e8995b","#e07339","#d74528"],9:["#518646","#7d9c56","#a6b26e","#cfc887","#f8dea0","#f0bc7e","#e8995b","#e07339","#d74528"]},div5:{2:["#59a1a6","#a67b30"],3:["#59a1a6","#f5f5a3","#a67b30"],4:["#59a1a6","#a8cba4","#cdb769","#a67b30"],5:["#59a1a6","#a8cba4","#f5f5a3","#cdb769","#a67b30"],6:["#59a1a6","#8ebda5","#c2d9a4","#dacb7c","#c0a356","#a67b30"],7:["#59a1a6","#8ebda5","#c2d9a4","#f5f5a3","#dacb7c","#c0a356","#a67b30"],8:["#59a1a6","#81b6a5","#a8cba4","#cee0a4","#e1d685","#cdb769","#b9994c","#a67b30"],9:["#59a1a6","#81b6a5","#a8cba4","#cee0a4","#f5f5a3","#e1d685","#cdb769","#b9994c","#a67b30"]},div6:{2:["#8b4583","#4a6147"],3:["#8b4583","#f9f2bf","#4a6147"],4:["#8b4583","#c29ba1","#9ea781","#4a6147"],5:["#8b4583","#c29ba1","#f9f2bf","#9ea781","#4a6147"],6:["#8b4583","#b07e97","#d4b8ab","#bcbf95","#818f6d","#4a6147"],7:["#8b4583","#b07e97","#d4b8ab","#f9f2bf","#bcbf95","#818f6d","#4a6147"],8:["#8b4583","#a77092","#c29ba1","#ddc6b0","#cbcc9f","#9ea781","#738363","#4a6147"],9:["#8b4583","#a77092","#c29ba1","#ddc6b0","#f9f2bf","#cbcc9f","#9ea781","#738363","#4a6147"]},schemeGroups:{sequential:["seq1","seq2","seq3","seq4","seq5","seq6","seq7","seq8","seq9","seq10","seq11","seq12"],singlehue:[],diverging:["div1","div2","div3","div4","div5","div6"]}};function ag({button:t,children:s}){const{state:n,setState:r}=C.useContext(Ee);return e.jsxs(ye,{as:"div",className:"relative inline-block text-left w-full",children:[e.jsx(ye.Button,{className:"w-full",children:t}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx(ye.Items,{className:"absolute -right-[10px] w-[226px] max-h-[400px] overflow-auto py-2 origin-top-right divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none z-20",children:s})})]})}function UI({path:t,datapath:s,params:n={}}){var E,M;const{state:r,setState:a}=C.useContext(Ee),{falcor:l,falcorCache:i,pgEnv:c}=C.useContext(ie);let{value:d,viewId:u,sourceId:m,paintValue:p,column:x,categories:h,categorydata:f,choroplethdata:g,colors:y,colorrange:v,numCategories:j,numbins:N,method:S,showOther:w}=b.useMemo(()=>({value:I(r,`symbology.layers[${r.symbology.activeLayer}].${t}`,{}),viewId:I(r,`symbology.layers[${r.symbology.activeLayer}].view_id`),sourceId:I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`),paintValue:I(r,`symbology.layers[${r.symbology.activeLayer}].${s}`,{}),column:I(r,`symbology.layers[${r.symbology.activeLayer}]['data-column']`,""),categories:I(r,`symbology.layers[${r.symbology.activeLayer}]['categories']`,{}),categorydata:I(r,`symbology.layers[${r.symbology.activeLayer}]['category-data']`,{}),choroplethdata:I(r,`symbology.layers[${r.symbology.activeLayer}]['choropleth-data']`,{}),colors:I(r,`symbology.layers[${r.symbology.activeLayer}]['color-set']`,bc.cat1),colorrange:I(r,`symbology.layers[${r.symbology.activeLayer}]['color-range']`,kt.seq1[9]),numbins:I(r,`symbology.layers[${r.symbology.activeLayer}]['num-bins']`,9),method:I(r,`symbology.layers[${r.symbology.activeLayer}]['bin-method']`,"ckmeans"),numCategories:I(r,`symbology.layers[${r.symbology.activeLayer}]['num-categories']`,10),showOther:I(r,`symbology.layers[${r.symbology.activeLayer}]['category-show-other']`,"#ccc")}),[r]);b.useEffect(()=>{m&&l.get(["dama",c,"sources","byId",m,"attributes","metadata"])},[m]);const k=b.useMemo(()=>{let _=I(i,["dama",c,"sources","byId",m,"attributes","metadata","value","columns"],[]);return _.length===0&&(_=I(i,["dama",c,"sources","byId",m,"attributes","metadata","value"],[])),_},[m,i]),$=b.useMemo(()=>{const _=(k==null?void 0:k.length)>0,L=k.reduce((D,A)=>(["integer","number"].includes(A.type)&&(D=!0),D),!1);return[{name:"Simple",value:"simple"},_?{name:"Categories",value:"categories"}:null,L?{name:"Color Range",value:"choropleth"}:null].filter(D=>D)},[k]);return C.useEffect(()=>{if(d==="categories"){let{paint:_,legend:L}=h!=null&&h.paint?h:PI(x,f,y,j,w,k);RI(_)&&!Ae(_,p)&&a(D=>{K(D,`symbology.layers[${r.symbology.activeLayer}].${s}`,_),K(D,`symbology.layers[${r.symbology.activeLayer}]['legend-data']`,L)})}else if(d==="choropleth"){let{paint:_,legend:L}=VI(x,g,v,N,S);_&&!Ae(_,p)&&a(D=>{K(D,`symbology.layers[${r.symbology.activeLayer}].${s}`,_),K(D,`symbology.layers[${r.symbology.activeLayer}]['legend-data']`,L)})}else d==="simple"&&typeof p!="string"&&a(_=>{K(_,`symbology.layers[${r.symbology.activeLayer}].${s}`,Qa(null))})},[d,x,f,y,j,w,g,v,N,S]),e.jsx("label",{className:"flex w-full",children:e.jsx("div",{className:"flex w-full items-center",children:e.jsx("select",{className:"w-full p-2 bg-transparent",value:I(r,`symbology.layers[${r.symbology.activeLayer}].${t}`,n.default||((M=(E=n==null?void 0:n.options)==null?void 0:E[0])==null?void 0:M.value)),onChange:_=>a(L=>{K(L,`symbology.layers[${r.symbology.activeLayer}].${t}`,_.target.value)}),children:($||[]).map((_,L)=>e.jsx("option",{value:_.value,children:_.name},L))})})})}function qI({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ee);return e.jsxs("label",{className:"flex",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("input",{type:"color",value:wr(I(n,`symbology.layers[${n.symbology.activeLayer}].${t}`,"#ccc")),onChange:a=>r(l=>{K(l,`symbology.layers[${n.symbology.activeLayer}].${t}`,a.target.value)})})}),e.jsx("div",{className:"flex items-center p-2",children:"Custom "})]})}function GI({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ee),a=i=>i,l=(s==null?void 0:s.format)||a;return e.jsxs("div",{className:"flex w-full  items-center",children:[e.jsx("div",{className:"flex-1 flex w-full",children:e.jsx("input",{className:'w-full flex-1 accent-slate-600 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700">',type:"range",min:s.min||"0",max:s.max||"1",step:s.step||"0.01",value:I(n,`symbology.layers[${n.symbology.activeLayer}].${t}`,s.default||"1"),onChange:i=>r(c=>{K(c,`symbology.layers[${n.symbology.activeLayer}].${t}`,+i.target.value)})})}),e.jsx("div",{className:"pl-2",children:e.jsx("input",{className:"w-14 px-2 py-1 bg-transparent",value:`${l(I(n,`symbology.layers[${n.symbology.activeLayer}].${t}`,s.default||"1"))}${s.units?s.units:""}`,onChange:()=>{}})})]})}function JI({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ee);return e.jsx("label",{className:"flex",children:e.jsx("div",{className:"flex items-center",children:e.jsx("input",{className:"w-full",type:"text",value:I(n,`symbology.layers[${n.symbology.activeLayer}].${t}`,(s==null?void 0:s.default)??"#ccc"),onChange:a=>r(l=>{K(l,`symbology.layers[${n.symbology.activeLayer}].${t}`,a.target.value)})})})})}function og({path:t,params:s={}}){var a,l;const{state:n,setState:r}=C.useContext(Ee);return e.jsx("label",{className:"flex w-full",children:e.jsx("div",{className:"flex w-full items-center",children:e.jsx("select",{className:"w-full py-2 bg-transparent",value:I(n,`symbology.layers[${n.symbology.activeLayer}].${t}`,s.default||((l=(a=s==null?void 0:s.options)==null?void 0:a[0])==null?void 0:l.value)),onChange:i=>r(c=>{K(c,`symbology.layers[${n.symbology.activeLayer}].${t}`,i.target.value)}),children:((s==null?void 0:s.options)||[]).map((i,c)=>e.jsx("option",{value:i.value,children:i.name},c))})})})}function XI({path:t,datapath:s,params:n={}}){const{state:r,setState:a}=C.useContext(Ee),{falcor:l,falcorCache:i,pgEnv:c}=C.useContext(ie),{layerType:d,viewId:u,sourceId:m}=b.useMemo(()=>({layerType:I(r,`symbology.layers[${r.symbology.activeLayer}]['layer-type']`),viewId:I(r,`symbology.layers[${r.symbology.activeLayer}].view_id`),sourceId:I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`)}),[r]),p=b.useMemo(()=>I(r,`symbology.layers[${r.symbology.activeLayer}].${t}`,null),[r]);b.useEffect(()=>{m&&l.get(["dama",c,"sources","byId",m,"attributes","metadata"])},[m]);const x=b.useMemo(()=>{let h=I(i,["dama",c,"sources","byId",m,"attributes","metadata","value","columns"],[]);return h.length===0&&(h=I(i,["dama",c,"sources","byId",m,"attributes","metadata","value"],[])),h},[m,i]);return b.useEffect(()=>{if(p&&d==="categories"){const h=JSON.stringify({groupBy:[p.split("AS ")[0]],exclude:{[p.split("AS ")[0]]:["null"]},orderBy:{2:"desc"}});l.get(["dama",c,"viewsbyId",u,"options",h,"databyIndex",{from:0,to:100},[p,"count(1)::int as count"]])}},[p]),b.useEffect(()=>{if(p&&d==="categories"){const h=JSON.stringify({groupBy:[p.split("AS ")[0]],exclude:{[p.split("AS ")[0]]:["null"]},orderBy:{2:"desc"}});let f=I(i,["dama",c,"viewsbyId",u,"options",h,"databyIndex"],{});a(g=>{K(g,`symbology.layers[${r.symbology.activeLayer}]['category-data']`,f)})}},[p,i]),b.useEffect(()=>{p&&d==="choropleth"&&(async()=>{const f=JSON.stringify({exclude:{[p]:["null"]}}),g=await l.get(["dama",c,"viewsbyId",u,"options",f,"length"]);let y=I(g,["json","dama",c,"viewsbyId",u,"options",f,"length"],0);y>0&&l.get(["dama",c,"viewsbyId",u,"options",f,"databyIndex",{from:0,to:y-1},p])})()},[p]),b.useEffect(()=>{if(d==="choropleth"){const h=JSON.stringify({exclude:{[p]:["null"]}});let f=Object.values(I(i,["dama",c,"viewsbyId",u,"options",h,"databyIndex"],{})).map((g,y)=>g[p]||null).filter(g=>g).sort((g,y)=>g-y);a(g=>{K(g,`symbology.layers[${r.symbology.activeLayer}]['choropleth-data']`,f)})}},[p,i]),e.jsx("label",{className:"flex w-full",children:e.jsx("div",{className:"flex w-full items-center",children:e.jsx("select",{className:"w-full p-2 bg-transparent",value:p,onChange:h=>a(f=>{let g=I(r,`symbology.layers[${r.symbology.activeLayer}].sources[0].source.tiles[0]`,"no source tiles").split("?")[0];g!=="no source tiles"&&K(f,`symbology.layers[${r.symbology.activeLayer}].sources[0].source.tiles[0]`,g+`?cols=${h.target.value}`),K(f,`symbology.layers[${r.symbology.activeLayer}].categories`,{}),K(f,`symbology.layers[${r.symbology.activeLayer}].${t}`,h.target.value)}),children:(x||[]).filter(h=>!(d==="choropleth"&&!["integer","number"].includes(h.type))).filter(h=>!["wkb_geometry"].includes(h.name)).map((h,f)=>e.jsx("option",{value:h.name,children:h.display_name||h.name},f))})})})}function ZI({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ee);let a=I(n,`symbology.layers[${n.symbology.activeLayer}]['range-key']`,kt.schemeGroups.sequential[0]),l=I(n,`symbology.layers[${n.symbology.activeLayer}]['num-bins']`,9),i=I(n,`symbology.layers[${n.symbology.activeLayer}].${t}`,kt[a][l]);return e.jsx("div",{className:"flex w-full items-center",children:e.jsxs(ag,{button:e.jsxs("div",{className:"flex items-center w-full cursor-pointer flex-1",children:[e.jsx("div",{className:"flex-1 flex justify-center ",children:(i.map?i:[]).map((c,d)=>e.jsx("div",{className:"flex-1 h-4",style:{backgroundColor:c}},d))}),e.jsx("div",{className:"flex items-center px-1 border-2 border-transparent h-8  hover fill-slate-400 hover:fill-slate-800 cursor-pointer",children:e.jsx(Wo,{className:""})})]}),children:[e.jsx(ye.Item,{className:"z-20",children:e.jsx("div",{className:"px-4 font-semibold text-sm text-slate-600",children:"SEQUENTIAL"})}),[...kt.schemeGroups.sequential,...kt.schemeGroups.singlehue].map(c=>e.jsx(ye.Item,{className:"z-20",children:({active:d})=>e.jsxs("div",{className:`${d?"bg-blue-50 ":""} flex`,children:[e.jsx("div",{className:"w-4 h-4"}),e.jsx("div",{className:"flex-1 flex w-full p-2",onClick:()=>r(u=>{K(u,`symbology.layers[${n.symbology.activeLayer}].${t}`,kt[c][l]),K(u,`symbology.layers[${n.symbology.activeLayer}]['range-key']`,c)}),children:kt[c][l].map((u,m)=>e.jsx("div",{className:"flex-1 h-4",style:{backgroundColor:u}},m))})]})},c)),e.jsx(ye.Item,{className:"z-20",children:e.jsx("div",{className:"px-4 font-semibold text-sm text-slate-600",children:"Diverging"})}),kt.schemeGroups.diverging.map(c=>e.jsx(ye.Item,{className:"z-20",children:({active:d})=>e.jsxs("div",{className:`${d?"bg-blue-50 ":""} flex`,children:[e.jsx("div",{className:"w-4 h-4"}),e.jsx("div",{className:"flex-1 flex w-full p-2",onClick:()=>r(u=>{K(u,`symbology.layers[${n.symbology.activeLayer}].${t}`,kt[c][l]),K(u,`symbology.layers[${n.symbology.activeLayer}]['range-key']`,c)}),children:kt[c][l].map((u,m)=>e.jsx("div",{className:"flex-1 h-4",style:{backgroundColor:u}},m))})]})},c))]})})}function YI({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ee);let a=bc,l=I(n,`symbology.layers[${n.symbology.activeLayer}].${t}`,a.cat1);return e.jsx("div",{className:"flex w-full items-center",children:e.jsx(ag,{button:e.jsxs("div",{className:"flex items-center w-full cursor-pointer flex-1",children:[e.jsx("div",{className:"flex-1 flex justify-center ",children:(l.map?l:[]).map((i,c)=>e.jsx("div",{className:"w-4 h-4",style:{backgroundColor:i}},c))}),e.jsx("div",{className:"flex items-center px-1 border-2 border-transparent h-8  hover fill-slate-400 hover:fill-slate-800 cursor-pointer",children:e.jsx(Wo,{className:""})})]}),children:Object.keys(a).map(i=>e.jsx(ye.Item,{className:"z-20",children:({active:c})=>e.jsxs("div",{className:`${c?"bg-blue-50 ":""} flex`,children:[e.jsx("div",{className:"w-4 h-4"}),e.jsx("div",{className:"flex-1 flex w-full p-2",onClick:()=>r(d=>{K(d,`symbology.layers[${n.symbology.activeLayer}].${t}`,a[i])}),children:a[i].map((d,u)=>e.jsx("div",{className:"w-4 h-4",style:{backgroundColor:d}},u))})]})},i))})})}function QI({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ee),{falcor:a,falcorCache:l,pgEnv:i}=C.useContext(ie);let{value:c,column:d,categorydata:u,colors:m,sourceId:p}=b.useMemo(()=>({sourceId:I(n,`symbology.layers[${n.symbology.activeLayer}].source_id`),value:I(n,`symbology.layers[${n.symbology.activeLayer}].${t}`,{}),column:I(n,`symbology.layers[${n.symbology.activeLayer}]['data-column']`,""),categorydata:I(n,`symbology.layers[${n.symbology.activeLayer}]['category-data']`,{}),colors:I(n,`symbology.layers[${n.symbology.activeLayer}]['color-set']`,bc.cat1)}),[n]);const[x,h]=C.useState();b.useEffect(()=>{p&&a.get(["dama",i,"sources","byId",p,"attributes","metadata"])},[p]);const f=b.useMemo(()=>{var S,w;let N=I(l,["dama",i,"sources","byId",p,"attributes","metadata","value","columns"],[]);return N.length===0&&(N=I(l,["dama",i,"sources","byId",p,"attributes","metadata","value"],[])),JSON.parse(((w=((S=N.filter(k=>k.name===d))==null?void 0:S[0])||{})==null?void 0:w.meta_lookup)||"{}")},[p,l]),g=b.useMemo(()=>Object.values(u).reduce((N,S)=>(typeof S[d]!="object"&&N++,N),0),[u]),y=(Array.isArray(c)?c:[]).filter((N,S)=>S>2).map((N,S)=>S%2===0?{color:N,label:c[S+2]}:null).filter(N=>N),v=eL(Object.values(u).filter(N=>typeof N[d]!="object").map(N=>N[d]),y.map(N=>N.label)).map(N=>({label:N,value:N})),j=I(n,`symbology.layers[${n.symbology.activeLayer}]['category-show-other']`,"#ccc")==="#ccc";return e.jsxs("div",{className:" w-full items-center",children:[x!==void 0&&e.jsx(e.Fragment,{children:e.jsxs("label",{className:"flex",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("input",{type:"color",value:wr(I(n,`symbology.layers[${n.symbology.activeLayer}].categories.legend[${x}].color`,m[x%m.length])),onChange:N=>{const S=[...c],w=[...y];w[x].color=N.target.value;const k=S.indexOf(w[x].label);S.splice(k+1,1,N.target.value),r($=>{K($,`symbology.layers[${n.symbology.activeLayer}].categories`,{paint:S,legend:w.map(E=>({color:E.color,label:I(f,E.label,E.label)}))})})}})}),e.jsxs("div",{className:"flex items-center p-2",children:["Custom color for ",y[x].label," "]})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Showing"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsxs("select",{className:"w-full p-2 bg-transparent text-slate-700 text-sm",value:y.length,onChange:N=>r(S=>{K(S,`symbology.layers[${n.symbology.activeLayer}].['num-categories']`,N.target.value),K(S,`symbology.layers[${n.symbology.activeLayer}].categories`,{})}),children:[e.jsxs("option",{value:y.length,children:[y.length," Categories"]},"def"),[10,20,30,50,100].filter(N=>N<g&&N!==y.length).map((N,S)=>e.jsxs("option",{value:N,children:[N," Categories"]},S))]})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Show Other"}),e.jsx("div",{className:"flex items-center",children:e.jsxs(sn,{checked:j,onChange:()=>{r(N=>{const S=I(n,`symbology.layers[${n.symbology.activeLayer}]['category-show-other']`,"#ccc")==="#ccc"?"rgba(0,0,0,0)":"#ccc";K(N,`symbology.layers[${n.symbology.activeLayer}]['category-show-other']`,S)})},className:`${j?"bg-blue-500":"bg-gray-200"} relative inline-flex h-4 w-8 items-center rounded-full `,children:[e.jsx("span",{className:"sr-only",children:"Show other"}),e.jsx("div",{className:`${j?"translate-x-5":"translate-x-0"} inline-block h-4 w-4  transform rounded-full bg-white transition border-[0.5] border-slate-600`})]})})]}),e.jsxs("div",{className:"w-full max-h-[250px] overflow-auto",children:[y.map((N,S)=>e.jsxs("div",{className:"group/title w-full flex items-center hover:bg-slate-100",children:[e.jsx("div",{className:"flex items-center h-8 w-8 justify-center  border-r border-b ",onClick:()=>{h(x!==S?S:void 0)},children:e.jsx("div",{className:"w-4 h-4 rounded border-[0.5px] border-slate-600",style:{backgroundColor:N.color}})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-600 border-b h-8 truncate",children:N.label}),e.jsx("div",{className:"group/icon border-b w-8 h-8 flex items-center border-slate-200 cursor-pointer fill-white group-hover/title:fill-slate-300 hover:bg-slate-200",onClick:()=>{const w=[...c],k=y.filter(E=>E.label!==N.label),$=w.indexOf(N.label);w.splice($,2),r(E=>{K(E,`symbology.layers[${n.symbology.activeLayer}].categories`,{paint:w,legend:k.map(M=>({color:M.color,label:I(f,M.label,M.label)}))})})},children:e.jsx(Gr,{className:"mx-[6px] cursor-pointer group-hover/icon:fill-slate-500 "})})]},S)),j&&e.jsxs("div",{className:"w-full flex items-center hover:bg-slate-100",children:[e.jsx("div",{className:"flex items-center h-8 w-8 justify-center  border-r border-b ",children:e.jsx("div",{className:"w-4 h-4 rounded border-[0.5px] border-slate-600",style:{backgroundColor:I(n,`symbology.layers[${n.symbology.activeLayer}]['category-show-other']`,"#ccc")}})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-600 border-b h-8 truncate",children:"Other"})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center mx-4",children:"Add Column"}),e.jsx("div",{className:"flex-1 flex items-center mx-4 pb-4",children:e.jsx(as,{children:e.jsx("label",{className:"flex w-full",children:e.jsx("div",{className:"flex w-full items-center",children:e.jsxs("select",{className:"w-full py-2 bg-transparent",value:"",onChange:N=>{const S=[...c],w=[...y],k=S[S.length-2],$=m.map(M=>Qa(M)).indexOf(k),E=$<m.length-1?m[$+1]:m[0];w.push({color:E,label:N.target.value}),S.splice(c.length-1,0,N.target.value,Qa(E)),r(M=>{K(M,`symbology.layers[${n.symbology.activeLayer}].categories`,{paint:S,legend:w.map(_=>({color:_.color,label:I(f,_.label,_.label)}))})})},children:[e.jsx("option",{value:""},-1),(v||[]).map((N,S)=>e.jsx("option",{value:N.value,children:N.label},S))]})})})})})]})]})]})}function KI({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ee),{falcor:a,falcorCache:l,pgEnv:i}=C.useContext(ie);let{value:c,column:d,choroplethdata:u,colors:m,numbins:p,method:x,colorKey:h}=b.useMemo(()=>({value:I(n,`symbology.layers[${n.symbology.activeLayer}].${t}`,{}),column:I(n,`symbology.layers[${n.symbology.activeLayer}]['data-column']`,""),choroplethdata:I(n,`symbology.layers[${n.symbology.activeLayer}]['choropleth-data']`,{}),colors:I(n,`symbology.layers[${n.symbology.activeLayer}]['color-range']`,kt.seq1[9]),numbins:I(n,`symbology.layers[${n.symbology.activeLayer}]['num-bins']`,9),colorKey:I(n,`symbology.layers[${n.symbology.activeLayer}]['range-key']`,"seq1"),method:I(n,`symbology.layers[${n.symbology.activeLayer}]['bin-method']`,"ckmeans")}),[n]);const f=Math.max(...u),g=[...(Array.isArray(c)?c:[]).filter((v,j)=>j>2).map((v,j)=>j%2===1?{color:c[j+1],label:`${c[j+2]} - ${c[j+4]||f}`}:null).filter(v=>v)],y=I(n,`symbology.layers[${n.symbology.activeLayer}]['category-show-other']`,"#ccc")==="#ccc";return e.jsxs("div",{className:" w-full items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Showing"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsx("select",{className:"w-full p-2 bg-transparent text-slate-700 text-sm",value:p,onChange:v=>r(j=>{K(j,`symbology.layers[${n.symbology.activeLayer}].['num-bins']`,v.target.value),K(j,`symbology.layers[${n.symbology.activeLayer}].['color-range']`,kt[h][v.target.value])}),children:(Object.keys(kt[h])||[]).map((v,j)=>e.jsx("option",{value:v,children:v},j))})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Method"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsxs("select",{className:"w-full p-2 bg-transparent text-slate-700 text-sm",value:x,onChange:v=>r(j=>{console.log("SelectViewColumnControl set bin method",t,v.target.value),K(j,`symbology.layers[${n.symbology.activeLayer}]['bin-method']`,v.target.value)}),children:[e.jsx("option",{value:"ckmeans",children:"ck-means"}),e.jsx("option",{value:"jenks",children:"Jenks"}),e.jsx("option",{value:"pretty",children:"Pretty Breaks"}),e.jsx("option",{value:"equalInterval",children:"Equal Interval"})]})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Show Other"}),e.jsx("div",{className:"flex items-center",children:e.jsxs(sn,{checked:y,onChange:()=>{r(v=>{const j=I(n,`symbology.layers[${n.symbology.activeLayer}]['category-show-other']`,"#ccc")==="#ccc"?"rgba(0,0,0,0)":"#ccc";K(v,`symbology.layers[${n.symbology.activeLayer}]['category-show-other']`,j)})},className:`${y?"bg-blue-500":"bg-gray-200"} relative inline-flex h-4 w-8 items-center rounded-full `,children:[e.jsx("span",{className:"sr-only",children:"Show other"}),e.jsx("div",{className:`${y?"translate-x-5":"translate-x-0"} inline-block h-4 w-4  transform rounded-full bg-white transition border-[0.5] border-slate-600`})]})})]}),e.jsx("div",{className:"w-full max-h-[250px] overflow-auto",children:g.map((v,j)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-slate-100",children:[e.jsx("div",{className:"flex items-center h-8 w-8 justify-center  border-r border-b ",children:e.jsx("div",{className:"w-4 h-4 rounded border-[0.5px] border-slate-600",style:{backgroundColor:v.color}})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-600 border-b h-8 truncate",children:v.label})]},j))})]})}const eL=(t,s)=>t.filter(n=>!s.includes(n)),lg=({setState:t,availableColumnNames:s})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center mx-4",children:"Add Column"}),e.jsx("div",{className:"flex-1 flex items-center mx-4",children:e.jsx(as,{children:e.jsx("label",{className:"flex w-full",children:e.jsx("div",{className:"flex w-full items-center",children:e.jsxs("select",{className:"w-full py-2 bg-transparent",value:"",onChange:n=>t(n.target.value),children:[e.jsx("option",{value:""},-1),(s||[]).map((n,r)=>e.jsx("option",{value:n.value,children:n.label},r))]})})})})})]}),Cr={color:qI,categoricalColor:YI,rangeColor:ZI,categoryControl:QI,choroplethControl:KI,range:GI,simple:JI,select:og,selectType:UI,selectViewColumn:XI};function as({children:t}){return e.jsx("div",{className:"rounded-md h-[36px] flex w-full w-[216px] p-2 items-center border border-white/50 hover:bg-white cursor-pointer hover:border-slate-200",children:t})}function tL({values:t,title:s="",children:n}){return e.jsx(as,{children:e.jsx(Tt,{className:"relative w-full",children:({open:r})=>e.jsxs(e.Fragment,{children:[e.jsx(Tt.Button,{className:"w-full",children:e.jsxs("div",{className:"w-full flex items-center group",children:[e.jsx("div",{className:"flex items-center group-hover:flex-1",children:(t||[]).map((a,l)=>e.jsxs(b.Fragment,{children:[a.type==="color"&&e.jsx("div",{className:"h-4 w-4 border",style:{backgroundColor:wr(a.value)}}),e.jsxs("div",{className:"px-1 py-1 truncate",children:[e.jsx("span",{className:"",children:a.type==="color"?wr(a.value):a.value}),a.unit?a.unit:""," "]}),e.jsx("div",{className:"px-1 py-1 truncate",children:l<t.length-1?"/":""})]},l))}),e.jsx("div",{className:"flex items-center ",children:e.jsx(Wo,{className:"fill-slate-400 group-hover:fill-slate-800"})})]})}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:e.jsx(Tt.Panel,{className:"absolute w-[250px] left-0  z-10 mt-3 -translate-x-[325px] -translate-y-[78px] transform px-4  ",children:({close:a})=>e.jsxs("div",{className:"overflow-hidden rounded-lg shadow-lg ring-1 ring-black/5 bg-white/95",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:" w-full flex text-slate-700 py-1 px-2 text-sm font-semibold tracking-wider",children:s}),e.jsx("div",{onClick:()=>a(),className:"p-0.5 rounded hover:bg-slate-100 m-1 cursor-pointer",children:e.jsx(Gr,{className:"fill-slate-700"})})]}),e.jsx("div",{className:"relative",children:n})]})})})]})})})}function sL({controls:t}){const{state:s,setState:n}=C.useContext(Ee);return e.jsx(as,{children:t.map((r,a)=>{const l=Cr[r.type]||Cr.simple;return e.jsx(l,{path:r.path,datapath:r.datapath,params:r.params},a)})})}function nL({label:t,controls:s}){const{state:n,setState:r}=C.useContext(Ee),a=b.useMemo(()=>s.map(l=>{var u;const i=m=>m;let d=(((u=l==null?void 0:l.params)==null?void 0:u.format)||i)(I(n,`symbology.layers[${n.symbology.activeLayer}].${l.path}`,""));return{type:l==null?void 0:l.type,unit:l==null?void 0:l.unit,value:d}}),[n,s]);return e.jsx(tL,{values:a,title:t,children:s.map((l,i)=>{const c=Cr[l.type]||Cr.simple;return e.jsx(c,{path:l.path,datapath:l.datapath,params:l.params},i)})})}const Xu={popover:nL,inline:sL},rL={fill:"Polygons",line:"Lines",circle:"Points"};function aL(t){const{state:s,setState:n}=C.useContext(Ee),r=b.useMemo(()=>{var l,i;return((i=(l=s.symbology)==null?void 0:l.layers)==null?void 0:i[s.symbology.activeLayer])||null},[s]),a=b.useMemo(()=>rg[r.type]||[],[r.type]);return r&&e.jsx("div",{children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"font-bold tracking-wider text-sm text-slate-700",children:rL[r.type]}),a.filter(l=>{if(l.conditional){const i=I(s,`symbology.layers[${s.symbology.activeLayer}].${l.conditional.path}`,"-999");return l.conditional.conditions.includes(i)}else return!0}).map((l,i)=>{let c=Xu[l.type]||Xu.inline;return e.jsxs("div",{className:"flex ",children:[e.jsx("div",{className:"w-16 text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center",children:l.label}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsx(c,{label:l.label,controls:l.controls})})]},i)})]})})}function oL(t,s,n){return n.indexOf(t)===s}const lL=(t,s)=>t.filter(n=>!s.includes(n));function iL({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ee),a=b.useMemo(()=>I(n,`symbology.layers[${n.symbology.activeLayer}].${t}`,[]),[n,t,s]),l=I(n,`symbology.layers[${n.symbology.activeLayer}].view_id`),i=I(n,`symbology.layers[${n.symbology.activeLayer}].source_id`),{pgEnv:c,falcor:d,falcorCache:u}=b.useContext(ie);b.useEffect(()=>{i&&d.get(["dama",c,"sources","byId",i,"attributes","metadata"])},[i]);const m=b.useMemo(()=>{let g=I(u,["dama",c,"sources","byId",i,"attributes","metadata","value","columns"],[]);return g.length===0&&(g=I(u,["dama",c,"sources","byId",i,"attributes","metadata","value"],[])),g},[i,u]),p=b.useMemo(()=>m.map(g=>g.name),[m]);b.useEffect(()=>{a.length===0&&r(g=>{K(g,`symbology.layers[${n.symbology.activeLayer}].${t}`,m.filter(y=>!["wkb_geometry"].includes(y.name)).map(y=>({column_name:y.name,display_name:(y==null?void 0:y.display_name)||y.name})))})},[m]);const x=b.useMemo(()=>a?typeof a[0]=="string"?a:a.map(g=>g==null?void 0:g.column_name):void 0,[a]),h=b.useMemo(()=>(x?lL(p,x):p).filter(g=>!["wkb_geometry"].includes(g)),[x,p]);C.useEffect(()=>{d.get(["dama",c,"viewsbyId",l,"databyIndex",{from:0,to:100},x])},[d,c,l,x]);const f=b.useMemo(()=>Object.values(I(u,["dama",c,"viewsbyId",l,"databyIndex"],[])).map(g=>g!=null&&g.value?I(u,g.value,""):""),[c,u]);return e.jsxs("div",{className:"flex w-full flex-wrap",children:[e.jsx(cL,{selectedColumns:a,sampleData:f,reorderAttrs:(g,y)=>{const v=[...a],[j]=v.splice(g,1);v.splice(y,0,j),r(N=>{K(N,`symbology.layers[${n.symbology.activeLayer}].${t}`,v)})},renameAttr:({columnName:g,displayName:y})=>{const v=[...a],j=v.findIndex(w=>w.column_name===g),[N]=v.splice(j,1),S={...N};S.display_name=y,v.splice(j,0,S),r(w=>{K(w,`symbology.layers[${n.symbology.activeLayer}].${t}`,v)})},removeAttr:g=>{r(y=>{K(y,`symbology.layers[${n.symbology.activeLayer}].${t}`,a.filter(v=>v.column_name!==g))})}}),e.jsx(lg,{setState:g=>{r(y=>{if(g!==""){const v=m.find(j=>j.name===g);K(y,`symbology.layers[${n.symbology.activeLayer}].${t}`,a?[...a,{column_name:g,display_name:(v==null?void 0:v.display_name)||g}]:[{column_name:g,display_name:(v==null?void 0:v.display_name)||g}])}})},availableColumnNames:h.map(g=>{const y=m.find(v=>v.name===g);return{value:g,label:(y==null?void 0:y.display_name)||g}})})]})}const cL=({selectedColumns:t,sampleData:s,path:n,reorderAttrs:r,removeAttr:a,renameAttr:l})=>e.jsx(Qt,{onDrop:r,children:t==null?void 0:t.map((i,c)=>e.jsxs("div",{className:"group/title w-full text-sm grid grid-cols-9 cursor-grab",children:[e.jsx("div",{className:"truncate border-t border-r border-slate-200 col-span-4 px-2 py-1",children:e.jsx("input",{type:"text",className:"w-full px-2  border text-sm border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent text-slate-700 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",value:i.display_name,onChange:d=>{l({columnName:i.column_name,displayName:d.target.value})}})}),e.jsx("div",{className:"truncate flex items-center text-[13px] border-t border-slate-200 col-span-4 text-slate-300 px-4 py-1",children:s.map(d=>d[i.column_name]).filter(d=>d!=="null").filter(oL).slice(0,2).join(", ")}),e.jsx("div",{className:"border-t flex items-center border-slate-200 cursor-pointer fill-white group-hover/title:fill-slate-300 hover:bg-slate-100 rounded group/icon col-span-1 p-0.5",onClick:()=>{a(i.column_name)},children:e.jsx(Gr,{className:"mx-[6px] cursor-pointer group-hover/icon:fill-slate-500 "})})]},c))});function dL(t){const{state:s,setState:n}=b.useContext(Ee),r=b.useMemo(()=>{var a,l;return((l=(a=s.symbology)==null?void 0:a.layers)==null?void 0:l[s.symbology.activeLayer])||null},[s]);return r&&e.jsxs("div",{className:"pb-4  max-h-[calc(100vh_-_251px)] scrollbar-xs overflow-x-hidden overflow-y-auto",children:[e.jsxs("div",{className:"flex mx-4 mt-1",children:[e.jsx("div",{className:"w-16 text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center",children:"Popover"}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsx(as,{children:e.jsx(og,{path:"['hover']",params:{options:[{value:"",name:"None"},{value:"hover",name:"Hover"}]}})})})]}),e.jsx("div",{className:"w-16 text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center mx-4",children:"Attributes"}),r.hover&&e.jsx(iL,{path:"['hover-columns']",params:{}})]})}const Zu={fill:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-4 rounded ",style:{backgroundColor:s}})}),circle:({layer:t,color:s})=>{let n=I(t,"layers[0].paint['circle-stroke-color']","#ccc");return e.jsx("div",{className:"pl-0.5 pr-2",children:e.jsx("div",{className:"w-3 h-3 rounded-full ",style:{backgroundColor:s,borderColor:n}})})},line:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-1",style:{backgroundColor:s}})})};function uL(){const{state:t,setState:s}=C.useContext(Ee);let{legenddata:n,layertype:r}=b.useMemo(()=>({legenddata:I(t,`symbology.layers[${t.symbology.activeLayer}]['legend-data']`,[]),layertype:I(t,`symbology.layers[${t.symbology.activeLayer}]['type']`,"fill")}),[t]);const a=Zu[r]||Zu.fill;return!n||n.length===0?e.jsx("div",{children:" No Legend Data "}):e.jsx("div",{className:"w-full max-h-[550px] pb-4 overflow-auto",children:n.map((l,i)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-pink-50",children:[e.jsx("div",{className:"flex items-center h-6 w-10 justify-center  ",children:e.jsx(a,{color:l.color})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-500  text-sm truncate",children:e.jsx("input",{type:"text",className:"block w-full border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-2 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",placeholder:"Select / Create New Map",value:n[i].label,onChange:c=>s(d=>{d.symbology.layers[d.symbology.activeLayer]["legend-data"][i].label=c.target.value})})})]},i))})}function mL(t){const{state:s,setState:n}=C.useContext(Ee),r=b.useMemo(()=>{var a,l;return((l=(a=s.symbology)==null?void 0:a.layers)==null?void 0:l[s.symbology.activeLayer])||null},[s]);return b.useMemo(()=>rg[r.type]||[],[r.type]),r&&e.jsx("div",{children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"font-bold tracking-wider text-sm text-slate-700 p-4",children:"Legend"}),e.jsx(uL,{})]})})}const{simple:Yu,select:pL}=Cr;function xL(t,s,n){return n.indexOf(t)===s}const hL=(t,s)=>t.filter(n=>!s.includes(n)),fL={string:["!=","=="],integer:["!=","<","<=","==",">=",">","between"],number:["!=","<","<=","==",">=",">","between"]},gL=({removeFilter:t,activeColumn:s,setActiveColumn:n})=>{var p;const{state:r,setState:a}=C.useContext(Ee),l=I(r,`symbology.layers[${r.symbology.activeLayer}].filter`,{}),i=I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`),{pgEnv:c,falcor:d,falcorCache:u}=b.useContext(ie);b.useEffect(()=>{i&&d.get(["dama",c,"sources","byId",i,"attributes","metadata"])},[i]);const m=b.useMemo(()=>{let x=I(u,["dama",c,"sources","byId",i,"attributes","metadata","value","columns"],[]);return x.length===0&&(x=I(u,["dama",c,"sources","byId",i,"attributes","metadata","value"],[])),x},[i,u]);return e.jsx("div",{className:"flex w-full flex-wrap",children:(p=Object.keys(l||{}))==null?void 0:p.map((x,h)=>{var k,$,E;const f=m.find(M=>M.name===x)||{},g=l[x],y=s===x?"bg-pink-100":"",v=s===x?"text-pink-100":"text-white",j=f.type==="string"&&["!=","=="].includes(g.operator),N=g.operator==="between",S=((k=m.find(M=>M.name===x))==null?void 0:k.display_name)||x;let w=g==null?void 0:g.value;return j?Array.isArray(g==null?void 0:g.value)&&(w=($=g==null?void 0:g.value)==null?void 0:$.join(", ")):N&&Array.isArray(g==null?void 0:g.value)&&(w=(E=g==null?void 0:g.value)==null?void 0:E.join(" and ")),e.jsxs("div",{className:`${y} m-1 border border-slate-200 rounded group/title w-full px-1 text-sm grid grid-cols-9 cursor-pointer hover:border-pink-500 hover:border`,onClick:()=>{n(x)},children:[e.jsxs("div",{className:"truncate col-span-8 py-1",children:[S," ",e.jsx("span",{className:"font-thin",children:g.operator})," ",w]}),e.jsx("div",{className:`cursor-pointer ${v} group-hover/title:text-black group/icon col-span-1 p-1`,onClick:M=>{M.stopPropagation(),t(x)},children:e.jsx("i",{className:"mx-2 fa fa-x cursor-pointer group-hover/icon:text-pink-800"})})]},h)})})};function bL({path:t,params:s={}}){var k,$;const{state:n,setState:r}=C.useContext(Ee),[a,l]=C.useState(""),{activeColumn:i,setActiveColumn:c}=s,{sourceId:d}=b.useMemo(()=>({sourceId:I(n,`symbology.layers[${n.symbology.activeLayer}].source_id`)}),[n]),{pgEnv:u,falcor:m,falcorCache:p}=b.useContext(ie);b.useEffect(()=>{d&&m.get(["dama",u,"sources","byId",d,"attributes","metadata"])},[d]);const x=b.useMemo(()=>{let E=I(p,["dama",u,"sources","byId",d,"attributes","metadata","value","columns"],[]);return E.length===0&&(E=I(p,["dama",u,"sources","byId",d,"attributes","metadata","value"],[])),E},[d,p]),h=b.useMemo(()=>x.find(E=>E.name===i),[i]),f=fL[h==null?void 0:h.type]||[],g=I(n,`symbology.layers[${n.symbology.activeLayer}].filter`,{}),y=`${t}.${i}.value`,v=((k=g==null?void 0:g[i])==null?void 0:k.operator)==="between",j=(h==null?void 0:h.type)==="string"&&["!=","=="].includes(($=g==null?void 0:g[i])==null?void 0:$.operator),N=j?e.jsx(as,{children:e.jsx("label",{className:"flex",children:e.jsx("div",{className:"flex items-center",children:e.jsx("input",{className:"w-full",type:"text",value:a,onChange:E=>{l(E.target.value)}})})})}):e.jsx(as,{children:e.jsx(Yu,{path:y+(v?"[0]":""),params:{default:""}})}),S=j?"Search values":"Value:",w=v?null:e.jsx("div",{className:"p-1",children:S});return e.jsxs(e.Fragment,{children:[!i&&e.jsx(yL,{path:t,params:s,setActiveColumn:c}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mx-4",children:[e.jsxs("div",{className:"flex my-1 items-center",children:[e.jsx("div",{className:"p-1",children:"Column:"}),e.jsx("div",{className:"p-2",children:h.display_name??i})]}),e.jsxs("div",{className:"flex my-1 items-center",children:[e.jsx("div",{className:"p-1",children:"Operator:"}),e.jsx(as,{children:e.jsx(pL,{path:`${t}.${i}.operator`,params:{options:f.map(E=>({value:E,name:E}))}})})]}),e.jsxs("div",{className:"flex my-1 items-center",children:[w,N]}),v&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-1",children:"And"}),e.jsx("div",{className:"flex my-1 items-center",children:e.jsx(as,{children:e.jsx(Yu,{path:y+"[1]",params:{default:""}})})})]})]}),j&&e.jsx(vL,{params:s,path:y,filterSearchValue:a})]})]})}function yL({path:t,params:s={},setActiveColumn:n}){var y,v;const{state:r,setState:a}=C.useContext(Ee),l=I(r,`symbology.layers[${r.symbology.activeLayer}].${t}`,s.default||((v=(y=s==null?void 0:s.options)==null?void 0:y[0])==null?void 0:v.value)||{}),i=Object.keys(l),c=I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`),{pgEnv:d,falcor:u,falcorCache:m}=b.useContext(ie);b.useEffect(()=>{c&&u.get(["dama",d,"sources","byId",c,"attributes","metadata"])},[c]);const p=b.useMemo(()=>{let j=I(m,["dama",d,"sources","byId",c,"attributes","metadata","value","columns"],[]);return j.length===0&&(j=I(m,["dama",d,"sources","byId",c,"attributes","metadata","value"],[])),j},[c,m]),x=b.useMemo(()=>p.filter(j=>!["wkb_geometry"].includes(j)).map(j=>j.name),[p]),h=hL(x,i).map(j=>{const N=p.find(S=>S.name===j);return{value:j,label:(N==null?void 0:N.display_name)||j}}),f={operator:"==",value:[]},g={operator:"==",value:""};return e.jsx(lg,{setState:j=>{a(N=>{if(j!==""){const S=p.find(k=>k.name===j);let w={...f,columnName:j};S.type!=="string"&&(w={...g,columnName:j}),K(N,`symbology.layers[${r.symbology.activeLayer}].${t}.${j}`,w)}}),n(j)},availableColumnNames:h})}function vL({params:t,path:s,filterSearchValue:n}){var g,y;const{pgEnv:r,falcor:a,falcorCache:l}=b.useContext(ie),{state:i,setState:c}=C.useContext(Ee),{activeColumn:d,setActiveColumn:u}=t,{viewId:m,sourceId:p}=b.useMemo(()=>({viewId:I(i,`symbology.layers[${i.symbology.activeLayer}].view_id`),sourceId:I(i,`symbology.layers[${i.symbology.activeLayer}].source_id`)}),[i]);b.useEffect(()=>{p&&a.get(["dama",r,"sources","byId",p,"attributes","metadata"])},[p]),b.useEffect(()=>{a.get(["dama",r,"viewsbyId",m,"databyIndex",{from:0,to:2e3},[d]])},[a,r,m,d]);const x=b.useMemo(()=>Object.values(I(l,["dama",r,"viewsbyId",m,"databyIndex"],[])).map(v=>v!=null&&v.value?I(l,v.value,""):""),[r,l]),h=b.useMemo(()=>{var v,j;return(j=(v=x==null?void 0:x.map(N=>N[d]))==null?void 0:v.filter(N=>N!=="null"))==null?void 0:j.filter(xL)},[x,d]);h.sort();const f=I(i,`symbology.layers[${i.symbology.activeLayer}].${s}`,t.default||((y=(g=t==null?void 0:t.options)==null?void 0:g[0])==null?void 0:y.value));return h==null?void 0:h.filter(v=>{var j,N;return(N=(j=v==null?void 0:v.toString())==null?void 0:j.toLowerCase())==null?void 0:N.includes(n.toString().toLowerCase())}).map((v,j)=>{const N=f==null?void 0:f.includes(v),S=N?"bg-pink-100":"";return e.jsx("div",{className:`${S} px-4 w-full text-sm hover:bg-pink-200 hover:cursor-pointer`,onClick:()=>c(w=>{const k=N?f.filter($=>$!==v):[...Array.isArray(f)?f:[],v];K(w,`symbology.layers[${i.symbology.activeLayer}].${s}`,k)}),children:e.jsxs("div",{className:"flex",children:[e.jsx("input",{readOnly:!0,type:"checkbox",checked:N}),e.jsx("div",{className:"truncate flex items-center text-[13px] px-4 py-1",children:v})]})},j)})}function wL(t){const{state:s,setState:n}=b.useContext(Ee),[r,a]=b.useState(!1),[l,i]=b.useState(),c=I(s,`symbology.layers[${s.symbology.activeLayer}].filter`);return e.jsxs("div",{className:"pb-4 w-full max-h-[calc(100vh_-_251px)] scrollbar-xs overflow-x-hidden overflow-y-auto",children:[e.jsx("div",{className:"w-full mt-1 mx-4 text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center mx",children:"Filters"}),e.jsx("div",{className:"mx-4",children:e.jsx(gL,{removeFilter:d=>{i(null),a(!1),n(u=>{const m=Object.keys(c).reduce((p,x)=>(x!==d&&(p[x]=c[x]),p),{});K(u,`symbology.layers[${s.symbology.activeLayer}].filter`,m)})},activeColumn:l,setActiveColumn:i})}),e.jsx("div",{className:"m-4",children:e.jsx($e,{className:"p-1",themeOptions:{size:"sm",color:"transparent"},onClick:()=>{a(!0),i(null)},children:"Add Filter"})}),(l||r)&&e.jsx(bL,{path:"['filter']",params:{activeColumn:l,setActiveColumn:i}})]})}function jL(t){var l,i,c,d;const{state:s,setState:n}=C.useContext(Ee),r=b.useMemo(()=>{var u,m;return((m=(u=s.symbology)==null?void 0:u.layers)==null?void 0:m[s.symbology.activeLayer])||null},[s]),a=["Style","Legend","Popup","Filter"];return r&&e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-white/95 w-[312px] rounded-lg drop-shadow-lg pointer-events-auto min-h-[400px] max-h-[calc(100vh_-_161px)]  ",children:[e.jsxs("div",{className:"flex justify-between items-center border-b",children:[e.jsx("div",{className:"flex text-slate-700 p-2 ",children:e.jsx("input",{type:"text",className:"block w-[220px] border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-2 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",placeholder:"Select / Create New Map",value:(d=(c=(l=s==null?void 0:s.symbology)==null?void 0:l.layers)==null?void 0:c[(i=s==null?void 0:s.symbology)==null?void 0:i.activeLayer])==null?void 0:d.name,onChange:u=>n(m=>{m.symbology.layers[m.symbology.activeLayer].name=u.target.value})})}),e.jsx("div",{className:"text-sm pt-1.5 px-1.5  hover:bg-slate-100 flex items-center",children:e.jsx(yc,{location:"right-0",layer:r,button:e.jsx(Ho,{className:" cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700"})})}),e.jsx("div",{onClick:()=>n(u=>{u.symbology.activeLayer=null}),className:"p-2.5 rounded hover:bg-slate-100 m-1 cursor-pointer",children:e.jsx(Gr,{className:"fill-slate-500"})})]}),e.jsx("div",{className:"min-h-20 relative",children:e.jsxs(Te.Group,{children:[e.jsx("div",{className:"flex justify-between items-center border-b",children:e.jsx(Te.List,{children:a.map(u=>e.jsx(Te,{as:b.Fragment,children:({selected:m})=>e.jsx("button",{className:`
                        ${m?"text-slate-600 border-b font-medium border-slate-600":"text-slate-400"} mx-1 text-sm p-2 cursor-pointer
                      `,children:u})},u))})}),e.jsxs(Te.Panels,{children:[e.jsx(Te.Panel,{children:e.jsx(aL,{})}),e.jsx(Te.Panel,{children:e.jsx(mL,{})}),e.jsx(Te.Panel,{children:e.jsx(dL,{})}),e.jsx(Te.Panel,{children:e.jsx(wL,{})})]})]})})]})})}const CL=({maplibreMap:t,layer:s,layerProps:n,allLayerProps:r})=>{b.useEffect(()=>()=>{s.layers.forEach(l=>{try{t&&t.getLayer(l.id)&&t.removeLayer(l.id)}catch(i){console.log("catch",i)}})},[]);const a=CI(n);b.useEffect(()=>{var i,c,d,u,m,p,x,h,f,g;if(((n==null?void 0:n["data-column"])!==(a==null?void 0:a["data-column"])||(n==null?void 0:n.filter)!==(a==null?void 0:a.filter))&&t.getSource((c=(i=n==null?void 0:n.sources)==null?void 0:i[0])==null?void 0:c.id)){let y=jt((d=n.sources)==null?void 0:d[0]),v=(u=y.source.tiles)==null?void 0:u[0];v&&(y.source.tiles=[NL(v,n)]),(m=n==null?void 0:n.layers)==null||m.forEach(N=>{t.getLayer(N==null?void 0:N.id)&&t.getLayer(N==null?void 0:N.id)&&t.removeLayer(N==null?void 0:N.id)}),t.removeSource(y.id),t.getSource(y.id)?console.log("cant add",t.getSource(y.id)):t.addSource(y.id,y.source);let j=Object.values(r).find(N=>N.order===n.order+1);(p=n==null?void 0:n.layers)==null||p.forEach(N=>{t.getLayer(j==null?void 0:j.id)?t.addLayer(N,j==null?void 0:j.id):t.addLayer(N)})}if((n==null?void 0:n.order)<((a==null?void 0:a.order)||-1)){let y=Object.values(r).find(v=>v.order===n.order+1);(x=n==null?void 0:n.layers)==null||x.forEach(v=>{t.getLayer(v==null?void 0:v.id)&&t.getLayer(v==null?void 0:v.id)&&t.moveLayer(v==null?void 0:v.id,y==null?void 0:y.id)})}(h=n==null?void 0:n.layers)==null||h.forEach((y,v)=>{t.getLayer(y.id)&&Object.keys(y.paint).forEach(j=>{var N,S,w,k;Ae((w=(S=(N=a==null?void 0:a.layers)==null?void 0:N[v])==null?void 0:S.paint)==null?void 0:w[j],(k=y==null?void 0:y.paint)==null?void 0:k[j])||t.setPaintProperty(y.id,j,y.paint[j])})}),(f=n==null?void 0:n.layers)==null||f.forEach((y,v)=>{t.getLayer(y.id)&&Object.keys((y==null?void 0:y.layout)||{}).forEach(j=>{var N,S,w,k;Ae((w=(S=(N=a==null?void 0:a.layers)==null?void 0:N[v])==null?void 0:S.layout)==null?void 0:w[j],(k=y==null?void 0:y.layout)==null?void 0:k[j])||t.setLayoutProperty(y.id,j,y.layout[j])})});const{filter:l}=n;(g=n==null?void 0:n.layers)==null||g.forEach((y,v)=>{if(t.getLayer(y.id)&&l){const j=Object.keys(l).map(N=>{let S=[];const w=l[N].operator,k=l[N].value,$=["get",N];return w==="between"?S=["all",[">=",["to-string",$],["to-string",k==null?void 0:k[0]]],["<=",["to-string",$],["to-string",k==null?void 0:k[1]]]]:["==","!="].includes(w)?(S=["in",$,["literal",k]],w==="!="&&(S=["!",S])):S=[w,["to-string",$],["to-string",k]],S});t.setFilter(y.id,["all",...j])}})},[n])},NL=(t,s)=>{var l;let n=t;const r=(s==null?void 0:s.filter)&&((l=Object.keys(s==null?void 0:s.filter))==null?void 0:l.length)>0,a=i=>i.includes(s==null?void 0:s["data-column"]);return n&&(s!=null&&s["data-column"]||r)&&(n!=null&&n.includes("?cols=")||(n+="?cols="),s!=null&&s["data-column"]&&!a(n)&&(n+=s==null?void 0:s["data-column"]),a(n)&&r&&(n+=","),r&&Object.keys(s.filter).forEach((i,c)=>{n+=`${i}`,c<Object.keys(s.filter).length-1&&(n+=",")})),n};let kL=class extends Po{constructor(){super(...arguments);Wt(this,"onHover",{layers:this.layers.filter(n=>{var r;return((r=n==null?void 0:n.id)==null?void 0:r.indexOf("_case"))===-1}).map(n=>n.id),callback:(n,r,a)=>[r[0].id,n,(r[0]||{}).properties],Component:$L,isPinnable:this.isPinnable||!0});Wt(this,"RenderComponent",CL)}};const $L=({data:t,layer:s})=>{if(!s.props.hover)return;const{source_id:n,view_id:r}=s,a=C.useContext(ie),l=C.useContext(me),i=a!=null&&a.falcor?a:l,{pgEnv:c,falcor:d,falcorCache:u}=i,m=C.useMemo(()=>I(t,"[0]",null),[t]),p=C.useMemo(()=>s.props["hover-columns"],[s]);b.useEffect(()=>{n&&d.get(["dama",c,"sources","byId",n,"attributes","metadata"])},[n,p]);const x=C.useMemo(()=>{if(p)return p;{let y=I(u,["dama",c,"sources","byId",n,"attributes","metadata","value","columns"],[]);return y.length===0&&(y=I(u,["dama",c,"sources","byId",n,"attributes","metadata","value"],[])),y}},[n,u,p]),h=C.useMemo(()=>{let y=I(u,["dama",c,"sources","byId",n,"attributes","metadata","value","columns"],[]);return y.length===0&&(y=I(u,["dama",c,"sources","byId",n,"attributes","metadata","value"],[])),y},[n,u]);let f=(typeof(x==null?void 0:x[0])=="string"?x:x.map(y=>y.name||y.column_name)).filter(y=>!["wkb_geometry"].includes(y));C.useEffect(()=>{d.get(["dama",c,"viewsbyId",r,"databyId",m,f])},[d,c,r,m,x]);const g=C.useMemo(()=>I(u,["dama",c,"viewsbyId",r,"databyId",""+m],{}),[m,u,r,c]);return e.jsxs("div",{className:"bg-white p-4 max-h-64 max-w-lg min-w-[300px] scrollbar-xs overflow-y-scroll",children:[e.jsx("div",{className:"font-medium pb-1 w-full border-b ",children:(s==null?void 0:s.name)||""}),Object.keys(g).length===0?`Fetching Attributes ${m}`:"",Object.keys(g).filter(y=>typeof g[y]!="object").sort((y,v)=>{const j=(p==null?void 0:p.findIndex(S=>S.column_name===y))||0,N=(p==null?void 0:p.findIndex(S=>S.column_name===v))||0;return j-N}).map((y,v)=>{const j=x.find(w=>w.name===y||w.column_name===y)||{},N=h.find(w=>w.name===y||w.column_name===y)||{},S=JSON.parse((N==null?void 0:N.meta_lookup)||"{}");return j.name||j.display_name?e.jsxs("div",{className:"flex border-b pt-1",children:[e.jsx("div",{className:"flex-1 font-medium text-xs text-slate-400 pl-1",children:j.display_name||j.name}),e.jsx("div",{className:"flex-1 text-right text-sm font-thin pl-4 pr-1",children:(g==null?void 0:g[y])!=="null"?I(S,g==null?void 0:g[y],g==null?void 0:g[y]):""})]},v):e.jsx(e.Fragment,{})})]})},Ee=b.createContext(void 0),SL=({collection:t,symbologies:s,activeSymbologyId:n,...r})=>{var y,v;const a=b.useRef(!1),{falcor:l,falcorCache:i,pgEnv:c,baseUrl:d}=C.useContext(ie),u=Le(),{symbologyId:m}=Be(),[p,x]=st(s.find(j=>+j.symbology_id==+n)||{name:"",collection_id:t.collection_id,description:""});b.useEffect(()=>{if(!m&&+n&&+m!=+n){u(`${d}/collection/${t.collection_id}/mapeditor/${n}`);let j=s.find(N=>+N.symbology_id==+n);x(j)}},[n,m,s,i]),b.useEffect(()=>{var w;async function j(){await l.set({paths:[["dama",c,"symbologies","byId",+n,"attributes","symbology"]],jsonGraph:{dama:{[c]:{symbologies:{byId:{[+n]:{attributes:{symbology:JSON.stringify(p.symbology)}}}}}}}})}async function N(){await l.set({paths:[["dama",c,"symbologies","byId",+n,"attributes","name"]],jsonGraph:{dama:{[c]:{symbologies:{byId:{[+n]:{attributes:{name:p.name}}}}}}}})}let S=s.find(k=>+k.symbology_id==+n);(w=p==null?void 0:p.symbology)!=null&&w.layers&&S&&!Ae(p==null?void 0:p.symbology,S==null?void 0:S.symbology)&&j(),p!=null&&p.name&&(p==null?void 0:p.name)!==S.name&&N()},[p.symbology,p.name]),b.useEffect(()=>{s.find(j=>+j.symbology_id==+n)&&x(s.find(j=>+j.symbology_id==+n))},[s.length,n]);const[h,f]=st([]);b.useEffect(()=>{(async()=>{a.current&&f(N=>{var E;let S=N.map(M=>M.id).filter(M=>M),w=Object.values(((E=p==null?void 0:p.symbology)==null?void 0:E.layers)||{}).filter(M=>M).filter(M=>!S.includes(M.id)).sort((M,_)=>_.order-M.order).map(M=>new kL(M));return[...N.filter(M=>{var _;return Object.keys(((_=p==null?void 0:p.symbology)==null?void 0:_.layers)||{}).includes(M.id)}),...w].sort((M,_)=>p.symbology.layers[_.id].order-p.symbology.layers[M.id].order)})})()},[(y=p==null?void 0:p.symbology)==null?void 0:y.layers]);const g=b.useMemo(()=>{var j;return((j=p==null?void 0:p.symbology)==null?void 0:j.layers)||{}},[(v=p==null?void 0:p.symbology)==null?void 0:v.layers]);return e.jsx(Ee.Provider,{value:{state:p,setState:x,collection:t,symbologies:s},children:e.jsxs("div",{className:"w-full h-full relative",ref:a,children:[e.jsx(Hn,{layers:h,layerProps:g,hideLoading:!0,showLayerSelect:!0,mapOptions:{center:[-76,43.3],zoom:6,maxPitch:60,protocols:[Ro],styles:[{name:"Default",style:"https://api.maptiler.com/maps/dataviz/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Satellite",style:"https://api.maptiler.com/maps/hybrid/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Streets",style:"https://api.maptiler.com/maps/streets-v2/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Light",style:"https://api.maptiler.com/maps/dataviz-light/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Dark",style:"https://api.maptiler.com/maps/dataviz-dark/style.json?key=mU28JQ6HchrQdneiq6k9"}]},leftSidebar:!1,rightSidebar:!1}),e.jsxs("div",{className:"absolute inset-0 flex pointer-events-none",children:[e.jsx(zI,{}),e.jsx("div",{className:"flex-1"}),e.jsx(jL,{})]})]})})},Il={overview:{name:"Overview",path:"",component:eI},mapeditor:{name:"Map Editor",path:"/mapeditor",fullWidth:!0,hideBreadcrumbs:!0,component:SL},versions:{name:"Versions",path:"/versions",hidden:"true",component:pI}},ma={},_L=t=>({"Guest User":-1,"Public User":0,"Agency User":1})[t],IL=t=>{const s=Object.keys(t);let n=Number.MAX_SAFE_INTEGER;return s.map(r=>{t[r].view==!0&&(n=Math.min(n,_L(r)))}),n==Number.MAX_SAFE_INTEGER&&(n=Number.MIN_SAFE_INTEGER),n},pa=({})=>{var $;const{collectionId:t,page:s,symbologyId:n}=Be(),[r,a]=b.useState(Il||[]),[l,i]=b.useState(n),{pgEnv:c,baseUrl:d,falcor:u,falcorCache:m,user:p}=C.useContext(ie),x=p.authLevel,h=b.useMemo(()=>s?I(r,`[${s}].component`,r.overview.component):r.overview.component,[s,r]),f=b.useMemo(()=>s?I(r,`[${s}].fullWidth`,!1):!1,[s,r]),g=b.useMemo(()=>s?I(r,`[${s}].hideBreadcrumbs`,!1):!1,[s,r]);b.useEffect(()=>{async function E(){const M=["dama",c,"collections","byId",t,"symbologies","length"],_=await u.get(M);return await u.get(["dama",c,"collections","byId",t,"symbologies","byIndex",{from:0,to:I(_.json,M,0)-1},"attributes",Object.values(En)],["dama",c,"collections","byId",t,"attributes",Object.values(vr)],["dama",c,"collections","byId",t,"meta"])}E()},[t,u,c]);const y=b.useMemo(()=>Object.keys(I(m,["dama",c,"symbologies","byId"],{})),[m,t,c]);b.useEffect(()=>{var M;async function E(){const _=["dama",c,"symbologies","byId",y.filter(L=>L&&L!=="undefined"),"attributes",Object.values(En)];await u.get(_)}(M=y==null?void 0:y.filter(_=>_&&_!=="undefined"))!=null&&M.length&&E()},[y,t,c]);const v=b.useMemo(()=>{const E=I(m,["dama",c,"symbologies","byId"],{});return Object.values(E).map(M=>{var D,A;const L={...(D=M.attributes)!=null&&D.value?(A=M.attributes)==null?void 0:A.value:M.attributes};return Object.keys(M.attributes).forEach(T=>{var O;L[T]=((O=M.attributes[T])==null?void 0:O.value)||M.attributes[T]}),L}).filter(M=>M.collection_id===parseInt(t))},[m,t,c]);b.useEffect(()=>{if(l&&l!==n&&i(n),!l&&v.length>0){let E=v.filter(M=>{var _;return(_=M==null?void 0:M.metadata)==null?void 0:_.authoritative}).length>0?v.filter(M=>{var _;return(_=M==null?void 0:M.metadata)==null?void 0:_.authoritative}):v;i(E.sort((M,_)=>M._created_timestamp-_._created_timestamp)[0].symbology_id)}},[v,n]);const j=b.useMemo(()=>{let E=Qs(I(m,["dama",c,"collections","byId",t],{attributes:{}}).attributes);if(ma[E.type]){let M=Object.keys(ma[E.type]).reduce((L,D)=>((ma[E.type][D].path||D==="overview")&&(L[D]=ma[E.type][D]),L),{}),_={...Il,...M};a(_)}else a(Il);return E},[m,t,c]),N=IL((($=j==null?void 0:j.statistics)==null?void 0:$.access)||{}),[S,w]=Rt(),k=C.useCallback(E=>{const M=[];return S.forEach((_,L)=>{M.push(`${L}=${_}`)}),`${d}/collection/${t}${E.path}${l&&E.path?"/"+l:""}${M.length?`?${M.join("&")}`:""}`},[d,t,l,S]);return N>x?e.jsx(Kf,{}):e.jsxs(Ct,{baseUrl:d,fullWidth:f,hideBreadcrumbs:g,children:[e.jsx(Ei,{menuItems:Object.values(r).filter(E=>{const M=(E==null?void 0:E.authLevel)||-1,_=p.authLevel||-1;return!E.hidden&&M<=_}).sort((E,M)=>((E==null?void 0:E.authLevel)||-1)-((M==null?void 0:M.authLevel)||-1)).map(E=>({name:E.name,path:k(E)})),themeOptions:{size:"inline"}}),e.jsx("div",{className:"w-full flex-1 bg-white shadow",children:e.jsx(h,{searchParams:S,setSearchParams:w,collection:j,symbologies:v,user:p,baseUrl:d,activeSymbologyId:l})})]})},LL=()=>{const t=Le(),[s,n]=b.useState(Object.keys(vr).filter(u=>!["collection_id","categories","metadata","source_dependencies","user_id","_created_timestamp","_modified_timestamp"].includes(u)).reduce((u,m)=>(u[m]="",u),{})),[r,a]=b.useState(null),{pgEnv:l,baseUrl:i}=C.useContext(ie);b.useEffect(()=>{(async()=>{const m=(await Promise.all(Object.keys(wt).map(async p=>wt[p].getIsAlreadyCreated&&await wt[p].getIsAlreadyCreated(l)?null:p))).filter(Boolean).reduce((p,x)=>(p[x]=wt[x],p),{});a(m)})()},[l]);const c=["name"],d=async()=>{const m=await(await fetch(`${gt}/dama-admin/${l}/collection/publish`,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}})).json();t(`${i}/collection/${m.collection_id}`)};return e.jsx("div",{children:e.jsxs(Ct,{children:[e.jsx("div",{className:"p-4 font-medium",children:" Create New Collection "}),e.jsxs("div",{className:"border-t border-gray-200 px-4 py-5 sm:p-0",children:[e.jsx("dl",{className:"sm:divide-y sm:divide-gray-200",children:Object.keys(vr).filter(u=>!["collection_id","metadata","categories","source_dependencies","user_id","_created_timestamp","_modified_timestamp"].includes(u)).map((u,m)=>e.jsx("div",{className:"flex justify-between group",children:e.jsxs("div",{className:"flex-1 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsxs("dt",{className:"text-sm font-medium text-gray-500 py-5 capitalize",children:[u," ",c.includes(u)&&e.jsx("span",{style:{color:"red",verticalAlign:"super"},children:"*"})]}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.jsx("div",{className:"pt-3 pr-8",children:e.jsx(Ns,{className:"w-full p-2 flex-1 px-2 shadow bg-grey-50 focus:bg-blue-100  border-gray-300 ",value:I(s,u,""),onChange:p=>{n({...s,[u]:p})}})})})]})},m))}),e.jsx("div",{children:e.jsx($e,{onClick:()=>{d()},children:"Publish"})})]})]})})};async function EL({falcor:t,pgEnv:s,sourceId:n}){const r=await t.get(["dama",s,"sources","byId",n,"dependents"]),a=[],l=[];I(r,["json","dama",s,"sources","byId",n,"dependents"]).forEach(i=>{a.push(i.source_id),l.push(i.view_id)}),await t.get(["dama",s,"sources","byId",[...a,n],"attributes",["type","name","display_name"]]),await t.get(["dama",s,"views","byId",l,"attributes",["version","metadata","_modified_timestamp","last_updated"]])}const ML=({text:t})=>{const{falcor:s,baseUrl:n,pgEnv:r}=C.useContext(ie),{sourceId:a}=Be(),l=Le();async function i(){const d=await(await fetch(`${gt}/dama-admin/${r}/deleteDamaSource`,{method:"POST",body:JSON.stringify({source_id:a}),headers:{"Content-Type":"application/json"}})).json();console.log("delete response",d),s.invalidate(["dama",r,"sources","length"],["dama",r,"sources","byIndex"],["dama",r,"sources","byId",a]),console.log("navigate to",n),l(n||"/")}return e.jsx("button",{className:"bg-red-50 hover:bg-red-400 hover:text-white p-2",onClick:i,children:"Confirm Delete"})},AL=()=>e.jsxs("div",{className:"pb-4 flex justify-between",children:[e.jsx("label",{children:"No dependents found."}),e.jsx(ML,{text:"Confirm Delete"})]});function TL(){const{pgEnv:t,baseUrl:s,falcor:n,falcorCache:r}=C.useContext(ie),{sourceId:a}=Be();console.log("delete page",a),b.useEffect(()=>{EL({falcor:n,pgEnv:t,sourceId:a})},[a,t,n]),I(r,["dama",t,"sources","byId",a,"dependents","value"],[]);const l=I(r,["dama",t,"sources","byId",a,"attributes","name"],"");return I(r,["dama",t,"sources","byId"],{}),I(r,["dama",t,"views","byId"],{}),e.jsx("div",{children:e.jsx(Ct,{children:e.jsxs("div",{className:"w-full p-4 bg-white my-1 block border shadow",children:[e.jsxs("div",{className:"pb-4 font-bold",children:["Delete ",e.jsx("i",{children:l})]}),AL()]})})})}const OL={name:"name",cron:"cron",timezone:"timezone",data:"data",options:"options",created_on:"created_on",updated_on:"updated_on"};function DL(t){const[s,n,r,a,l]=t.trim().split(" "),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function d(f,g){if(f==="*")return`every ${g}`;if(f.includes("/")){const[y,v]=f.split("/");return`every ${v} ${g}${v>1?"s":""}${y!=="*"?` starting at ${y}`:""}`}return f.includes(",")?f.split(",").map(v=>g==="month"?i[+v-1]:g==="day of week"?c[+v%7]:v).join(", "):g==="month"?i[+f-1]:g==="day of week"?c[+f%7]:f}d(s,"minute"),d(n,"hour");const u=d(r,"day"),m=d(a,"month"),p=d(l,"day of week");let x=s==="*"&&n==="*"?"every minute":n==="*"?`at minute ${s} past every hour`:s==="*"?`every minute during hour ${n}`:`at ${n.padStart(2,"0")}:${s.padStart(2,"0")}`,h="";return r!=="*"&&l!=="*"?h=`on the ${u} of the month and every ${p}`:r!=="*"?h=`on the ${u} of the month`:l!=="*"?h=`every ${p}`:h="every day",a!=="*"&&(h+=` in ${m}`),`${x}, ${h}`}const Ll=["npmrds_raw","transcom"];function BL({}){const[t,s]=C.useState(!1),[n,r]=C.useState(!1),[a,l]=C.useState(null),{pgEnv:i,falcor:c,falcorCache:d}=b.useContext(ie),[u,m]=b.useState([]);b.useEffect(()=>{(async()=>{const f=["dama",i,"schedule","type",Ll,"length"],g=await c.get(f);Ll.forEach(async y=>{await c.get(["dama",i,"schedule","type",y,"dataByIndex",{from:0,to:Wc.get(g.json,["dama",i,"schedule","type",y,"length"],0)-1},Object.values(OL)])})})()},[c]),b.useEffect(()=>{const h=Ll.reduce((f,g)=>(f.push(...Object.values(Wc.get(d,["dama",i,"schedule","type",g,"dataByIndex"],{})).map(y=>Object.entries(y).reduce((v,[j,N])=>(v[j]=typeof N.value<"u"?N.value:N,v),{}))),f),[]);m(h)},[d,i]);const p=["name","type","cron","timezone","options","created_on"," "],x=async(h,f)=>{const g={dama_task_queue_name:h,pgEnv:f};r(!0);try{const v=await(await fetch(`${gt}/dama-admin/${f}/unschedule`,{method:"POST",body:JSON.stringify(g),headers:{"Content-Type":"application/json"}})).json();v&&v.isUnScheduled&&m(u.filter(j=>j.name!==h)),r(!1)}catch{r(!1)}};return e.jsxs("div",{className:"w-full p-5",children:[e.jsxs("div",{className:"flex m-3",children:[e.jsx("div",{className:"justify-start w-full md:w-1/2 px-3 mb-6 md:mb-0",children:e.jsx("label",{className:"block uppercase tracking-wide text-gray-700 text-xl font-bold mb-2",children:"Schedules"})}),e.jsx("div",{className:"mr-0"})]}),u.length?e.jsx("div",{className:"overflow-x-auto px-5 py-3",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsx("tr",{children:p.map(h=>e.jsx("th",{className:"py-2 px-4 bg-gray-200 text-left border-b",children:h},h))})}),e.jsx("tbody",{children:u.map((h,f)=>{var g,y;return e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-4 border-b",children:(h==null?void 0:h.name)&&(h==null?void 0:h.name.split(":")[1])},`${h==null?void 0:h.name}`),e.jsx("td",{className:"py-2 px-4 border-b",children:(g=h==null?void 0:h.data)==null?void 0:g.type},`${(y=h==null?void 0:h.data)==null?void 0:y.type}_${f}`),e.jsx("td",{className:"py-2 px-4 border-b",children:DL(h==null?void 0:h.cron)},`${h==null?void 0:h.cron}`),e.jsx("td",{className:"py-2 px-4 border-b",children:h==null?void 0:h.timezone},`${h==null?void 0:h.timezone}`),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsx("pre",{children:JSON.stringify(h==null?void 0:h.options,null,3)})},`${h==null?void 0:h.options}_${f}`),e.jsx("td",{className:"py-2 px-4 border-b",children:mc(h==null?void 0:h.created_on)},`${h==null?void 0:h.created_on}`),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsx("button",{className:"relative align-middle select-none font-sans font-medium text-center uppercase transition-all disabled:opacity-50 disabled:shadow-none disabled:pointer-events-none w-10 max-w-[40px] h-10 max-h-[40px] rounded-lg text-xs bg-red-500 text-white shadow-md shadow-red-900/10 hover:shadow-lg hover:shadow-red-900/20 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none",type:"button",onClick:()=>{l(h==null?void 0:h.name),s(!0)},children:e.jsx("span",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2",children:e.jsx("i",{className:"fad fa-trash","aria-hidden":"true"})})})},`${Math.random()}`)]},f)})})]})}):e.jsx("div",{className:"p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50 dark:bg-gray-800 dark:text-red-400",role:"alert",children:e.jsx("span",{className:"font-medium",children:"No Schedules available"})}),e.jsx(Je,{as:"div",className:"relative z-50",open:t,onClose:()=>s(!1),children:e.jsxs("div",{className:"fixed inset-0 flex w-screen items-center justify-center p-4",children:[e.jsx("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:""}),e.jsx(mo,{children:e.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[e.jsx(rp,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:"Remove Schedule"}),e.jsx("div",{className:"relative p-2 flex-auto",children:e.jsx("div",{className:"p-4 text-sm",role:"alert",children:e.jsx("span",{className:"font-medium",children:"Are you sure you want to remove Schedule?"})})}),e.jsxs("div",{className:"",children:[e.jsx("button",{type:"button",className:"inline-flex justify-center px-4 py-2 text-sm text-red-900 bg-red-100 border border-transparent rounded-md hover:bg-red-200 duration-300",onClick:()=>s(!1),children:"Close"}),e.jsx("button",{type:"button",className:"ml-3 inline-flex justify-center px-4 py-2 text-sm text-green-900 bg-green-100 border border-transparent rounded-md hover:bg-green-200 duration-300",onClick:async()=>{await x(a,i),s(!1)},children:n?e.jsxs("div",{style:{display:"flex"},children:[e.jsx("div",{className:"mr-2",children:"Deleting..."}),e.jsx(wp,{scale:.25,color:"#fefefe"})]}):"Yes"})]})]})})]})})]})}const Qu=t=>Object.entries(t||{}).reduce((s,n)=>{const[r,a]=n;return typeof a.value<"u"?s[r]=a.value:s[r]=a,s},{}),FL=({fullWidth:t})=>{const{etl_context_id:s}=Be(),{pgEnv:n,baseUrl:r,falcor:a,falcorCache:l}=C.useContext(ie);b.useEffect(()=>{async function c(){return await a.get(["dama",n,"etlContexts","byEtlContextId",s,"attributes",li]).then(d=>{var m;const u=Qu(I(d,["json","dama",n,"etlContexts","byEtlContextId",s],{attributes:{}}));Object.keys(u).length&&a.get(["dama",n,"sources","byId",[(m=u==null?void 0:u.meta)==null?void 0:m.source_id],"attributes","name"])})}s&&c()},[a,s,n]);const i=b.useMemo(()=>{var p,x;const c=Qu(I(l,["dama",n,"etlContexts","byEtlContextId",s],{attributes:{}}).value);let d=I(l,["dama",n,"sources","byId",[(p=c==null?void 0:c.meta)==null?void 0:p.source_id],"attributes","name"],"");const u=(x=c==null?void 0:c.events)==null?void 0:x.find(h=>h.type.toLowerCase().includes("initial"));return d=typeof d=="string"?d:"",u&&u.type&&(d+=" "+u.type.split(":")[0]),[{name:d}]},[l,s,n,r]);return e.jsx("nav",{className:"border-b border-gray-200 flex ","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:`${t?"w-full":"max-w-screen-xl w-full mx-auto"}  px-4 flex space-x-4 sm:px-6 lg:px-8`,children:[e.jsx("li",{className:"flex",children:e.jsx("div",{className:"flex items-center",children:e.jsxs(ue,{to:`${r||"/"}`,className:"hover:text-[#bbd4cb] text-[#679d89]",children:[e.jsx("i",{className:"fad fa-database flex-shrink-0 h-5 w-5","aria-hidden":"true"}),e.jsx("span",{className:"sr-only",children:"Home"})]})})}),e.jsx("li",{className:"flex",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"flex-shrink-0 w-6 h-full text-gray-300",viewBox:"0 0 30 44",preserveAspectRatio:"none",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:e.jsx("path",{d:"M.293 0l22 22-22 22h1.414l22-22-22-22H.293z"})}),e.jsx(ue,{to:`${r}/tasks`,className:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700",children:"All Tasks"})]})}),i.map((c,d)=>e.jsx("li",{className:"flex",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"flex-shrink-0 w-6 h-full text-gray-300",viewBox:"0 0 30 44",preserveAspectRatio:"none",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:e.jsx("path",{d:"M.293 0l22 22-22 22h1.414l22-22-22-22H.293z"})}),c.href?e.jsx(ue,{to:c.href,className:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700","aria-current":c.current?"page":void 0,children:c.name}):e.jsx("div",{className:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700","aria-current":c.current?"page":void 0,children:c.name})]})},d))]})})},ig=({children:t})=>e.jsxs(e.Fragment,{children:[e.jsx(FL,{}),e.jsx("div",{className:"mt-4",children:t})]}),zL=t=>e.jsx(ig,{children:e.jsx(kf,{...t})});function PL(t,s,n){return n.indexOf(t)===s}const RL=({value:t,...s})=>{const n=new Date(t.replace(/"/g,""));return e.jsx("div",{children:n.toLocaleString()})},HL=[{accessor:"etl_context_id",Header:"ETL Context ID"},{accessor:"event_id",Header:"Event ID"},{accessor:"user",Header:"User",Cell:Nf},{accessor:"created_at",Header:"Created At",Cell:RL},{accessor:"type",Header:"Type"},{accessor:"payload",Header:"Data",Cell:({value:t})=>{const s=typeof t=="string"?JSON.parse(t):t,n=(s==null?void 0:s.data)||(s==null?void 0:s.message)||s;return e.jsx("div",{className:"max-h-[75px] overflow-auto",children:JSON.stringify(n).substring(0,1e3)})}}],sr=10,WL=t=>{const{etl_context_id:s}=Be(),{pgEnv:n,falcor:r,falcorCache:a}=C.useContext(ie),[l,i]=C.useState(0),c=C.useMemo(()=>po(l*sr,l*sr+sr),[l,sr]),d=["dama",n,"etlContexts",s,"allEvents","length"],u=x=>["dama",n,"etlContexts",s,"allEvents",x,["event_id","etl_context_id","created_at","type","payload","user"]];C.useEffect(()=>{(async()=>{await r.get(d)})()},[r,n]);const m=C.useMemo(()=>I(a,d),[r,a,n]);C.useEffect(()=>{(async()=>{await r.get(u(c)).then(h=>{const f=u(c);f.pop(),f.pop();const g=Object.values(I(h,["json",...f])).map(v=>v.etl_context_id).filter(v=>!!v).filter(PL),y=["dama",n,"etlContexts","byEtlContextId"];g.forEach(v=>{r.get([...y,v])})})})()},[r,n,c]);const p=C.useMemo(()=>c.map(x=>{const h=u(x);return h.pop(),{...I(a,h)}}).filter(x=>!!x.etl_context_id),[a,n,s,c]);return e.jsx(ig,{children:e.jsx(Dn,{data:p,columns:HL,pageSize:sr,manualPagination:!0,numRecords:m,onPageChange:i,sortBy:"created_at",sortOrder:"desc",disableFilters:!0,disableSortBy:!0})})},VL=()=>{const{pgEnv:t,baseUrl:s,falcor:n,falcorCache:r}=C.useContext(ie),[a,l]=b.useState(""),[i,c]=b.useState(!1),d=C.useCallback(h=>{c(!0),n.set({paths:[["dama-info",t,"settings"]],jsonGraph:{"dama-info":{[t]:{settings:JSON.stringify({filtered_categories:h.filteredCategories})}}}}).then(()=>c(!1))},[t]);b.useEffect(()=>{async function h(){const f=["dama",t,"sources","length"],g=await n.get(f);await n.get(["dama",t,"sources","byIndex",{from:0,to:I(g.json,f,0)-1},"attributes",Object.values(Xt)],["dama-info",t,"settings"])}h()},[n,t]);const u=b.useMemo(()=>Object.values(I(r,["dama",t,"sources","byIndex"],{})).map(h=>ft(I(r,h.value,{attributes:{}}).attributes)),[r,t]),m=b.useMemo(()=>I(r,["dama-info",t,"settings","value","filtered_categories"],[]),[r,t]),p=[...new Set(u.filter(h=>{var f;return!((f=h.categories)!=null&&f.find(g=>m.find(y=>g.includes(y))))}).reduce((h,f)=>{var g;return[...h,...((g=f.categories)==null?void 0:g.map(y=>y[0]))||[]]},[]))].sort(),x=[...new Set(u.reduce((h,f)=>{var g;return[...h,...((g=f.categories)==null?void 0:g.map(y=>y[0]))||[]]},[]))].reduce((h,f)=>{var g;return h[f]=(g=u.filter(y=>{var v;return(v=y.categories)==null?void 0:v.find(j=>j.includes(f))}))==null?void 0:g.length,h},{});return e.jsxs(Ct,{baseUrl:s,children:[e.jsx("input",{value:a,className:"my-4 w-full text-lg p-2 border border-gray-300 ",placeholder:"Start typing or click on a category to filter categories...",onChange:h=>{l(h.target.value)},onKeyDown:h=>{const f=p.find(g=>g.toLowerCase()===h.target.value.toLowerCase());h.key==="Enter"&&f&&(d({filteredCategories:[...m,f]}),l(""))}}),e.jsxs("div",{className:"flex flex-wrap",children:[e.jsxs("div",{className:"w-full sm:w-1/2 border-2 p-1 my-1 bg-slate-200 rounded-md",children:[e.jsxs("label",{className:"text-gray-800 text-sm",children:["Available Categories",e.jsx("span",{className:"text-xs italic mx-1",children:"(click to filter...)"})]}),e.jsx("div",{className:"flex flex-row",children:e.jsx("div",{className:"w-full flex flex-wrap p-1 max-h-[80dvh] overflow-auto scrollbar-sm",children:(p||[]).filter(h=>!a||h.toLowerCase().includes(a.toLowerCase())).sort((h,f)=>h.localeCompare(f)).map(h=>e.jsxs("button",{className:"bg-white hover:bg-blue-50 p-2 m-1 rounded-md flex items-center",onClick:f=>d({filteredCategories:[...m,h]}),children:[e.jsx("i",{className:"fa fa-category"})," ",h,e.jsx("div",{className:"bg-blue-200 text-blue-600 text-xs w-5 h-5 ml-2 shrink-0 grow-0 rounded-lg flex items-center justify-center border border-blue-300",children:x[h]})]},h))})})]}),e.jsxs("div",{className:"w-full sm:w-1/2 border-2 p-1 my-1 bg-slate-200 rounded-md",children:[e.jsxs("label",{className:"text-gray-800 text-sm",children:["Filtered Categories ",e.jsx("span",{className:"text-xs italic mx-1",children:"(click to un-filter...)"})]}),e.jsx("div",{className:"w-full flex flex-wrap items-center p-1 max-h-[20dvh] overflow-auto scrollbar-sm",children:m!=null&&m.length?m.filter(h=>!a||h.toLowerCase().includes(a.toLowerCase())).sort((h,f)=>h.localeCompare(f)).map(h=>e.jsxs("button",{className:"bg-white hover:bg-blue-50 p-2 m-1 rounded-md flex items-center",onClick:f=>d({filteredCategories:m.filter(g=>g!==h)}),children:[e.jsx("i",{className:"fa fa-category"})," ",h,e.jsx("div",{className:"bg-blue-200 text-blue-600 text-xs w-5 h-5 ml-2 shrink-0 grow-0 rounded-lg flex items-center justify-center border border-blue-300",children:x[h]})]},h)):e.jsx("div",{className:"text-gray-800",children:"No categories have been filtered."})})]})]})]})},UL=({totalPages:t,pageSize:s,currentPage:n,setVCurrentPage:r})=>{const a=Math.ceil(t/s);return e.jsxs("div",{className:"float-right flex flex-col items-end p-1 text-sm font-gray-500",children:[e.jsxs("div",{className:"text-xs italic",children:["showing ",Math.min(s,t)," of ",isNaN(t)?0:parseInt(t).toLocaleString()," rows"]}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx("div",{className:"mx-1 cursor-pointer hover:text-gray-800",onClick:()=>r(n>0?n-1:n),children:"<< prev"}),e.jsx("select",{className:"p-0.5 border-2 text-gray-800 hover:bg-blue-50 rounded-lg",value:n,onChange:l=>r(+l.target.value),children:[...new Array(a).keys()].map(l=>e.jsx("option",{className:"p-2 border-2 text-gray-800 hover:bg-blue-50",value:l,children:l+1},l))}),e.jsx("div",{className:"mx-1 cursor-pointer text-gray-500 hover:text-gray-800",onClick:()=>r(n<t?n+1:n),children:"next >>"})]})]})},qL=t=>{if(typeof t=="object")return t;try{return JSON.parse(t)}catch{return t}},Ku=t=>typeof t=="object"?JSON.stringify(t):t,GL=[{app:"dms-site",type:"docs-page",baseUrl:""},{app:"dms-site",type:"docs-docs",baseUrl:"/docs"},{app:"dms-site",type:"docs-play",baseUrl:"/playground"}],JL=()=>{const{pgEnv:t,baseUrl:s,falcor:n,falcorCache:r}=C.useContext(ie),[a,l]=b.useState({app:"dms-site",type:"docs-page",baseUrl:""}),[i,c]=b.useState(void 0),[d,u]=b.useState(!1),[m,p]=b.useState(0),x=20;b.useEffect(()=>{async function y(){u(!0);const v=await n.get(["dms","data",`${a.app}+${a.type}`,"length"]),j=I(v,["json","dms","data",`${a.app}+${a.type}`,"length"],0);await n.get(["dms","data",`${a.app}+${a.type}`,"byIndex",{from:0,to:j-1},["app","type","data"]]),u(!1)}y()},[a,t]);const h=b.useMemo(()=>Object.values(I(r,["dms","data",`${a.app}+${a.type}`,"byIndex"],{})).map(y=>I(r,y.value)).filter(y=>{var v,j;return!((j=(v=y==null?void 0:y.data)==null?void 0:v.value)!=null&&j.template_id)}),[r,t,a]),f=b.useMemo(()=>h.reduce((y,v)=>[...y,...I(v,["data","value","sections"],[]).map(j=>j.id).filter(j=>j)],[]),[h]);b.useEffect(()=>{async function y(){f.length&&(u(!0),await n.chunk(["dms","data","byId",f,["data"]]),u(!1))}y()},[h]);const g=b.useMemo(()=>f.reduce((y,v)=>({...y,[v]:I(r,["dms","data","byId",v,"data","value"])}),{}),[r,t,h,f]);return e.jsxs(Ct,{baseUrl:s,children:[e.jsx("select",{className:"p-4 bg-transparent font-bold",value:JSON.stringify(a),onChange:y=>l(JSON.parse(y.target.value)),children:GL.map(y=>e.jsx("option",{value:JSON.stringify(y),children:JSON.stringify(y)},y))}),e.jsx("div",{className:"font-bold max-h-[calc(100vh-150px)] grid grid-cols-2 divide-x divide-y overflow-auto scrollbar-sm",style:{gridTemplateColumns:"1fr 3fr"},children:e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Page"}),e.jsx("div",{children:"Sections"})]})}),e.jsx("div",{className:"max-h-[calc(100vh-150px)] grid grid-cols-2 divide-x divide-y overflow-auto scrollbar-sm",style:{gridTemplateColumns:"1fr 3fr"},children:h.filter((y,v)=>v>=m*x&&v<m*x+x).map((y,v)=>{const j=I(y,["data","value","sections"],[]).filter(N=>g[N.id]).map(N=>{var $,E,M,_,L;const S=qL((E=($=g[N.id])==null?void 0:$.element)==null?void 0:E["element-data"]),w=Ku((S==null?void 0:S.dataSource)||(S==null?void 0:S.ealSourceId)),k=Ku((S==null?void 0:S.version)||(S==null?void 0:S.ealViewId));return e.jsxs("div",{className:"p-2 hover:bg-blue-300",children:[e.jsxs(ue,{className:"w-full justify-between",to:`${a.baseUrl}/${I(y,["data","value","url_slug"])}#${N.id}`,children:[(M=g[N.id])==null?void 0:M.title,e.jsx("span",{className:"px-4 italic text-blue-300 hover: text-blue-600 text-sm",children:"view"})]}),e.jsxs("div",{children:["type: ",(L=(_=g[N.id])==null?void 0:_.element)==null?void 0:L["element-type"]]}),e.jsxs("div",{className:"font-bold text-gray-900",children:["source: ",w]}),e.jsxs("div",{className:"font-bold text-gray-900",children:["version: ",k]})]})});return e.jsxs(C.Fragment,{children:[e.jsx("div",{className:"p-2 w-full",children:e.jsxs(ue,{to:`${a.baseUrl}/${I(y,["data","value","url_slug"])}`,children:[I(y,["data","value","title"]),e.jsx("span",{className:"px-4 italic text-sm",children:I(y,["data","value","url_slug"])})]})}),e.jsx("div",{className:"p-2 h-[250px] overflow-auto scrollbar-sm",children:j})]})})}),e.jsx(UL,{pageSize:x,totalPages:h.length,currentPage:m,setVCurrentPage:p})]})},ms=({className:t="fill-slate-800",size:s="20"})=>e.jsx("svg",{width:s,height:s,viewBox:"0 0 24 24",className:t,children:e.jsx("path",{d:"M10.5858 12L4.92898 17.6569L6.3432 19.0711L12 13.4143L17.6569 19.0711L19.0711 17.6569L13.4142 12L19.0711 6.34317L17.6569 4.92896L12 10.5858L6.34317 4.92897L4.92896 6.34319L10.5858 12Z"})}),Jr=({className:t="fill-slate-800",size:s="12"})=>e.jsx("svg",{width:s,height:s,viewBox:"0 0 12 12",className:t,children:e.jsx("path",{d:"M7 0H5V5H0V7H5V12H7V7H12V5H7V0Z"})}),Wn=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 13.5C7.82843 13.5 8.5 12.8284 8.5 12C8.5 11.1716 7.82843 10.5 7 10.5C6.17157 10.5 5.5 11.1716 5.5 12C5.5 12.8284 6.17157 13.5 7 13.5ZM13.5 12C13.5 12.8284 12.8284 13.5 12 13.5C11.1716 13.5 10.5 12.8284 10.5 12C10.5 11.1716 11.1716 10.5 12 10.5C12.8284 10.5 13.5 11.1716 13.5 12ZM18.5 12C18.5 12.8284 17.8284 13.5 17 13.5C16.1716 13.5 15.5 12.8284 15.5 12C15.5 11.1716 16.1716 10.5 17 10.5C17.8284 10.5 18.5 11.1716 18.5 12Z"})}),cg=({className:t="fill-gray-900",onClick:s=()=>{}})=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,onClick:s,children:[e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.1278 12C15.1278 13.6863 13.7274 15.0533 12 15.0533C10.2726 15.0533 8.8722 13.6863 8.8722 12C8.8722 10.3137 10.2726 8.94664 12 8.94664C13.7274 8.94664 15.1278 10.3137 15.1278 12ZM13.3717 12C13.3717 12.7395 12.7576 13.339 12 13.339C11.2424 13.339 10.6283 12.7395 10.6283 12C10.6283 11.2604 11.2424 10.6609 12 10.6609C12.7576 10.6609 13.3717 11.2604 13.3717 12Z"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 18C7.90486 18 4.40498 15.512 3 12C4.40498 8.48798 7.90475 6 11.9999 6C16.095 6 19.595 8.48798 21 12C19.595 15.512 16.0951 18 12 18ZM11.9999 7.71429C15.1026 7.71429 17.7877 9.45991 19.0808 12C17.7877 14.5401 15.1027 16.2857 12 16.2857C8.89726 16.2857 6.21206 14.5401 4.91897 12C6.21206 9.45991 8.89715 7.71429 11.9999 7.71429Z"})]}),dg=({className:t="fill-slate-800",onClick:s=()=>{}})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,onClick:s,children:e.jsx("path",{d:"M3 12C3.34629 12.8656 3.81984 13.669 4.3982 14.3883L3.1051 15.6814L4.51932 17.0956L5.80754 15.8074C6.60111 16.4553 7.50288 16.9811 8.48252 17.3552L8.01453 19.1018L9.94638 19.6194L10.4142 17.8735C10.9301 17.9567 11.4599 18 12 18C12.5413 18 13.0722 17.9565 13.5892 17.873L14.0572 19.6194L15.989 19.1018L15.5207 17.354C16.4999 16.9796 17.4012 16.4537 18.1944 15.8058L19.4842 17.0956L20.8984 15.6814L19.6034 14.3863C20.181 13.6676 20.654 12.8648 21 12H19.0808C17.7877 14.5401 15.1027 16.2857 12 16.2857C8.89725 16.2857 6.21206 14.5401 4.91897 12H3Z"})}),XL=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.75146 15.1306V15.1306C6.7516 15.5448 6.41592 15.8807 6.0017 15.8808C5.58749 15.881 5.2516 15.5453 5.25146 15.1311C5.25142 14.9906 5.29183 13.8577 5.72195 12.7308C6.15161 11.6052 7.07875 10.2542 8.93625 10.2542C10.6713 10.2542 11.7208 10.8779 12.6242 11.4218L12.6343 11.4279C13.5029 11.9509 14.2064 12.3744 15.4163 12.3744C15.9048 12.3744 16.2194 12.1925 16.4573 11.9172C16.7183 11.6151 16.9063 11.1726 17.0283 10.6575C17.1484 10.1509 17.1911 9.63239 17.2023 9.23237C17.2078 9.03445 17.2055 8.87034 17.2019 8.75742C17.2001 8.70106 17.198 8.65774 17.1964 8.62967L17.1946 8.59935L17.1942 8.59372C17.1628 8.18088 17.4718 7.82024 17.8847 7.78861C18.2977 7.75696 18.6582 8.06611 18.6898 8.47911L17.942 8.53641C18.6898 8.47911 18.6898 8.47911 18.6898 8.47911L18.69 8.48178L18.6903 8.48614L18.6913 8.4998L18.6941 8.54621C18.6963 8.58534 18.6989 8.64059 18.7011 8.70969C18.7055 8.84767 18.7082 9.042 18.7017 9.27419C18.6888 9.73442 18.6397 10.3629 18.4879 11.0033C18.3382 11.6352 18.0746 12.3396 17.5923 12.8979C17.0869 13.4828 16.3665 13.8744 15.4163 13.8744C13.7881 13.8744 12.7801 13.267 11.9056 12.74C11.8871 12.7289 11.8688 12.7179 11.8505 12.7068C10.993 12.1906 10.2412 11.7542 8.93625 11.7542C8.00391 11.7542 7.46363 12.3742 7.12334 13.2657C6.95675 13.7022 6.86216 14.1544 6.80996 14.5155C6.78413 14.6942 6.76931 14.8461 6.76102 14.9566C6.75321 15.0608 6.75168 15.1221 6.75146 15.1306Z"})}),ZL=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.6289 16.4087C18.7672 16.1958 18.7885 15.9274 18.6854 15.6954L14.6854 6.6954C14.5242 6.3327 14.1083 6.15839 13.7367 6.29775L5.73666 9.29775C5.44393 9.40753 5.25 9.68737 5.25 10L5.25 16C5.25 16.4142 5.58578 16.75 6 16.75L18 16.75C18.2539 16.75 18.4905 16.6216 18.6289 16.4087ZM16.8459 15.25L6.75 15.25L6.75 10.5197L13.6017 7.95038L16.8459 15.25Z"})}),YL=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:t,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 14.5C13.3807 14.5 14.5 13.3807 14.5 12C14.5 10.6193 13.3807 9.5 12 9.5C10.6193 9.5 9.5 10.6193 9.5 12C9.5 13.3807 10.6193 14.5 12 14.5ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z"})}),Uo=({className:t="fill-slate-800"})=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",className:t,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.64645 4.64645C2.84171 4.45118 3.15829 4.45118 3.35355 4.64645L6 7.29289L8.64645 4.64645C8.84171 4.45118 9.15829 4.45118 9.35355 4.64645C9.54882 4.84171 9.54882 5.15829 9.35355 5.35355L6.35355 8.35355C6.15829 8.54882 5.84171 8.54882 5.64645 8.35355L2.64645 5.35355C2.45118 5.15829 2.45118 4.84171 2.64645 4.64645Z"})}),ug=({className:t="fill-slate-800",size:s="12",onClick:n=()=>{}})=>e.jsx("svg",{width:s,height:s,viewBox:"0 0 320 512",className:t,onClick:n,children:e.jsx("path",{d:"M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"})}),mg=({className:t="fill-slate-800",size:s="12",onClick:n=()=>{}})=>e.jsx("svg",{width:s,height:s,viewBox:"0 0 320 512",className:t,onClick:n,children:e.jsx("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8l256 0c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"})}),QL=({className:t="fill-slate-800",size:s="12"})=>e.jsx("svg",{className:t,width:s,height:s,viewBox:"0 0 576 512",children:e.jsx("path",{d:"M384 480l48 0c11.4 0 21.9-6 27.6-15.9l112-192c5.8-9.9 5.8-22.1 .1-32.1S555.5 224 544 224l-400 0c-11.4 0-21.9 6-27.6 15.9L48 357.1 48 96c0-8.8 7.2-16 16-16l117.5 0c4.2 0 8.3 1.7 11.3 4.7l26.5 26.5c21 21 49.5 32.8 79.2 32.8L416 144c8.8 0 16 7.2 16 16l0 32 48 0 0-32c0-35.3-28.7-64-64-64L298.5 96c-17 0-33.3-6.7-45.3-18.7L226.7 50.7c-12-12-28.3-18.7-45.3-18.7L64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l23.7 0L384 480z"})}),KL=({className:t="fill-slate-800",size:s="12"})=>e.jsx("svg",{className:t,width:s,height:s,viewBox:"0 0 448 512",children:e.jsx("path",{d:"M135.2 17.7L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-7.2-14.3C307.4 6.8 296.3 0 284.2 0L163.8 0c-12.1 0-23.2 6.8-28.6 17.7zM416 128L32 128 53.2 467c1.6 25.3 22.6 45 47.9 45l245.8 0c25.3 0 46.3-19.7 47.9-45L416 128z"})}),eE=({className:t="fill-slate-800",size:s="12"})=>e.jsx("svg",{className:t,width:s,height:s,viewBox:"0 0 448 512",children:e.jsx("path",{d:"M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-242.7c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32L64 32zm0 96c0-17.7 14.3-32 32-32l192 0c17.7 0 32 14.3 32 32l0 64c0 17.7-14.3 32-32 32L96 224c-17.7 0-32-14.3-32-32l0-64zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"})}),pg=({className:t="fill-slate-800",size:s="12"})=>e.jsx("svg",{className:t,width:s,height:s,viewBox:"0 0 576 512",children:e.jsx("path",{d:"M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z"})}),tE=({symbology:t,selectedSymbologyId:s,setSelectedSymbologyId:n,cat1:r,setCat1:a})=>{const l=s===t.symbology_id,i=Array.isArray(t==null?void 0:t.categories)?t==null?void 0:t.categories:[];return e.jsx("div",{children:e.jsx("div",{className:`w-full p-4 ${l?"bg-blue-100 hover:bg-blue-200":"bg-white hover:bg-blue-50"} block border shadow flex`,onClick:()=>{n(l?null:t.symbology_id)},children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-medium w-full block",children:e.jsx("span",{children:t.name})}),e.jsx("div",{children:i.map(c=>(typeof c=="string"?[c]:c).map((d,u)=>{const m=d===r;let p="bg-blue-100 text-blue-400 hover:bg-blue-400";return(l||m)&&(p="bg-blue-300 text-blue-500 hover:bg-blue-400",l&&m&&(p="bg-blue-400 text-blue-600 hover:bg-blue-500")),e.jsx("div",{onClick:x=>{x.stopPropagation(),a(m?"":d)},className:`inline hover:cursor-pointer text-xs p-1 px-2 ${p}  mr-2`,children:d},u)}))}),e.jsx("div",{className:"py-2 block",children:t.description})]})})})},sE=({selectedSymbologyId:t,setSelectedSymbologyId:s,symbologies:n})=>{var N,S;const r=b.useContext(me);let{pgEnv:a="hazmit_dama",falcor:l,falcorCache:i}=r;const c=((S=(N=window.location.pathname)==null?void 0:N.split("/"))==null?void 0:S[0])==="listall",[d,u]=b.useState(""),[m,p]=b.useState(),[x,h]=b.useState(),[f,g]=b.useState("asc"),y="Unknown";[...new Set(n.filter(w=>{const k=Array.isArray(w==null?void 0:w.categories)?w==null?void 0:w.categories:[];return c||!c&&!(k!=null&&k.find($=>$.includes(y)))}).reduce((w,k)=>{let $=Array.isArray(k==null?void 0:k.categories)?k.categories:[];return[...w,...$.map(E=>E[0])||[]]},[]))].sort().reduce((w,k)=>{var $;return w[k]=($=n.filter(E=>{var M;return(M=E.categories)==null?void 0:M.find(_=>_.includes(k))}))==null?void 0:$.length,w},{}),b.useMemo(()=>n.find(w=>w.symbology_id===t)??{},[n,a,t]);const j="bg-transparent hover:bg-blue-100 rounded-sm p-2 ml-0.5 border-2";return e.jsxs(Ct,{isListAll:c,hideBreadcrumbs:!0,children:[e.jsxs("div",{className:"py-4 flex flex-rows items-center",children:[e.jsx("input",{className:"w-full text-lg p-2 border border-gray-300 ",placeholder:"Search symbologies",value:d,onChange:w=>u(w.target.value)}),e.jsx("button",{className:j,title:"Toggle Sort",onClick:()=>g(f==="asc"?"desc":"asc"),children:e.jsx("i",{className:`fa-solid ${f==="asc"?"fa-arrow-down-z-a":"fa-arrow-down-a-z"} text-xl text-blue-400`})}),e.jsx("div",{onClick:()=>{p(""),u("")},className:j,title:c?"View Key Sources":"View All Sources",children:e.jsx("i",{className:`fa-solid ${c?"fa-filter-list":"fa-list-ul"} text-xl text-blue-400`})})]}),e.jsx("div",{className:"flex flex-row",children:e.jsx("div",{className:"w-full flex flex-col space-y-1.5 ml-1.5 max-h-[65dvh] overflow-auto scrollbar-sm",children:n.filter(w=>{const k=Array.isArray(w==null?void 0:w.categories)?w==null?void 0:w.categories:[];return c||!c&&!(k!=null&&k.find($=>$.includes(y)))}).filter(w=>{let k=!0;return m&&(k=!1,(I(w,"categories",[])||[]).forEach($=>{$[0]===m&&(!x||$[1]===x)&&(k=!0)})),k}).filter(w=>{const k=Array.isArray(w==null?void 0:w.categories)?w==null?void 0:w.categories:[];let $=w.name+" "+(k||[]).reduce((E,M)=>(E+=Array.isArray(M)?M.join(" "):typeof M=="string"?M:"",E),"");return!d.length>2||$.toLowerCase().includes(d.toLowerCase())}).sort((w,k)=>{var E;return(f==="asc"?1:-1)*((E=w.name)==null?void 0:E.localeCompare(k.name))}).map((w,k)=>e.jsx(tE,{cat1:m,setCat1:p,symbology:w,selectedSymbologyId:t,setSelectedSymbologyId:s},k))})})]})},js=["rgb(80, 149, 127)","rgb(159, 161, 69)","rgb(128, 182, 109)","rgb(122, 168, 36)","rgb(96, 117, 159)","rgb(55, 124, 164)","rgb(78, 139, 212)","rgb(104, 198, 222)","rgb(136, 154, 221)","rgb(143, 125, 191)","rgb(158, 101, 179)","rgb(191, 105, 162)","rgb(204, 98, 92)","rgb(235, 147, 96)","rgb(213, 176, 42)","rgb(242, 218, 58)","rgb(173, 122, 103)","rgb(130, 100, 100)","rgb(128, 128, 128)","rgb(204, 204, 204)"],Ka=t=>((!t||typeof t!="string")&&(t=js[qo(0,js.length-1)]),"#"+t.match(/\d+/g).map(n=>(+n).toString(16).padStart(2,0)).join``),nE=t=>{const{style:s}=new Option;return s.color=t,s.color},Ks=t=>Ka(nE(t));function rE(t,s){const n=js[qo(0,js.length-1)];return[{id:t,type:"circle",layout:{visibility:"visible"},paint:{"circle-color":n,"circle-radius":4,"circle-stroke-color":vc(-.4,n),"circle-stroke-width":1},source:`${s.source}_${t}`,"source-layer":s["source-layer"]}]}function aE(t,s){const n=js[qo(0,js.length-1)];return[{id:`${t}_case`,type:"line",layout:{visibility:"visible"},paint:{"line-color":vc(-.4,n),"line-width":3},source:`${s.source}_${t}`,"source-layer":s["source-layer"]},{id:t,type:"line",layout:{visibility:"visible"},paint:{"line-color":n,"line-width":3},source:`${s.source}_${t}`,"source-layer":s["source-layer"]}]}function oE(t,s){const n=js[qo(0,js.length-1)];return[{id:`${t}_case`,type:"line",layout:{visibility:"visible"},paint:{"line-color":vc(-.4,n),"line-width":1},source:`${s.source}_${t}`,"source-layer":s["source-layer"]},{id:t,type:"fill",layout:{visibility:"visible"},paint:{"fill-color":n,"fill-opacity":.75},source:`${s.source}_${t}`,"source-layer":s["source-layer"]}]}const lE=(t,s)=>{const n={fill:oE,line:aE,circle:rE};return n[s==null?void 0:s.type]?n[s==null?void 0:s.type](t,s):[s]},vc=(t,i)=>{var n=parseInt,r=Math.round,[a,l,i,c]=i.split(","),u=t<0,d=u?0:t*255**2,u=u?1+t:1-t;return"rgb"+(c?"a(":"(")+r((u*n(a[3]=="a"?a.slice(5):a.slice(4))**2+d)**.5)+","+r((u*n(l)**2+d)**.5)+","+r((u*n(i)**2+d)**.5)+(c?","+c:")")};function qo(t=0,s=100){return Math.floor(Math.random()*(s-t))+t}const Nr=t=>{const s=b.useRef();return b.useEffect(()=>{s.current=t}),s.current},wc={cat1:["rgb(107, 184, 199)","rgb(229, 102, 102)","rgb(172, 114, 165)","rgb(114, 172, 120)","rgb(234, 147, 97)","rgb(166, 140, 217)","rgb(237, 190, 94)","rgb(103, 203, 148)","rgb(209, 152, 77)","rgb(168, 169, 96)"],cat2:["rgb(234, 147, 97)","rgb(136, 154, 221)","rgb(198, 150, 88)","rgb(139, 193, 168)","rgb(225, 184, 81)","rgb(206, 126, 168)","rgb(184, 203, 128)","rgb(152, 135, 196)","rgb(223, 215, 129)","rgb(148, 209, 152)"],cat3:["rgb(119, 170, 221)","rgb(238, 136, 102)","rgb(238, 221, 136)","rgb(255, 170, 187)","rgb(153, 221, 255)","rgb(68, 187, 153)","rgb(187, 204, 51)","rgb(112, 128, 207)","rgb(170, 170, 0)","rgb(170, 68, 153)"],cat4:["rgb(155, 201, 69)","rgb(138, 81, 158)","rgb(228, 136, 7)","rgb(195, 75, 143)","rgb(46, 137, 194)","rgb(60, 175, 154)","rgb(249, 122, 113)","rgb(223, 173, 22)","rgb(116, 116, 205)","rgb(179, 136, 86)"],cat5:["rgb(92, 107, 192)","rgb(255, 167, 38)","rgb(236, 64, 122)","rgb(66, 165, 245)","rgb(255, 112, 67)","rgb(102, 187, 106)","rgb(255, 213, 79)","rgb(38, 166, 154)","rgb(255, 138, 101)","rgb(126, 87, 194)"],cat6:["rgb(204, 102, 119)","rgb(51, 34, 136)","rgb(221, 204, 119)","rgb(17, 119, 51)","rgb(136, 204, 238)","rgb(136, 34, 85)","rgb(68, 170, 153)","rgb(153, 153, 51)","rgb(170, 68, 153)","rgb(238, 119, 51)"],cat7:["rgb(129, 144, 71)","rgb(93, 106, 42)","rgb(172, 114, 165)","rgb(107, 71, 128)","rgb(114, 127, 192)","rgb(76, 89, 154)","rgb(179, 126, 117)","rgb(141, 87, 78)","rgb(166, 140, 43)","rgb(76, 141, 154)"],cat8:["rgb(255, 115, 87)","rgb(255, 142, 66)","rgb(255, 173, 41)","rgb(249, 203, 21)","rgb(147, 208, 83)","rgb(40, 189, 140)","rgb(7, 166, 171)","rgb(64, 142, 191)","rgb(107, 127, 184)","rgb(138, 111, 165)"],cat9:["rgb(201, 63, 54)","rgb(219, 96, 51)","rgb(233, 125, 43)","rgb(242, 154, 38)","rgb(248, 187, 42)","rgb(191, 202, 88)","rgb(139, 179, 111)","rgb(103, 158, 125)","rgb(69, 130, 124)","rgb(40, 109, 128)"]};function iE(t,s,n,r=10,a){var u,m;let l=JSON.parse(((m=((u=a.filter(p=>p.name===t))==null?void 0:u[0])||{})==null?void 0:m.meta_lookup)||"{}"),c=["match",["to-string",["get",(t||"").includes("AS ")?t.split("AS ")[1]:t]]];Array.from(Array(+r).keys()).forEach((p,x)=>{var f,g;let h=""+((f=s==null?void 0:s[x])==null?void 0:f[t]);h&&h!="[object Object]"&&(c.push(""+((g=s==null?void 0:s[x])==null?void 0:g[t])),c.push(Ks(n[x%n.length])))});const d=(c||[]).filter((p,x)=>x>2).map((p,x)=>x%2===0?{color:p,label:I(l,c[x+2],c[x+2])}:null).filter(p=>p);return{paint:c,legend:d}}function ui(t){let s=typeof t=="object"&&Array.isArray(t);return s&&(t.forEach(n=>{(!n||n==="undefined")&&(s=!1)}),s)}function mi(t,s,n,r=10,a="ckmeans",l,i,c="vertical"){let d=["step",["to-number",["get",t]]],u=l;if(!Array.isArray(u)||u.length===0)return!1;u.forEach((p,x)=>{d.push(n[x]),d.push(+p)}),d.push(n[r-1]);const m=[...(d||[]).filter((p,x)=>x>2).map((p,x)=>{if(x%2===1){let h="";return c==="vertical"?h=`${d[x+2]>1e3?Rs(d[x+2]):d[x+2]} - ${d[x+2]>1e3||d[x+4]>1e3?Rs(d[x+4]||s):d[x+4]||s}`:(c="horizontal")&&(h=`${d[x+2]>1e3?Rs(d[x+2]):d[x+2]}`),{color:d[x+1],label:h}}return null}).filter(p=>p)];return{paint:["case",["==",["get",t],null],i,d],legend:m}}const Rs=(t,s=2,n=!1)=>t>=1e12?`${n?"$":""}${(t/1e12).toFixed(s)}T`:t>=1e9?`${n?"$":""}${(t/1e9).toFixed(s)}B`:t>=1e6?`${n?"$":""}${(t/1e6).toFixed(s)}M`:t>=1e3?`${n?"$":""}${(t/1e3).toFixed(s)}K`:typeof t=="object"?"":`${n?"$":""}${parseInt(t)}`,$t={seq1:{2:["#f7e76e","#ce141f"],3:["#f7e76e","#ec962a","#ce141f"],4:["#f7e76e","#f1b33d","#e5751d","#ce141f"],5:["#f7e76e","#f3c048","#ec962a","#e1631a","#ce141f"],6:["#f7e76e","#f4c94f","#efa835","#e88321","#de581a","#ce141f"],7:["#f7e76e","#f4ce54","#f1b33d","#ec962a","#e5751d","#dc501a","#ce141f"],8:["#f7e76e","#f5d157","#f2bb43","#eea331","#e98823","#e36b1b","#da491b","#ce141f"],9:["#f7e76e","#f5d45a","#f3c048","#f0ac38","#ec962a","#e77e1f","#e1631a","#d9451b","#ce141f"]},seq2:{2:["#fde89b","#4d53b3"],3:["#fde89b","#f37b8a","#4d53b3"],4:["#fde89b","#ff9e81","#d4629b","#4d53b3"],5:["#fde89b","#ffb080","#f37b8a","#bd5aa4","#4d53b3"],6:["#fde89b","#ffbc82","#fe8f83","#e36a94","#ad57a9","#4d53b3"],7:["#fde89b","#ffc385","#ff9e81","#f37b8a","#d4629b","#a056ac","#4d53b3"],8:["#fde89b","#ffc887","#ffa880","#fb8985","#e86f91","#c85da0","#9755ad","#4d53b3"],9:["#fde89b","#ffcc88","#ffb080","#ff9582","#f37b8a","#de6797","#bd5aa4","#9055af","#4d53b3"]},seq3:{2:["#f2e68c","#035d6d"],3:["#f2e68c","#59a884","#035d6d"],4:["#f2e68c","#87bf84","#319082","#035d6d"],5:["#f2e68c","#a0ca84","#59a884","#1f837f","#035d6d"],6:["#f2e68c","#afd084","#74b684","#409984","#147b7d","#035d6d"],7:["#f2e68c","#bad485","#87bf84","#59a884","#319082","#0e767b","#035d6d"],8:["#f2e68c","#c2d785","#95c584","#6cb284","#479e84","#268881","#097379","#035d6d"],9:["#f2e68c","#c8d986","#a0ca84","#7bb984","#59a884","#3a9683","#1f837f","#077078","#035d6d"]},seq4:{2:["#e8e873","#4b5899"],3:["#e8e873","#2cbaa8","#4b5899"],4:["#e8e873","#62d198","#209eb0","#4b5899"],5:["#e8e873","#84d98c","#2cbaa8","#2d8eaf","#4b5899"],6:["#e8e873","#98dd85","#4ac9a0","#1caaae","#3483ad","#4b5899"],7:["#e8e873","#a5e081","#62d198","#2cbaa8","#209eb0","#397cab","#4b5899"],8:["#e8e873","#afe17e","#75d691","#41c5a2","#1eafad","#2795af","#3d77a9","#4b5899"],9:["#e8e873","#b6e27c","#84d98c","#53cc9d","#2cbaa8","#1ca5af","#2d8eaf","#3f74a8","#4b5899"]},seq5:{2:["#f3cdb4","#c33c3c"],3:["#f3cdb4","#dd8a6c","#c33c3c"],4:["#f3cdb4","#e5a182","#d57259","#c33c3c"],5:["#f3cdb4","#e8ac8d","#dd8a6c","#d16651","#c33c3c"],6:["#f3cdb4","#eab395","#e29879","#d87c61","#ce5e4c","#c33c3c"],7:["#f3cdb4","#ecb79a","#e5a182","#dd8a6c","#d57259","#cc5949","#c33c3c"],8:["#f3cdb4","#edba9d","#e7a788","#e09475","#da8064","#d36b54","#cb5547","#c33c3c"],9:["#f3cdb4","#eebda0","#e8ac8d","#e39b7c","#dd8a6c","#d7785e","#d16651","#ca5246","#c33c3c"]},seq6:{2:["#f6e389","#cd4c71"],3:["#f6e389","#f49566","#cd4c71"],4:["#f6e389","#f7af6b","#ec7b66","#cd4c71"],5:["#f6e389","#f8bc70","#f49566","#e66e68","#cd4c71"],6:["#f6e389","#f8c474","#f6a568","#ef8566","#e26769","#cd4c71"],7:["#f6e389","#f8c976","#f7af6b","#f49566","#ec7b66","#df626b","#cd4c71"],8:["#f6e389","#f8cd79","#f8b76d","#f6a067","#f18a66","#e87467","#dd5f6b","#cd4c71"],9:["#f6e389","#f8d07a","#f8bc70","#f7a869","#f49566","#ee8166","#e66e68","#db5c6c","#cd4c71"]},seq7:{2:["#f2e9a6","#344e31"],3:["#f2e9a6","#8a9968","#344e31"],4:["#f2e9a6","#abb47c","#6b8055","#344e31"],5:["#f2e9a6","#bcc186","#8a9968","#5d734c","#344e31"],6:["#f2e9a6","#c6c98c","#9da974","#778a5c","#546b46","#344e31"],7:["#f2e9a6","#cdce90","#abb47c","#8a9968","#6b8055","#4e6643","#344e31"],8:["#f2e9a6","#d3d293","#b4bb81","#98a570","#7c8e60","#637850","#4b6340","#344e31"],9:["#f2e9a6","#d6d596","#bcc186","#a2ad77","#8a9968","#73865a","#5d734c","#48603e","#344e31"]},seq8:{2:["#d2e2a6","#096b6d"],3:["#d2e2a6","#6ba888","#096b6d"],4:["#d2e2a6","#8cbc91","#4d9480","#096b6d"],5:["#d2e2a6","#9dc596","#6ba888","#3e897b","#096b6d"],6:["#d2e2a6","#a7cb98","#7fb48d","#599c83","#358379","#096b6d"],7:["#d2e2a6","#aecf9b","#8cbc91","#6ba888","#4d9480","#2f7f77","#096b6d"],8:["#d2e2a6","#b3d29c","#95c193","#79b08c","#5e9f85","#448e7d","#2a7c76","#096b6d"],9:["#d2e2a6","#b7d49d","#9dc596","#84b78f","#6ba888","#549982","#3e897b","#277a75","#096b6d"]},seq9:{2:["#ebdbad","#27859c"],3:["#ebdbad","#7eb699","#27859c"],4:["#ebdbad","#a2c39a","#5ba79b","#27859c"],5:["#ebdbad","#b4ca9c","#7eb699","#4b9f9c","#27859c"],6:["#ebdbad","#c0cd9e","#93be99","#68ad9a","#429a9c","#27859c"],7:["#ebdbad","#c7d0a0","#a2c39a","#7eb699","#5ba79b","#3c979d","#27859c"],8:["#ebdbad","#ccd1a1","#adc79b","#8dbc99","#6eb099","#51a29b","#38949d","#27859c"],9:["#ebdbad","#d0d2a3","#b4ca9c","#99c099","#7eb699","#63ab9a","#4b9f9c","#35929d","#27859c"]},seq10:{2:["#d0f0da","#274c72"],3:["#d0f0da","#609fa8","#274c72"],4:["#d0f0da","#82bab7","#438398","#274c72"],5:["#d0f0da","#95c8bf","#609fa8","#387590","#274c72"],6:["#d0f0da","#a0d0c4","#74afb1","#4e8e9f","#336d8b","#274c72"],7:["#d0f0da","#a8d5c7","#82bab7","#609fa8","#438398","#306887","#274c72"],8:["#d0f0da","#aed9ca","#8dc2bb","#6eabae","#5393a1","#3d7b94","#2e6484","#274c72"],9:["#d0f0da","#b2dccc","#95c8bf","#79b3b3","#609fa8","#4a8a9c","#387590","#2c6182","#274c72"]},seq11:{2:["#ffcdc6","#513a8d"],3:["#f3c0b9","#bd6f95","#513a8d"],4:["#f3c0b9","#d3899c","#a15991","#513a8d"],5:["#f3c0b9","#dc96a1","#bd6f95","#915090","#513a8d"],6:["#f3c0b9","#e19ea5","#cb7e99","#ad6293","#864a90","#513a8d"],7:["#f3c0b9","#e5a4a8","#d3899c","#bd6f95","#a15991","#7f478f","#513a8d"],8:["#f3c0b9","#e7a8aa","#d8909f","#c77a98","#b26593","#985491","#79458f","#513a8d"],9:["#f3c0b9","#e8abac","#dc96a1","#ce829a","#bd6f95","#a95e92","#915090","#75438f","#513a8d"]},seq12:{2:["#e9c5ed","#663b91"],3:["#e9c5ed","#aa7dbd","#663b91"],4:["#e9c5ed","#bf94cc","#9466ae","#663b91"],5:["#e9c5ed","#caa0d4","#aa7dbd","#895ba7","#663b91"],6:["#e9c5ed","#d0a7d9","#b78bc6","#9d6fb4","#8255a2","#663b91"],7:["#e9c5ed","#d4acdc","#bf94cc","#aa7dbd","#9466ae","#7d509f","#663b91"],8:["#e9c5ed","#d7b0df","#c59bd1","#b387c4","#a173b6","#8e60aa","#7a4d9d","#663b91"],9:["#e9c5ed","#dab2e1","#caa0d4","#ba8ec9","#aa7dbd","#996cb2","#895ba7","#784b9c","#663b91"]},div1:{2:["#2b8bab","#dc565f"],3:["#2b8bab","#eff4c8","#dc565f"],4:["#2b8bab","#a4d5b5","#e8c68b","#dc565f"],5:["#2b8bab","#7fc4b2","#eff4c8","#e7ac74","#dc565f"],6:["#2b8bab","#69bab1","#c2e2ba","#e9d9a2","#e79c6a","#dc565f"],7:["#2b8bab","#5cb2b1","#a4d5b5","#eff4c8","#e8c68b","#e69165","#dc565f"],8:["#2b8bab","#52adb0","#8fccb3","#cfe7bd","#eae1ac","#e7b87d","#e58962","#dc565f"],9:["#2b8bab","#4ca9b0","#7fc4b2","#b7ddb8","#eff4c8","#e9d299","#e7ac74","#e58360","#dc565f"]},div2:{2:["#448480","#c54b3e"],3:["#448480","#f9dd35","#c54b3e"],4:["#448480","#a0b169","#e9932f","#c54b3e"],5:["#448480","#a0b169","#f9dd35","#e9932f","#c54b3e"],6:["#448480","#82a373","#bec05c","#f0ac30","#e07b31","#c54b3e"],7:["#448480","#82a373","#bec05c","#f9dd35","#f0ac30","#e07b31","#c54b3e"],8:["#448480","#729b77","#a0b169","#cdc755","#f2b830","#e9932f","#db6e32","#c54b3e"],9:["#448480","#729b77","#a0b169","#cdc755","#f9dd35","#f2b830","#e9932f","#db6e32","#c54b3e"]},div3:{3:["#3166aa","#efefef","#c73d4b"],4:["#3166aa","#b6bfd9","#eab7b5","#c73d4b"],5:["#3166aa","#98a8cd","#efefef","#e49a99","#c73d4b"],6:["#3166aa","#869ac6","#cdd2e2","#edcdcc","#e08989","#c73d4b"],7:["#3166aa","#7a91c1","#b6bfd9","#efefef","#eab7b5","#dc7d7e","#c73d4b"],8:["#3166aa","#718bbe","#a5b2d2","#d7dbe6","#eed7d6","#e7a6a5","#da7576","#c73d4b"],9:["#3166aa","#6a86bc","#98a8cd","#c4cbde","#efefef","#ecc5c4","#e49a99","#d86e71","#c73d4b"]},div4:{2:["#518646","#d74528"],3:["#518646","#f8dea0","#d74528"],4:["#518646","#a6b26e","#e8995b","#d74528"],5:["#518646","#a6b26e","#f8dea0","#e8995b","#d74528"],6:["#518646","#8ba35d","#c1c07e","#eeb072","#e38042","#d74528"],7:["#518646","#8ba35d","#c1c07e","#f8dea0","#eeb072","#e38042","#d74528"],8:["#518646","#7d9c56","#a6b26e","#cfc887","#f0bc7e","#e8995b","#e07339","#d74528"],9:["#518646","#7d9c56","#a6b26e","#cfc887","#f8dea0","#f0bc7e","#e8995b","#e07339","#d74528"]},div5:{2:["#59a1a6","#a67b30"],3:["#59a1a6","#f5f5a3","#a67b30"],4:["#59a1a6","#a8cba4","#cdb769","#a67b30"],5:["#59a1a6","#a8cba4","#f5f5a3","#cdb769","#a67b30"],6:["#59a1a6","#8ebda5","#c2d9a4","#dacb7c","#c0a356","#a67b30"],7:["#59a1a6","#8ebda5","#c2d9a4","#f5f5a3","#dacb7c","#c0a356","#a67b30"],8:["#59a1a6","#81b6a5","#a8cba4","#cee0a4","#e1d685","#cdb769","#b9994c","#a67b30"],9:["#59a1a6","#81b6a5","#a8cba4","#cee0a4","#f5f5a3","#e1d685","#cdb769","#b9994c","#a67b30"]},div6:{2:["#8b4583","#4a6147"],3:["#8b4583","#f9f2bf","#4a6147"],4:["#8b4583","#c29ba1","#9ea781","#4a6147"],5:["#8b4583","#c29ba1","#f9f2bf","#9ea781","#4a6147"],6:["#8b4583","#b07e97","#d4b8ab","#bcbf95","#818f6d","#4a6147"],7:["#8b4583","#b07e97","#d4b8ab","#f9f2bf","#bcbf95","#818f6d","#4a6147"],8:["#8b4583","#a77092","#c29ba1","#ddc6b0","#cbcc9f","#9ea781","#738363","#4a6147"],9:["#8b4583","#a77092","#c29ba1","#ddc6b0","#f9f2bf","#cbcc9f","#9ea781","#738363","#4a6147"]},schemeGroups:{sequential:["seq1","seq2","seq3","seq4","seq5","seq6","seq7","seq8","seq9","seq10","seq11","seq12"],singlehue:[],diverging:["div1","div2","div3","div4","div5","div6"]}},cE=({source:t,selectedSource:s,setSource:n,cat1:r,setCat1:a})=>{const{pgEnv:l,baseUrl:i,falcor:c,falcorCache:d}=C.useContext(ie),u=s.viewId,m=(s==null?void 0:s.sourceId)===t.source_id,p=["dama",l,"sources","byId",t.source_id,"views","length"],x=b.useMemo(()=>parseInt(I(d,p,0)),[d]);b.useEffect(()=>{async function f(){const g=await c.get(p);await c.get(["dama",l,"sources","byId",t.source_id,"views","byIndex",{from:0,to:I(g.json,p,0)-1},"attributes",Object.values(Ot)])}f()},[c,d,t,l]);const h=b.useMemo(()=>Object.values(I(d,["dama",l,"sources","byId",t.source_id,"views","byIndex"],{})).map(f=>{var g;return ft((g=I(d,f.value,{}))==null?void 0:g.attributes)}).sort((f,g)=>new Date(g==null?void 0:g._created_timestamp)-new Date(f==null?void 0:f._created_timestamp)),[d,t.source_id]);return e.jsxs("div",{children:[e.jsx("div",{className:`w-full p-4 ${m?"bg-blue-100 hover:bg-blue-200":"bg-white hover:bg-blue-50"} overflow-hidden block border shadow flex`,onClick:()=>{if(s.sourceId!==t.source_id){const f={...t,add:!0,sourceId:t.source_id};x===1&&h.length===1&&(f.viewId=h[0].view_id),n(f)}else n({...pi,add:!0})},children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-medium w-full block",children:e.jsx("span",{children:t.name})}),e.jsx("div",{children:(I(t,"categories",[])||[]).map(f=>(typeof f=="string"?[f]:f).map((g,y)=>{const v=g===r;let j="bg-blue-100 text-blue-400 hover:bg-blue-400";return(m||v)&&(j="bg-blue-300 text-blue-500 hover:bg-blue-400",m&&v&&(j="bg-blue-400 text-blue-600 hover:bg-blue-500")),e.jsx("div",{onClick:N=>{N.stopPropagation(),a(v?"":g)},className:`inline hover:cursor-pointer text-xs p-1 px-2 ${j}  mr-2`,children:g},y)}))}),e.jsx("div",{className:"py-2 block",children:t.description})]})}),m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-200 shadow grid grid-cols-10 ",children:[e.jsx("div",{className:"border-bottom border-black border-b-2 pl-4 col-span-6",children:"Name"}),e.jsx("div",{className:"border-bottom border-black border-b-2 pl-[7px] col-span-2",children:"Date uploaded"}),e.jsx("div",{className:"border-bottom border-black border-b-2 pl-[3px] col-span-2",children:"Last modified"})]}),h.map((f,g)=>{const y=u===f.view_id,v=g%2==0,j=y?"bg-gray-300 hover:bg-gray-400":v?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200";return e.jsxs("div",{className:`${j} px-4  shadow grid grid-cols-10 gap-4`,onClick:()=>{n(y?{...s,viewId:void 0}:{...s,viewId:f.view_id})},children:[e.jsx("div",{className:"col-span-6",children:e.jsx("div",{children:f.version??f.view_id})}),e.jsx("div",{className:"flex items-center col-span-2",children:new Date(f._created_timestamp).toLocaleDateString()}),e.jsxs("div",{className:"flex items-center col-span-2",children:[new Date(f._modified_timestamp).toLocaleDateString(),y&&e.jsx(_i,{className:"ml-2 text-green-700 h-5 w-5"})]})]},`sourceview_row_${f.view_id}`)})]})]})},dE=({selectedSource:t,setSource:s})=>{var S,w;const[n,r]=b.useState(""),[a,l]=b.useState(),[i,c]=b.useState(),{pgEnv:d,baseUrl:u,falcor:m,falcorCache:p}=C.useContext(ie),[x,h]=b.useState("asc"),f="Unknown",g=((w=(S=window.location.pathname.replace(`${u}/`,""))==null?void 0:S.split("/"))==null?void 0:w[0])==="listall";b.useEffect(()=>{async function k(){const $=["dama",d,"sources","length"],E=await m.get($);await m.get(["dama",d,"sources","byIndex",{from:0,to:I(E.json,$,0)-1},"attributes",Object.values(Xt)])}k()},[m,d]);const y=b.useMemo(()=>Object.values(I(p,["dama",d,"sources","byIndex"],{})).map(k=>ft(I(p,k.value,{attributes:{}}).attributes)),[p,d]),v=[...new Set(y.filter(k=>{var $;return g||!g&&!(($=k.categories)!=null&&$.find(E=>E.includes(f)))}).reduce((k,$)=>{var E;return[...k,...((E=$.categories)==null?void 0:E.map(M=>M[0]))||[]]},[]))].sort(),j=v.reduce((k,$)=>{var E;return k[$]=(E=y.filter(M=>{var _;return(_=M.categories)==null?void 0:_.find(L=>L.includes($))}))==null?void 0:E.length,k},{}),N="bg-transparent hover:bg-blue-100 rounded-sm p-2 ml-0.5 border-2";return e.jsxs(Ct,{baseUrl:u,isListAll:g,hideBreadcrumbs:!0,children:[e.jsxs("div",{className:"py-4 flex flex-rows items-center",children:[e.jsx("input",{className:"w-full text-lg p-2 border border-gray-300 ",placeholder:"Search datasources",value:n,onChange:k=>r(k.target.value)}),e.jsx("button",{className:N,title:"Toggle Sort",onClick:()=>h(x==="asc"?"desc":"asc"),children:e.jsx("i",{className:`fa-solid ${x==="asc"?"fa-arrow-down-z-a":"fa-arrow-down-a-z"} text-xl text-blue-400`})}),e.jsx("div",{onClick:()=>{l(""),r("")},className:N,title:g?"View Key Sources":"View All Sources",children:e.jsx("i",{className:`fa-solid ${g?"fa-filter-list":"fa-list-ul"} text-xl text-blue-400`})})]}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx("div",{className:"w-1/4 flex flex-col space-y-1.5 max-h-[65dvh] overflow-auto scrollbar-sm",children:(v||[]).filter(k=>k!==f).sort((k,$)=>k.localeCompare($)).map(k=>e.jsxs("div",{className:`${a===k||i===k?"bg-blue-100 hover:bg-blue-200":"bg-white hover:bg-blue-50"}  hover:cursor-pointer p-2 rounded-md flex items-center`,onClick:()=>{l(k===a?"":k)},children:[e.jsx("i",{className:"fa fa-category"}),k,e.jsx("div",{className:"bg-blue-200 text-blue-600 text-xs w-5 h-5 ml-2 shrink-0 grow-0 rounded-lg flex items-center justify-center border border-blue-300",children:j[k]})]},k))}),e.jsx("div",{className:"w-3/4 flex flex-col space-y-1.5 ml-1.5 max-h-[65dvh] overflow-y-auto overflow-x-hidden scrollbar-sm",children:y.filter(k=>{var $;return g||!g&&!(($=k.categories)!=null&&$.find(E=>E.includes(f)))}).filter(k=>{let $=!0;return a&&($=!1,(I(k,"categories",[])||[]).forEach(E=>{E[0]===a&&(!i||E[1]===i)&&($=!0)})),$}).filter(k=>{let $=k.name+" "+((k==null?void 0:k.categories)||[]).reduce((E,M)=>(E+=Array.isArray(M)?M.join(" "):typeof M=="string"?M:"",E),"");return!n.length>2||$.toLowerCase().includes(n.toLowerCase())}).sort((k,$)=>{var M;return(x==="asc"?1:-1)*((M=k.name)==null?void 0:M.localeCompare($.name))}).map((k,$)=>e.jsx(cE,{cat1:a,setCat1:l,source:k,baseUrl:u,selectedSource:t,setSource:s},$))})]})]})},pi={active:!1,sourceId:null,viewId:null,add:!1};function uE(){const{state:t,setState:s}=C.useContext(Ne),{pgEnv:n,baseUrl:r,falcor:a,falcorCache:l}=C.useContext(ie),[i,c]=C.useState(pi);b.useEffect(()=>{async function x(){const h=["dama",n,"sources","length"],f=await a.get(h);await a.get(["dama",n,"sources","byIndex",{from:0,to:I(f.json,h,0)-1},"attributes",Object.values(Xt)])}x()},[a,n]);const d=b.useMemo(()=>Object.values(I(l,["dama",n,"sources","byIndex"],{})).map(x=>ft(I(l,x.value,{attributes:{}}).attributes)),[l,n]);b.useEffect(()=>{async function x(){const{sourceId:h}=i,f=["dama",n,"sources","byId",h,"views","length"],g=await a.get(f);return await a.get(["dama",n,"sources","byId",h,"views","byIndex",{from:0,to:I(g.json,f,0)-1},"attributes",Object.values(Ot)])}i.sourceId&&x()},[i.sourceId,a,n]);const u=b.useMemo(()=>Object.values(I(l,["dama",n,"sources","byId",i.sourceId,"views","byIndex"],{})).map(x=>ft(I(l,x.value,{attributes:{}}).attributes)),[l,i.sourceId,n]);b.useMemo(()=>{var x;return((x=t.symbology)==null?void 0:x.layers)||[]},[t.symbology]);const m=()=>{var v,j,N,S,w,k,$,E,M;const x=((v=d.filter(_=>_.source_id===+i.sourceId))==null?void 0:v[0])||{},h=((j=u.filter(_=>_.view_id===+i.viewId))==null?void 0:j[0])||{},f=Math.random().toString(36).replace(/[^a-z]+/g,""),g=(w=(S=(N=h==null?void 0:h.metadata)==null?void 0:N.tiles)==null?void 0:S.layers)==null?void 0:w[0],y={id:f,name:`${x.display_name||x.name} ${h.version||h.view_id}`,source_id:x.source_id,view_id:i.viewId,"layer-type":"simple",type:g.type,sources:((($=(k=h==null?void 0:h.metadata)==null?void 0:k.tiles)==null?void 0:$.sources)||[]).map(_=>{const L={..._};return L.id=`${_.id}_${f}`,L}),layers:lE(f,g),isVisible:!0,hover:"hover",order:((M=Object.keys(((E=t==null?void 0:t.symbology)==null?void 0:E.layers)||{}))==null?void 0:M.length)||0,filterGroupEnabled:!1,viewGroupEnabled:!1};s(_=>{var L;_!=null&&_.symbology||(_.symbology={}),(L=_==null?void 0:_.symbology)!=null&&L.layers||(_.symbology.layers={}),K(_,`symbology.layers[${f}]`,y),(!_.symbology.activeLayer||!_.symbology.layers[_.symbology.activeLayer])&&K(_,"symbology.activeLayer",y.id)}),c({add:!1,sourceId:null,viewId:null})},p=(i==null?void 0:i.sourceId)&&(i==null?void 0:i.viewId);return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"p-1 rounded hover:bg-slate-100 m-1",onClick:()=>c({...i,add:!i.add}),children:i.add?e.jsx(ms,{className:"fill-slate-500"}):e.jsx(Jr,{className:"fill-slate-500"})}),e.jsxs(Vn,{open:i.add,setOpen:()=>c({...i,add:!i.add}),width:"w-[1200px]",children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fad fa-layer-group text-blue-600","aria-hidden":"true"})}),e.jsx("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:e.jsx(Je.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Add Layer"})})]}),e.jsx("div",{className:"mt-2 w-full",children:e.jsx(dE,{selectedSource:i,setSource:c})}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex justify-end",children:[e.jsx("div",{className:"mr-1",children:e.jsx("button",{type:"button",themeOptions:{color:"cancel"},className:"inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>c({...pi}),children:"Cancel"})}),e.jsx("div",{children:e.jsx("button",{type:"button",themeOptions:p?{color:"primary"}:{color:"transparent"},disabled:!p,className:"inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>m(),children:"Add layer"})})]})]})]})}const mE=({layer:t})=>{const{state:s,setState:n}=b.useContext(Ne),{falcor:r,falcorCache:a,pgEnv:l}=b.useContext(ie),{view_id:i}=t,{zoomToFit:c}=b.useMemo(()=>({zoomToFit:I(s,"symbology.zoomToFit")}),[s]);b.useEffect(()=>{i&&r.get(["dama",l,"views","byId",i,"attributes","metadata"])},[i]);const d=b.useMemo(()=>{let x=I(a,["dama",l,"views","byId",i,"attributes","metadata","value","columns"],[]);return x.length===0&&(x=I(a,["dama",l,"views","byId",i,"attributes","metadata","value"],[])),x},[i,a]),u=b.useMemo(()=>d.extent,[d]);b.useEffect(()=>{const x=async()=>{const h=JSON.stringify({}),f=await r.get(["dama",l,"viewsbyId",i,"options",h,"databyIndex",{},["ST_AsGeojson(ST_Extent(wkb_geometry)) as bextent"]]),g=I(f,["json","dama",l,"viewsbyId",i,"options",h,"databyIndex",0,["ST_AsGeojson(ST_Extent(wkb_geometry)) as bextent"]]);r.call(["dama","views","metadata","update"],[l,i,{extent:g}]).then(y=>console.log("resp from saving view extent:",y))};Object.keys(d).length>0&&!u&&x()},[d,u]);const m=b.useMemo(()=>{if(u){const h=JSON.parse(u).coordinates[0],f=h.reduce((g,y)=>g.extend(y),new gn.LngLatBounds(h[0],h[0]));return[f._sw,f._ne]}else return null},[u]),p=Ae(JSON.stringify(c),JSON.stringify(m));return e.jsx("div",{onClick:()=>{n(x=>{p?K(x,"symbology.zoomToFit",[]):K(x,"symbology.zoomToFit",m)})},className:`${p?"bg-blue-100 hover:bg-blue-200":"hover:bg-pink-50 "} group flex w-full items-center text-slate-600 rounded-md px-2 py-2 text-sm`,children:"Zoom to Fit"})};function pE({button:t,className:s}){const[n,r]=b.useState(!1);return e.jsxs("div",{onClick:()=>r(!0),className:s,children:[e.jsx(xE,{open:n,setOpen:r}),t]})}const xi=t=>{if(t.includes("(")&&t.includes(")")){const s=t.indexOf("("),n=t.indexOf(")"),r=parseInt(t.slice(s+1,n));return isNaN(r)?t+" (1)":t.substring(0,s+1)+(r+1)+t.substring(n)}else return t+" (1)"};function xE({open:t,setOpen:s}){const n=b.useRef(null),{pgEnv:r,falcor:a,falcorCache:l,baseUrl:i}=b.useContext(ie),{state:c,setState:d,symbologies:u}=b.useContext(Ne),{symbologyId:m}=Be(),p=Le(),x=b.useMemo(()=>u.find($=>+$.symbology_id==+m),[u,m]),h={action:null,name:xi(c==null?void 0:c.name)},[f,g]=b.useState(h);b.useEffect(()=>{g({...f,name:xi(c==null?void 0:c.name)})},[c.name]);async function y(){await a.set({paths:[["dama",r,"symbologies","byId",+m,"attributes","symbology"]],jsonGraph:{dama:{[r]:{symbologies:{byId:{[+m]:{attributes:{symbology:JSON.stringify(c.symbology)}}}}}}}})}async function v(){await a.set({paths:[["dama",r,"symbologies","byId",+m,"attributes","name"]],jsonGraph:{dama:{[r]:{symbologies:{byId:{[+m]:{attributes:{name:c.name}}}}}}}})}const j=async()=>{var L,D,A;let $=JSON.stringify({...c,name:f.name});Object.keys(c.symbology.layers).forEach(T=>{const O=Math.random().toString(36).replace(/[^a-z]+/g,"");$=$.replaceAll(T,O)});const E=await a.call(["dama","symbology","symbology","create"],[r,JSON.parse($)]),M=((L=Object.keys(I(E,["json","dama",r,"symbologies","byId"],{})))==null?void 0:L[0])||!1,_=(A=(D=I(E,["json","dama",r,"symbologies","byId"],{}))==null?void 0:D[M])==null?void 0:A.attributes;M&&(await a.invalidate(["dama",r,"symbologies","byIndex"],["dama",r,"symbologies","length"]),s(!1),g({action:null,name:""}),d(_),p(`${i}/mapeditor/${M}`))},N=()=>{var E;const $=Nc+`${m}`;f.action==="save"?((E=c==null?void 0:c.symbology)!=null&&E.layers&&x&&!Ae(c==null?void 0:c.symbology,x==null?void 0:x.symbology)&&y(),c!=null&&c.name&&(c==null?void 0:c.name)!==(x==null?void 0:x.name)&&v()):f.action==="discard"?(window.localStorage.setItem($,JSON.stringify(x)),d(x)):f.action==="saveas"&&(window.localStorage.setItem($,JSON.stringify(x)),j()),s(!1),g(h)},S=b.useMemo(()=>{var $,E,M;return(($=c==null?void 0:c.symbology)==null?void 0:$.layers)&&x&&!Ae((E=c==null?void 0:c.symbology)==null?void 0:E.layers,(M=x==null?void 0:x.symbology)==null?void 0:M.layers)||(c==null?void 0:c.name)!==(x==null?void 0:x.name)},[c,x]),w=f.action?f.action==="discard"?"danger":"primary":"white",k=f.action?" ":"disabled:opacity-75 pointer-events-none	";return e.jsxs(Vn,{open:t,setOpen:s,initialFocus:n,children:[e.jsxs("div",{className:"flex items-center ",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fa-regular fa-floppy-disk text-blue-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-2 sm:mt-0 sm:text-left w-full",children:[e.jsx(Je.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Manage Changes"}),S?e.jsx("div",{className:"text-sm text-red-400 font-semibold",children:"You have unsaved changes"}):e.jsx("div",{className:"text-sm text-green-700 italic",children:"No pending changes"})]})]}),e.jsxs("div",{className:"flex items-center capitalize",children:[e.jsxs("div",{className:"mt-4 ml-1 w-32 flex  flex-col items-start justify-items-start",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"discard",name:"discard",value:"discard",type:"radio",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:f.action==="discard",disabled:!S,onChange:$=>g({...f,action:$.target.value})}),e.jsx("label",{htmlFor:"discard",className:"ml-2 text-sm text-gray-900",children:"Discard"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"save",name:"save",value:"save",type:"radio",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:f.action==="save",disabled:!S,onChange:$=>{g({...f,action:$.target.value})}}),e.jsx("label",{htmlFor:"save",className:"ml-2 text-sm text-gray-900",children:"Save"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"saveas",name:"saveas",value:"saveas",type:"radio",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:f.action==="saveas",onChange:$=>g({...f,action:$.target.value})}),e.jsx("label",{htmlFor:"saveas",className:"ml-2 text-sm text-gray-900",children:"Save As"})]})]}),f.action==="saveas"&&e.jsx("div",{className:"flex mt-4 ml-4 w-full items-start justify-items-start",children:e.jsx("input",{value:f.name,onChange:$=>g({...f,name:$.target.value}),className:"p-1 w-full bg-slate-100 ",placeholder:"New Map Name"})})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("div",{className:"px-1",children:e.jsx($e,{themeOptions:{size:"sm",color:w},className:k,disabled:!f.action,onClick:N,children:hE[f.action]??"Save ..."})}),e.jsx("div",{className:"px-1",children:e.jsx($e,{themeOptions:{size:"sm",color:"transparent"},onClick:()=>{s(!1),g(h)},children:"Cancel"})})]})]})}const hE={save:"Save Changes",saveas:"Save and Open",discard:"Discard Changes"},fE=({layer:t})=>{const{state:s,setState:n}=b.useContext(Ne),r=()=>{let a=JSON.stringify({...t,name:xi(t.name),order:Object.values(s.symbology.layers).length});const l=Math.random().toString(36).replace(/[^a-z]+/g,"");a=a.replaceAll(t.id,l),n(i=>{K(i,`symbology.layers[${l}]`,JSON.parse(a))})};return e.jsx("div",{onClick:r,className:"hover:bg-pink-50 flex w-full items-center text-slate-600 rounded-md px-2 py-2 text-sm",children:"Duplicate layer"})},gE={fill:ZL,circle:YL,line:XL};function jc({layer:t,button:s,location:n="left-0"}){const{state:r,setState:a}=C.useContext(Ne);return e.jsxs(ye,{as:"div",className:"relative inline-block text-left",children:[e.jsx(ye.Button,{children:s}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx(ye.Items,{className:`absolute ${n} mt-1 w-36 origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none`,children:e.jsxs("div",{className:"px-1 py-1 ",children:[e.jsx(ye.Item,{children:e.jsx(mE,{layer:t})}),e.jsx(ye.Item,{children:e.jsx(fE,{layer:t})}),e.jsx(ye.Item,{children:({active:l})=>e.jsx("div",{className:`${l?"bg-pink-50 ":""} group flex w-full items-center text-red-400 rounded-md px-2 py-2 text-sm`,onClick:()=>{a(i=>{delete i.symbology.layers[t.id],Object.values(i.symbology.layers).sort((c,d)=>c.order-d.order).forEach((c,d)=>c.order=d)})},children:"Remove"})})]})})})]})}function bE({index:t,layer:s,i:n}){const{state:r,setState:a}=C.useContext(Ne),{activeLayer:l}=r.symbology,i=()=>{a(u=>{u.symbology.activeLayer=l===s.id?"":s.id})},c=gE[s.type]||e.jsx("span",{}),d=s.visible;return e.jsxs("div",{className:`w-full ${l==s.id?"bg-pink-100":""} p-2 py-1 flex border-white/85 border hover:border-pink-500 group items-center`,children:[e.jsx("div",{className:"px-1",children:e.jsx(c,{className:"fill-slate-400"})}),e.jsx("div",{onClick:i,className:"text-sm text-slate-600 font-medium truncate flex-1",children:s.name}),e.jsx("div",{className:"text-sm pt-1 px-0.5 flex items-center",children:e.jsx(jc,{layer:s,button:e.jsx(Wn,{className:` ${l==s.id?"fill-pink-100":"fill-white"} cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`})})}),e.jsx("div",{onClick:()=>{a(u=>{u.symbology.layers[s.id].visible=!u.symbology.layers[s.id].visible})},children:d?e.jsx(cg,{className:` ${l==s.id?"fill-pink-100":"fill-white"} cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`}):e.jsx(dg,{className:` ${l==s.id?"fill-pink-100":"fill-white"} cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`})})]})}function yE(t){const{state:s,setState:n}=C.useContext(Ne),r=b.useMemo(()=>{var l;return((l=s.symbology)==null?void 0:l.layers)||{}},[s]),a=C.useCallback((l,i)=>{n(c=>{const d=Object.values(c.symbology.layers);let u=Object.values(c.symbology.layers).length-1,m=u-l,p=u-i;const[x]=d.splice(m,1);d.splice(p,0,x),d.forEach((h,f)=>{h.order=f}),c.symbology.layers=d.reduce((h,f)=>(h[f.id]=f,h),{})})},[]);return e.jsx(e.Fragment,{children:e.jsx("div",{className:"min-h-20 relative",children:e.jsx(Qt,{onDrop:a,offset:{x:16,y:45},children:Object.values(r).sort((l,i)=>i.order-l.order).map((l,i)=>e.jsx(bE,{layer:l,i},l.id))})})})}function vE({layer:t}){const{state:s,setState:n}=C.useContext(Ne),{activeLayer:r}=s.symbology,a=t.isVisible,l=()=>{n(i=>{i.symbology.layers[t.id].isVisible=!i.symbology.layers[t.id].isVisible,i.symbology.layers[t.id].layers.forEach((c,d)=>{let m=I(s,`symbology.layers[${t.id}].layers[${d}].layout.visibility`,"")==="visible"?"none":"visible";i.symbology.layers[t.id].layers[d].layout={visibility:m}})})};return e.jsx(e.Fragment,{children:a?e.jsx(cg,{onClick:l,className:` ${r==t.id?"fill-pink-100":"fill-white"} pt-[2px] cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`}):e.jsx(dg,{onClick:l,className:` ${r==t.id?"fill-pink-100":"fill-white"} pt-[2px] cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`})})}const An={fill:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-4 rounded ",style:{backgroundColor:s}})}),circle:({layer:t,color:s})=>{let n=I(t,"layers[0].paint['circle-stroke-color']","#ccc");return e.jsx("div",{className:"pl-0.5 pr-2",children:e.jsx("div",{className:"w-3 h-3 rounded-full ",style:{backgroundColor:s,borderColor:n}})})},line:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-1",style:{backgroundColor:s}})})},un={fill:t=>I(t,"layers[1].paint['fill-color']","#ccc"),circle:t=>I(t,"layers[0].paint['circle-color']","#ccc"),line:t=>I(t,"layers[1].paint['line-color']","#ccc")};function wE({layer:t,toggleSymbology:s,isListVisible:n}){var d,u;const{state:r,setState:a}=C.useContext(Ne);let{interactiveFilters:l}=b.useMemo(()=>({interactiveFilters:I(t,"['interactive-filters']",[])}),[t]);const i=t==null?void 0:t.selectedInteractiveFilterIndex,c=(u=(d=t==null?void 0:t["interactive-filters"])==null?void 0:d[i])==null?void 0:u["layer-type"];return e.jsxs("div",{className:"w-full max-h-[350px] overflow-x-auto scrollbar-sm",children:[c==="categories"&&e.jsx(xg,{layer:t,toggleSymbology:s}),c==="choropleth"&&e.jsx(fg,{layer:t,toggleSymbology:s}),c==="circles"&&e.jsx(hg,{layer:t,toggleSymbology:s})]})}function xg({layer:t,toggleSymbology:s}){const n=An[t.type]||An.fill;let r=(t==null?void 0:t["legend-data"])||[];return(!r||r.length===0)&&(r=[]),e.jsx("div",{className:"w-full max-h-[250px] overflow-x-auto",onClick:s,children:r.map((a,l)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-pink-50",children:[e.jsx("div",{className:"flex items-center h-6 w-10 justify-center  ",children:e.jsx(n,{color:a.color})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-500 h-6 text-sm truncate",children:a.label})]},l))})}function hg({layer:t,toggleSymbology:s}){let{minRadius:n,maxRadius:r,lowerBound:a,upperBound:l,isLoadingColorbreaks:i}=b.useMemo(()=>({isLoadingColorbreaks:I(t,"['is-loading-colorbreaks']",!1),minRadius:I(t,"['min-radius']",8),maxRadius:I(t,"['max-radius']",128),lowerBound:I(t,"['lower-bound']",null),upperBound:I(t,"['upper-bound']",null)}),[t]);return i?e.jsx("div",{className:"w-full max-h-[250px] overflow-x-auto scrollbar-sm",children:e.jsxs("div",{className:"flex w-full justify-center overflow-hidden pb-2",children:["Creating legend...",e.jsx("span",{style:{fontSize:"1.5rem"},className:"ml-2 fa-solid fa-spinner fa-spin"})]})}):e.jsxs("div",{className:"w-[33%] text-sm max-h-[250px] overflow-x-auto scrollbar-sm px-4",onClick:s,children:[e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsxs("div",{children:[n,"px"]}),e.jsxs("div",{children:[r,"px"]})]}),e.jsx("div",{className:"ml-8",children:e.jsx("i",{class:"fa-solid fa-arrow-right-long",style:{transform:"scaleX(3)"}})}),e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsx("div",{children:Rs(a)}),e.jsx("div",{children:Rs(l)})]})]})}function fg({layer:t,toggleSymbology:s}){const{state:n,setState:r}=C.useContext(Ne);let{legenddata:a,isLoadingColorbreaks:l}=b.useMemo(()=>({legenddata:I(t,"['legend-data']",[]),isLoadingColorbreaks:I(t,"['is-loading-colorbreaks']",!1)}),[n]);const i=An[t.type]||An.fill``;return l?e.jsx("div",{className:"w-full max-h-[250px] overflow-x-auto scrollbar-sm",children:e.jsxs("div",{className:"flex w-full justify-center overflow-hidden pb-2",children:["Creating legend...",e.jsx("span",{style:{fontSize:"1.5rem"},className:"ml-2 fa-solid fa-spinner fa-spin"})]})}):e.jsx("div",{className:"w-full max-h-[250px] overflow-x-auto scrollbar-sm",onClick:s,children:a.map((c,d)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-pink-50",children:[e.jsx("div",{className:"flex items-center h-6 w-10 justify-center  ",children:e.jsx(i,{color:c.color})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-500 h-6 text-sm truncate",children:c.label})]},d))})}function jE({layer:t,toggleSymbology:s}){const{state:n,setState:r}=C.useContext(Ne);let{legenddata:a,isLoadingColorbreaks:l,showOther:i}=b.useMemo(()=>({legenddata:I(t,"['legend-data']",[]),isLoadingColorbreaks:I(t,"['is-loading-colorbreaks']",!1),showOther:I(t,"['category-show-other']","#ccc")}),[n]);const c=i==="#ccc";return l?e.jsx("div",{className:"w-full max-h-[250px] overflow-x-auto scrollbar-sm",children:e.jsxs("div",{className:"flex w-full justify-center overflow-hidden pb-2",children:["Creating legend...",e.jsx("span",{style:{fontSize:"1.5rem"},className:"ml-2 fa-solid fa-spinner fa-spin"})]})}):e.jsx("div",{className:"w-full max-h-[350px] overflow-x-auto scrollbar-sm",onClick:s,children:e.jsx("div",{className:"flex-1 flex w-full p-2",children:a.map((d,u)=>e.jsxs("div",{className:"flex-1 h-6",children:[e.jsx("div",{className:"flex justify-self-end text-xs h-4",children:c&&u===a.length-1?"N/A":a[u].label}),e.jsx("div",{className:"flex-1 h-2",style:{backgroundColor:d.color}},u)]},`horizontal_legend_item_${u}`))})})}function CE({layer:t,i:s,numLayers:n,onRowMove:r}){var B;const{state:a,setState:l}=C.useContext(Ne),{falcor:i,falcorCache:c,pgEnv:d}=b.useContext(ie),{activeLayer:u}=a.symbology,[m,p]=C.useState(!0);let{layerType:x,legendOrientation:h,selectedInteractiveFilterIndex:f,interactiveFilters:g,dataColumn:y,filterGroup:v,filterGroupLegendColumn:j,filterGroupName:N,viewGroup:S,viewGroupName:w,sourceId:k,dynamicFilters:$}=b.useMemo(()=>({initialViewId:I(t,"initial-view-id"),sourceId:I(t,"source_id"),legendOrientation:I(t,"['legend-orientation']","vertical"),layerType:I(t,"['layer-type']"),selectedInteractiveFilterIndex:I(t,"['selectedInteractiveFilterIndex']"),interactiveFilters:I(t,"['interactive-filters']",[]),dataColumn:I(t,"['data-column']",[]),filterGroup:I(t,"['filter-group']",[]),filterGroupName:I(t,"['filter-group-name']",""),filterGroupLegendColumn:I(t,"['filter-group-legend-column']",""),viewGroup:I(t,"['filter-source-views']",[]),viewGroupName:I(t,"['view-group-name']",""),dynamicFilters:I(t,"['dynamic-filters']",[])}),[a,t]);const E=()=>{l(F=>{F.symbology.activeLayer=u===t.id?"":t.id})},M=x==="simple"||x==="interactive"&&((B=g==null?void 0:g[f])==null?void 0:B["layer-type"])==="simple"||!x,_=An[t.type]||An.fill;let L=un!=null&&un[t==null?void 0:t.type]?un==null?void 0:un[t==null?void 0:t.type](t):"#fff";const D=t.name??N,A=e.jsxs("div",{className:"flex justify-between items-center justify w-full",onClick:E,children:[M&&e.jsxs("div",{className:"pl-1 flex",children:[e.jsx(_,{layer:t,color:L}),D]}),!M&&D,e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"text-sm pt-1  flex items-center",children:e.jsx(jc,{layer:t,button:e.jsx(Wn,{className:` ${u==t.id?"fill-pink-100":"fill-white"} pb-[2px] cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`})})}),e.jsx(mg,{onClick:()=>{r(s,s-1)},size:24,className:`${s===0?"pointer-events-none":""} mr-[-6px] ${u==t.id?"fill-pink-100":"fill-white"}  pt-[2px] cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`}),e.jsx(ug,{onClick:()=>{r(s,s+1)},size:24,className:`${s===n-1?"pointer-events-none":""} mr-[-3px] ${u==t.id?"fill-pink-100":"fill-white"} pb-[2px] cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700`}),e.jsx(vE,{layer:t})]})]});C.useEffect(()=>{async function F(){const z=["dama",d,"sources","byId",k,"views","length"],P=await i.get(z);return await i.get(["dama",d,"sources","byId",k,"views","byIndex",{from:0,to:I(P.json,z,0)-1},"attributes",Object.values(Ot)])}k&&F()},[k,i,d]);const T=C.useMemo(()=>Object.values(I(c,["dama",d,"sources","byId",k,"views","byIndex"],{})).map(F=>ft(I(c,F.value,{attributes:{}}).attributes)),[c,k,d]),O=[];return x==="interactive"&&O.push(e.jsxs("div",{className:"text-slate-600 font-medium truncate flex-1",children:[e.jsx("div",{className:"text-xs text-black",children:"Filters:"}),e.jsx("div",{className:"rounded-md h-[36px] pl-0 flex w-full w-[216px] items-center border border-transparent cursor-pointer hover:border-slate-300",children:e.jsx("select",{className:"w-full bg-transparent",value:f,onChange:F=>{l(z=>{z.symbology.layers[t.id].selectedInteractiveFilterIndex=parseInt(F.target.value)})},children:g.map((F,z)=>e.jsx("option",{value:z,children:F.label},z))})})]})),t.filterGroupEnabled&&O.push(e.jsxs("div",{className:"text-slate-600 font-medium truncate flex-1 items-center",children:[e.jsxs("div",{className:"text-xs text-black",children:[N,":"]}),e.jsx("div",{className:"rounded-md h-[36px] pl-0 flex w-full w-[216px] items-center border border-transparent cursor-pointer hover:border-slate-300",children:e.jsx("select",{className:"w-full bg-transparent",value:y,onChange:F=>{l(z=>{x==="interactive"?(z.symbology.layers[t.id]["interactive-filters"][f]["data-column"]=F.target.value,z.symbology.layers[t.id]["interactive-filters"][f]["layer-type"]==="categories"&&(z.symbology.layers[t.id]["interactive-filters"][f].categories={})):(z.symbology.layers[t.id]["data-column"]=F.target.value,x==="categories"&&(z.symbology.layers[t.id].categories={}))})},children:v.map((F,z)=>{const P=j===F.column_name?"**":j?` (${j})`:"";return e.jsxs("option",{value:F.column_name,children:[F.display_name," ",P]},z)})})})]})),t.viewGroupEnabled&&O.push(e.jsxs("div",{className:"text-slate-600 font-medium truncate flex-1 items-center",children:[e.jsxs("div",{className:"text-xs text-black",children:[w,": "]}),e.jsx("div",{className:"rounded-md h-[36px] pl-0 flex w-full w-[216px] items-center border border-transparent cursor-pointer hover:border-slate-300",children:e.jsx("select",{className:"w-full bg-transparent",value:t.view_id,onChange:F=>{l(z=>{const P=JSON.parse(JSON.stringify(z.symbology.layers[t.id].layers).replaceAll(t.view_id,F.target.value));z.symbology.layers[t.id].layers=P;const U=JSON.parse(JSON.stringify(z.symbology.layers[t.id].sources).replaceAll(t.view_id,F.target.value));z.symbology.layers[t.id].sources=U,z.symbology.layers[t.id].view_id=F.target.value})},children:S.map((F,z)=>{const P=T.find(U=>U.view_id===F);return e.jsx("option",{value:F,children:(P==null?void 0:P.version)??(P==null?void 0:P.view_id)},z)})})})]})),$.length>0&&O.push(e.jsx(kE,{layer:t},`${t.id}_dynamic_filter`)),e.jsxs("div",{className:`${u==t.id?"bg-pink-100":""} hover:border-pink-500 group border`,children:[e.jsx("div",{className:`w-full px-2 pt-1 pb-0 flex border-blue-50/50 border justify-between items-center ${x==="interactive"&&!M?"pl-[3px]":""}`,children:e.jsxs("div",{className:"text-sm mr-1 flex flex-col justify-start align-start content-start flex-wrap w-full",children:[A,O]})}),h!=="none"&&(h==="horizontal"?e.jsx(jE,{layer:t,toggleSymbology:E}):e.jsxs(e.Fragment,{children:[x==="categories"&&e.jsx(xg,{layer:t,toggleSymbology:E}),x==="circles"&&e.jsx(hg,{layer:t,toggleSymbology:E}),x==="choropleth"&&e.jsx(fg,{layer:t,toggleSymbology:E}),x==="interactive"&&e.jsx(wE,{layer:t,toggleSymbology:E,isListVisible:m})]}))]})}function NE(t){const{state:s,setState:n}=C.useContext(Ne),r=b.useMemo(()=>{var i;return((i=s.symbology)==null?void 0:i.layers)||{}},[s]),a=C.useCallback((i,c)=>{n(d=>{const u=Object.values(d.symbology.layers);u.sort((p,x)=>x.order-p.order);const[m]=u.splice(i,1);u.splice(c,0,m),u.reverse().forEach((p,x)=>{p.order=x}),d.symbology.layers=u.reverse().reduce((p,x)=>(p[x.id]=x,p),{})})},[]),l=b.useMemo(()=>Object.values(r).length,[r]);return e.jsx(e.Fragment,{children:e.jsx("div",{className:"min-h-20 relative max-h-[calc(100vh_-_220px)] scrollbar-sm ",children:Object.values(r).sort((i,c)=>c.order-i.order).map((i,c)=>e.jsx(CE,{layer:i,i:c,numLayers:l,onRowMove:a},i.id))})})}const kE=({layer:t})=>{const{state:s,setState:n}=C.useContext(Ne),{falcor:r,falcorCache:a,pgEnv:l}=b.useContext(ie);let{layerType:i,dynamicFilters:c,viewId:d}=b.useMemo(()=>({viewId:I(t,"view_id"),layerType:I(t,"['layer-type']"),dynamicFilters:I(t,"['dynamic-filters']",[])}),[s,t]);const u=c==null?void 0:c.map(m=>m.column_name);return C.useEffect(()=>{u.length>0&&u.forEach(m=>{const p=JSON.stringify({groupBy:[m.split("AS ")[0]],exclude:{[m.split("AS ")[0]]:["null"]},orderBy:{2:"desc"}});r.get(["dama",l,"viewsbyId",d,"options",p,"databyIndex",{from:0,to:200},[m,"count(1)::int as count"]])})},[u,i,d]),e.jsxs("div",{className:"flex my-2 flex-col",children:[e.jsx("b",{children:"Dynamic Filters:"}),c.map((m,p)=>{const x=m.column_name,h=JSON.stringify({groupBy:[x.split("AS ")[0]],exclude:{[x.split("AS ")[0]]:["null"]},orderBy:{2:"desc"}}),f=Object.values(I(a,["dama",l,"viewsbyId",d,"options",h,"databyIndex"],[])).map(g=>g==null?void 0:g[x]).filter(g=>typeof g!="object");return f.sort(),e.jsx("div",{className:"w-full",children:e.jsx($E,{layer:t,filterIndex:p,sampleData:f,button:e.jsxs("div",{className:"flex w-full p-1 pl-0 rounded items-center justify-between border-transparent border hover:border-gray-300",children:[m.display_name," ",e.jsx(Uo,{className:""})," "]})})},`${x}_${p}_legend_filter_option_row`)})]})};function $E({button:t,layer:s,sampleData:n,filterIndex:r}){const{state:a,setState:l}=C.useContext(Ne),{filterValues:i}=b.useMemo(()=>({filterValues:I(s,`['dynamic-filters'][${r}].values`,[])}),[a,r]);return e.jsxs(ye,{as:"div",className:"relative inline-block text-left w-full",children:[e.jsx(ye.Button,{as:"div",children:t}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx(ye.Items,{anchor:"right",className:"absolute w-48 origin-top-right divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none",children:e.jsx("div",{className:" p-2 max-h-[250px] overflow-auto ",children:n.map(c=>e.jsx(ye.Item,{children:({active:d})=>e.jsxs("div",{className:`${d?"bg-pink-50 ":""} group flex w-full items-center rounded-md px-1 py-1 text-sm`,onClick:u=>{u.preventDefault(),u.stopPropagation()},children:[e.jsx("input",{type:"checkbox",checked:i.includes(c),onChange:u=>{if(i.includes(c))l(m=>{m.symbology.layers[s.id]["dynamic-filters"][r].values=i.filter(p=>p!==c)});else{const m=[...i];m.push(c),l(p=>{console.log(JSON.parse(JSON.stringify(p.symbology.layers[s.id]))),p.symbology.layers[s.id]["dynamic-filters"][r].values=m})}}}),e.jsx("div",{className:"truncate flex items-center text-[15px] px-4 py-1",children:c})]})},`menu_item_${c}`))})})})]})}function SE(){const{state:t}=C.useContext(Ne),s=["Legend","Layers"];return e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-white/95 w-[340px] rounded-lg drop-shadow-lg pointer-events-auto min-h-[400px] max-h-[calc(100vh_-_111px)] scroll-xs",children:[e.jsx(IM,{}),(t==null?void 0:t.symbology_id)&&e.jsxs(Te.Group,{children:[e.jsxs("div",{className:"flex justify-between items-center border-b",children:[e.jsx(Te.List,{children:s.map(n=>e.jsx(Te,{as:b.Fragment,children:({selected:r})=>e.jsx("button",{className:`
                        ${r?"text-slate-600 border-b font-medium border-slate-600":"text-slate-400"} mx-1 text-sm p-2 cursor-pointer
                      `,children:n})},n))}),e.jsx(uE,{})]}),e.jsxs(Te.Panels,{children:[e.jsx(Te.Panel,{children:e.jsx(NE,{})}),e.jsx(Te.Panel,{children:e.jsx(yE,{})})]})]})]})})}const gg={fill:[{label:"Type",type:"inline",controls:[{type:"selectType",params:{options:[{name:"Simple",value:"simple"},{name:"Categories",value:"categories"},{name:"Color Range",value:"choropleth"},{name:"Interactive",value:"interactive"}]},path:"['layer-type']",datapath:"layers[1].paint['fill-color']"}]},{label:"Color By",type:"inline",conditional:[{path:"['layer-type']",conditions:["categories","choropleth"]},{path:"['filterGroupEnabled']",conditions:[!1]}],controls:[{type:"selectViewColumn",params:{options:[{name:"Column Select",value:"simple"}]},path:"['data-column']"}]},{label:"Filter Group",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth"]},controls:[{type:"toggleControl",path:"['filterGroupEnabled']",title:"filter group"}]},{label:"",type:"popover",conditional:[{path:"['filterGroupEnabled']",conditions:[!0]},{path:"['layer-type']",conditions:["categories","choropleth"]}],controls:[{type:"filterGroupControl",path:"['filter-group']",params:{format:t=>`${t==null?void 0:t.length} columns`}}]},{label:"View Group",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth"]},controls:[{type:"toggleControl",path:"['viewGroupEnabled']",title:"View Group"}]},{label:"",type:"popover",conditional:[{path:"['viewGroupEnabled']",conditions:[!0]},{path:"['layer-type']",conditions:["categories","choropleth"]}],controls:[{type:"viewGroupControl",path:"['filter-source-views']",params:{format:t=>`${t==null?void 0:t.length} views`}}]},{label:"Categories",type:"popover",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoryControl",params:{options:[{name:"Column Select",value:"simple"}],format:t=>`${((t==null?void 0:t.length)-3||0)/2||"10"} Categories`},path:"layers[1].paint['fill-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoricalColor",path:"['color-set']"}]},{label:"Scale",type:"popover",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"choroplethControl",params:{format:t=>{var s;return`${(((s=t==null?void 0:t[3])==null?void 0:s.length)-3||0)/2||"10"} Categories`}},path:"layers[1].paint['fill-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"rangeColor",path:"['color-range']"}]},{label:"Fill",type:"popover",conditional:{path:"['layer-type']",conditions:["simple"]},controls:[{type:"color",path:"layers[1].paint['fill-color']"}]},{label:"Stroke",type:"popover",conditional:{path:"['layer-type']",conditions:["categories","choropleth","simple"]},controls:[{type:"color",path:"layers[0].paint['line-color']"},{type:"range",unit:"px",path:"layers[0].paint['line-width']",params:{min:"0",max:"10",step:"0.5",default:"3",units:"px"}}]},{label:"Interactive Filters",type:"full-width",conditional:{path:"['layer-type']",conditions:["interactive"]},controls:[{type:"interactiveFilterControl",path:"['interactive-filters']"}]},{label:"Opacity",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth","simple"]},controls:[{type:"range",unit:"%",path:"layers[1].paint['fill-opacity']",params:{min:"0",max:"1",step:"0.01",default:"0.75",units:"%",format:t=>Math.round(t*100)}}]}],circle:[{label:"Type",type:"inline",controls:[{type:"selectType",params:{options:[{name:"Simple",value:"simple"},{name:"Categories",value:"categories"},{name:"Color Range",value:"choropleth"},{name:"Circles",value:"circles"},{name:"Interactive",value:"interactive"}]},path:"['layer-type']",datapath:"layers[0].paint['circle-color']"}]},{label:"Color By",type:"inline",conditional:[{path:"['layer-type']",conditions:["categories","choropleth"]},{path:"['filterGroupEnabled']",conditions:[!1]}],controls:[{type:"selectViewColumn",params:{options:[{name:"Column Select",value:"simple"}]},path:"['data-column']",datapath:"['category-data']"}]},{label:"Radius By",type:"inline",conditional:[{path:"['layer-type']",conditions:["circles"]},{path:"['filterGroupEnabled']",conditions:[!1]}],controls:[{type:"selectViewColumn",params:{options:[{name:"Column Select",value:"simple"}]},path:"['data-column']",datapath:"['category-data']"}]},{label:"Filter Group",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth","circles"]},controls:[{type:"toggleControl",path:"['filterGroupEnabled']",title:"filter group"}]},{label:"",type:"popover",conditional:[{path:"['filterGroupEnabled']",conditions:[!0]},{path:"['layer-type']",conditions:["categories","choropleth","circles"]}],controls:[{type:"filterGroupControl",path:"['filter-group']",params:{format:t=>`${t==null?void 0:t.length} columns`}}]},{label:"View Group",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth","circles"]},controls:[{type:"toggleControl",path:"['viewGroupEnabled']",title:"View Group"}]},{label:"",type:"popover",conditional:[{path:"['viewGroupEnabled']",conditions:[!0]},{path:"['layer-type']",conditions:["categories","choropleth","circles"]}],controls:[{type:"viewGroupControl",path:"['filter-source-views']",params:{format:t=>`${t==null?void 0:t.length} views`}}]},{label:"Categories",type:"popover",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoryControl",params:{options:[{name:"Column Select",value:"simple"}],format:t=>`${((t==null?void 0:t.length)-3||0)/2||"10"} Categories`},path:"layers[0].paint['circle-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoricalColor",path:"['color-set']"}]},{label:"Scale",type:"popover",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"choroplethControl",params:{format:t=>{var s;return`${(((s=t==null?void 0:t[3])==null?void 0:s.length)-3||0)/2||"10"} Categories`}},path:"layers[0].paint['circle-color']"}]},{label:"Scale",type:"popover",conditional:{path:"['layer-type']",conditions:["circles"]},controls:[{type:"circleControl",params:{format:t=>`${t[4]}px - ${t[6]}px`},path:"layers[0].paint['circle-radius']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["circles"]},controls:[{type:"color",path:"layers[0].paint['circle-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"rangeColor",path:"['color-range']"}]},{label:"Fill",type:"popover",conditional:{path:"['layer-type']",conditions:["simple"]},controls:[{type:"color",path:"layers[0].paint['circle-color']"}]},{label:"Size",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth","simple"]},controls:[{type:"range",unit:"%",path:"layers[0].paint['circle-radius']",params:{min:"0",max:"20",step:"0.5",default:"3",units:"px"}}]},{label:"Stroke",type:"popover",conditional:{path:"['layer-type']",conditions:["categories","choropleth","simple","circles"]},controls:[{type:"color",path:"layers[0].paint['circle-stroke-color']"},{type:"range",unit:"px",path:"layers[0].paint['circle-stroke-width']",params:{min:"0",max:"20",step:"0.5",default:"3",units:"px"}}]},{label:"Interactive Filters",type:"full-width",conditional:{path:"['layer-type']",conditions:["interactive"]},controls:[{type:"interactiveFilterControl",path:"['interactive-filters']"}]},{label:"Opacity",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth","simple","circles"]},controls:[{type:"range",unit:"%",path:"layers[0].paint['circle-opacity']",params:{min:"0",max:"1",step:"0.01",default:"0.75",units:"%",format:t=>Math.round(t*100)}}]}],line:[{label:"Type",type:"inline",controls:[{type:"selectType",params:{options:[{name:"Simple",value:"simple"},{name:"Categories",value:"categories"},{name:"Color Range",value:"choropleth"},{name:"Interactive",value:"interactive"}]},path:"['layer-type']",datapath:"layers[1].paint['line-color']"}]},{label:"Color By",type:"inline",conditional:[{path:"['layer-type']",conditions:["categories","choropleth"]},{path:"['filterGroupEnabled']",conditions:[!1]}],controls:[{type:"selectViewColumn",params:{options:[{name:"Column Select",value:"simple"}]},path:"['data-column']",datapath:"['category-data']"}]},{label:"",type:"popover",conditional:[{path:"['filterGroupEnabled']",conditions:[!0]},{path:"['layer-type']",conditions:["categories","choropleth"]}],controls:[{type:"filterGroupControl",path:"['filter-group']",params:{format:t=>`${t==null?void 0:t.length} columns`}}]},{label:"Filter Group",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth"]},controls:[{type:"toggleControl",path:"['filterGroupEnabled']",title:"filter group"}]},{label:"View Group",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth"]},controls:[{type:"toggleControl",path:"['viewGroupEnabled']",title:"View Group"}]},{label:"",type:"popover",conditional:[{path:"['viewGroupEnabled']",conditions:[!0]},{path:"['layer-type']",conditions:["categories","choropleth"]}],controls:[{type:"viewGroupControl",path:"['filter-source-views']",params:{format:t=>`${t==null?void 0:t.length} views`}}]},{label:"Categories",type:"popover",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoryControl",params:{options:[{name:"Column Select",value:"simple"}],format:t=>`${((t==null?void 0:t.length)-3||0)/2||"10"} Categories`},path:"layers[1].paint['line-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["categories"]},controls:[{type:"categoricalColor",path:"['color-set']"}]},{label:"Scale",type:"popover",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"choroplethControl",params:{format:t=>{var s;return`${(((s=t==null?void 0:t[3])==null?void 0:s.length)-3||0)/2||"10"} Categories`}},path:"layers[1].paint['line-color']"}]},{label:"Fill",type:"inline",conditional:{path:"['layer-type']",conditions:["choropleth"]},controls:[{type:"rangeColor",path:"['color-range']"}]},{label:"Fill",type:"popover",conditional:{path:"['layer-type']",conditions:["simple"]},controls:[{type:"color",path:"layers[1].paint['line-color']"}]},{label:"Size",type:"inline",controls:[{type:"range",unit:"%",path:"layers[1].paint['line-width']",params:{min:"0",max:"20",step:"0.5",default:"3",units:"px"}}]},{label:"Offset",type:"inline",controls:[{type:"range",unit:"%",path:"layers[1].paint['line-offset']",params:{min:"-10",max:"10",step:"0.5",default:"0",units:"px"}}]},{label:"Casing",type:"popover",controls:[{type:"color",path:"layers[0].paint['line-color']"},{type:"range",unit:"px",path:"layers[0].paint['line-width']",params:{min:"0",max:"20",step:"0.5",default:"0",units:"px"}},{type:"range",unit:"px",path:"layers[0].paint['line-offset']",params:{min:"-10",max:"10",step:"0.5",default:"0",units:"px"}}]},{label:"Opacity",type:"inline",conditional:{path:"['layer-type']",conditions:["categories","choropleth","simple"]},controls:[{type:"range",unit:"%",path:"layers[1].paint['line-opacity']",params:{min:"0",max:"1",step:"0.01",default:"0.75",units:"%",format:t=>Math.round(t*100)}}]},{label:"Interactive Filters",type:"full-width",conditional:{path:"['layer-type']",conditions:["interactive"]},controls:[{type:"interactiveFilterControl",path:"['interactive-filters']"}]}]},_E=(t,s)=>t.filter(n=>!s.includes(n));function IE({path:t,params:s={}}){var E,M;const{state:n,setState:r}=C.useContext(Ne),{falcor:a,falcorCache:l,pgEnv:i}=C.useContext(ie),c=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`;let{value:d,column:u,categorydata:m,colors:p,sourceId:x,categories:h,showOther:f,legenddata:g}=b.useMemo(()=>({sourceId:I(n,`symbology.layers[${n.symbology.activeLayer}].source_id`),value:I(n,`${c}.${t}`,{}),column:I(n,`${c}['data-column']`,""),categorydata:I(n,`${c}['category-data']`,{}),colors:I(n,`${c}['color-set']`,wc.cat1),categories:I(n,`${c}['categories']`,{}),showOther:I(n,`${c}['category-show-other']`,"#ccc"),legenddata:I(n,`${c}['legend-data']`,[])}),[n]);const[y,v]=C.useState();b.useEffect(()=>{x&&a.get(["dama",i,"sources","byId",x,"attributes","metadata"])},[x]);const j=b.useMemo(()=>{var L,D;let _=I(l,["dama",i,"sources","byId",x,"attributes","metadata","value","columns"],[]);return _.length===0&&(_=I(l,["dama",i,"sources","byId",x,"attributes","metadata","value"],[])),JSON.parse(((D=((L=_.filter(A=>A.name===u))==null?void 0:L[0])||{})==null?void 0:D.meta_lookup)||"{}")},[x,l]),N=b.useMemo(()=>Object.values(m).reduce((_,L)=>(typeof L[u]!="object"&&_++,_),0),[m]),S=((E=h==null?void 0:h.legend)==null?void 0:E.filter(_=>_.label!=="Other"))??[],w=_E(Object.values(m).filter(_=>typeof _[u]!="object").map(_=>_[u]),S.map(_=>_.label)).map(_=>({label:_,value:_})),k=f==="#ccc",$=[10,20,30,50,100];return e.jsxs("div",{className:" w-full items-center",children:[y!==void 0&&e.jsx(e.Fragment,{children:e.jsxs("label",{className:"flex",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("input",{type:"color",value:Ks(I(n,`${c}['categories'].legend[${y}].color`,p[y%p.length])),onChange:_=>{const L=[...d],D=L.indexOf(S[y].label);L.splice(D+1,1,_.target.value),r(A=>{const T=S.map((O,B)=>B===y?{color:_.target.value,label:I(j,O.label,O.label)}:{color:O.color,label:I(j,O.label,O.label)});K(A,`${c}['legend-data']`,T),K(A,`${c}['categories']`,{paint:L,legend:T})})}})}),e.jsxs("div",{className:"flex items-center p-2",children:["Custom color for ",(M=S[y])==null?void 0:M.label," "]})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Showing"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsxs("select",{className:"w-full p-2 bg-transparent text-slate-700 text-sm",value:S.length,onChange:_=>{_.target.value<=y&&v(void 0),r(L=>{K(L,`${c}['categories']`,{}),K(L,`${c}.['num-categories']`,_.target.value)})},children:[e.jsxs("option",{value:S.length,children:[S.length," Categories"]},"def"),$.filter((_,L)=>_!==S.length&&(_<N||$[L-1]<N)).map((_,L)=>e.jsxs("option",{value:_,children:[_," Categories"]},L))]})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Show Other"}),e.jsx("div",{className:"flex items-center",children:e.jsxs(sn,{checked:k,onChange:()=>{r(_=>{const L=k?"rgba(0,0,0,0)":"#ccc";K(_,`${c}['category-show-other']`,L)})},className:`${k?"bg-blue-500":"bg-gray-200"} relative inline-flex h-4 w-8 items-center rounded-full `,children:[e.jsx("span",{className:"sr-only",children:"Show other"}),e.jsx("div",{className:`${k?"translate-x-5":"translate-x-0"} inline-block h-4 w-4  transform rounded-full bg-white transition border-[0.5] border-slate-600`})]})})]}),e.jsxs("div",{className:"w-full max-h-[250px] overflow-auto",children:[e.jsx(Qt,{onDrop:(_,L)=>{r(D=>{const A=[...S],[T]=A.splice(_,1);A.splice(L,0,T),K(D,`${c}['categories']['legend']`,A);const O=[...g],[B]=O.splice(_,1);O.splice(L,0,B),K(D,`${c}['legend-data']`,O)})},children:S.map((_,L)=>e.jsxs("div",{className:"group/title w-full flex items-center hover:bg-slate-100",children:[e.jsx("div",{className:"flex items-center h-8 w-8 justify-center  border-r border-b ",onClick:()=>{v(y!==L?L:void 0)},children:e.jsx("div",{className:"w-4 h-4 rounded border-[0.5px] border-slate-600",style:{backgroundColor:_.color}})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-600 border-b h-8 truncate",children:_.label}),e.jsx("div",{className:"group/icon border-b w-8 h-8 flex items-center border-slate-200 cursor-pointer fill-white group-hover/title:fill-slate-300 hover:bg-slate-200",onClick:()=>{const D=[...d],A=S.filter(O=>O.label!==_.label),T=D.indexOf(_.label);D.splice(T,2),r(O=>{K(O,`${c}['legend-data']`,A),K(O,`${c}.['num-categories']`,A.length),K(O,`${c}['categories']`,{paint:D,legend:A.map(B=>({color:B.color,label:I(j,B.label,B.label)}))})})},children:e.jsx(ms,{className:"mx-[6px] cursor-pointer group-hover/icon:fill-slate-500 "})})]},L))}),k&&e.jsxs("div",{className:"w-full flex items-center hover:bg-slate-100",children:[e.jsx("div",{className:"flex items-center h-8 w-8 justify-center  border-r border-b ",children:e.jsx("div",{className:"w-4 h-4 rounded border-[0.5px] border-slate-600",style:{backgroundColor:f}})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-600 border-b h-8 truncate",children:"Other"})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center mx-4",children:"Add Column"}),e.jsx("div",{className:"flex-1 flex items-center mx-4 pb-4",children:e.jsx(os,{children:e.jsx("label",{className:"flex w-full",children:e.jsx("div",{className:"flex w-full items-center",children:e.jsxs("select",{className:"w-full py-2 bg-transparent",value:"",onChange:_=>{const L=[...d],D=[...S],A=L[L.length-2],T=p.map(B=>Ka(B)).indexOf(A),O=T<p.length-1?p[T+1]:p[0];D.push({color:O,label:_.target.value}),L.splice(d.length-1,0,_.target.value,Ka(O)),r(B=>{K(B,`${c}['categories']`,{paint:L,legend:D.map(F=>({color:F.color,label:I(j,F.label,F.label)}))}),K(B,`${c}.['num-categories']`,D.length),K(B,`${c}['legend-data']`,D)})},children:[e.jsx("option",{value:""},-1),(w||[]).map((_,L)=>e.jsx("option",{value:_.value,children:_.label},L))]})})})})})]})]})]})}function Go({path:t,params:s={enableBuilder:!0}}){const{enableBuilder:n}=s,{state:r,setState:a}=C.useContext(Ne),{value:l,selectedInteractiveFilterIndex:i,layerName:c,activeLayer:d}=b.useMemo(()=>{var m;return{value:I(r,`symbology.layers[${r.symbology.activeLayer}].${t}`,[]),selectedInteractiveFilterIndex:I(r,`symbology.layers[${r.symbology.activeLayer}]['selectedInteractiveFilterIndex']`),layerName:I(r,`symbology.layers[${r.symbology.activeLayer}]['name']`,""),activeLayer:I(r,`symbology.layers[${(m=r==null?void 0:r.symbology)==null?void 0:m.activeLayer}]`,{})}},[r]);b.useEffect(()=>{i!==void 0&&!l[i]&&a(m=>{K(m,`symbology.layers[${r.symbology.activeLayer}]['selectedInteractiveFilterIndex']`,void 0)})},[l]);const u=n&&i!==void 0&&i!==null;return e.jsxs("div",{className:" w-full items-center mt-2",children:[e.jsxs("div",{className:"w-full text-slate-500 text-[14px] flex justify-between ",children:["Interactive Filters",n&&e.jsxs("div",{className:"flex justify-end",children:[e.jsx($e,{themeOptions:{size:"xs",color:"danger"},className:"col-span-2 capitalize mb-2 mr-6",onClick:()=>{a(m=>{const p=I(m,`symbology.layers[${r.symbology.activeLayer}].${t}`);p.splice(i,1),K(m,`symbology.layers[${r.symbology.activeLayer}].${t}`,p)})},children:e.jsx(ms,{size:12,className:"fill-gray-200"})}),e.jsx($e,{themeOptions:{size:"xs",color:"primary"},className:"col-span-2 capitalize mb-2",onClick:()=>{a(m=>{const p={...d,"layer-type":"simple",label:`${c}`,selectedInteractiveFilterIndex:void 0,filterGroupEnabled:!1,viewGroupEnabled:!1,"filter-group":[],"filter-group-name":"","view-group-name":"","filter-source-views":[],"interactive-filters":null},x=[...l,p];K(m,`symbology.layers[${r.symbology.activeLayer}].${t}`,x),K(m,`symbology.layers[${r.symbology.activeLayer}]['selectedInteractiveFilterIndex']`,x.length-1)})},children:e.jsx(Jr,{className:"fill-gray-200 p-0.5"})})]})]}),e.jsx("div",{className:"w-full p-2 bg-blue-100 text-slate-700 text-sm mb-2 rounded",children:e.jsx("select",{className:"bg-blue-100 w-full",value:i,onChange:m=>{a(p=>{K(p,`symbology.layers[${r.symbology.activeLayer}]['selectedInteractiveFilterIndex']`,m.target.value)})},children:(l||[]).map((m,p)=>e.jsx("option",{value:p,children:m.label},p))})}),u&&e.jsx(LE,{})]})}const LE=()=>{var a;const{state:t,setState:s}=C.useContext(Ne),{interactiveFilters:n,selectedInteractiveFilterIndex:r}=b.useMemo(()=>({interactiveFilters:I(t,`symbology.layers[${t.symbology.activeLayer}]['interactive-filters']`,[]),selectedInteractiveFilterIndex:I(t,`symbology.layers[${t.symbology.activeLayer}]['selectedInteractiveFilterIndex']`,[])}),[t]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"truncate col-span-10 group",children:["Editing:",e.jsx("input",{type:"text",className:" px-2  border text-sm border-transparent group-hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent text-slate-700 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",value:(a=n[r])==null?void 0:a.label,onChange:l=>{s(i=>{K(i,`symbology.layers[${t.symbology.activeLayer}]['interactive-filters'][${r}].label`,l.target.value)})}})]}),e.jsx(vg,{type:"interactive",pathPrefix:`['interactive-filters'][${r}]`})]})},EE=(t,s)=>t.filter(n=>!s.includes(n));function ME({path:t,params:s={},setFilterGroupLegendColumn:n}){const{state:r,setState:a}=C.useContext(Ne),l=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${r.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${r.symbology.activeLayer}]`,{selectedColumns:i,layerType:c,filterGroupLegendColumn:d}=b.useMemo(()=>({selectedColumns:I(r,`${l}.${t}`),layerType:I(r,`${l}['layer-type']`),filterGroupLegendColumn:I(r,`${l}['filter-group-legend-column']`)}),[r,t,s]),u=I(r,`symbology.layers[${r.symbology.activeLayer}].view_id`),m=I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`),{pgEnv:p,falcor:x,falcorCache:h}=b.useContext(ie);b.useEffect(()=>{m&&x.get(["dama",p,"sources","byId",m,"attributes","metadata"])},[m]);const f=b.useMemo(()=>{let j=I(h,["dama",p,"sources","byId",m,"attributes","metadata","value","columns"],[]);return j.length===0&&(j=I(h,["dama",p,"sources","byId",m,"attributes","metadata","value"],[])),s.onlyTypedAttributes&&(j=j.filter(N=>!(c==="choropleth"&&!["integer","number"].includes(N.type)))),j},[m,h]),g=b.useMemo(()=>f.map(j=>j.name),[f]);b.useEffect(()=>{i===void 0&&(s.default?a(j=>{K(j,`${l}.${t}`,f.filter(N=>N.name===s.default).map(N=>({column_name:N.name,display_name:(N==null?void 0:N.display_name)||N.name})))}):a(j=>{K(j,`${l}.${t}`,f.filter(N=>!["wkb_geometry"].includes(N.name)).map(N=>({column_name:N.name,display_name:(N==null?void 0:N.display_name)||N.name})))}))},[f]);const y=b.useMemo(()=>i?typeof i[0]=="string"?i:i.map(j=>j==null?void 0:j.column_name):void 0,[i]),v=b.useMemo(()=>(y?EE(g,y):g).filter(j=>!["wkb_geometry"].includes(j)),[y,g]);return C.useEffect(()=>{x.get(["dama",p,"viewsbyId",u,"databyIndex",{from:0,to:100},y])},[x,p,u,y]),e.jsxs("div",{className:"flex w-full flex-wrap",children:[e.jsx("div",{className:"flex w-full flex-wrap my-2",children:e.jsx(Xr,{setState:j=>{a(N=>{if(j!==""){const S=f.find(w=>w.name===j);K(N,`${l}.${t}`,i?[...i,{column_name:j,display_name:(S==null?void 0:S.display_name)||j}]:[{column_name:j,display_name:(S==null?void 0:S.display_name)||j}])}})},availableColumnNames:v.map(j=>{const N=f.find(S=>S.name===j);return{value:j,label:(N==null?void 0:N.display_name)||j}})})}),e.jsxs("div",{className:"flex w-full flex-wrap my-2 mx-4 justify-around",children:[e.jsx($e,{themeOptions:{size:"xs",color:"primary"},className:(v==null?void 0:v.length)===0?"disabled:opacity-75 pointer-events-none	":" ",disabled:(v==null?void 0:v.length)===0,onClick:()=>{a(j=>{K(j,`${l}.${t}`,f.filter(N=>!["wkb_geometry"].includes(N.name)).map(N=>({column_name:N.name,display_name:(N==null?void 0:N.display_name)||N.name})))})},children:"Add All Columns"}),e.jsx($e,{themeOptions:{size:"xs",color:"danger"},className:(y==null?void 0:y.length)===0?"disabled:opacity-75 pointer-events-none	bgDanger":" bgDanger",disabled:(y==null?void 0:y.length)===0,onClick:()=>{a(j=>{K(j,`${l}.${t}`,[])})},children:"Remove All Columns"})]}),e.jsx(AE,{filterGroupLegendColumn:d,setFilterGroupLegendColumn:n,selectedColumns:i,reorderAttrs:(j,N)=>{const S=[...i],[w]=S.splice(j,1);S.splice(N,0,w),a(k=>{K(k,`${l}.${t}`,S)})},renameAttr:({columnName:j,displayName:N})=>{const S=[...i],w=S.findIndex(E=>E.column_name===j),[k]=S.splice(w,1),$={...k};$.display_name=N,S.splice(w,0,$),a(E=>{K(E,`${l}.${t}`,S)})},removeAttr:j=>{a(N=>{K(N,`${l}.${t}`,i.filter(S=>S.column_name!==j))})}})]})}const AE=({selectedColumns:t,sampleData:s,path:n,reorderAttrs:r,removeAttr:a,renameAttr:l,filterGroupLegendColumn:i,setFilterGroupLegendColumn:c})=>e.jsx(Qt,{onDrop:r,children:t==null?void 0:t.map((d,u)=>e.jsxs("div",{className:"group/title w-full text-sm grid grid-cols-8 cursor-grab border-t border-slate-200",children:[e.jsx("div",{className:"flex items-center border-slate-200 cursor-pointer fill-white group-hover/title:fill-slate-300 hover:bg-slate-100 rounded group/icon col-span-1 p-0.5",onClick:()=>{console.log("legend prop change::",d.column_name),c(d.column_name)},children:e.jsx(pg,{size:18,className:`${i===d.column_name?"fill-pink-400 ":""} cursor-pointer group-hover/icon:fill-slate-500 `})}),e.jsx("div",{className:"truncate  col-span-6  pl-0 py-1",children:e.jsx("input",{type:"text",className:"w-full p-1 border text-sm border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent text-slate-700 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",value:d.display_name,onChange:m=>{l({columnName:d.column_name,displayName:m.target.value})}})}),e.jsx("div",{className:"flex items-center border-slate-200 cursor-pointer fill-white group-hover/title:fill-slate-300 hover:bg-slate-100 rounded group/icon col-span-1 p-0.5",onClick:()=>{a(d.column_name)},children:e.jsx(ms,{className:" cursor-pointer group-hover/icon:fill-slate-500 "})})]},u))}),TE=({path:t,datapath:s,params:n={}})=>{const{state:r,setState:a}=b.useContext(Ne),{falcor:l,falcorCache:i,pgEnv:c}=b.useContext(ie),d=(n==null?void 0:n.version)==="interactive"?`symbology.layers[${r.symbology.activeLayer}]${n.pathPrefix}`:`symbology.layers[${r.symbology.activeLayer}]`,{layerType:u,viewId:m,sourceId:p,filterGroupName:x,filterGroup:h,dataColumn:f,selectedInteractiveFilterIndex:g,legendViewId:y,filterGroupLegendColumn:v}=b.useMemo(()=>({dataColumn:I(r,`${d}['data-column']`),legendViewId:I(r,`${d}['legend-view-id']`),filterGroupLegendColumn:I(r,`${d}['filter-group-legend-column']`),layerType:I(r,`${d}['layer-type']`),viewId:I(r,`symbology.layers[${r.symbology.activeLayer}].view_id`),sourceId:I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`),filterGroupEnabled:I(r,`${d}['filterGroupEnabled']`,!1),filterGroup:I(r,`${d}${t}`,[]),filterGroupName:I(r,`${d}['filter-group-name']`,""),selectedInteractiveFilterIndex:I(r,`symbology.layers[${r.symbology.activeLayer}]['selectedInteractiveFilterIndex']`,[])}),[r]);return b.useEffect(()=>{p&&l.get(["dama",c,"sources","byId",p,"attributes","metadata"])},[p]),e.jsxs("div",{className:"pb-4 max-h-[calc(80vh_-_220px)] overflow-auto",children:[e.jsxs("div",{className:"group w-full flex px-2",children:["Name:",e.jsx("input",{type:"text",className:"mx-2 w-[150px]  border text-sm border-transparent group-hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent text-slate-700 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",value:x,onChange:j=>{a(N=>{K(N,`${d}['filter-group-name']`,j.target.value)})}})]}),e.jsx(ME,{path:"['filter-group']",params:{default:f,onlyTypedAttributes:!0,pathPrefix:n.pathPrefix,version:n==null?void 0:n.version},setFilterGroupLegendColumn:j=>{a(N=>{K(N,`${d}['choroplethdata']`,{}),K(N,`${d}['category-data']`,{}),K(N,`${d}['categories']`,{}),K(N,`${d}['data-column']`,j),K(N,`${d}['filter-group-legend-column']`,j)})}})]})},OE=(t,s)=>t.filter(n=>!s.includes(n)),DE=({path:t,datapath:s,params:n={}})=>{const{state:r,setState:a}=b.useContext(Ne),{falcor:l,falcorCache:i,pgEnv:c}=b.useContext(ie),d=(n==null?void 0:n.version)==="interactive"?`symbology.layers[${r.symbology.activeLayer}]${n.pathPrefix}`:`symbology.layers[${r.symbology.activeLayer}]`,{layerType:u,viewId:m,sourceId:p,viewGroupName:x,viewGroup:h,initialViewId:f,viewGroupId:g}=b.useMemo(()=>({layerType:I(r,`${d}['layer-type']`),viewId:I(r,`symbology.layers[${r.symbology.activeLayer}].view_id`),sourceId:I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`),viewGroup:I(r,`${d}['filter-source-views']`,[]),viewGroupName:I(r,`${d}['view-group-name']`,""),initialViewId:I(r,`${d}['initial-view-id']`,""),filterGroupLegendColumn:I(r,`${d}['filter-group-legend-column']`),viewGroupId:I(r,`${d}['view-group-id']`)}),[r]);u==="interactive"&&(layerPath=`['interactive-filters'][${selectedInteractiveFilterIndex}]`),b.useEffect(()=>{f||a(w=>{K(w,`${d}['initial-view-id']`,m)})},[]),b.useEffect(()=>{async function w(){const k=["dama",c,"sources","byId",p,"views","length"],$=await l.get(k);return await l.get(["dama",c,"sources","byId",p,"views","byIndex",{from:0,to:I($.json,k,0)-1},"attributes",Object.values(Ot)])}p&&w()},[p,l,c]);const y=b.useMemo(()=>Object.values(I(i,["dama",c,"sources","byId",p,"views","byIndex"],{})).map(w=>ft(I(i,w.value,{attributes:{}}).attributes)),[i,p,c]),v=y.map(w=>w.view_id),j=OE(v,h),N=y.filter(w=>j.includes(w.view_id)),S=y.filter(w=>h.includes(w.view_id));return e.jsxs("div",{className:"pb-2 max-h-[calc(80vh_-_220px)] overflow-auto",children:[e.jsxs("div",{className:"group w-full flex px-2",children:["Name:",e.jsx("input",{type:"text",className:"mx-2 w-[150px]  border text-sm border-transparent group-hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent text-slate-700 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",value:x,onChange:w=>{a(k=>{K(k,`${d}['view-group-name']`,w.target.value)})}})]}),e.jsx("div",{className:"pb-2",children:e.jsx(Xr,{label:"Add Data View",setState:w=>{a(k=>{console.log("adding new viewId to group::",w),K(k,`${d}.${t}`,[...h,parseInt(w)])})},availableColumnNames:N.map(w=>({value:w.view_id,label:w.version??w.view_id}))})}),e.jsx(BE,{setViewGroupId:w=>{a(k=>{K(k,`${d}['view-group-id']`,w)})},viewGroupId:g,selectedViews:S.map(w=>({...w,display_name:w.version??w.view_id})),reorderAttrs:(w,k)=>{const $=[...h],[E]=$.splice(w,1);$.splice(k,0,E),a(M=>{K(M,`${d}.${t}`,$)})},removeAttr:w=>{a(k=>{K(k,`${d}.${t}`,h.filter($=>$!==w))})}})]})},BE=({selectedViews:t,reorderAttrs:s,removeAttr:n,viewGroupId:r,setViewGroupId:a})=>e.jsx(Qt,{onDrop:s,children:t==null?void 0:t.map((l,i)=>e.jsxs("div",{className:"group/title w-full text-sm grid grid-cols-10 cursor-grab border-t border-slate-20",children:[e.jsx("div",{className:"flex items-center border-slate-200 cursor-pointer fill-white group-hover/title:fill-slate-300 hover:bg-slate-100 rounded group/icon col-span-1 p-0.5",onClick:()=>{console.log("legend prop change, setting viewId::",l),a(l.view_id)},children:e.jsx(pg,{size:18,className:`${r===l.view_id?"fill-pink-400 ":""} cursor-pointer group-hover/icon:fill-slate-500 `})}),e.jsx("div",{className:"truncate  col-span-8 px-2 py-1",children:e.jsx("div",{className:"w-full p-1 text-sm     text-slate-700s",children:l.display_name})}),e.jsx("div",{className:"flex items-center  cursor-pointer fill-white group-hover/title:fill-slate-300 hover:bg-slate-100 rounded group/icon col-span-1 p-0.5",onClick:()=>{n(l.view_id)},children:e.jsx(ms,{className:"cursor-pointer group-hover/icon:fill-slate-500 "})})]},i))});function bg({button:t,children:s}){const{state:n,setState:r}=C.useContext(Ne);return e.jsxs(ye,{as:"div",className:"relative inline-block text-left w-full",children:[e.jsx(ye.Button,{className:"w-full",children:t}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx(ye.Items,{className:"absolute -right-[10px] w-[226px] max-h-[400px] overflow-auto py-2 origin-top-right divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none z-20",children:s})})]})}function FE({path:t,datapath:s,params:n={}}){var x,h;const{state:r,setState:a}=C.useContext(Ne),{falcor:l,falcorCache:i,pgEnv:c}=C.useContext(ie),d=(n==null?void 0:n.version)==="interactive"?`symbology.layers[${r.symbology.activeLayer}]${n.pathPrefix}`:`symbology.layers[${r.symbology.activeLayer}]`;let{sourceId:u,column:m}=b.useMemo(()=>({sourceId:I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`),column:I(r,`${d}['data-column']`,"")}),[r]);b.useEffect(()=>{u&&l.get(["dama",c,"sources","byId",u,"attributes","metadata"])},[u]);const p=b.useMemo(()=>{let f=I(i,["dama",c,"sources","byId",u,"attributes","metadata","value","columns"],[]);return f.length===0&&(f=I(i,["dama",c,"sources","byId",u,"attributes","metadata","value"],[])),f},[u,i]);return e.jsx("label",{className:"flex w-full",children:e.jsx("div",{className:"flex w-full items-center",children:e.jsx("select",{className:"w-full p-2 bg-transparent",value:I(r,`${d}.${t}`,n.default||((h=(x=n==null?void 0:n.options)==null?void 0:x[0])==null?void 0:h.value)),onChange:f=>a(g=>{var y,v,j,N;if(!m&&f.target.value==="categories"){const S=((y=p.filter(w=>!["integer","number"].includes(w.type))[0])==null?void 0:y.name)??((v=p[0])==null?void 0:v.name);K(g,`${d}['data-column']`,S)}else if(f.target.value==="choropleth"){const S=p.find(w=>w.name===m);if(!["integer","number"].includes(S==null?void 0:S.type)){const w=((j=p.filter(k=>["integer","number"].includes(k.type))[0])==null?void 0:j.name)??((N=p[0])==null?void 0:N.name);K(g,`${d}['data-column']`,w)}}K(g,`${d}.${t}`,f.target.value)}),children:(n.options||[]).map((f,g)=>e.jsx("option",{value:f.value,children:f.name},g))})})})}function zE({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ne),a=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`;return e.jsxs("label",{className:"flex",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("input",{type:"color",value:Ks(I(n,`${a}.${t}`,"#ccc")),onChange:l=>r(i=>{K(i,`${a}.${t}`,l.target.value)})})}),e.jsx("div",{className:"flex items-center p-2",children:"Custom "})]})}function PE({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ne),a=c=>c,l=(s==null?void 0:s.format)||a,i=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`;return e.jsxs("div",{className:"flex w-full  items-center",children:[e.jsx("div",{className:"flex-1 flex w-full",children:e.jsx("input",{className:'w-full flex-1 accent-slate-600 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700">',type:"range",min:s.min||"0",max:s.max||"1",step:s.step||"0.01",value:I(n,`${i}].${t}`,s.default||"1"),onChange:c=>r(d=>{K(d,`${i}].${t}`,+c.target.value)})})}),e.jsx("div",{className:"pl-2",children:e.jsx("input",{className:"w-14 px-2 py-1 bg-transparent",value:`${l(I(n,`${i}].${t}`,s.default||"1"))}${s.units?s.units:""}`,onChange:()=>{}})})]})}function RE({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ne),a=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`;return e.jsx("label",{className:"flex",children:e.jsx("div",{className:"flex items-center",children:e.jsx("input",{className:"w-full",type:"text",value:I(n,`${a}.${t}`,(s==null?void 0:s.default)??"#ccc"),onChange:l=>r(i=>{K(i,`${a}.${t}`,l.target.value)})})})})}function HE({path:t,params:s={title:""}}){const{state:n,setState:r}=C.useContext(Ne),a=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`,{value:l}=b.useMemo(()=>({value:I(n,`${a}.${t}`,{})}),[n]);return e.jsx("label",{className:"flex",children:e.jsx("div",{className:"flex items-center",children:e.jsxs(sn,{checked:l,onChange:()=>{r(i=>{K(i,`${a}${t}`,!l)})},className:`${l?"bg-blue-500":"bg-gray-200"} relative inline-flex h-4 w-8 items-center rounded-full `,children:[e.jsx("span",{className:"sr-only",children:s.title}),e.jsx("div",{className:`${l?"translate-x-5":"translate-x-0"} inline-block h-4 w-4  transform rounded-full bg-white transition border-[0.5] border-slate-600`})]})})})}function yg({path:t,params:s={}}){var l,i;const{state:n,setState:r}=C.useContext(Ne),a=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`;return e.jsx("label",{className:"flex w-full",children:e.jsx("div",{className:"flex w-full items-center",children:e.jsx("select",{className:"w-full py-2 bg-transparent",value:I(n,`${a}.${t}`,s.default||((i=(l=s==null?void 0:s.options)==null?void 0:l[0])==null?void 0:i.value)),onChange:c=>r(d=>{K(d,`${a}.${t}`,c.target.value)}),children:((s==null?void 0:s.options)||[]).map((c,d)=>e.jsx("option",{value:c.value,children:c.name},d))})})})}function WE({path:t,datapath:s,params:n={}}){const{state:r,setState:a}=C.useContext(Ne),{falcor:l,falcorCache:i,pgEnv:c}=C.useContext(ie),d=(n==null?void 0:n.version)==="interactive"?`symbology.layers[${r.symbology.activeLayer}]${n.pathPrefix}`:`symbology.layers[${r.symbology.activeLayer}]`,{layerType:u,viewId:m,sourceId:p,method:x}=b.useMemo(()=>({layerType:I(r,`${d}['layer-type']`),viewId:I(r,`symbology.layers[${r.symbology.activeLayer}].view_id`),sourceId:I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`),method:I(r,`${d}['bin-method']`,"ckmeans")}),[r]),h=b.useMemo(()=>I(r,`${d}.${t}`,null),[r,t]);b.useEffect(()=>{p&&l.get(["dama",c,"sources","byId",p,"attributes","metadata"])},[c,p]);const f=b.useMemo(()=>{let g=I(i,["dama",c,"sources","byId",p,"attributes","metadata","value","columns"],[]);return g.length===0&&(g=I(i,["dama",c,"sources","byId",p,"attributes","metadata","value"],[])),g},[c,p,i]);return e.jsx("label",{className:"flex w-full",children:e.jsx("div",{className:"flex w-full items-center",children:e.jsx("select",{className:"w-full p-2 bg-transparent",value:h,onChange:g=>a(y=>{let v=I(r,`${d}.sources[0].source.tiles[0]`,"no source tiles").split("?")[0];v!=="no source tiles"&&K(y,`${d}.sources[0].source.tiles[0]`,v+`?cols=${g.target.value}`),u==="circles"&&(K(y,`${d}['lower-bound']`,null),K(y,`${d}['upper-bound']`,null),K(y,`${d}['min-radius']`,8),K(y,`${d}['max-radius']`,128)),x==="custom"&&K(y,`${d}['bin-method']`,"ckmeans"),K(y,`${d}['choroplethdata']`,{}),K(y,`${d}['categories']`,{}),K(y,`${d}.${t}`,g.target.value)}),children:(f||[]).filter(g=>!(u==="choropleth"&&!["integer","number"].includes(g.type))).filter(g=>!["wkb_geometry"].includes(g.name)).map((g,y)=>e.jsx("option",{value:g.name,children:g.display_name||g.name},y))})})})}function VE({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ne),a=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`;let l=I(n,`${a}['range-key']`,$t.schemeGroups.sequential[0]),i=I(n,`${a}['num-bins']`,9),c=I(n,`${a}.${t}`,$t[l][i]);return e.jsx("div",{className:"flex w-full items-center",children:e.jsxs(bg,{button:e.jsxs("div",{className:"flex items-center w-full cursor-pointer flex-1",children:[e.jsx("div",{className:"flex-1 flex justify-center ",children:(c.map?c:[]).map((d,u)=>e.jsx("div",{className:"flex-1 h-4",style:{backgroundColor:d}},u))}),e.jsx("div",{className:"flex items-center px-1 border-2 border-transparent h-8  hover fill-slate-400 hover:fill-slate-800 cursor-pointer",children:e.jsx(Uo,{className:""})})]}),children:[e.jsx(ye.Item,{className:"z-20",children:e.jsx("div",{className:"px-4 font-semibold text-sm text-slate-600",children:"SEQUENTIAL"})}),[...$t.schemeGroups.sequential,...$t.schemeGroups.singlehue].map(d=>e.jsx(ye.Item,{className:"z-20",children:({active:u})=>e.jsxs("div",{className:`${u?"bg-blue-50 ":""} flex`,children:[e.jsx("div",{className:"w-4 h-4"}),e.jsx("div",{className:"flex-1 flex w-full p-2",onClick:()=>r(m=>{K(m,`${a}.${t}`,$t[d][i]),K(m,`${a}['range-key']`,d)}),children:$t[d][i].map((m,p)=>e.jsx("div",{className:"flex-1 h-4",style:{backgroundColor:m}},p))})]})},d)),e.jsx(ye.Item,{className:"z-20",children:e.jsx("div",{className:"px-4 font-semibold text-sm text-slate-600",children:"Diverging"})}),$t.schemeGroups.diverging.map(d=>e.jsx(ye.Item,{className:"z-20",children:({active:u})=>e.jsxs("div",{className:`${u?"bg-blue-50 ":""} flex`,children:[e.jsx("div",{className:"w-4 h-4"}),e.jsx("div",{className:"flex-1 flex w-full p-2",onClick:()=>r(m=>{K(m,`${a}.${t}`,$t[d][i]),K(m,`${a}['range-key']`,d)}),children:$t[d][i].map((m,p)=>e.jsx("div",{className:"flex-1 h-4",style:{backgroundColor:m}},p))})]})},d))]})})}function UE({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ne);let a=wc;const l=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`;let{value:i,categories:c}=b.useMemo(()=>({value:I(n,`${l}.${t}`,a.cat1),categories:I(n,`${l}['categories']`,{})}),[n]);const d=(u,m)=>{const p=u.legend.map((h,f)=>({...h,color:Ks(m[f])}));return{paint:u.paint.map((h,f)=>f<3||f===u.paint.length-1?h:f%2===1?Ks(m[((f+1)/2-2)%m.length]):h),legend:p}};return e.jsx("div",{className:"flex w-full items-center",children:e.jsx(bg,{button:e.jsxs("div",{className:"flex items-center w-full cursor-pointer flex-1",children:[e.jsx("div",{className:"flex-1 flex justify-center ",children:(i.map?i:[]).map((u,m)=>e.jsx("div",{className:"w-4 h-4",style:{backgroundColor:u}},m))}),e.jsx("div",{className:"flex items-center px-1 border-2 border-transparent h-8  hover fill-slate-400 hover:fill-slate-800 cursor-pointer",children:e.jsx(Uo,{className:""})})]}),children:Object.keys(a).map(u=>e.jsx(ye.Item,{className:"z-20",children:({active:m})=>e.jsxs("div",{className:`${m?"bg-blue-50 ":""} flex`,children:[e.jsx("div",{className:"w-4 h-4"}),e.jsx("div",{className:"flex-1 flex w-full p-2",onClick:()=>{r(p=>{const x=d(c,a[u]);K(p,`${l}.${t}`,a[u]),K(p,`${l}['categories']`,x)})},children:a[u].map((p,x)=>e.jsx("div",{className:"w-4 h-4",style:{backgroundColor:p}},x))})]})},u))})})}function qE({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ne),{falcor:a,falcorCache:l,pgEnv:i}=C.useContext(ie),c=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`;let{lowerBound:d,upperBound:u,minRadius:m,maxRadius:p,radiusCurve:x,curveFactor:h}=b.useMemo(()=>({lowerBound:I(n,`${c}.layers[0].paint['circle-radius'][3]`),minRadius:I(n,`${c}.layers[0].paint['circle-radius'][4]`),upperBound:I(n,`${c}.layers[0].paint['circle-radius'][5]`),maxRadius:I(n,`${c}.layers[0].paint['circle-radius'][6]`),radiusCurve:I(n,`${c}.layers[0].paint['circle-radius'][1][0]`,"linear"),curveFactor:I(n,`${c}.layers[0].paint['circle-radius'][1][1]`,1)}),[n]);return e.jsxs("div",{className:" w-full items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 pl-2",children:"Radius curve:"}),e.jsx("div",{className:"w-full border border-transparent hover:border-slate-200 rounded mr-1 mb-1",children:e.jsxs("select",{className:"w-full p-2 pl-0 bg-transparent text-slate-700 text-sm",value:x,onChange:f=>{r(g=>{K(g,`${c}['radius-curve']`,f.target.value)})},children:[e.jsx("option",{value:"linear",children:"Linear"}),e.jsx("option",{value:"exponential",children:"Exponential"})]})})]}),x==="exponential"&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Curve Factor:"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsx("input",{className:"block w-full border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-1 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",type:"number",value:h,step:".1",onChange:f=>{r(g=>{K(g,`${c}['curve-factor']`,parseFloat(f.target.value))})}})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Min Radius:"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsx("input",{className:"block w-full border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-1 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",type:"number",value:m,onChange:f=>{r(g=>{K(g,`${c}['min-radius']`,parseInt(f.target.value))})}})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Max Radius:"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsx("input",{className:"block w-full border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-1 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",type:"number",value:p,onChange:f=>{r(g=>{K(g,`${c}['max-radius']`,parseInt(f.target.value))})}})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Lower Bound:"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsx("input",{className:"block w-full border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-1 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",type:"number",value:d,onChange:f=>{r(g=>{K(g,`${c}['lower-bound']`,parseInt(f.target.value))})}})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Upper Bound:"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsx("input",{className:"block w-full border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-1 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",type:"number",value:u,onChange:f=>{r(g=>{K(g,`${c}['upper-bound']`,parseInt(f.target.value))})}})})]})]})}function xa(t){return Math.pow(10,Math.round(Math.log10(t)))}function GE({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ne),{falcor:a,falcorCache:l,pgEnv:i}=C.useContext(ie),c=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`;let{numbins:d,method:u,colorKey:m,legenddata:p,showOther:x,choroplethdata:h,isLoadingColorbreaks:f}=b.useMemo(()=>({numbins:I(n,`${c}['num-bins']`,9),colorKey:I(n,`${c}['range-key']`,"seq1"),method:I(n,`${c}['bin-method']`,"ckmeans"),legenddata:I(n,`${c}['legend-data']`),choroplethdata:I(n,`${c}['choroplethdata']`,{breaks:[]}),showOther:I(n,`${c}['category-show-other']`,"#ccc"),isLoadingColorbreaks:I(n,`${c}['is-loading-colorbreaks']`,!1)}),[n]);const{breaks:g,max:y}=h,v=g==null?void 0:g.map((w,k)=>{var $;return{color:($=p[k])==null?void 0:$.color,label:`${g[k]} - ${g[k+1]||y}`}}).filter(w=>w),j=x==="#ccc",N=g==null?void 0:g.map((w,k)=>{const $=k===0?`Minimum: ${w}`:w;return e.jsx("input",{className:"block w-full border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-1 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",type:"text",value:$,disabled:k===0,onChange:E=>{r(M=>{const _=[...g];let L=E.target.value;L.slice(-1)==="."&&L.length>g[k].toString().length&&(L=L+"1"),_[k]=parseFloat(L),Number.isNaN(_[k])&&(_[k]=0),K(M,`${c}['choroplethdata']['breaks']`,_)})}},`custom_breaks_${k}`)});N&&N.push(e.jsx("input",{className:"block w-full border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-1 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",type:"text",value:`Maximum: ${y}`,disabled:!0},`${y}`));const S=v==null?void 0:v.map((w,k)=>e.jsx("div",{children:e.jsxs("div",{className:"w-full flex items-center hover:bg-slate-100 cursor-auto",children:[e.jsx("div",{className:"flex items-center h-8 w-8 justify-center  border-r border-b ",children:e.jsx("div",{className:"w-4 h-4 rounded border-[0.5px] border-slate-600",style:{backgroundColor:w.color}})}),e.jsxs("div",{className:"flex items-center justify-between text-center flex-1 px-2 text-slate-600 border-b h-8 truncate overflow-auto w-full",children:[e.jsx("div",{className:"px-2 w-[10px]",children:k!==0&&e.jsx("i",{className:"fa-solid fa-chevron-left cursor-pointer hover:text-pink-700",onClick:()=>{console.log("move lower bound for range::",w.label),r($=>{const E=g[k-1]+1,M=[...g];M[k]=k!==0?Math.max(M[k]-xa(M[k]/10),E):M[k]-xa(M[k]/10),K($,`${c}['choroplethdata']['breaks']`,M)})}})}),w.label,e.jsx("div",{className:"px-2 w-[10px]",children:k!==v.length-1&&e.jsx("i",{className:"fa-solid fa-chevron-right cursor-pointer hover:text-pink-700",onClick:()=>{console.log("move upper bound for range::",w.label),r($=>{const E=[...g];if(k!==v.length-1){const M=k===v.length-2?y-1:g[k+2]-1;E[k+1]=Math.min(E[k+1]+xa(E[k+1]/10),M),K($,`${c}['choroplethdata']['breaks']`,E)}else{const M=y+xa(y/10);K($,`${c}['choroplethdata']['max']`,M)}})}})})]})]},k)},`range_input_${k}`));return e.jsxs("div",{className:" w-full items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Showing"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsx("select",{className:"w-full p-2 bg-transparent text-slate-700 text-sm",value:d,onChange:w=>r(k=>{if(K(k,`${c}.['num-bins']`,w.target.value),u==="custom"){const $=d-w.target.value;if($>0){const E=[...g].slice(0,-$);K(k,`${c}['choroplethdata']['breaks']`,E)}else{const E=$*-1,M=[...g];for(let _=0;_<E;_++)M.push(y);K(k,`${c}['choroplethdata']['breaks']`,M)}}else K(k,`${c}.['choroplethdata']`,{});K(k,`${c}.['color-range']`,$t[m][w.target.value])}),children:(Object.keys($t[m])||[]).map((w,k)=>e.jsx("option",{value:w,children:w},k))})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Method"}),e.jsx("div",{className:"border border-transparent hover:border-slate-200 m-1 rounded ",children:e.jsxs("select",{className:"w-full p-2 bg-transparent text-slate-700 text-sm",value:u,onChange:w=>r(k=>{w.target.value!=="custom"&&K(k,`${c}.['choroplethdata']`,{}),K(k,`${c}['bin-method']`,w.target.value)}),children:[e.jsx("option",{value:"ckmeans",children:"ck-means"}),e.jsx("option",{value:"pretty",children:"Pretty Breaks"}),e.jsx("option",{value:"equalInterval",children:"Equal Interval"}),e.jsx("option",{value:"custom",children:"Custom"})]})})]}),e.jsxs("div",{className:"flex items-center pb-2",children:[e.jsx("div",{className:"text-sm text-slate-400 px-2",children:"Show missing data"}),e.jsx("div",{className:"flex items-center",children:e.jsxs(sn,{checked:j,onChange:()=>{r(w=>{const k=j?"rgba(0,0,0,0)":"#ccc";K(w,`${c}['category-show-other']`,k)})},className:`${j?"bg-blue-500":"bg-gray-200"} relative inline-flex h-4 w-8 items-center rounded-full `,children:[e.jsx("span",{className:"sr-only",children:"Show other"}),e.jsx("div",{className:`${j?"translate-x-5":"translate-x-0"} inline-block h-4 w-4  transform rounded-full bg-white transition border-[0.5] border-slate-600`})]})})]}),u==="custom"&&e.jsx("div",{className:"flex flex-col px-2",children:e.jsxs(e.Fragment,{children:["Breaks:",N]})}),e.jsxs("div",{className:"w-full max-h-[300px] overflow-auto",children:[f?e.jsxs("div",{className:"flex w-full justify-center overflow-hidden pb-2",children:["Creating scale...",e.jsx("span",{style:{fontSize:"1.5rem"},className:"ml-2 fa-solid fa-spinner fa-spin"})]}):u==="custom"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-2",children:"Ranges:"}),S]}):S,j&&e.jsxs("div",{className:"w-full flex items-center hover:bg-slate-100",children:[e.jsx("div",{className:"flex items-center h-8 w-8 justify-center  border-r border-b ",children:e.jsx("div",{className:"w-4 h-4 rounded border-[0.5px] border-slate-600",style:{backgroundColor:x}})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-600 border-b h-8 truncate",children:"No data"})]})]})]})}const Xr=({setState:t,availableColumnNames:s,label:n="Add Column"})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center ml-4",children:n}),e.jsx("div",{className:"flex-1 flex items-center mx-4",children:e.jsx(os,{children:e.jsx("label",{className:"flex w-full",children:e.jsx("div",{className:"flex w-full items-center",children:e.jsxs("select",{className:"w-full py-2 bg-transparent",value:"",onChange:r=>t(r.target.value),children:[e.jsx("option",{value:""},-1),(s||[]).map((r,a)=>e.jsx("option",{value:r.value,children:r.label},a))]})})})})})]}),en={color:zE,categoricalColor:UE,rangeColor:VE,categoryControl:IE,choroplethControl:GE,circleControl:qE,interactiveFilterControl:Go,range:PE,simple:RE,select:yg,selectType:FE,selectViewColumn:WE,filterGroupControl:TE,viewGroupControl:DE,toggleControl:HE};function os({children:t}){return e.jsx("div",{className:"rounded-md h-[36px] flex w-full w-[216px] p-2 items-center border border-white/50 hover:bg-white cursor-pointer hover:border-slate-200",children:t})}function JE({values:t,title:s="",children:n}){return e.jsx(os,{children:e.jsx(Tt,{className:"relative w-full",children:({open:r})=>e.jsxs(e.Fragment,{children:[e.jsx(Tt.Button,{className:"w-full",children:e.jsxs("div",{className:"w-full flex items-center group",children:[e.jsx("div",{className:"flex items-center group-hover:flex-1",children:(t||[]).map((a,l)=>e.jsxs(b.Fragment,{children:[a.type==="color"&&e.jsx("div",{className:"h-4 w-4 border",style:{backgroundColor:Ks(a.value)}}),e.jsxs("div",{className:"px-1 py-1 truncate",children:[e.jsx("span",{className:"",children:a.type==="color"?Ks(a.value):a.value}),a.unit?a.unit:""," "]}),e.jsx("div",{className:"px-1 py-1 truncate",children:l<t.length-1?"/":""})]},l))}),e.jsx("div",{className:"flex items-center ",children:e.jsx(Uo,{className:"fill-slate-400 group-hover:fill-slate-800"})})]})}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:e.jsx(Tt.Panel,{className:"absolute w-[250px] left-0  z-10 mt-3 -translate-x-[325px] -translate-y-[78px] transform px-4  ",children:({close:a})=>e.jsxs("div",{className:"overflow-hidden rounded-lg shadow-lg ring-1 ring-black/5 bg-white/95",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:" w-full flex text-slate-700 py-1 px-2 text-sm font-semibold tracking-wider",children:s}),e.jsx("div",{onClick:()=>a(),className:"p-0.5 rounded hover:bg-slate-100 m-1 cursor-pointer",children:e.jsx(ms,{className:"fill-slate-700"})})]}),e.jsx("div",{className:"relative",children:n})]})})})]})})})}function XE({label:t,controls:s}){const{state:n,setState:r}=C.useContext(Ne);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center",children:t}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsx(os,{children:s.map((a,l)=>{const i=en[a.type]||en.simple;return e.jsx(i,{path:a.path,datapath:a.datapath,params:a.params},l)})})})]})}function ZE({label:t,controls:s}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex-1 flex items-center",children:s.map((n,r)=>{const a=en[n.type]||en.simple;return e.jsx(a,{path:n.path,datapath:n.datapath,params:n.params},r)})})})}function YE(t){const{label:s,controls:n}=t,{state:r,setState:a}=C.useContext(Ne),l=b.useMemo(()=>n.map(i=>{var p,x;const c=((p=i.params)==null?void 0:p.version)==="interactive"?`symbology.layers[${r.symbology.activeLayer}]${i.params.pathPrefix}`:`symbology.layers[${r.symbology.activeLayer}]`,d=h=>h;let m=(((x=i==null?void 0:i.params)==null?void 0:x.format)||d)(I(r,`${c}.${i.path}`,""));return{type:i==null?void 0:i.type,unit:i==null?void 0:i.unit,value:m}}),[r,n]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center",children:s}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsx(JE,{values:l,title:s,children:n.map((i,c)=>{const d=en[i.type]||en.simple;return e.jsx(d,{path:i.path,datapath:i.datapath,params:i.params},c)})})})]})}const em={popover:YE,inline:XE,"full-width":ZE},QE={fill:"Polygons",line:"Lines",circle:"Points"};function vg(t){const{state:s,setState:n}=C.useContext(Ne),r=b.useMemo(()=>{var l,i;return((i=(l=s.symbology)==null?void 0:l.layers)==null?void 0:i[s.symbology.activeLayer])||null},[s]);let a=b.useMemo(()=>gg[r.type]||[],[r.type]);return t.type==="interactive"&&(a=a.filter(l=>l.label!=="Interactive Filters").map(l=>{let i=[...l.controls],c;return i=i.map(d=>({...d,params:{...d.params,pathPrefix:t.pathPrefix,version:"interactive"}})),l.conditional&&(Array.isArray(l.conditional)?c=l.conditional.map(d=>({...d,path:t.pathPrefix+d.path})):c={...l.conditional,path:t.pathPrefix+l.conditional.path}),{...l,controls:i,conditional:c}})),r&&e.jsx("div",{children:e.jsxs("div",{className:`${t.type==="interactive"?"mt-2 border-2 p-1 border-gray-100 rounded":"p-4"}`,children:[e.jsx("div",{className:"font-bold tracking-wider text-sm text-slate-700",children:QE[r.type]}),a.filter(l=>{if(l.conditional){if(Array.isArray(l.conditional))return l.conditional.every(i=>{const c=I(s,`symbology.layers[${s.symbology.activeLayer}].${i.path}`,"-999");return i.conditions.includes(c)});{const i=I(s,`symbology.layers[${s.symbology.activeLayer}].${l.conditional.path}`,"-999");return l.conditional.conditions.includes(i)}}else return!0}).map((l,i)=>{let c=em[l.type]||em.inline;return e.jsx("div",{className:"flex flex-wrap",children:e.jsx(c,{label:l.label,controls:l.controls})},i)})]})})}function KE(t,s,n){return n.indexOf(t)===s}const eM=(t,s)=>t.filter(n=>!s.includes(n));function tM({path:t,params:s={}}){const{state:n,setState:r}=C.useContext(Ne),a=(s==null?void 0:s.version)==="interactive"?`symbology.layers[${n.symbology.activeLayer}]${s.pathPrefix}`:`symbology.layers[${n.symbology.activeLayer}]`,{selectedColumns:l,layerType:i}=b.useMemo(()=>({selectedColumns:I(n,`${a}.${t}`),layerType:I(n,`${a}['layer-type']`)}),[n,t,s]),c=I(n,`symbology.layers[${n.symbology.activeLayer}].view_id`),d=I(n,`symbology.layers[${n.symbology.activeLayer}].source_id`),{pgEnv:u,falcor:m,falcorCache:p}=b.useContext(ie);b.useEffect(()=>{d&&m.get(["dama",u,"sources","byId",d,"attributes","metadata"])},[d]);const x=b.useMemo(()=>{let v=I(p,["dama",u,"sources","byId",d,"attributes","metadata","value","columns"],[]);return v.length===0&&(v=I(p,["dama",u,"sources","byId",d,"attributes","metadata","value"],[])),s.onlyTypedAttributes&&(v=v.filter(j=>!(i==="choropleth"&&!["integer","number"].includes(j.type)))),v},[d,p]),h=b.useMemo(()=>x.map(v=>v.name),[x]);b.useEffect(()=>{l===void 0&&(s.default?r(v=>{K(v,`${a}.${t}`,x.filter(j=>j.name===s.default).map(j=>({column_name:j.name,display_name:(j==null?void 0:j.display_name)||j.name})))}):r(v=>{K(v,`${a}.${t}`,x.filter(j=>!["wkb_geometry"].includes(j.name)).map(j=>({column_name:j.name,display_name:(j==null?void 0:j.display_name)||j.name})))}))},[x]);const f=b.useMemo(()=>l?typeof l[0]=="string"?l:l.map(v=>v==null?void 0:v.column_name):void 0,[l]),g=b.useMemo(()=>(f?eM(h,f):h).filter(v=>!["wkb_geometry"].includes(v)),[f,h]);C.useEffect(()=>{m.get(["dama",u,"viewsbyId",c,"databyIndex",{from:0,to:100},f])},[m,u,c,f]);const y=b.useMemo(()=>Object.values(I(p,["dama",u,"viewsbyId",c,"databyIndex"],[])).map(v=>v!=null&&v.value?I(p,v.value,""):""),[u,p]);return e.jsxs("div",{className:"flex w-full flex-wrap",children:[e.jsx("div",{className:"flex w-full flex-wrap my-2",children:e.jsx(Xr,{setState:v=>{r(j=>{if(v!==""){const N=x.find(S=>S.name===v);K(j,`${a}.${t}`,l?[...l,{column_name:v,display_name:(N==null?void 0:N.display_name)||v}]:[{column_name:v,display_name:(N==null?void 0:N.display_name)||v}])}})},availableColumnNames:g.map(v=>{const j=x.find(N=>N.name===v);return{value:v,label:(j==null?void 0:j.display_name)||v}})})}),e.jsxs("div",{className:"flex w-full flex-wrap my-2 mx-4 justify-around",children:[e.jsx($e,{themeOptions:{size:"xs",color:"primary"},className:(g==null?void 0:g.length)===0?"disabled:opacity-75 pointer-events-none	":" ",disabled:(g==null?void 0:g.length)===0,onClick:()=>{r(v=>{K(v,`${a}.${t}`,x.filter(j=>!["wkb_geometry"].includes(j.name)).map(j=>({column_name:j.name,display_name:(j==null?void 0:j.display_name)||j.name})))})},children:"Add All Columns"}),e.jsx($e,{themeOptions:{size:"xs",color:"danger"},className:(f==null?void 0:f.length)===0?"disabled:opacity-75 pointer-events-none	bgDanger":" bgDanger",disabled:(f==null?void 0:f.length)===0,onClick:()=>{r(v=>{K(v,`${a}.${t}`,[])})},children:"Remove All Columns"})]}),e.jsx(sM,{selectedColumns:l,sampleData:y,reorderAttrs:(v,j)=>{const N=[...l],[S]=N.splice(v,1);N.splice(j,0,S),r(w=>{K(w,`${a}.${t}`,N)})},renameAttr:({columnName:v,displayName:j})=>{const N=[...l],S=N.findIndex($=>$.column_name===v),[w]=N.splice(S,1),k={...w};k.display_name=j,N.splice(S,0,k),r($=>{K($,`${a}.${t}`,N)})},removeAttr:v=>{r(j=>{K(j,`${a}.${t}`,l.filter(N=>N.column_name!==v))})}})]})}const sM=({selectedColumns:t,sampleData:s,path:n,reorderAttrs:r,removeAttr:a,renameAttr:l})=>e.jsx(Qt,{onDrop:r,children:t==null?void 0:t.map((i,c)=>e.jsxs("div",{className:"group/title w-full text-sm grid grid-cols-9 cursor-grab",children:[e.jsx("div",{className:"truncate border-t border-r border-slate-200 col-span-4 px-2 py-1",children:e.jsx("input",{type:"text",className:"w-full px-2  border text-sm border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent text-slate-700 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",value:i.display_name,onChange:d=>{l({columnName:i.column_name,displayName:d.target.value})}})}),e.jsx("div",{className:"truncate flex items-center text-[13px] border-t border-slate-200 col-span-4 text-slate-300 px-4 py-1",children:s.map(d=>d[i.column_name]).filter(d=>d!=="null").filter(KE).slice(0,2).join(", ")}),e.jsx("div",{className:"border-t flex items-center border-slate-200 cursor-pointer fill-white group-hover/title:fill-slate-300 hover:bg-slate-100 rounded group/icon col-span-1 p-0.5",onClick:()=>{a(i.column_name)},children:e.jsx(ms,{className:"mx-[6px] cursor-pointer group-hover/icon:fill-slate-500 "})})]},c))});function nM(t){const{state:s,setState:n}=b.useContext(Ne),{layerType:r,selectedInteractiveFilterIndex:a}=b.useMemo(()=>({selectedInteractiveFilterIndex:I(s,`symbology.layers[${s.symbology.activeLayer}]['selectedInteractiveFilterIndex']`),layerType:I(s,`symbology.layers[${s.symbology.activeLayer}]['layer-type']`,"fill")}),[s]);let l="";r==="interactive"&&(l=`['interactive-filters'][${a}]`);const{activeLayer:i}=b.useMemo(()=>{const c=l!==""?`symbology.layers[${s.symbology.activeLayer}].${l}`:`symbology.layers[${s.symbology.activeLayer}]`;return{activeLayer:I(s,c)}},[s]);return i&&e.jsxs("div",{className:"pb-4  max-h-[calc(100vh_-_251px)] scrollbar-xs overflow-x-hidden overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-col mx-4 mt-1",children:[e.jsx("div",{className:"w-full text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center",children:"Popover"}),r==="interactive"&&e.jsx("div",{className:"w-full",children:e.jsx(Go,{path:"['interactive-filters']",params:{enableBuilder:!1}})}),e.jsx("div",{className:"flex-1 flex items-center w-full",children:e.jsx(os,{children:e.jsx(yg,{path:"['hover']",params:{version:r==="interactive"?"interactive":void 0,pathPrefix:l,options:[{value:"",name:"None"},{value:"hover",name:"Hover"}]}})})})]}),i.hover&&e.jsx(tM,{path:"['hover-columns']",params:{version:r==="interactive"?"interactive":void 0,pathPrefix:l}})]})}const tm={fill:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-4 rounded ",style:{backgroundColor:s}})}),circle:({layer:t,color:s})=>{let n=I(t,"layers[0].paint['circle-stroke-color']","#ccc");return e.jsx("div",{className:"pl-0.5 pr-2",children:e.jsx("div",{className:"w-3 h-3 rounded-full ",style:{backgroundColor:s,borderColor:n}})})},line:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-1",style:{backgroundColor:s}})})};function rM(){const{state:t,setState:s}=C.useContext(Ne),{layerType:n,selectedInteractiveFilterIndex:r}=b.useMemo(()=>({selectedInteractiveFilterIndex:I(t,`symbology.layers[${t.symbology.activeLayer}]['selectedInteractiveFilterIndex']`),layerType:I(t,`symbology.layers[${t.symbology.activeLayer}]['layer-type']`,"fill")}),[t]);let a=`symbology.layers[${t.symbology.activeLayer}]`;n==="interactive"&&(a=`symbology.layers[${t.symbology.activeLayer}]['interactive-filters'][${r}]`);const{type:l,legenddata:i,legendOrientation:c,showOther:d}=b.useMemo(()=>({legendOrientation:I(t,`${a}['legend-orientation']`,"vertical"),legenddata:I(t,`${a}['legend-data']`,[]),type:I(t,`${a}['type']`,"fill"),showOther:I(t,`${a}['category-show-other']`,"#ccc")}),[t]);if(!i||i.length===0)return e.jsx("div",{children:" No Legend Data "});const u=tm[l]||tm.fill;return e.jsxs("div",{className:"w-full max-h-[550px] pb-4 overflow-auto",children:[e.jsxs("div",{className:"flex p-4 pt-0 text-sm",children:[e.jsx("div",{className:"pr-2",children:" Legend Type: "}),e.jsxs("select",{className:"w-full py-2 bg-transparent",value:c,onChange:m=>{s(p=>{K(p,`${a}['legend-orientation']`,m.target.value)})},children:[n!=="circles"&&e.jsx("option",{value:"vertical",children:"Vertical"}),n!=="circles"&&e.jsx("option",{value:"horizontal",children:"Horizontal"}),n==="circles"&&e.jsx("option",{value:"vertical",children:"Visible"}),e.jsx("option",{value:"none",children:"None"})]})]}),n!=="circles"&&c==="vertical"&&i.map((m,p)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-pink-50",children:[e.jsx("div",{className:"flex items-center h-6 w-10 justify-center  ",children:e.jsx(u,{color:m.color})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-500  text-sm truncate",children:e.jsx("input",{type:"text",className:"block w-full border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-2 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",value:i[p].label,onChange:x=>s(h=>{K(h,`${a}['legend-data'][${p}].label`,x.target.value)})})})]},`vertical_input_${p}`)),n!=="circles"&&c==="horizontal"&&e.jsx("div",{className:"flex-1 flex w-full p-2",children:i.map((m,p)=>e.jsxs("div",{className:"flex-1 h-6",children:[e.jsx("div",{className:"flex justify-self-end text-xs",children:e.jsx("input",{type:"text",className:"block w-full border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent px-1 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",value:i[p].label,onChange:x=>s(h=>{K(h,`${a}['legend-data'][${p}].label`,x.target.value)})})}),e.jsx("div",{className:"flex-1 h-4",style:{backgroundColor:m.color}},p)]},`horizontal_input_${p}`))})]})}function aM(t){const{state:s,setState:n}=C.useContext(Ne),r=b.useMemo(()=>{var l,i;return((i=(l=s.symbology)==null?void 0:l.layers)==null?void 0:i[s.symbology.activeLayer])||null},[s]);b.useMemo(()=>gg[r.type]||[],[r.type]);const a=r["layer-type"];return r&&e.jsx("div",{children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"font-bold tracking-wider text-sm text-slate-700 p-4 pb-2",children:"Legend"}),a==="interactive"&&e.jsx("div",{className:"px-2",children:e.jsx(Go,{path:"['interactive-filters']",params:{enableBuilder:!1}})}),e.jsx(rM,{})]})})}const{simple:sm,select:oM}=en;function lM(t,s,n){return n.indexOf(t)===s}const iM=(t,s)=>t.filter(n=>!s.includes(n)),cM={string:["!=","=="],integer:["!=","<","<=","==",">=",">","between"],number:["!=","<","<=","==",">=",">","between"]},dM=({removeFilter:t,activeColumn:s,setActiveColumn:n})=>{var f;const{state:r,setState:a}=C.useContext(Ne),l=I(r,`symbology.layers[${r.symbology.activeLayer}]['layer-type']`),i=I(r,`symbology.layers[${r.symbology.activeLayer}]['selectedInteractiveFilterIndex']`),c=l==="interactive"?`['interactive-filters'][${i}]`:"",d=I(r,`symbology.layers[${r.symbology.activeLayer}]${c}.filter`,{}),u=I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`),{pgEnv:m,falcor:p,falcorCache:x}=b.useContext(ie);b.useEffect(()=>{u&&p.get(["dama",m,"sources","byId",u,"attributes","metadata"])},[u]);const h=b.useMemo(()=>{let g=I(x,["dama",m,"sources","byId",u,"attributes","metadata","value","columns"],[]);return g.length===0&&(g=I(x,["dama",m,"sources","byId",u,"attributes","metadata","value"],[])),g},[u,x]);return e.jsx("div",{className:"flex w-full flex-wrap",children:(f=Object.keys(d||{}))==null?void 0:f.map((g,y)=>{var M,_,L;const v=h.find(D=>D.name===g)||{},j=d[g],N=s===g?"bg-pink-100":"",S=s===g?"text-pink-100":"text-white",w=v.type==="string"&&["!=","=="].includes(j.operator),k=j.operator==="between",$=((M=h.find(D=>D.name===g))==null?void 0:M.display_name)||g;let E=j==null?void 0:j.value;return w?Array.isArray(j==null?void 0:j.value)&&(E=(_=j==null?void 0:j.value)==null?void 0:_.join(", ")):k&&Array.isArray(j==null?void 0:j.value)&&(E=(L=j==null?void 0:j.value)==null?void 0:L.join(" and ")),e.jsxs("div",{className:`${N} m-1 border border-slate-200 rounded group/title w-full px-1 text-sm grid grid-cols-9 cursor-pointer hover:border-pink-500 hover:border`,onClick:()=>{n(g)},children:[e.jsxs("div",{className:"truncate col-span-8 py-1",children:[$," ",e.jsx("span",{className:"font-thin",children:j.operator})," ",E]}),e.jsx("div",{className:`cursor-pointer ${S} group-hover/title:text-black group/icon col-span-1 p-1`,onClick:D=>{D.stopPropagation(),t(g)},children:e.jsx("i",{className:"mx-2 fa fa-x cursor-pointer group-hover/icon:text-pink-800"})})]},y)})})};function uM({path:t,params:s={}}){var k,$;const{state:n,setState:r}=C.useContext(Ne),[a,l]=C.useState(""),{activeColumn:i,setActiveColumn:c}=s,{sourceId:d}=b.useMemo(()=>({sourceId:I(n,`symbology.layers[${n.symbology.activeLayer}].source_id`)}),[n]),{pgEnv:u,falcor:m,falcorCache:p}=b.useContext(ie);b.useEffect(()=>{d&&m.get(["dama",u,"sources","byId",d,"attributes","metadata"])},[d]);const x=b.useMemo(()=>{let E=I(p,["dama",u,"sources","byId",d,"attributes","metadata","value","columns"],[]);return E.length===0&&(E=I(p,["dama",u,"sources","byId",d,"attributes","metadata","value"],[])),E},[d,p]),h=b.useMemo(()=>x.find(E=>E.name===i),[i]),f=cM[h==null?void 0:h.type]||[],g=I(n,`symbology.layers[${n.symbology.activeLayer}]${t}`,{}),y=`${t}.${i}.value`,v=((k=g==null?void 0:g[i])==null?void 0:k.operator)==="between",j=(h==null?void 0:h.type)==="string"&&["!=","=="].includes(($=g==null?void 0:g[i])==null?void 0:$.operator),N=j?e.jsx(os,{children:e.jsx("label",{className:"flex",children:e.jsx("div",{className:"flex items-center",children:e.jsx("input",{className:"w-full",type:"text",value:a,onChange:E=>{l(E.target.value)}})})})}):e.jsx(os,{children:e.jsx(sm,{path:y+(v?"[0]":""),params:{default:""}})}),S=j?"Search:":"Value:",w=v?null:e.jsx("div",{className:"p-1",children:S});return e.jsxs(e.Fragment,{children:[!i&&e.jsx(mM,{path:t,params:s,setActiveColumn:c}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mx-4",children:[e.jsxs("div",{className:"flex my-1 items-center",children:[e.jsx("div",{className:"p-1",children:"Column:"}),e.jsx("div",{className:"p-2",children:h.display_name??i})]}),e.jsxs("div",{className:"flex my-1 items-center",children:[e.jsx("div",{className:"p-1",children:"Operator:"}),e.jsx(os,{children:e.jsx(oM,{path:`${t}.${i}.operator`,params:{options:f.map(E=>({value:E,name:E}))}})})]}),e.jsxs("div",{className:"flex my-1 items-center",children:[w,N]}),v&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-1",children:"And"}),e.jsx("div",{className:"flex my-1 items-center",children:e.jsx(os,{children:e.jsx(sm,{path:y+"[1]",params:{default:""}})})})]})]}),j&&e.jsx(pM,{params:s,path:y,filterSearchValue:a})]})]})}function mM({path:t,params:s={},setActiveColumn:n}){var y,v;const{state:r,setState:a}=C.useContext(Ne),l=I(r,`symbology.layers[${r.symbology.activeLayer}].${t}`,s.default||((v=(y=s==null?void 0:s.options)==null?void 0:y[0])==null?void 0:v.value)||{}),i=Object.keys(l),c=I(r,`symbology.layers[${r.symbology.activeLayer}].source_id`),{pgEnv:d,falcor:u,falcorCache:m}=b.useContext(ie);b.useEffect(()=>{c&&u.get(["dama",d,"sources","byId",c,"attributes","metadata"])},[c]);const p=b.useMemo(()=>{let j=I(m,["dama",d,"sources","byId",c,"attributes","metadata","value","columns"],[]);return j.length===0&&(j=I(m,["dama",d,"sources","byId",c,"attributes","metadata","value"],[])),j},[c,m]),x=b.useMemo(()=>p.filter(j=>!["wkb_geometry"].includes(j)).map(j=>j.name),[p]),h=iM(x,i).map(j=>{const N=p.find(S=>S.name===j);return{value:j,label:(N==null?void 0:N.display_name)||j}}),f={operator:"==",value:[]},g={operator:"==",value:""};return e.jsx(Xr,{setState:j=>{a(N=>{if(j!==""){const S=p.find(k=>k.name===j);let w={...f,columnName:j};S.type!=="string"&&(w={...g,columnName:j}),K(N,`symbology.layers[${r.symbology.activeLayer}].${t}.${j}`,w)}}),n(j)},availableColumnNames:h})}function pM({params:t,path:s,filterSearchValue:n}){var y,v;const{pgEnv:r,falcor:a,falcorCache:l}=b.useContext(ie),{state:i,setState:c}=C.useContext(Ne),{activeColumn:d,setActiveColumn:u}=t,{viewId:m,sourceId:p}=b.useMemo(()=>({viewId:I(i,`symbology.layers[${i.symbology.activeLayer}].view_id`),sourceId:I(i,`symbology.layers[${i.symbology.activeLayer}].source_id`)}),[i]);b.useEffect(()=>{p&&a.get(["dama",r,"sources","byId",p,"attributes","metadata"])},[p]);const x=JSON.stringify({groupBy:[d.split("AS ")[0]],exclude:{[d.split("AS ")[0]]:["null"]}});b.useEffect(()=>{a.get(["dama",r,"viewsbyId",m,"options",x,"databyIndex",{from:0,to:500},[d,"count(1)::int as count"]])},[a,r,m,d]);const h=b.useMemo(()=>Object.values(I(l,["dama",r,"viewsbyId",m,"options",x,"databyIndex"],{})),[r,l]),f=b.useMemo(()=>{var j,N;return(N=(j=h==null?void 0:h.map(S=>S[d]))==null?void 0:j.filter(S=>typeof S=="string"&&S!=="null"))==null?void 0:N.filter(lM)},[h,d]);f.sort();const g=I(i,`symbology.layers[${i.symbology.activeLayer}].${s}`,t.default||((v=(y=t==null?void 0:t.options)==null?void 0:y[0])==null?void 0:v.value));return f==null?void 0:f.filter(j=>{var N,S;return(S=(N=j==null?void 0:j.toString())==null?void 0:N.toLowerCase())==null?void 0:S.includes(n.toString().toLowerCase())}).map((j,N)=>{const S=g==null?void 0:g.includes(j),w=S?"bg-pink-100":"";return e.jsx("div",{className:`${w} px-4 w-full text-sm hover:bg-pink-200 hover:cursor-pointer`,onClick:()=>c(k=>{const $=S?g.filter(E=>E!==j):[...Array.isArray(g)?g:[],j];K(k,`symbology.layers[${i.symbology.activeLayer}].${s}`,$)}),children:e.jsxs("div",{className:"flex",children:[e.jsx("input",{readOnly:!0,type:"checkbox",checked:S}),e.jsx("div",{className:"truncate flex items-center text-[13px] px-4 py-1",children:j})]})},N)})}const xM=(t,s)=>t.filter(n=>!s.includes(n)),hM=({path:t,params:s={}})=>{const{pgEnv:n,falcor:r,falcorCache:a}=b.useContext(ie),{state:l,setState:i}=C.useContext(Ne),{existingFilter:c,existingDynamicFilter:d,sourceId:u}=b.useMemo(()=>{var j,N;const g=I(l,`symbology.layers[${l.symbology.activeLayer}]['layer-type']`),y=I(l,`symbology.layers[${l.symbology.activeLayer}]['selectedInteractiveFilterIndex']`),v=g==="interactive"?`['interactive-filters'][${y}]`:"";return{existingFilter:I(l,`symbology.layers[${l.symbology.activeLayer}]${v}['filter']`,s.default||((N=(j=s==null?void 0:s.options)==null?void 0:j[0])==null?void 0:N.value)||{}),existingDynamicFilter:I(l,`symbology.layers[${l.symbology.activeLayer}]${t}`,[]),sourceId:I(l,`symbology.layers[${l.symbology.activeLayer}].source_id`)}},[l,t,s]),m=Object.keys(c),p=d.map(g=>g.column_name);b.useEffect(()=>{u&&r.get(["dama",n,"sources","byId",u,"attributes","metadata"])},[u]);const x=b.useMemo(()=>{let g=I(a,["dama",n,"sources","byId",u,"attributes","metadata","value","columns"],[]);return g.length===0&&(g=I(a,["dama",n,"sources","byId",u,"attributes","metadata","value"],[])),g},[u,a]),h=b.useMemo(()=>x.filter(g=>!["wkb_geometry"].includes(g)).map(g=>g.name),[x]),f=xM(h,m.concat(p)).map(g=>{const y=x.find(v=>v.name===g);return{value:g,label:(y==null?void 0:y.display_name)||g}});return e.jsx("div",{className:"flex w-full flex-wrap",children:e.jsxs("div",{className:"flex w-full flex-wrap my-2",children:[e.jsx("div",{className:"mb-2 w-full",children:e.jsx(Xr,{label:"Add Dynamic Column",setState:g=>{i(y=>{if(g!==""){const v=x.find(j=>j.name===g);K(y,`symbology.layers[${l.symbology.activeLayer}]${t}`,d?[...d,{column_name:g,display_name:(v==null?void 0:v.display_name)||g}]:[{column_name:g,display_name:(v==null?void 0:v.display_name)||g}])}})},availableColumnNames:f})}),d.length>0&&e.jsx("div",{className:"mb-2 w-full",children:e.jsx(fM,{selectedColumns:d,reorderAttrs:(g,y)=>{const v=[...d],[j]=v.splice(g,1);v.splice(y,0,j),i(N=>{K(N,`symbology.layers[${l.symbology.activeLayer}]${t}`,v)})},removeAttr:g=>{i(y=>{K(y,`symbology.layers[${l.symbology.activeLayer}]${t}`,d.filter(v=>v.column_name!==g))})},renameAttr:({columnName:g,displayName:y})=>{const v=[...d],j=v.findIndex(w=>w.column_name===g),[N]=v.splice(j,1),S={...N};S.display_name=y,v.splice(j,0,S),i(w=>{K(w,`symbology.layers[${l.symbology.activeLayer}]${t}`,v)})}})})]})})},fM=({selectedColumns:t,reorderAttrs:s,removeAttr:n,renameAttr:r})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"group/title w-full text-sm grid grid-cols-9 cursor-grab border-t border-slate-20",children:[e.jsx("div",{className:"truncate  col-span-4 px-2 py-1 border-r",children:e.jsx("div",{className:" p-1 text-sm text-slate-700 font-bold",children:"Column name"})}),e.jsx("div",{className:"truncate  col-span-4 px-2 py-1",children:e.jsx("div",{className:" p-1 text-sm text-slate-700 font-bold",children:"Display name"})})]}),e.jsx(Qt,{onDrop:s,children:t==null?void 0:t.map((a,l)=>e.jsxs("div",{className:"group/title w-full text-sm grid grid-cols-9 cursor-grab border-t border-slate-20",children:[e.jsx("div",{className:"truncate  col-span-4 px-2 py-1 border-r",children:e.jsx("div",{className:" p-1 text-sm text-slate-700",children:a.column_name})}),e.jsx("div",{className:"truncate  col-span-4 py-1",children:e.jsx("div",{className:" p-1 text-sm text-slate-700",children:e.jsx("input",{type:"text",className:"w-full px-2 border text-sm border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent text-slate-700 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",value:a.display_name,onChange:i=>{r({columnName:a.column_name,displayName:i.target.value})}})})}),e.jsx("div",{className:"flex items-center  cursor-pointer fill-white group-hover/title:fill-slate-300 hover:bg-slate-100 rounded group/icon col-span-1 p-0.5",onClick:()=>{n(a.column_name)},children:e.jsx(ms,{className:"cursor-pointer group-hover/icon:fill-slate-500 "})})]},l))})]});function gM(t){const{state:s,setState:n}=b.useContext(Ne),[r,a]=b.useState(!1),[l,i]=b.useState(!1),[c,d]=b.useState(),{existingFilter:u,existingDynamicFilter:m,layerType:p,pathBase:x}=b.useMemo(()=>{const h=I(s,`symbology.layers[${s.symbology.activeLayer}]['layer-type']`),f=I(s,`symbology.layers[${s.symbology.activeLayer}]['selectedInteractiveFilterIndex']`),g=h==="interactive"?`['interactive-filters'][${f}]`:"";return{pathBase:g,layerType:h,existingFilter:I(s,`symbology.layers[${s.symbology.activeLayer}]${g}['filter']`,{}),existingDynamicFilter:I(s,`symbology.layers[${s.symbology.activeLayer}]${g}['dynamic-filters']`,[]),sourceId:I(s,`symbology.layers[${s.symbology.activeLayer}].source_id`)}},[s,t]);return e.jsxs("div",{className:"pb-4 w-full max-h-[calc(100vh_-_251px)] scrollbar-xs overflow-x-hidden overflow-y-auto",children:[e.jsx("div",{className:"w-full mt-1 mx-4 text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center mx",children:"Filters"}),p==="interactive"&&e.jsx("div",{className:"px-2",children:e.jsx(Go,{path:"['interactive-filters']",params:{enableBuilder:!1}})}),e.jsx("div",{className:"mx-4",children:e.jsx(dM,{removeFilter:h=>{d(null),a(!1),n(f=>{if(u){const g=Object.keys(u).reduce((y,v)=>(v!==h&&(y[v]=u[v]),y),{});K(f,`symbology.layers[${s.symbology.activeLayer}]${x}.filter`,g)}else K(f,`symbology.layers[${s.symbology.activeLayer}]${x}.filter`,{})})},activeColumn:c,setActiveColumn:d})}),e.jsx("div",{className:"m-4 mt-2",children:e.jsx($e,{className:"p-1",themeOptions:{size:"sm",color:"transparent"},onClick:()=>{a(!0),i(!1),d(null)},children:"Add Filter"})}),(c||r)&&e.jsx(uM,{path:`${x}['filter']`,params:{activeColumn:c,setActiveColumn:d}}),e.jsx("div",{className:"w-full mt-1 mx-4 text-slate-500 text-[14px] tracking-wide min-h-[32px] flex items-center mx",children:"Dynamic Filters"}),e.jsx(hM,{path:`${x}['dynamic-filters']`})]})}function bM(t){var l,i,c,d;const{state:s,setState:n}=C.useContext(Ne),r=b.useMemo(()=>{var u,m,p;return((p=(u=s==null?void 0:s.symbology)==null?void 0:u.layers)==null?void 0:p[(m=s==null?void 0:s.symbology)==null?void 0:m.activeLayer])||null},[s]),a=["Style","Legend","Popup","Filter"];return r&&e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-white/95 w-[312px] rounded-lg drop-shadow-lg pointer-events-auto min-h-[400px] max-h-[calc(100vh_-_161px)]  ",children:[e.jsxs("div",{className:"flex justify-between items-center border-b",children:[e.jsx("div",{className:"flex text-slate-700 p-2 ",children:e.jsx("input",{type:"text",className:"block w-[220px] border border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-2 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",placeholder:"Layer Name",value:(d=(c=(l=s==null?void 0:s.symbology)==null?void 0:l.layers)==null?void 0:c[(i=s==null?void 0:s.symbology)==null?void 0:i.activeLayer])==null?void 0:d.name,onChange:u=>n(m=>{m.symbology.activeLayer&&(m.symbology.layers[m.symbology.activeLayer].name=u.target.value)})})}),e.jsx("div",{className:"text-sm pt-1.5 px-1.5  hover:bg-slate-100 flex items-center",children:e.jsx(jc,{location:"right-0",layer:r,button:e.jsx(Wn,{className:" cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700"})})}),e.jsx("div",{onClick:()=>n(u=>{u.symbology.activeLayer=null}),className:"p-2.5 rounded hover:bg-slate-100 m-1 cursor-pointer",children:e.jsx(ms,{className:"fill-slate-500"})})]}),e.jsx("div",{className:"min-h-20 relative",children:e.jsxs(Te.Group,{children:[e.jsx("div",{className:"flex justify-between items-center border-b",children:e.jsx(Te.List,{children:a.map(u=>e.jsx(Te,{as:b.Fragment,children:({selected:m})=>e.jsx("button",{className:`
                        ${m?"text-slate-600 border-b font-medium border-slate-600":"text-slate-400"} mx-1 text-sm p-2 cursor-pointer
                      `,children:u})},u))})}),e.jsxs(Te.Panels,{children:[e.jsx(Te.Panel,{children:e.jsx(vg,{})}),e.jsx(Te.Panel,{children:e.jsx(aM,{})}),e.jsx(Te.Panel,{children:e.jsx(nM,{})}),e.jsx(Te.Panel,{children:e.jsx(gM,{})})]})]})})]})})}function yM(t,s,n){return n.indexOf(t)===s}const vM=({maplibreMap:t,layer:s,layerProps:n,allLayerProps:r})=>{var p,x;const a=b.useContext(ps),{state:l,setState:i}=a||{state:{},setState:()=>{}};b.useEffect(()=>()=>{s.layers.forEach(h=>{try{t&&t.getLayer(h.id)&&t.removeLayer(h.id)}catch{}})},[]);const c=t.getCenter(),d=t.getZoom();b.useEffect(()=>{l.setInitialBounds&&i(h=>{h.setInitialBounds=!1;const f={center:c,zoom:d};Ae(l.initialBounds,f)||(h.initialBounds=f)})},[t,l.setInitialBounds]);const u=Nr(n),m=t.getSource((x=(p=n==null?void 0:n.sources)==null?void 0:p[0])==null?void 0:x.id);b.useEffect(()=>{var N,S,w,k,$,E,M,_,L,D,A,T,O,B,F,z,P,U;const h=n.filterGroupEnabled&&!Ae(n==null?void 0:n["filter-group"],u==null?void 0:u["filter-group"]),f=!n.filterGroupEnabled&&(n==null?void 0:n["data-column"])!==(u==null?void 0:u["data-column"]),g=(n==null?void 0:n.filter)!==(u==null?void 0:u.filter),y=(n==null?void 0:n["dynamic-filters"])!==(u==null?void 0:u["dynamic-filters"]);if((h||f||g||y)&&t.getSource((S=(N=n==null?void 0:n.sources)==null?void 0:N[0])==null?void 0:S.id)){let R=jt((w=n.sources)==null?void 0:w[0]),W=(k=R.source.tiles)==null?void 0:k[0];W&&(R.source.tiles=[nm(W,n)]),($=n==null?void 0:n.layers)==null||$.forEach(X=>{t.getLayer(X==null?void 0:X.id)&&t.getLayer(X==null?void 0:X.id)&&t.removeLayer(X==null?void 0:X.id)}),t.removeSource(R.id),t.getSource(R.id)?console.log("cant add",t.getSource(R.id)):t.addSource(R.id,R.source);let V=Object.values(r).find(X=>(X==null?void 0:X.order)===n.order+1);(E=n==null?void 0:n.layers)==null||E.forEach(X=>{t.getLayer(V==null?void 0:V.id)?t.addLayer(X,V==null?void 0:V.id):t.addLayer(X)})}if((M=Object.keys(n))!=null&&M.length&&n.view_id!==(u==null?void 0:u.view_id)&&t.getSource((L=(_=u==null?void 0:u.sources)==null?void 0:_[0])==null?void 0:L.id)){const R=jt((D=u.sources)==null?void 0:D[0]);let W=jt((A=n.sources)==null?void 0:A[0]),V=(T=W==null?void 0:W.source.tiles)==null?void 0:T[0];V&&(W.source.tiles=[nm(V,n)]),(O=n==null?void 0:n.layers)==null||O.forEach(q=>{t.getLayer(q==null?void 0:q.id)&&t.getLayer(q==null?void 0:q.id)&&t.removeLayer(q==null?void 0:q.id)}),t.removeSource(R.id),t.getSource(W.id)?console.log("cant add",t.getSource(W.id)):t.addSource(W.id,W.source);let X=Object.values(r).find(q=>(q==null?void 0:q.order)===n.order+1);(B=n==null?void 0:n.layers)==null||B.forEach(q=>{t.getLayer(X==null?void 0:X.id)?t.addLayer(q,X==null?void 0:X.id):t.addLayer(q)})}if((u==null?void 0:u.order)!==void 0&&(n==null?void 0:n.order)<(u==null?void 0:u.order)){let R=Object.values(r).find(W=>(W==null?void 0:W.order)===(n==null?void 0:n.order)+1);(F=n==null?void 0:n.layers)==null||F.forEach(W=>{t.getLayer(W==null?void 0:W.id)&&t.moveLayer(W==null?void 0:W.id,R==null?void 0:R.id)})}(z=n==null?void 0:n.layers)==null||z.forEach((R,W)=>{t.getLayer(R.id)&&Object.keys(R.paint).forEach(V=>{var X,q,Q,Y;Ae((Q=(q=(X=u==null?void 0:u.layers)==null?void 0:X[W])==null?void 0:q.paint)==null?void 0:Q[V],(Y=R==null?void 0:R.paint)==null?void 0:Y[V])||t.setPaintProperty(R.id,V,R.paint[V])})}),(P=n==null?void 0:n.layers)==null||P.forEach((R,W)=>{t.getLayer(R.id)&&Object.keys((R==null?void 0:R.layout)||{}).forEach(V=>{var X,q,Q,Y;Ae((Q=(q=(X=u==null?void 0:u.layers)==null?void 0:X[W])==null?void 0:q.layout)==null?void 0:Q[V],(Y=R==null?void 0:R.layout)==null?void 0:Y[V])||t.setLayoutProperty(R.id,V,R.layout[V])})});const{filter:v,["dynamic-filters"]:j}=n;(U=n==null?void 0:n.layers)==null||U.forEach((R,W)=>{if(t.getLayer(R.id)){let V=[];v&&(V=Object.keys(v).map(Q=>{var H;let Y=[];if(Q.includes("rpad(substring(prop_class, 1, 1), 3, '0')")){const J=["slice",["get","prop_class"],0,1],G=v[Q].operator,se=(H=v==null?void 0:v[Q])==null?void 0:H.value.map(le=>le==null?void 0:le.substring(0,1));Y=["in",J,["literal",se]],G==="!="&&(Y=["!",Y])}else{const J=v[Q].operator,G=v[Q].value,se=["get",Q];J==="between"?Y=["all",[">=",["to-string",se],["to-string",G==null?void 0:G[0]]],["<=",["to-string",se],["to-string",G==null?void 0:G[1]]]]:["==","!="].includes(J)?(Y=["in",se,["literal",G]],J==="!="&&(Y=["!",Y])):Y=[J,["to-string",se],["to-string",G]]}return Y}));const X=j&&(j==null?void 0:j.length)>0&&j.some(Q=>{var Y;return((Y=Q==null?void 0:Q.values)==null?void 0:Y.length)>0});let q=[];X&&(q=j==null?void 0:j.filter(Q=>{var Y;return((Y=Q==null?void 0:Q.values)==null?void 0:Y.length)>0}).map(Q=>{let Y=[];const H=Q.values;return Y=["in",["get",Q.column_name],["literal",H]],Y})),t.setFilter(R.id,["all",...V,...q])}})},[m,n]),b.useEffect(()=>{var h;t&&r&&((h=r==null?void 0:r.zoomToFit)==null?void 0:h.length)>0&&t.fitBounds(r.zoomToFit,{duration:400})},[t,r==null?void 0:r.zoomToFit])},nm=(t,s)=>{var c,d,u,m;let n=t;const r=(s==null?void 0:s.filter)&&((c=Object.keys(s==null?void 0:s.filter))==null?void 0:c.length)>0,a=s!=null&&s.filterGroupEnabled&&((d=s==null?void 0:s["filter-group"])==null?void 0:d.length)>0?(u=s==null?void 0:s["filter-group"])==null?void 0:u.map(p=>p.column_name):[s==null?void 0:s["data-column"]],l=(m=s==null?void 0:s["dynamic-filters"])==null?void 0:m.filter(p=>{var x;return((x=p==null?void 0:p.values)==null?void 0:x.length)>0}).map(p=>p.column_name),i=a.concat(l).filter(yM).filter(p=>!!p).join(",");if(n&&(i||r)){n!=null&&n.includes("?cols=")||(n+="?cols=");const p=n.split("?cols=");i&&p[1].length===0&&(n+=i),i&&p[1].length>0&&(n=n.replace(p[1],i)),i&&n.includes(i)&&r&&(n+=","),r&&Object.keys(s.filter).forEach((x,h)=>{x.includes("rpad(substring(prop_class, 1, 1), 3, '0')")?n+="prop_class":n+=`${x}`,h<Object.keys(s.filter).length-1&&(n+=",")})}return n};let Cc=class extends Po{constructor(){super(...arguments);Wt(this,"onHover",{layers:this.layers.filter(n=>{var r;return((r=n==null?void 0:n.id)==null?void 0:r.indexOf("_case"))===-1}).map(n=>n.id),callback:(n,r,a)=>[r[0].id,n,(r[0]||{}).properties],Component:wM,isPinnable:this.isPinnable||!0});Wt(this,"RenderComponent",vM)}};const wM=({data:t,layer:s})=>{if(!s.props.hover)return;const{source_id:n,view_id:r}=s,a=C.useContext(ie),l=C.useContext(me),i=a!=null&&a.falcor?a:l,{pgEnv:c,falcor:d,falcorCache:u}=i,m=C.useMemo(()=>I(t,"[0]",null),[t]),p=C.useMemo(()=>s.props["hover-columns"],[s]);b.useEffect(()=>{n&&d.get(["dama",c,"sources","byId",n,"attributes","metadata"])},[n,p]);const x=C.useMemo(()=>{if(p)return p;{let y=I(u,["dama",c,"sources","byId",n,"attributes","metadata","value","columns"],[]);return y.length===0&&(y=I(u,["dama",c,"sources","byId",n,"attributes","metadata","value"],[])),y}},[n,u,p]),h=C.useMemo(()=>{let y=I(u,["dama",c,"sources","byId",n,"attributes","metadata","value","columns"],[]);return y.length===0&&(y=I(u,["dama",c,"sources","byId",n,"attributes","metadata","value"],[])),Array.isArray(y)?y:[]},[n,u]);let f=(typeof(x==null?void 0:x[0])=="string"?x:(x||[]).map(y=>y.name||y.column_name)).filter(y=>!["wkb_geometry"].includes(y));C.useEffect(()=>{d.get(["dama",c,"viewsbyId",r,"databyId",m,f])},[d,c,r,m,x]);const g=C.useMemo(()=>I(u,["dama",c,"viewsbyId",r,"databyId",""+m],{}),[m,u,r,c]);return e.jsxs("div",{className:"bg-white p-4 max-h-64 max-w-lg min-w-[300px] scrollbar-xs overflow-y-scroll",children:[e.jsx("div",{className:"font-medium pb-1 w-full border-b ",children:(s==null?void 0:s.name)||""}),Object.keys(g).length===0&&(x==null?void 0:x.length)!==0?`Fetching Attributes ${m}`:"",Object.keys(g).filter(y=>typeof g[y]!="object").sort((y,v)=>{const j=(p==null?void 0:p.findIndex(S=>S.column_name===y))||0,N=(p==null?void 0:p.findIndex(S=>S.column_name===v))||0;return j-N}).map((y,v)=>{const j=(x||[]).find(w=>w.name===y||w.column_name===y)||{},N=h.find(w=>w.name===y||w.column_name===y)||{},S=JSON.parse((N==null?void 0:N.meta_lookup)||"{}");return j.name||j.display_name?e.jsxs("div",{className:"flex border-b pt-1",children:[e.jsx("div",{className:"flex-1 font-medium text-xs text-slate-400 pl-1",children:j.display_name||j.name}),e.jsx("div",{className:"flex-1 text-right text-sm font-thin pl-4 pr-1",children:(g==null?void 0:g[y])!=="null"?I(S,g==null?void 0:g[y],g==null?void 0:g[y]):""})]},v):e.jsx("span",{},v)})]})},Ne=b.createContext(void 0),Nc="mapeditor_symbology_",rm=()=>{var ee,xe,ke,he,we,be,Me,Ve,Xe,yt,_t,an,Zr,Sc,_c;const t=b.useRef(!1),{falcor:s,falcorCache:n,pgEnv:r,baseUrl:a}=C.useContext(ie);Le();const{symbologyId:l}=Be();b.useEffect(()=>{async function fe(){const ge=["dama",r,"symbologies","byId",[l],"attributes",Object.values(En)];await s.get(ge)}l&&fe()},[l,r]),b.useEffect(()=>{async function fe(){const ge=["dama",r,"symbologies","length"],Se=await s.get(ge),Ie=["dama",r,"symbologies","byIndex",{from:0,to:I(Se.json,ge,0)-1},"attributes",Object.values(En)];await s.get(Ie)}fe()},[l]);const i=b.useMemo(()=>Object.values(I(n,["dama",r,"symbologies","byIndex"],{})).map(fe=>Qs(I(n,fe.value,{attributes:{}}).attributes)).filter(fe=>Object.keys(fe).length>0),[n,r]),c=b.useMemo(()=>i==null?void 0:i.find(fe=>+fe.symbology_id==+l),[i,l]);let d={name:"",description:"",symbology:{layers:{}}};const u=Nc+`${l}`,m=(ee=window==null?void 0:window.localStorage)==null?void 0:ee.getItem(u),p=m!=="undefined"?JSON.parse(m):null;p?d=p:c&&(d=c),(xe=d==null?void 0:d.symbology)!=null&&xe.layers&&Object.keys((ke=d==null?void 0:d.symbology)==null?void 0:ke.layers).length>0&&(((he=d==null?void 0:d.symbology)==null?void 0:he.activeLayer)===""||!(d!=null&&d.symbology.layers[(we=d==null?void 0:d.symbology)==null?void 0:we.activeLayer]))&&(d.symbology.activeLayer=(Me=Object.values((be=d==null?void 0:d.symbology)==null?void 0:be.layers).find(fe=>fe.order===0))==null?void 0:Me.id);const[x,h]=st(d);b.useEffect(()=>{x.symbology_id&&+l!=+x.symbology_id&&h(d)},[d]),b.useEffect(()=>{var ge;function fe(){try{window.localStorage&&window.localStorage.setItem(u,JSON.stringify(x))}catch(Se){console.error(Se)}}(ge=x==null?void 0:x.symbology)!=null&&ge.layers&&!Ae(x,d)&&fe()},[x==null?void 0:x.symbology,d]),b.useEffect(()=>{!p&&c&&h(c)},[i.length,c]);const[f,g]=st([]);b.useEffect(()=>{(async()=>{t.current&&g(ge=>{var Ht;let Se=ge.map(Fe=>Fe.id).filter(Fe=>Fe),Ie=Object.values(((Ht=x==null?void 0:x.symbology)==null?void 0:Ht.layers)||{}).filter(Fe=>Fe).filter(Fe=>!Se.includes(Fe.id)).sort((Fe,ht)=>ht.order-Fe.order).map(Fe=>new Cc(Fe));return[...ge.filter(Fe=>{var ht;return Object.keys(((ht=x==null?void 0:x.symbology)==null?void 0:ht.layers)||{}).includes(Fe.id)}),...Ie].sort((Fe,ht)=>{var Ic,Lc;return((Ic=x.symbology.layers[ht==null?void 0:ht.id])==null?void 0:Ic.order)-((Lc=x.symbology.layers[Fe==null?void 0:Fe.id])==null?void 0:Lc.order)})})})()},[(Ve=x==null?void 0:x.symbology)==null?void 0:Ve.layers,(Xe=x==null?void 0:x.symbology)==null?void 0:Xe.zoomToFit]);const y=b.useMemo(()=>{var fe,ge;return{...(fe=x==null?void 0:x.symbology)==null?void 0:fe.layers,zoomToFit:(ge=x==null?void 0:x.symbology)==null?void 0:ge.zoomToFit}},[(yt=x==null?void 0:x.symbology)==null?void 0:yt.layers,(_t=x==null?void 0:x.symbology)==null?void 0:_t.zoomToFit]),{activeLayerType:v,selectedInteractiveFilterIndex:j,currentInteractiveFilter:N}=b.useMemo(()=>{var ge,Se,Ie;const fe=I(x,`symbology.layers[${(ge=x==null?void 0:x.symbology)==null?void 0:ge.activeLayer}]['selectedInteractiveFilterIndex']`,0);return{selectedInteractiveFilterIndex:fe,activeLayerType:I(x,`symbology.layers[${(Se=x==null?void 0:x.symbology)==null?void 0:Se.activeLayer}]['layer-type']`,{}),currentInteractiveFilter:I(x,`symbology.layers[${(Ie=x==null?void 0:x.symbology)==null?void 0:Ie.activeLayer}]['interactive-filters'][${fe}]`)}},[x==null?void 0:x.symbology.layers]);b.useEffect(()=>{v==="interactive"&&j!==void 0&&(()=>{h(ge=>{var ot,Ht,Fe,ht;const Se=ge.symbology.layers[(ot=ge==null?void 0:ge.symbology)==null?void 0:ot.activeLayer],Ie=I(ge,`symbology.layers[${(Ht=ge==null?void 0:ge.symbology)==null?void 0:Ht.activeLayer}]['interactive-filters']`),Nt=I(ge,`symbology.layers[${(Fe=ge==null?void 0:ge.symbology)==null?void 0:Fe.activeLayer}]['interactive-filters'][${j}]`);Nt&&(ge.symbology.layers[(ht=ge==null?void 0:ge.symbology)==null?void 0:ht.activeLayer]={...Se,...Nt,name:Se.name,filter:Nt.filter??{},order:Se.order,"layer-type":"interactive","interactive-filters":Ie,selectedInteractiveFilterIndex:j})})})()},[j,v,N]);const S=b.useMemo(()=>Object.values(x.symbology.layers).map(fe=>fe.selectedInteractiveFilterIndex),[x.symbology.layers]),w=Nr(S);b.useEffect(()=>{h(fe=>{Object.values(fe.symbology.layers).filter(ge=>ge["layer-type"]==="interactive"&&ge.id!==fe.symbology.activeLayer).forEach(ge=>{const Se=I(ge,"['interactive-filters']"),Ie=ge.selectedInteractiveFilterIndex,Nt=Se[Ie];Nt&&(fe.symbology.layers[ge.id]={...ge,...Nt,order:ge.order,"layer-type":"interactive","interactive-filters":Se,selectedInteractiveFilterIndex:Ie})})})},[Ae(S,w)]);const $=((_c=(Sc=(an=x==null?void 0:x.symbology)==null?void 0:an.layers)==null?void 0:Sc[(Zr=x==null?void 0:x.symbology)==null?void 0:Zr.activeLayer])==null?void 0:_c["layer-type"])==="interactive"?`symbology.layers[${x.symbology.activeLayer}]['interactive-filters'][${j}]`:`symbology.layers[${x.symbology.activeLayer}]`;let{layerType:E,viewId:M,sourceId:_,paintValue:L,column:D,categories:A,categorydata:T,colors:O,colorrange:B,numCategories:F,numbins:z,method:P,showOther:U,symbology_id:R,choroplethdata:W,filterGroupEnabled:V,filterGroupLegendColumn:X,viewGroupEnabled:q,layerPaintPath:Q,viewGroupId:Y,initialViewId:H,baseDataColumn:J,legendOrientation:G,minRadius:se,maxRadius:le,lowerBound:ce,upperBound:je,radiusCurve:Ce,curveFactor:oe,legendData:ve}=b.useMemo(()=>{const fe=I(x,`${$}['type']`,{}),ge={fill:"layers[1].paint['fill-color']",circle:"layers[0].paint['circle-color']",line:"layers[1].paint['line-color']"},Se=I(x,`${$}['layer-type']`,{});let Ie=ge[fe];return Se==="circles"&&(Ie="layers[0].paint['circle-radius']"),{layerPaintPath:Ie,layerType:Se,viewId:I(x,`symbology.layers[${x.symbology.activeLayer}].view_id`),sourceId:I(x,`symbology.layers[${x.symbology.activeLayer}].source_id`),paintValue:I(x,`${$}.${Ie}`,{}),baseDataColumn:I(x,`symbology.layers[${x.symbology.activeLayer}]['data-column']`,""),column:I(x,`${$}['data-column']`,""),categories:I(x,`${$}['categories']`,{}),categorydata:I(x,`${$}['category-data']`,{}),choroplethdata:I(x,`${$}['choroplethdata']`),colors:I(x,`${$}['color-set']`,wc.cat1),colorrange:I(x,`${$}['color-range']`,$t.seq1[9]),numbins:I(x,`${$}['num-bins']`,9),method:I(x,`${$}['bin-method']`,"ckmeans"),numCategories:I(x,`${$}['num-categories']`,10),showOther:I(x,`${$}['category-show-other']`,"#ccc"),symbology_id:I(x,"symbology_id"),filterGroupEnabled:I(x,`${$}['filterGroupEnabled']`,!1),filterGroupLegendColumn:I(x,`${$}['filter-group-legend-column']`),viewGroupEnabled:I(x,`${$}['viewGroupEnabled']`,!1),viewGroupId:I(x,`${$}['view-group-id']`),initialViewId:I(x,`${$}['initial-view-id']`),legendOrientation:I(x,`${$}['legend-orientation']`,"vertical"),minRadius:I(x,`${$}['min-radius']`,8),maxRadius:I(x,`${$}['max-radius']`,128),lowerBound:I(x,`${$}['lower-bound']`,null),upperBound:I(x,`${$}['upper-bound']`,null),radiusCurve:I(x,`${$}['radius-curve']`,"linear"),curveFactor:I(x,`${$}['curve-factor']`,1),legendData:I(x,`${$}['legend-data']`)}},[x]);b.useEffect(()=>{_&&s.get(["dama",r,"sources","byId",_,"attributes","metadata"])},[_]);const ae=b.useMemo(()=>{let fe=I(n,["dama",r,"sources","byId",_,"attributes","metadata","value","columns"],[]);return fe.length===0&&(fe=I(n,["dama",r,"sources","byId",_,"attributes","metadata","value"],[])),fe},[_,n]);b.useEffect(()=>{async function fe(){const ge=["dama",r,"sources","byId",_,"views","length"],Se=await s.get(ge);return await s.get(["dama",r,"sources","byId",_,"views","byIndex",{from:0,to:I(Se.json,ge,0)-1},"attributes",Object.values(Ot)])}_&&fe()},[_,s,r]);const de=b.useMemo(()=>Object.values(I(n,["dama",r,"sources","byId",_,"views","byIndex"],{})).map(fe=>Qs(I(n,fe.value,{attributes:{}}).attributes)),[n,_,r]),te=Nr(Y);b.useEffect(()=>{(async()=>{var ge;if(E==="categories"){let{paint:Se,legend:Ie}=A!=null&&A.paint&&(A!=null&&A.legend)?jt(A):iE(J,T,O,F,ae);Se.length%2?Se[Se.length-1]=U:Se.push(U),U==="#ccc"&&Ie?(((ge=Ie[Ie.length-1])==null?void 0:ge.label)!=="Other"&&Ie.push({color:U,label:"Other"}),Ie[Ie.length-1].color=U):Ie[Ie.length-1].label==="Other"&&Ie.pop(),ui(Se)&&!Ae(Se,L)&&h(ot=>{K(ot,`${$}['categories']`,{paint:Se,legend:Ie}),K(ot,`${$}.${Q}`,Se),K(ot,`${$}['legend-data']`,Ie)})}else if(E==="choropleth"||E==="circles"){const Se={column:J,viewId:M,numbins:z,method:P};let Ie;if(W&&Object.keys(W).length===2&&Y===te)Ie=W;else{V&&(Se.column=X),q&&(Se.viewId=Y),h(Fe=>{K(Fe,`${$}['is-loading-colorbreaks']`,!0)});const Ht=await s.get(["dama",r,"symbologies","byId",[R],"colorDomain","options",JSON.stringify(Se)]);Ie=I(Ht,["json","dama",r,"symbologies","byId",[R],"colorDomain","options",JSON.stringify(Se)]),h(Fe=>{K(Fe,`${$}['is-loading-colorbreaks']`,!1)})}let{paint:Nt,legend:ot}=mi(J,Ie.max,B,z,P,Ie.breaks,U,G);if(E==="circles"){console.log("---RECALCULATING CIRCLE RADIUS---"),ce||h(ht=>{K(ht,`${$}['lower-bound']`,Ie.breaks[0])}),je||h(ht=>{K(ht,`${$}['upper-bound']`,Ie.max)});const Ht=ce!==null?ce:Ie.breaks[0],Fe=je!==null?je:Ie.max;Nt=["interpolate",[Ce,oe],["number",["get",J]],Ht,se,Fe,le]}(ui(Nt)||E==="circles")&&!Ae(Nt,L)&&(U==="#ccc"?(ot[ot.length-1].label!=="No data"&&ot.push({color:U,label:"No data"}),ot[ot.length-1].color=U):ot[ot.length-1].label==="No data"&&ot.pop(),h(Fe=>{K(Fe,`${$}.${Q}`,Nt),K(Fe,`${$}['legend-data']`,ot),K(Fe,`${$}['choroplethdata']`,Ie)}))}else E==="simple"&&typeof L!="string"&&h(Se=>{K(Se,`${$}.${Q}`,Ka(null))})})()},[A,E,J,T,O,F,U,B,z,P,W,Y,X]),b.useEffect(()=>{if(W&&!ve){console.log("---NEW LEGEND, switching legend orientation----");let{legend:fe}=mi(J,W.max,B,z,P,W.breaks,U,G);fe&&(U==="#ccc"?(fe[fe.length-1].label!=="No data"&&fe.push({color:U,label:"No data"}),fe[fe.length-1].color=U):fe[fe.length-1].label==="No data"&&fe.pop(),h(Se=>{K(Se,`${$}['legend-data']`,fe)}))}},[G,ve]);const re=I(x,`symbology.layers[${x.symbology.activeLayer}]`);return b.useEffect(()=>{re&&(V&&!X?h(fe=>{const ge=ae.find(Se=>Se.name===D);K(fe,`${$}['filter-group-name']`,D),K(fe,`${$}['filter-group-legend-column']`,D),K(fe,`${$}['filter-group']`,[{display_name:(ge==null?void 0:ge.display_name)||ge.name,column_name:ge.name}])}):!V&&re&&h(fe=>{K(fe,`${$}['filter-group-name']`,""),K(fe,`${$}['filter-group-legend-column']`,""),K(fe,`${$}['filter-group']`,[])}))},[V]),b.useEffect(()=>{re&&(q&&!Y&&re?h(fe=>{const ge=de.find(Ie=>Ie.view_id===M),Se=(ge==null?void 0:ge.version)??(ge==null?void 0:ge.view_id)+" group";K(fe,`${$}['filter-source-views']`,[M]),K(fe,`${$}['view-group-name']`,Se),K(fe,`${$}['view-group-id']`,M)}):!q&&re&&h(fe=>{K(fe,`${$}['filter-source-views']`,[]),K(fe,`${$}['view-group-name']`,""),K(fe,`${$}['view-group-id']`,void 0),K(fe,`${$}['view_id']`,H??M)}))},[q]),b.useEffect(()=>{if(J&&E==="categories"){const fe=JSON.stringify({groupBy:[J.split("AS ")[0]],exclude:{[J.split("AS ")[0]]:["null"]},orderBy:{2:"desc"}});s.get(["dama",r,"viewsbyId",M,"options",fe,"databyIndex",{from:0,to:100},[J,"count(1)::int as count"]])}},[J,E,M]),b.useEffect(()=>{if(J&&E==="categories"){const fe=JSON.stringify({groupBy:[J.split("AS ")[0]],exclude:{[J.split("AS ")[0]]:["null"]},orderBy:{2:"desc"}});let ge=I(n,["dama",r,"viewsbyId",M,"options",fe,"databyIndex"],{});h(Se=>{K(Se,`${$}['category-data']`,ge)})}},[J,E,M,n]),e.jsx(Ne.Provider,{value:{state:x,setState:h,symbologies:i},children:e.jsxs("div",{className:"w-full h-full relative",ref:t,children:[e.jsx(Hn,{layers:f,layerProps:y,hideLoading:!0,showLayerSelect:!0,mapOptions:{center:[-76,43.3],zoom:6,maxPitch:60,protocols:[Ro],styles:[{name:"Default",style:"https://api.maptiler.com/maps/dataviz/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Satellite",style:"https://api.maptiler.com/maps/hybrid/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Streets",style:"https://api.maptiler.com/maps/streets-v2/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Light",style:"https://api.maptiler.com/maps/dataviz-light/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Dark",style:"https://api.maptiler.com/maps/dataviz-dark/style.json?key=mU28JQ6HchrQdneiq6k9"}]},leftSidebar:!1,rightSidebar:!1}),e.jsxs("div",{className:"absolute inset-0 flex pointer-events-none",children:[e.jsx(SE,{}),e.jsx("div",{className:"flex-1"}),e.jsx(bM,{})]})]})})},jM=({symbology:t,selectedSymbologyId:s,setSelectedSymbologyId:n,cat1:r,setCat1:a})=>{const l=s===t.symbology_id,i=Array.isArray(t==null?void 0:t.categories)?t==null?void 0:t.categories:[];return e.jsx("div",{children:e.jsx("div",{className:`w-full p-4 ${l?"bg-blue-100 hover:bg-blue-200":"bg-white hover:bg-blue-50"} block border shadow flex`,onClick:()=>{n(l?null:t.symbology_id)},children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-medium w-full block",children:e.jsx("span",{children:t.name})}),e.jsx("div",{children:i.map(c=>(typeof c=="string"?[c]:c).map((d,u)=>{const m=d===r;let p="bg-blue-100 text-blue-400 hover:bg-blue-400";return(l||m)&&(p="bg-blue-300 text-blue-500 hover:bg-blue-400",l&&m&&(p="bg-blue-400 text-blue-600 hover:bg-blue-500")),e.jsx("div",{onClick:x=>{x.stopPropagation(),a(m?"":d)},className:`inline hover:cursor-pointer text-xs p-1 px-2 ${p}  mr-2`,children:d},u)}))}),e.jsx("div",{className:"py-2 block",children:t.description})]})})})},CM=({selectedSymbologyId:t,setSelectedSymbologyId:s})=>{var S,w;const{falcorCache:n,pgEnv:r,baseUrl:a}=C.useContext(ie),{symbologies:l}=C.useContext(Ne),i=((w=(S=window.location.pathname.replace(`${a}/`,""))==null?void 0:S.split("/"))==null?void 0:w[0])==="listall",[c,d]=b.useState(""),[u,m]=b.useState(),[p,x]=b.useState(),[h,f]=b.useState("asc"),g="Unknown",y=[...new Set(l.filter(k=>{const $=Array.isArray(k==null?void 0:k.categories)?k==null?void 0:k.categories:[];return i||!i&&!($!=null&&$.find(E=>E.includes(g)))}).reduce((k,$)=>{let E=Array.isArray($==null?void 0:$.categories)?$.categories:[];return[...k,...E.map(M=>M[0])||[]]},[]))].sort(),v=y.reduce((k,$)=>{var E;return k[$]=(E=l.filter(M=>{var _;return(_=M.categories)==null?void 0:_.find(L=>L.includes($))}))==null?void 0:E.length,k},{}),j=b.useMemo(()=>l.find(k=>k.symbology_id===t)??{},[r,n,t]),N="bg-transparent hover:bg-blue-100 rounded-sm p-2 ml-0.5 border-2";return e.jsxs(Ct,{baseUrl:a,isListAll:i,hideBreadcrumbs:!0,children:[e.jsxs("div",{className:"py-4 flex flex-rows items-center",children:[e.jsx("input",{className:"w-full text-lg p-2 border border-gray-300 ",placeholder:"Search symbologies",value:c,onChange:k=>d(k.target.value)}),e.jsx("button",{className:N,title:"Toggle Sort",onClick:()=>f(h==="asc"?"desc":"asc"),children:e.jsx("i",{className:`fa-solid ${h==="asc"?"fa-arrow-down-z-a":"fa-arrow-down-a-z"} text-xl text-blue-400`})}),e.jsx("div",{onClick:()=>{m(""),d("")},className:N,title:i?"View Key Sources":"View All Sources",children:e.jsx("i",{className:`fa-solid ${i?"fa-filter-list":"fa-list-ul"} text-xl text-blue-400`})})]}),e.jsxs("div",{className:"flex flex-row",children:[e.jsxs("div",{className:"w-1/4 flex flex-col space-y-1.5 max-h-[65dvh] overflow-auto scrollbar-sm",children:[e.jsx(gf,{symbology:j,editingCategories:!!t,entityType:"symbologies"}),(y||[]).filter(k=>k!==g).sort((k,$)=>k.localeCompare($)).map(k=>e.jsxs("div",{className:`${u===k||p===k?"bg-blue-100 hover:bg-blue-200":"bg-white hover:bg-blue-50"}  hover:cursor-pointer p-2 rounded-md flex items-center`,onClick:()=>{m(k===u?"":k)},children:[e.jsx("i",{className:"fa fa-category"}),k,e.jsx("div",{className:"bg-blue-200 text-blue-600 text-xs w-5 h-5 ml-2 shrink-0 grow-0 rounded-lg flex items-center justify-center border border-blue-300",children:v[k]})]},k))]}),e.jsx("div",{className:"w-3/4 flex flex-col space-y-1.5 ml-1.5 max-h-[65dvh] overflow-auto scrollbar-sm",children:l.filter(k=>{const $=Array.isArray(k==null?void 0:k.categories)?k==null?void 0:k.categories:[];return i||!i&&!($!=null&&$.find(E=>E.includes(g)))}).filter(k=>{let $=!0;return u&&($=!1,(I(k,"categories",[])||[]).forEach(E=>{E[0]===u&&(!p||E[1]===p)&&($=!0)})),$}).filter(k=>{const $=Array.isArray(k==null?void 0:k.categories)?k==null?void 0:k.categories:[];let E=k.name+" "+($||[]).reduce((M,_)=>(M+=Array.isArray(_)?_.join(" "):typeof _=="string"?_:"",M),"");return!c.length>2||E.toLowerCase().includes(c.toLowerCase())}).sort((k,$)=>{var M;return(h==="asc"?1:-1)*((M=k.name)==null?void 0:M.localeCompare($.name))}).map((k,$)=>e.jsx(jM,{cat1:u,setCat1:m,symbology:k,baseUrl:a,selectedSymbologyId:t,setSelectedSymbologyId:s},$))})]})]})},NM=({modalState:t,setModalState:s})=>{const{baseUrl:n}=C.useContext(ie),r=Le();return e.jsx("div",{children:e.jsxs(Vn,{open:t.open,setOpen:()=>s({...t,open:!t.open}),width:"w-[1200px]",children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fad fa-layer-group text-blue-600","aria-hidden":"true"})}),e.jsx("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:e.jsx(Je.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Select Symbology"})})]}),e.jsx("div",{className:"mt-2 ",children:e.jsx(CM,{selectedSymbologyId:t.symbologyId,setSelectedSymbologyId:a=>{s({...t,symbologyId:a})}})}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex justify-end",children:[e.jsx("div",{className:"mr-1",children:e.jsx($e,{type:"button",themeOptions:{color:"cancel"},onClick:()=>s(kr),children:"Cancel"})}),e.jsx("div",{children:e.jsx($e,{type:"button",themeOptions:t.symbologyId?{color:"primary"}:{color:"transparent"},disabled:!t.symbologyId,onClick:()=>{r(`${n}/mapeditor/${t.symbologyId}`),s(kr)},children:"Open Symbology"})})]})]})})};function kM({button:t,className:s}){const[n,r]=b.useState(!1);return e.jsxs("div",{onClick:()=>r(!0),className:s,children:[e.jsx($M,{open:n,setOpen:r}),t]})}const El={name:"",loading:!1};function $M({open:t,setOpen:s}){var x;const n=b.useRef(null),{pgEnv:r,falcor:a,baseUrl:l}=b.useContext(ie),{state:i,setState:c}=b.useContext(Ne),d=Le(),[u,m]=b.useState(El),p=async()=>{var v,j;const h={name:u.name,description:"map",symbology:{layers:{}}};let f=await a.call(["dama","symbology","symbology","create"],[r,h]);const g=(j=(v=Object.values(I(f,["json","dama",r,"symbologies","byId"],{})).filter(N=>Object.keys(N).includes("attributes")))==null?void 0:v[0])==null?void 0:j.attributes;let{symbology_id:y}=g||!1;y&&(await a.invalidate(["dama",r,"symbologies","byIndex"],["dama",r,"symbologies","byId"],["dama",r,"symbologies","length"]),s(!1),c(g),m(El),d(`${l}/mapeditor/${y}`))};return e.jsxs(Vn,{open:t,setOpen:s,initialFocus:n,children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fad fa-layer-group text-blue-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:[e.jsx(Je.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Create New Map"}),e.jsx("div",{className:"mt-2 w-full",children:e.jsx("input",{value:u.name,onChange:h=>m({...i,name:h.target.value}),className:"p-2 bg-slate-100 text-lg font-medium w-full",placeholder:"Map Name"})})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{type:"button",disabled:u.loading||((x=u.name)==null?void 0:x.length)<4,className:"disabled:bg-slate-300 disabled:cursor-warning inline-flex w-full justify-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 sm:ml-3 sm:w-auto",onClick:p,children:["Creat",u.loading?"ing...":"e"]}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>{s(!1),m(El)},ref:n,children:"Cancel"})]})]})}function SM({button:t,className:s}){const[n,r]=b.useState(!1);return e.jsxs("div",{onClick:()=>r(!0),className:s,children:[e.jsx(_M,{open:n,setOpen:r}),t]})}const _M=({open:t,setOpen:s})=>{const{pgEnv:n,falcor:r,falcorCache:a,baseUrl:l}=b.useContext(ie),{symbologyId:i}=Be(),c=Le(),d=async()=>{await r.call(["dama","symbology","symbology","delete"],[n,i]),await r.invalidate(["dama",n,"symbologies","byIndex"],["dama",n,"symbologies","byId",i],["dama",n,"symbologies","length"]);const u=Nc+`${i}`;window.localStorage.setItem(u,null),c(`${l}/mapeditor`)};return e.jsxs(Vn,{open:t,setOpen:s,children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fad fa-layer-group text-blue-600","aria-hidden":"true"})}),e.jsx("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:e.jsx(Je.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Delete Symbology"})})]}),e.jsx("div",{className:"flex items-center",children:"Are you sure you want to delete this symbology? This action cannot be undone."}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("div",{className:"px-1",children:e.jsx($e,{themeOptions:{size:"sm",color:"danger"},className:" capitalize",onClick:d,children:"Delete"})}),e.jsx("div",{className:"px-1",children:e.jsx($e,{themeOptions:{size:"sm",color:"transparent"},className:" capitalize",onClick:()=>s(!1),children:"Cancel"})})]})]})};function Vn({open:t,setOpen:s,width:n="sm:my-8 sm:w-full sm:max-w-lg sm:p-6",initialFocus:r,children:a}){return e.jsx(Oe.Root,{show:t,as:b.Fragment,children:e.jsxs(Je,{as:"div",className:"relative z-30 ",initialFocus:r,onClose:s,children:[e.jsx(Oe.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),e.jsx("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:e.jsx("div",{onClick:()=>{s(!1)},className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:e.jsx(Oe.Child,{as:b.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:e.jsx(Je.Panel,{className:`relative transform overflow-auto rounded-lg bg-white px-4 h-[calc(100vh_-_100px)] pb-4 pt-5 text-left shadow-xl transition-all ${n}`,children:a})})})})]})})}const kr={open:!1,symbologyId:null};function IM(){const{state:t,setState:s}=b.useContext(Ne),{symbologyId:n}=Be(),[r,a]=b.useState(kr);return e.jsxs("div",{className:"p-1 flex",children:[e.jsxs("div",{className:"w-full px-1 flex bg-slate-100 border border-transparent hover:border-slate-300 group rounded-md shadow-sm ring-1 ring-inset ring-slate-100 focus-within:ring-2 focus-within:ring-inset focus-within:ring-pink-600 sm:max-w-md",children:[e.jsx("input",{type:"text",className:"block w-[220px] flex-1 outline-0  bg-transparent p-2 text-slate-800 placeholder:text-gray-400  focus:border-0  sm:leading-6",placeholder:"Select / Create New Map",value:t==null?void 0:t.name,onClick:n?void 0:()=>a({...r,open:!0}),onChange:i=>{s(c=>{K(c,"name",i.target.value)})}}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex  mr-2",children:e.jsx(kM,{className:"relative inline-block text-left",button:e.jsx(Jr,{size:14,className:"cursor-pointer fill-none group-hover:fill-gray-400 group-hover:hover:fill-pink-700"})})}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex  mr-2",onClick:()=>a({...r,open:!0}),children:e.jsx(QL,{size:14,className:"cursor-pointer fill-none group-hover:fill-gray-400 group-hover:hover:fill-pink-700"})}),e.jsx("div",{className:"flex  mr-2",children:e.jsx(pE,{button:e.jsx(eE,{size:14,className:"cursor-pointer fill-none group-hover:fill-gray-400 group-hover:hover:fill-pink-700"})})}),e.jsx("div",{className:"flex",children:e.jsx(SM,{button:e.jsx(KL,{size:14,className:"cursor-pointer fill-none group-hover:fill-gray-400 group-hover:hover:fill-pink-700"})})})]})]})]}),e.jsx("div",{className:"flex items-center ml-1",children:e.jsx(NM,{className:" p-1 rounded hover:bg-slate-100 group",modalState:r,setModalState:a})})]})}const LM=({modalState:t,setModalState:s,tabIndex:n})=>{const{state:r,setState:a,falcor:l,falcorCache:i,pgEnv:c}=b.useContext(ps);b.useEffect(()=>{async function m(){console.log("pgEnv",c);const p=["dama",c,"symbologies","length"],x=await l.get(p);await l.get(["dama",c,"symbologies","byIndex",{from:0,to:I(x.json,p,0)-1},"attributes",Object.values(En)])}m()},[l,c]);const d=b.useMemo(()=>Object.values(I(i,["dama",c,"symbologies","byIndex"],{})).map(m=>Qs(I(i,m.value,{attributes:{}}).attributes)),[i,c]),u=()=>{const{symbologyId:m}=t;a(p=>{let x=jt(d.find(h=>+h.symbology_id==+m));x.isVisible=!1,Object.keys(x.symbology.layers).forEach(h=>{var f;x.symbology.layers[h].layers.forEach((g,y)=>{x.symbology.layers[h].layers[y].layout={visibility:"none"}}),(f=x.symbology.layers[h]["interactive-filters"])==null||f.forEach((g,y)=>{((g==null?void 0:g.layers)||[]).forEach((v,j)=>{x.symbology.layers[h]["interactive-filters"][y].layers[j].layout={visibility:"none"}})})}),p.symbologies[""+m]=x,p.tabs[n].rows=[...p.tabs[n].rows,{type:"symbology",name:x.name,symbologyId:x.symbology_id}]}),s(kr)};return e.jsx("div",{children:e.jsxs(Vn,{open:t.open,setOpen:()=>s({...t,open:!t.open}),width:"w-[1200px]",children:[e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("i",{className:"fad fa-layer-group text-blue-600","aria-hidden":"true"})}),e.jsx("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:e.jsx(Je.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Select Symbology"})})]}),e.jsx("div",{className:"mt-2 ",children:e.jsx(sE,{symbologies:d,selectedSymbologyId:t.symbologyId,setSelectedSymbologyId:m=>{s({...t,symbologyId:m})}})}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex justify-end",children:[e.jsx("div",{className:"mr-1",children:e.jsx($e,{type:"button",themeOptions:{color:"cancel"},onClick:()=>s(kr),children:"Cancel"})}),e.jsx("div",{children:e.jsx($e,{type:"button",themeOptions:t.symbologyId?{color:"primary"}:{color:"transparent"},disabled:!t.symbologyId,onClick:()=>{u()},children:"Add Layer"})})]})]})})};let EM=["fad fa-wrench","fad fa-train","fad fa-subway","fad fa-traffic-light","fad fa-traffic-cone","fad fa-ship","fad fa-route","fad fa-road","fad fa-plane-alt","fad fa-parking","fad fa-map-signs","fad fa-map-pin","fad fa-map-marker","fad fa-map-marker-alt","fad fa-map","fad fa-location-circle","fad fa-location-arrow","fad fa-location","fad fa-info","fad fa-info-circle","fad fa-industry-alt","fad fa-globe","fad fa-directions","fad fa-car","fad fa-cars","fad fa-bus","fad fa-truck","fad fa-bicycle","fad fa-layer-group","fad fa-tachometer-fastest"];function eo(t,s,n){var r=t[s];t.splice(s,1),t.splice(n,0,r)}function to({button:t,location:s="left-0",width:n="w-36",children:r}){return e.jsxs(ye,{as:"div",className:"relative inline-block text-left",children:[e.jsx(ye.Button,{children:t}),e.jsx(Oe,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx(ye.Items,{className:`absolute ${s} mt-1 ${n} origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none`,children:r})})]})}function MM({tabIndex:t,row:s,rowIndex:n}){var D,A;const{state:r,setState:a,falcor:l,falcorCache:i,pgEnv:c}=C.useContext(ps),{sourceId:d,symbology:u,layer:m,selectedInteractiveFilterIndex:p,layerType:x,dataColumn:h,interactiveFilters:f,filterGroupEnabled:g,filterGroup:y,filterGroupLegendColumn:v,filterGroupName:j,viewGroupEnabled:N,viewGroup:S,viewGroupName:w}=b.useMemo(()=>{var B;const T=I(r,`symbologies[${s.symbologyId}]`,{}),O=I(T,`symbology.layers[${Object.keys(((B=T==null?void 0:T.symbology)==null?void 0:B.layers)||{})[0]}]`,{});return{symbology:T,layer:O,sourceId:I(O,"['source_id']"),dataColumn:I(O,"['data-column']"),selectedInteractiveFilterIndex:I(O,"['selectedInteractiveFilterIndex']"),layerType:I(O,"['layer-type']","simple"),interactiveFilters:I(O,"['interactive-filters']",[]),filterGroupEnabled:I(O,"['filterGroupEnabled']"),filterGroup:I(O,"['filter-group']",[]),filterGroupName:I(O,"['filter-group-name']",""),filterGroupLegendColumn:I(O,"['filter-group-legend-column']",""),viewGroupEnabled:I(O,"['viewGroupEnabled']"),viewGroup:I(O,"['filter-source-views']",[]),viewGroupName:I(O,"['view-group-name']","")}},[s,r]),k=(A=(D=r==null?void 0:r.symbologies)==null?void 0:D[u.symbology_id])==null?void 0:A.isVisible,$=b.useMemo(()=>()=>a(T=>{T.symbologies[u.symbology_id].isVisible=!T.symbologies[u.symbology_id].isVisible,Object.keys(T.symbologies[u.symbology_id].symbology.layers).forEach(O=>{T.symbologies[u.symbology_id].symbology.layers[O].layers.forEach((F,z)=>{let U=I(r,`symbologies[${u.symbology_id}].symbology.layers[${O}].layers[${z}].layout.visibility`,"")==="visible"?"none":"visible";T.symbologies[u.symbology_id].symbology.layers[O].layers[z].layout={visibility:U}})})}),[r,a]),E=b.useMemo(()=>Object.values(I(i,["dama",c,"symbologies","byIndex"],{})).map(T=>Qs(I(i,T.value,{attributes:{}}).attributes)),[i,c]),M=b.useMemo(()=>r.tabs[t].rows.length,[r.tabs[t].length]);C.useEffect(()=>{async function T(){const O=["dama",c,"sources","byId",d,"views","length"],B=await l.get(O);return await l.get(["dama",c,"sources","byId",d,"views","byIndex",{from:0,to:I(B.json,O,0)-1},"attributes",Object.values(Ot)])}d&&T()},[d,l,c]);const _=b.useMemo(()=>Object.values(I(i,["dama",c,"sources","byId",d,"views","byIndex"],{})).map(T=>Qs(I(i,T.value,{attributes:{}}).attributes)),[i,d,c]),L=[];return x==="interactive"&&L.push(e.jsxs("div",{className:"text-slate-600 font-medium text-xs  truncate flex-1 pl-3 pr-1 pb-1 w-full",children:[e.jsx("div",{className:"text-black",children:"Filters:"}),e.jsx("div",{className:"rounded-md h-[36px] pl-0 pr-1 flex w-full w-[216px] items-center border border-transparent cursor-pointer hover:border-slate-300",children:e.jsx("select",{className:"w-full bg-transparent",value:p,onChange:T=>{a(O=>{O.symbologies[s.symbologyId].symbology.layers[m.id].selectedInteractiveFilterIndex=parseInt(T.target.value)})},children:f.map((T,O)=>e.jsx("option",{value:O,children:T.label},O))})})]})),g&&L.push(e.jsxs("div",{className:"text-slate-600 font-medium text-xs  truncate flex-1 pl-3 pr-1 pb-1 w-full",children:[e.jsxs("div",{className:"text-black",children:[j,":"]}),e.jsx("div",{className:"rounded-md h-[36px] pl-0 pr-1 flex w-full w-[216px] items-center border border-transparent cursor-pointer hover:border-slate-300",children:e.jsx("select",{className:"w-full bg-transparent",value:h,onChange:T=>{a(O=>{O.symbologies[s.symbologyId].symbology.layers[m.id]["data-column"]=T.target.value,x==="categories"&&(O.symbologies[s.symbologyId].symbology.layers[m.id].categories={})})},children:y.map((T,O)=>{const B=v===T.column_name?"**":v?` (${v})`:"";return e.jsxs("option",{value:T.column_name,children:[T.display_name," ",B]},O)})})})]})),m.viewGroupEnabled&&L.push(e.jsxs("div",{className:"text-slate-600 font-medium text-xs  truncate flex-1 pl-3 pr-1 pb-1 w-full ",children:[e.jsxs("div",{className:" text-black",children:[w,": "]}),e.jsx("div",{className:"rounded-md h-[36px]  pl-0 pr-1 flex w-full w-[216px] items-center border border-transparent cursor-pointer hover:border-slate-300",children:e.jsx("select",{className:"w-full bg-transparent",value:m.view_id,onChange:T=>{a(O=>{const B=JSON.parse(JSON.stringify(O.symbologies[s.symbologyId].symbology.layers[m.id].layers).replaceAll(m.view_id,T.target.value));O.symbologies[s.symbologyId].symbology.layers[m.id].layers=B;const F=JSON.parse(JSON.stringify(O.symbologies[s.symbologyId].symbology.layers[m.id].sources).replaceAll(m.view_id,T.target.value));O.symbologies[s.symbologyId].symbology.layers[m.id].sources=F,O.symbologies[s.symbologyId].symbology.layers[m.id].view_id=T.target.value})},children:S.map((T,O)=>{const B=_.find(F=>F.view_id===T);return e.jsx("option",{value:T,children:(B==null?void 0:B.version)??(B==null?void 0:B.view_id)},O)})})})]})),b.useEffect(()=>{m&&a(T=>{const O=m.type,F={fill:"layers[1].paint['fill-color']",circle:"layers[0].paint['circle-color']",line:"layers[1].paint['line-color']"}[O],{choroplethdata:z={},colorrange:P=$t.seq1[9],numbins:U=9,method:R,["category-show-other"]:W="#ccc"}=m,{breaks:V,max:X}=z;let{paint:q}=mi(h,X,P,U,R,V,W);ui(q)&&K(T,`symbologies[${[s.symbologyId]}].symbology.layers[${m.id}].${F}`,q)})},[h]),e.jsxs("div",{className:"border-white/85 border hover:border-pink-500 group",children:[e.jsxs("div",{className:"w-full  px-2 flex  items-center",children:[e.jsx("div",{className:"pr-2 flex items-center",children:e.jsx("input",{type:"checkbox",checked:k,className:"h-4 w-4 rounded border-slate-300 text-pink-600 focus:ring-pink-600",onChange:$})}),e.jsx("div",{onClick:r.isEdit?()=>{}:$,className:"text-[13px] cursor-pointer font-regular hover:text-slate-900 text-slate-600 truncate flex items-center flex-1",children:r.isEdit?e.jsx("input",{className:"block w-[240px] flex flex-1 bg-transparent text-slate-800 placeholder:text-gray-400  focus:border-0",value:u==null?void 0:u.name,placeholder:"Layer Name",type:"text",onChange:T=>{const O=T.target.value;a(B=>{const F=Object.keys(B.symbologies[s.symbologyId].symbology.layers).reduce((z,P)=>(z[P]={...B.symbologies[s.symbologyId].symbology.layers[P],name:O},z),{});B.symbologies[s.symbologyId].symbology.layers=F,B.symbologies[s.symbologyId].name=O,B.tabs[t].rows[n].name=O})}}):(u==null?void 0:u.name)||" no name"}),r.isEdit&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`${n===0?"pointer-events-none":""}`,onClick:()=>{a(T=>{eo(T.tabs[t].rows,n,n-1)})},children:e.jsx(mg,{className:"pt-[2px] fill-white cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700",size:20})}),e.jsx("div",{className:`${n===M-1?"pointer-events-none":""}`,onClick:()=>{a(T=>{eo(T.tabs[t].rows,n,n+1)})},children:e.jsx(ug,{className:"pb-[2px] fill-white cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700",size:20})})]}),r.isEdit&&e.jsx("div",{className:"text-sm pt-1 px-0.5 flex items-center",children:e.jsxs(to,{button:e.jsx(Wn,{className:"fill-white cursor-pointer group-hover:fill-gray-400 group-hover:hover:fill-pink-700"}),children:[e.jsx("div",{className:"px-1 py-1 ",children:e.jsx(ye.Item,{children:({active:T})=>e.jsx("div",{className:`${T?"bg-pink-50 ":""} group flex w-full items-center text-red-400 rounded-md px-2 py-2 text-sm`,onClick:()=>{a(O=>{delete O.symbologies[u.symbology_id],O.tabs[t].rows.splice(n,1)})},children:"Remove"})})}),e.jsx("div",{className:"px-1 py-1 ",children:e.jsx(ye.Item,{children:({active:T})=>e.jsx("div",{className:`${T?"bg-pink-50 ":""} group flex w-full items-center rounded-md px-2 py-2 text-sm`,onClick:async()=>{console.log("updating symbology for::",s.symbologyId),a(O=>{let B=jt(E.find(F=>+F.symbology_id==+s.symbologyId));Object.keys(B.symbology.layers).forEach(F=>{B.symbology.layers[F].layers.forEach((z,P)=>{const U=I(r,`symbologies[${u.symbology_id}].symbology.layers[${F}].layers[${P}].layout.visibility`,"");B.symbology.layers[F].layers[P].layout={visibility:U}})}),O.symbologies[""+s.symbologyId]=B,O.symbologies[u.symbology_id].isVisible=k})},children:"Update symbology"})})})]})})]}),e.jsx("div",{className:"text-sm mr-1 flex flex-col justify-start align-start content-start flex-wrap w-full",children:L})]})}function AM({row:t}){return e.jsx("div",{children:t.name})}const am={symbology:MM,category:AM},TM={open:!1,symbologyId:null};function OM({tabIndex:t,tab:s}){const{state:n,setState:r}=C.useContext(ps),a=" p-1 rounded hover:bg-slate-100 group",[l,i]=C.useState(TM),c=b.useMemo(()=>n.tabs.length,[n.tabs.length]);return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex-1 items-center",children:[n.isEdit&&e.jsx("input",{type:"text",className:"border w-[180px] font-medium border-transparent hover:border-slate-200 outline-2 outline-transparent rounded-md bg-transparent py-1 px-2 text-slate-800 placeholder:text-gray-400 focus:outline-pink-300 sm:leading-6",value:s.name,onChange:d=>r(u=>{u.tabs[t].name=d.target.value})}),!n.isEdit&&e.jsx("div",{className:"font-medium py-1 px-2 text-slate-800",children:s.name})]}),n.isEdit&&e.jsx("div",{className:"w-[28px] h-[28px] justify-center m-1 rounded hover:bg-slate-100 flex items-center flex",onClick:()=>{i({...l,open:!0})},children:e.jsx(Jr,{className:"fill-slate-500 hover:fill-pink-300 hover:cursor-pointer"})}),n.isEdit&&e.jsxs(e.Fragment,{children:[e.jsxs(to,{button:e.jsx("div",{className:"w-[28px] h-[28px] justify-center m-1 rounded hover:bg-slate-100 flex items-center",children:e.jsx(Wn,{className:"fill-slate-500 hover:fill-pink-300"})}),children:[e.jsx("div",{className:"px-1 py-1 ",children:e.jsx(ye.Item,{children:({active:d})=>e.jsx("div",{className:`${d?"bg-pink-50 ":""} group flex w-full items-center text-red-400 rounded-md px-2 py-2 text-sm`,onClick:()=>{r(u=>{console.log("remove tab",n,t),u.tabs.splice(t,1)})},children:"Remove"})})}),t!==0&&e.jsx("div",{className:"px-1 py-1 ",children:e.jsx(ye.Item,{children:({active:d})=>e.jsx("div",{className:`${d?"bg-pink-50 ":""} group flex w-full items-center  rounded-md px-2 py-2 text-sm`,onClick:()=>{r(u=>{eo(u.tabs,t,t-1)})},children:"Move section up"})})}),t!==c-1&&e.jsx("div",{className:"px-1 py-1 ",children:e.jsx(ye.Item,{children:({active:d})=>e.jsx("div",{className:`${d?"bg-pink-50 ":""} group flex w-full items-center  rounded-md px-2 py-2 text-sm`,onClick:()=>{r(u=>{eo(u.tabs,t,t+1)})},children:"Move section down"})})})]}),e.jsx(to,{button:e.jsx("div",{className:"w-[28px] h-[28px] justify-center m-1 rounded hover:bg-slate-100 flex items-center",children:e.jsx("i",{className:`text-lg text-slate-400 hover:text-pink-300 ${(s==null?void 0:s.icon)||"fad fa-layer-group"} fa-fw mx-auto`})}),width:"w-[190px]",children:e.jsx("div",{className:"px-1 py-1 flex flex-wrap",children:EM.map(d=>e.jsx(ye.Item,{children:({active:u})=>e.jsx("div",{className:`${u?"bg-pink-50 ":""} rounded-md p-1 text-lg`,onClick:()=>{r(m=>{m.tabs[t].icon=d})},children:e.jsx("div",{className:` cursor-pointer w-[28px] h-[28px] justify-center rounded hover:bg-slate-100 flex items-center ${d}`})})},d))})}),e.jsx("div",{className:"flex items-center ml-1",children:e.jsx(LM,{tabIndex:t,className:a,modalState:l,setModalState:i})})]})]}),e.jsx("div",{className:"flex flex-col ",children:((s==null?void 0:s.rows)||[]).map((d,u)=>{let m=am[d.type]||am.category;return e.jsx(m,{row:d,rowIndex:u,tabIndex:t},u)})})]})}const so={full:"calc(95vh)",1:"900px","2/3":"600px","1/3":"300px","1/4":"150px"};function wg(){const{state:t,setState:s}=C.useContext(ps),{blankBaseMap:n,isEdit:r,hideControls:a,initialBounds:l,tabs:i,height:c,zoomPan:d}=b.useMemo(()=>({isEdit:I(t,["isEdit"],!1),blankBaseMap:I(t,["blankBaseMap"],!1),hideControls:I(t,["hideControls"],!1),initialBounds:I(t,["initialBounds"],{}),height:I(t,["height"],"full"),tabs:I(t,["tabs"],[]),zoomPan:I(t,["zoomPan"],!0)}),[t]),u=r?"overflow-x-auto overflow-x-visible":"overflow-y-auto";return e.jsx("div",{className:"p-4",children:e.jsx("div",{className:`bg-white/95 w-[340px] ${u} rounded-lg drop-shadow-lg pointer-events-auto  min-h-[400px] max-h-[calc(100vh_-_111px)] scrollbar-sm `,children:e.jsxs(Te.Group,{className:"flex",children:[e.jsxs("div",{className:"flex flex-col justify-between items-center border-r",children:[e.jsx(Te.List,{className:"flex w-[40px] flex-1 flex-col ",children:i.map((m,p)=>e.jsx(Te,{as:b.Fragment,children:({selected:x})=>e.jsx("div",{className:`
                        ${x?"text-blue-500 border-r-2 border-blue-600":"text-slate-400"} text-sm cursor-pointer
                      `,children:e.jsx("div",{className:"w-full flex items-center",children:e.jsx("i",{className:`text-lg hover:text-blue-500 ${(m==null?void 0:m.icon)||"fad fa-layer-group"} fa-fw mx-auto`})})})},m.name))}),r&&e.jsxs(e.Fragment,{children:[e.jsxs(to,{button:e.jsx("div",{className:"w-[28px] h-[28px] justify-center m-1 rounded hover:bg-slate-100 flex items-center",children:e.jsx(Wn,{className:"fill-slate-500 hover:fill-pink-300"})}),children:[e.jsx("div",{className:"px-1 py-1",children:e.jsx(ye.Item,{children:({active:m})=>e.jsxs("div",{className:`${m?"bg-pink-50 ":""} group flex w-full items-center rounded-md px-2 py-2 text-sm`,children:["Height:",e.jsx("select",{className:"ml-1 bg-transparent",value:c,onChange:p=>{s(x=>{console.log("setting new map hieght::",p),x.height=p.target.value})},children:Object.keys(so).map((p,x)=>e.jsx("option",{value:p,children:so[p]},x))})]})})}),e.jsx("div",{className:"px-1 py-1",children:e.jsx(ye.Item,{children:({active:m})=>e.jsx("div",{className:`${m?"bg-pink-50 ":""} group flex w-full items-center rounded-md px-2 py-2 text-sm`,onClick:()=>{s(p=>{p.hideControls=!p.hideControls})},children:a?"Display Map Controls":"Hide Map Controls"})})}),e.jsx("div",{className:"px-1 py-1",children:e.jsx(ye.Item,{children:({active:m})=>e.jsx("div",{className:`${m?"bg-pink-50 ":""} group flex w-full items-center rounded-md px-2 py-2 text-sm`,onClick:()=>{s(p=>{p.zoomPan=!p.zoomPan})},children:d?"Disable zoom/pan":"Enable zoom/pan"})})}),e.jsx("div",{className:"px-1 py-1",children:e.jsx(ye.Item,{children:({active:m})=>e.jsx("div",{className:`${m?"bg-pink-50 ":""} group flex w-full items-center rounded-md px-2 py-2 text-sm`,onClick:()=>{s(p=>{p.setInitialBounds=!0})},children:"Set Initial Viewport"})})}),l&&e.jsx("div",{className:"px-1 py-1",children:e.jsx(ye.Item,{children:({active:m})=>e.jsx("div",{className:`${m?"bg-pink-50 ":""} group flex w-full items-center text-red-400 rounded-md px-2 py-2 text-sm`,onClick:()=>{s(p=>{p.setInitialBounds=!1,p.initialBounds=null})},children:"Remove Initial Viewport"})})}),e.jsx("div",{className:"px-1 py-1",children:e.jsx(ye.Item,{children:({active:m})=>e.jsx("div",{className:`${m?"bg-pink-50 ":""} group flex w-full items-center rounded-md px-2 py-2 text-sm`,onClick:()=>{s(p=>{p.blankBaseMap=!p.blankBaseMap,console.log("Settting draft.blankBaseMap::",p.blankBaseMap)})},children:n?"Reset base map layer":"Use blank basemap"})})})]}),e.jsx("div",{className:"p-1 rounded hover:bg-slate-100 m-1 cursor-pointer",onClick:()=>s(m=>{m.tabs.push({name:`Layers ${i.length-1}`,icon:"fad fa-layer-group",rows:[]})}),children:e.jsx(Jr,{className:"fill-slate-500 hover:fill-pink-700"})})]})]}),e.jsx(Te.Panels,{className:"flex-1 w-[220px] ",children:i.map((m,p)=>e.jsx(Te.Panel,{className:"w-full",children:e.jsx(OM,{tab:m,tabIndex:p})},p))})]})})})}const Tn={fill:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-4 rounded ",style:{backgroundColor:s}})}),circle:({layer:t,color:s})=>{let n=I(t,"layers[0].paint['circle-stroke-color']","#ccc");return e.jsx("div",{className:"pl-0.5 pr-2",children:e.jsx("div",{className:"w-3 h-3 rounded-full ",style:{backgroundColor:s,borderColor:n}})})},line:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-1",style:{backgroundColor:s}})})},$r={fill:t=>I(t,"layers[1].paint['fill-color']","#ccc"),circle:t=>I(t,"layers[0].paint['circle-color']","#ccc"),line:t=>I(t,"layers[1].paint['line-color']","#ccc")};function DM({layer:t}){const s=Tn[t.type]||Tn.fill;let n=(t==null?void 0:t["legend-data"])||[],r=typeof $r[t.type](t)=="object"?$r[t.type](t):[];const a=n||(r||[]).filter((l,i)=>i>2).map((l,i)=>i%2===0?{color:l,label:r[i+2]}:null).filter(l=>l);return e.jsx("div",{className:"w-full max-h-[250px] overflow-auto",children:a.map((l,i)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-pink-50",children:[e.jsx("div",{className:"flex items-center h-6 w-10 justify-center  ",children:e.jsx(s,{color:l.color})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-500 h-6 text-sm truncate",children:l.label})]},i))})}function BM({layer:t}){const{state:s,setState:n}=C.useContext(ps),{choroplethdata:r,legenddata:a}=b.useMemo(()=>({choroplethdata:I(t,"['choropleth-data']",[]),legenddata:(t==null?void 0:t["legend-data"])||[]}),[s]),l=Tn[t.type]||Tn.fill;let i=typeof $r[t.type](t)=="object"?$r[t.type](t):[];const c=Math.max(...r),d=a||[...(i||[]).filter((u,m)=>m>2).map((u,m)=>m%2===1?{color:i[m+1],label:`${i[m+2]} - ${i[m+4]||c}`}:null).filter(u=>u)];return e.jsx("div",{className:"w-full max-h-[250px] overflow-auto",children:d.map((u,m)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-pink-50",children:[e.jsx("div",{className:"flex items-center h-6 w-10 justify-center  ",children:e.jsx(l,{color:u.color})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-500 h-6 text-sm truncate",children:u.label})]},m))})}function FM({layer:t}){let{legenddata:s,showOther:n}=b.useMemo(()=>({legenddata:I(t,"['legend-data']",[]),showOther:I(t,"['category-show-other']","#ccc")}),[t]);const r=n==="#ccc";return e.jsx("div",{className:"w-full max-h-[350px] overflow-x-auto scrollbar-sm",children:e.jsx("div",{className:"flex-1 flex w-full p-2",children:s.map((a,l)=>e.jsxs("div",{className:"flex-1 h-6 overflow-hidden",children:[e.jsx("div",{className:"flex h-4 justify-self-end text-xs",children:r&&l===s.length-1?"N/A":s[l].label}),e.jsx("div",{className:"flex-1 h-2 w-20",style:{backgroundColor:a.color}},l)]},l))})})}function zM({layer:t}){const{minRadius:s,maxRadius:n,lowerBound:r,upperBound:a}=b.useMemo(()=>({minRadius:I(t,"['min-radius']",8),maxRadius:I(t,"['max-radius']",128),lowerBound:I(t,"['lower-bound']",null),upperBound:I(t,"['upper-bound']",null)}),[t]);return e.jsxs("div",{className:"w-[50%] max-h-[350px] overflow-x-auto scrollbar-sm text-sm",children:[e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsxs("div",{children:[s,"px"]}),e.jsxs("div",{children:[n,"px"]})]}),e.jsx("div",{className:"ml-8",children:e.jsx("i",{class:"fa-solid fa-arrow-right-long",style:{transform:"scaleX(3)"}})}),e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsx("div",{children:Rs(r)}),e.jsx("div",{children:Rs(a)})]})]})}function PM({index:t,layer:s,i:n,symbology_id:r}){const a=Le(),l=null,i=Tn[s.type]||Tn.fill;let c=$r[s.type](s),{layerType:d,selectedInteractiveFilterIndex:u,legendOrientation:m}=b.useMemo(()=>({layerType:I(s,"['layer-type']"),selectedInteractiveFilterIndex:I(s,"['selectedInteractiveFilterIndex']"),legendOrientation:I(s,"['legend-orientation']","vertical")}),[s]);const p=`/datasources/source/${s.source_id}`,x=d==="interactive"?s.label:s.name;return d=d==="interactive"?I(s,`['interactive-filters'][${u}]['layer-type']`):d,e.jsxs("div",{className:`${l==s.id?"bg-pink-100":""} hover:border-pink-500 border border-transparent`,children:[e.jsxs("div",{className:"group/title w-full  p-2 py-1 flex items-center",children:[(d==="simple"||!d)&&e.jsx("div",{className:"px-1",children:e.jsx(i,{layer:s,color:c})}),e.jsxs("div",{className:"w-full text-sm text-slate-600 font-medium truncate flex justify-between flex-wrap",children:[x,e.jsx("div",{className:"cursor-pointer text-white group-hover/title:text-black group/icon ",onClick:h=>{h.ctrlKey?window.open(p,"_blank"):a(p)},children:e.jsx("span",{className:"mx-2 text-md text-slate-300 fa fa-info group-hover/icon:text-pink-800"})})]})]}),m==="horizontal"?e.jsx(FM,{layer:s}):d==="circles"?e.jsx(zM,{layer:s}):e.jsxs(e.Fragment,{children:[d==="categories"&&e.jsx(DM,{layer:s}),d==="choropleth"&&e.jsx(BM,{layer:s})]})]})}function jg(t){const{state:s,setState:n}=C.useContext(ps),r=b.useMemo(()=>Object.values((s==null?void 0:s.symbologies)||{}).filter(a=>a.isVisible).map(a=>({name:a.name,symbology_id:a.symbology_id,layers:{...a.symbology.layers}})),[s]);return e.jsx(e.Fragment,{children:e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"min-h-10 relative bg-white/75 max-h-[calc(100vh_-_111px)] overflow-auto pointer-events-auto scrollbar-sm",children:r.map(a=>e.jsxs("div",{className:"m-1 p-1 rounded",children:[e.jsx("div",{className:"font-normal",children:a.name}),Object.values(a.layers).sort((l,i)=>i.order-l.order).filter(l=>(l==null?void 0:l["legend-orientation"])!=="none").map((l,i)=>e.jsx(PM,{layer:l,i,symbology_id:a.symbology_id},l.id))]},a.symbology_id))})})})}const Cg=t=>{try{JSON.parse(t)}catch{return!1}return!0},ps=b.createContext(void 0),RM=async()=>({}),Ng=({value:t,onChange:s,size:n})=>{var N;const{falcor:r,falcorCache:a,pgEnv:l}=C.useContext(me),i=b.useRef(!1),c=typeof t=="object"?t:t&&Cg(t)?JSON.parse(t):{},[d,u]=st({tabs:c.tabs||[{name:"Layers",rows:[]}],symbologies:c.symbologies||{},isEdit:!0,setInitialBounds:c.setInitialBounds||!1,initialBounds:c.initialBounds||null,hideControls:c.hideControls||!1,blankBaseMap:c.blankBaseMap||!1,height:c.height||"full",zoomPan:typeof c.zoomPan=="boolean"?c.zoomPan:!0}),[m,p]=st([]);b.useEffect(()=>{async function S(){s(d)}Ae(d,t)||S()},[d]),b.useEffect(()=>{(async()=>{if(i.current){let w=Object.values(d.symbologies).reduce((k,$)=>{var _;let E=k.map(L=>L.id),M=Object.keys((_=$==null?void 0:$.symbology)==null?void 0:_.layers).reduce((L,D)=>{var A;return E.includes(D)||(L[D]=(A=$==null?void 0:$.symbology)==null?void 0:A.layers[D]),L},{});return[...k,...Object.values(M)]},[]);p(k=>{let $=k.map(D=>D.id).filter(D=>D),E=w.filter(D=>D).filter(D=>!$.includes(D.id)).sort((D,A)=>A.order-D.order).map(D=>new Cc(D));const M=w.map(D=>D.id);return[...k.filter(D=>M.includes(D.id)),...E].sort((D,A)=>A.order-D.order)})}})()},[d.symbologies]);const x=b.useMemo(()=>Object.values(d.symbologies).reduce((S,w)=>{var k;return{...S,...((k=w==null?void 0:w.symbology)==null?void 0:k.layers)||{}}},{}),[d==null?void 0:d.symbologies]),h=(N=Object.values(d==null?void 0:d.symbologies))==null?void 0:N.filter(S=>S.isVisible).some(S=>{var w;return Object.values((w=S==null?void 0:S.symbology)==null?void 0:w.layers).some(k=>k["legend-orientation"]==="horizontal")}),f=b.useMemo(()=>Object.values(d.symbologies).map(S=>Object.values(S.symbology.layers).map(w=>w.selectedInteractiveFilterIndex)),[d.symbologies]),g=Nr(f);b.useEffect(()=>{u(S=>{Object.keys(S.symbologies).forEach(w=>{const k=S.symbologies[w];Object.keys(k.symbology.layers).filter($=>k.symbology.layers[$]["layer-type"]==="interactive").forEach($=>{const E=S.symbologies[w].symbology.layers[$],M=E["interactive-filters"],_=E.selectedInteractiveFilterIndex,L=M[_];if(L){const D={...E,...L,order:E.order,"layer-type":"interactive","interactive-filters":M,selectedInteractiveFilterIndex:_};D.layers.forEach((A,T)=>{D.layers[T].layout.visibility=k.isVisible?"visible":"none"}),S.symbologies[w].symbology.layers[$]=D}})})})},[Ae(f,g)]);const{center:y,zoom:v}=d.initialBounds?d.initialBounds:{center:[-75.17,42.85],zoom:6.6},j=so[d.height];return e.jsx(ps.Provider,{value:{state:d,setState:u,falcor:r,falcorCache:a,pgEnv:l},children:e.jsxs("div",{id:"dama_map_edit",className:"w-full relative",style:{height:j},ref:i,children:[e.jsx(Hn,{layers:m,layerProps:x,hideLoading:!0,showLayerSelect:!0,mapOptions:{center:y,zoom:v,protocols:[Ro],styles:d.blankBaseMap?$g:kg},leftSidebar:!1,rightSidebar:!1}),e.jsxs("div",{className:"absolute inset-0 flex pointer-events-none",children:[e.jsx("div",{className:"",children:e.jsx(wg,{})}),e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:h?"max-w-[350px]":"max-w-[300px]",children:e.jsx(jg,{})})]})]})})};Ng.settings={hasControls:!1,name:"ElementEdit"};const HM=({value:t,size:s})=>{var j;const{falcor:n,falcorCache:r,pgEnv:a}=C.useContext(me),l=b.useRef(!1),i=typeof t=="object"?t:t&&Cg(t)?JSON.parse(t):{},[c,d]=st({tabs:i.tabs||[{name:"Layers",rows:[]}],symbologies:i.symbologies||{},initialBounds:i.initialBounds||null,hideControls:i.hideControls||!1,blankBaseMap:i.blankBaseMap||!1,height:i.height||"full",zoomPan:typeof i.zoomPan=="boolean"?i.zoomPan:!0}),[u,m]=st([]);b.useEffect(()=>{(async()=>{if(l.current){let S=Object.values(c.symbologies).reduce((w,k)=>{var M;let $=w.map(_=>_.id),E=Object.keys((M=k==null?void 0:k.symbology)==null?void 0:M.layers).reduce((_,L)=>{var D;return $.includes(L)||(_[L]=(D=k==null?void 0:k.symbology)==null?void 0:D.layers[L]),_},{});return[...w,...Object.values(E)]},[]);m(w=>{let k=w.map(L=>L.id).filter(L=>L),$=S.filter(L=>L).filter(L=>!k.includes(L.id)).sort((L,D)=>D.order-L.order).map(L=>new Cc(L));const E=S.map(L=>L.id);return[...w.filter(L=>E.includes(L.id)),...$].sort((L,D)=>D.order-L.order)})}})()},[c==null?void 0:c.symbologies]);const p=b.useMemo(()=>Object.values(c.symbologies).reduce((N,S)=>{var w;return{...N,...((w=S==null?void 0:S.symbology)==null?void 0:w.layers)||{}}},{}),[c==null?void 0:c.symbologies]),x=(j=Object.values(c==null?void 0:c.symbologies))==null?void 0:j.filter(N=>N.isVisible).some(N=>{var S;return Object.values((S=N==null?void 0:N.symbology)==null?void 0:S.layers).some(w=>w["legend-orientation"]==="horizontal")}),h=b.useMemo(()=>Object.values(c.symbologies).map(N=>Object.values(N.symbology.layers).map(S=>S.selectedInteractiveFilterIndex)),[c.symbologies]),f=Nr(h);b.useEffect(()=>{d(N=>{Object.keys(N.symbologies).forEach(S=>{const w=N.symbologies[S];Object.keys(w.symbology.layers).filter(k=>w.symbology.layers[k]["layer-type"]==="interactive").forEach(k=>{const $=N.symbologies[S].symbology.layers[k],E=$["interactive-filters"],M=$.selectedInteractiveFilterIndex,_=E[M];if(_){const L={...$,..._,order:$.order,"layer-type":"interactive","interactive-filters":E,selectedInteractiveFilterIndex:M};L.layers.forEach((D,A)=>{L.layers[A].layout.visibility=w.isVisible?"visible":"none"}),N.symbologies[S].symbology.layers[k]=L}})})})},[Ae(h,f)]);const{center:g,zoom:y}=c.initialBounds?c.initialBounds:{center:[-75.17,42.85],zoom:6.6},v=so[c.height];return e.jsx(ps.Provider,{value:{state:c,setState:d,falcor:n,falcorCache:r,pgEnv:a},children:e.jsxs("div",{id:"dama_map_view",className:"w-full relative",style:{height:v},ref:l,children:[e.jsx(Hn,{layers:u,layerProps:p,hideLoading:!0,showLayerSelect:!0,mapOptions:{center:g,zoom:y,protocols:[Ro],styles:c.blankBaseMap?$g:kg,dragPan:c.zoomPan,scrollZoom:c.zoomPan,dragRotate:c.zoomPan},leftSidebar:!1,rightSidebar:!1}),e.jsxs("div",{className:"absolute inset-0 flex pointer-events-none",children:[!c.hideControls&&e.jsx("div",{className:"",children:e.jsx(wg,{})}),e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:x?"max-w-[350px]":"max-w-[300px]",children:e.jsx(jg,{})})]})]})})},WM={name:"Map: Dama",type:"Map",variables:[{name:"geoid",default:"36"}],getData:RM,EditComp:Ng,ViewComp:HM},kg=[{name:"Default",style:"https://api.maptiler.com/maps/dataviz/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Satellite",style:"https://api.maptiler.com/maps/hybrid/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Streets",style:"https://api.maptiler.com/maps/streets-v2/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Light",style:"https://api.maptiler.com/maps/dataviz-light/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Dark",style:"https://api.maptiler.com/maps/dataviz-dark/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Blank",style:{sources:{},version:8,layers:[{id:"background",type:"background",layout:{visibility:"visible"},paint:{"background-color":"rgba(208, 208, 206, 0)"}}]}}],$g=[{name:"Blank",style:{sources:{},version:8,layers:[{id:"background",type:"background",layout:{visibility:"visible"},paint:{"background-color":"rgba(208, 208, 206, 0)"}}]}}],Sg=(t,s)=>t*Math.pow(2,s),nr=(t,s)=>Math.floor(t/Math.pow(2,s)),no=(t,s)=>Sg(t.getUint16(s+1,!0),8)+t.getUint8(s),_g=(t,s)=>Sg(t.getUint32(s+2,!0),16)+t.getUint16(s,!0),VM=(t,s,n,r,a)=>{if(t!=r.getUint8(a))return t-r.getUint8(a);const l=no(r,a+1);if(s!=l)return s-l;const i=no(r,a+4);return n!=i?n-i:0},UM=(t,s,n,r)=>{const a=Ig(t,s|128,n,r);return a?{z:s,x:n,y:r,offset:a[0],length:a[1],is_dir:!0}:null},om=(t,s,n,r)=>{const a=Ig(t,s,n,r);return a?{z:s,x:n,y:r,offset:a[0],length:a[1],is_dir:!1}:null},Ig=(t,s,n,r)=>{let a=0,l=t.byteLength/17-1;for(;a<=l;){const i=l+a>>1,c=VM(s,n,r,t,i*17);if(c>0)a=i+1;else if(c<0)l=i-1;else return[_g(t,i*17+7),t.getUint32(i*17+13,!0)]}return null},qM=(t,s)=>t.is_dir&&!s.is_dir?1:!t.is_dir&&s.is_dir?-1:t.z!==s.z?t.z-s.z:t.x!==s.x?t.x-s.x:t.y-s.y,Lg=(t,s)=>{const n=t.getUint8(s*17);return{z:n&127,x:no(t,s*17+1),y:no(t,s*17+4),offset:_g(t,s*17+7),length:t.getUint32(s*17+13,!0),is_dir:n>>7===1}},lm=t=>{const s=[],n=new DataView(t);for(let r=0;r<n.byteLength/17;r++)s.push(Lg(n,r));return GM(s)},GM=t=>{t.sort(qM);const s=new ArrayBuffer(17*t.length),n=new Uint8Array(s);for(let r=0;r<t.length;r++){const a=t[r];let l=a.z;a.is_dir&&(l=l|128),n[r*17]=l,n[r*17+1]=a.x&255,n[r*17+2]=a.x>>8&255,n[r*17+3]=a.x>>16&255,n[r*17+4]=a.y&255,n[r*17+5]=a.y>>8&255,n[r*17+6]=a.y>>16&255,n[r*17+7]=a.offset&255,n[r*17+8]=nr(a.offset,8)&255,n[r*17+9]=nr(a.offset,16)&255,n[r*17+10]=nr(a.offset,24)&255,n[r*17+11]=nr(a.offset,32)&255,n[r*17+12]=nr(a.offset,48)&255,n[r*17+13]=a.length&255,n[r*17+14]=a.length>>8&255,n[r*17+15]=a.length>>16&255,n[r*17+16]=a.length>>24&255}return s},JM=(t,s)=>{if(t.byteLength<17)return null;const n=t.byteLength/17,r=Lg(t,n-1);if(r.is_dir){const a=r.z,l=s.z-a,i=Math.trunc(s.x/(1<<l)),c=Math.trunc(s.y/(1<<l));return{z:a,x:i,y:c}}return null};async function XM(t){const s=await t.getBytes(0,512e3),n=new DataView(s.data),r=n.getUint32(4,!0),a=n.getUint16(8,!0),l=new TextDecoder("utf-8"),i=JSON.parse(l.decode(new DataView(s.data,10,r)));let c=Sa.Unknown;i.compression==="gzip"&&(c=Sa.Gzip);let d=0;"minzoom"in i&&(d=+i.minzoom);let u=0;"maxzoom"in i&&(u=+i.maxzoom);let m=0,p=0,x=0,h=-180,f=-85,g=180,y=85;if(i.bounds){const j=i.bounds.split(",");h=+j[0],f=+j[1],g=+j[2],y=+j[3]}if(i.center){const j=i.center.split(",");m=+j[0],p=+j[1],x=+j[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:a*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:Sa.None,tileCompression:c,tileType:kc.Mvt,minZoom:d,maxZoom:u,minLon:h,minLat:f,maxLon:g,maxLat:y,centerZoom:x,centerLon:m,centerLat:p,etag:s.etag}}async function ZM(t,s,n,r,a,l,i){let c=await n.getArrayBuffer(s,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(c=lm(c));const d=om(new DataView(c),r,a,l);if(d){let p=(await s.getBytes(d.offset,d.length,i)).data;const x=new DataView(p);return x.getUint8(0)==31&&x.getUint8(1)==139&&(p=_n(new Uint8Array(p))),{data:p}}const u=JM(new DataView(c),{z:r,x:a,y:l});if(u){const m=UM(new DataView(c),u.z,u.x,u.y);if(m){let p=await n.getArrayBuffer(s,m.offset,m.length,t);t.specVersion===1&&(p=lm(p));const x=om(new DataView(p),r,a,l);if(x){let f=(await s.getBytes(x.offset,x.length,i)).data;const g=new DataView(f);return g.getUint8(0)==31&&g.getUint8(1)==139&&(f=_n(new Uint8Array(f))),{data:f}}}}}const Eg={getHeader:XM,getZxy:ZM};class YM{constructor(){this.tile=(s,n)=>{if(s.type=="json"){const r=s.url.substr(10);let a=this.tiles.get(r);return a||(a=new hi(r),this.tiles.set(r,a)),a.getHeader().then(l=>{const i={tiles:[s.url+"/{z}/{x}/{y}"],minzoom:l.minZoom,maxzoom:l.maxZoom,bounds:[l.minLon,l.minLat,l.maxLon,l.maxLat]};n(null,i,null,null)}).catch(l=>{n(l,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),a=s.url.match(r);if(!a)throw new Error("Invalid PMTiles protocol URL");const l=a[1];let i=this.tiles.get(l);i||(i=new hi(l),this.tiles.set(l,i));const c=a[2],d=a[3],u=a[4],m=new AbortController,p=m.signal;let x=()=>{m.abort()};return i.getHeader().then(h=>{i.getZxy(+c,+d,+u,p).then(f=>{f?n(null,new Uint8Array(f.data),f.cacheControl,f.expires):h.tileType==kc.Mvt?n(null,new Uint8Array,null,null):n(null,null,null,null)}).catch(f=>{f.name!=="AbortError"&&n(f,null,null,null)})}),{cancel:x}}},this.tiles=new Map}add(s){this.tiles.set(s.source.getKey(),s)}get(s){return this.tiles.get(s)}}function mn(t,s){return(s>>>0)*4294967296+(t>>>0)}function QM(t,s){const n=s.buf;let r,a;if(a=n[s.pos++],r=(a&112)>>4,a<128||(a=n[s.pos++],r|=(a&127)<<3,a<128)||(a=n[s.pos++],r|=(a&127)<<10,a<128)||(a=n[s.pos++],r|=(a&127)<<17,a<128)||(a=n[s.pos++],r|=(a&127)<<24,a<128)||(a=n[s.pos++],r|=(a&1)<<31,a<128))return mn(t,r);throw new Error("Expected varint not more than 10 bytes")}function rr(t){const s=t.buf;let n,r;return r=s[t.pos++],n=r&127,r<128||(r=s[t.pos++],n|=(r&127)<<7,r<128)||(r=s[t.pos++],n|=(r&127)<<14,r<128)||(r=s[t.pos++],n|=(r&127)<<21,r<128)?n:(r=s[t.pos],n|=(r&15)<<28,QM(n,t))}function KM(t,s,n,r){if(r==0){n==1&&(s[0]=t-1-s[0],s[1]=t-1-s[1]);const a=s[0];s[0]=s[1],s[1]=a}}const eA=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function tA(t,s,n){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(s>Math.pow(2,t)-1||n>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const r=eA[t],a=Math.pow(2,t);let l=0,i=0,c=0;const d=[s,n];let u=a/2;for(;u>0;)l=(d[0]&u)>0?1:0,i=(d[1]&u)>0?1:0,c+=u*u*(3*l^i),KM(u,d,l,i),u=u/2;return r+c}var Sa=(t=>(t[t.Unknown=0]="Unknown",t[t.None=1]="None",t[t.Gzip=2]="Gzip",t[t.Brotli=3]="Brotli",t[t.Zstd=4]="Zstd",t))(Sa||{});async function Mg(t,s){if(s===1||s===0)return t;if(s===2){if(typeof globalThis.DecompressionStream>"u")return _n(new Uint8Array(t));{let r=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(r).arrayBuffer()}}else throw Error("Compression method not supported")}var kc=(t=>(t[t.Unknown=0]="Unknown",t[t.Mvt=1]="Mvt",t[t.Png=2]="Png",t[t.Jpeg=3]="Jpeg",t[t.Webp=4]="Webp",t[t.Avif=5]="Avif",t))(kc||{});const sA=127;function nA(t,s){let n=0,r=t.length-1;for(;n<=r;){const a=r+n>>1,l=s-t[a].tileId;if(l>0)n=a+1;else if(l<0)r=a-1;else return t[a]}return r>=0&&(t[r].runLength===0||s-t[r].tileId<t[r].runLength)?t[r]:null}class rA{constructor(s){this.url=s.includes("localhost")?"http://"+s:"https://"+s}getKey(){return this.url}async getBytes(s,n,r){let a;r||(a=new AbortController,r=a.signal);let l=await fetch(this.url,{signal:r,headers:{Range:"bytes="+s+"-"+(s+n-1)}});if(l.status===416&&s===0){const d=l.headers.get("Content-Range");if(!d||!d.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const u=+d.substr(8);l=await fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(u-1)}})}if(l.status>=300)throw Error("Bad response code: "+l.status);const i=l.headers.get("Content-Length");if(l.status===200&&(!i||+i>n))throw a&&a.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:await l.arrayBuffer(),etag:l.headers.get("ETag")||void 0,cacheControl:l.headers.get("Cache-Control")||void 0,expires:l.headers.get("Expires")||void 0}}}function zt(t,s){const n=t.getUint32(s+4,!0),r=t.getUint32(s+0,!0);return n*Math.pow(2,32)+r}function aA(t,s){const n=new DataView(t),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:zt(n,8),rootDirectoryLength:zt(n,16),jsonMetadataOffset:zt(n,24),jsonMetadataLength:zt(n,32),leafDirectoryOffset:zt(n,40),leafDirectoryLength:zt(n,48),tileDataOffset:zt(n,56),tileDataLength:zt(n,64),numAddressedTiles:zt(n,72),numTileEntries:zt(n,80),numTileContents:zt(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:s}}function Ag(t){const s={buf:new Uint8Array(t),pos:0},n=rr(s),r=[];let a=0;for(let l=0;l<n;l++){const i=rr(s);r.push({tileId:a+i,offset:0,length:0,runLength:1}),a+=i}for(let l=0;l<n;l++)r[l].runLength=rr(s);for(let l=0;l<n;l++)r[l].length=rr(s);for(let l=0;l<n;l++){const i=rr(s);i===0&&l>0?r[l].offset=r[l-1].offset+r[l-1].length:r[l].offset=i-1}return r}function oA(t){const s=new DataView(t);return s.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):s.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}class vn extends Error{}async function lA(t,s,n,r){const a=await t.getBytes(0,16384),l=new DataView(a.data);if(l.getUint16(0,!0)!==19792)throw new Error(`Wrong magic number for PMTiles archive got ${l.getUint16(0,!0)} not 19729`);if(oA(a.data)<3)return[await Eg.getHeader(t)];const i=a.data.slice(0,sA);let c=a.etag;r&&a.etag!=r&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),c=void 0);const d=aA(i,c);if(n){const u=a.data.slice(d.rootDirectoryOffset,d.rootDirectoryOffset+d.rootDirectoryLength),m=t.getKey()+"|"+(d.etag||"")+"|"+d.rootDirectoryOffset+"|"+d.rootDirectoryLength,p=Ag(await s(u,d.internalCompression));return[d,[m,p.length,p]]}return[d,void 0]}async function iA(t,s,n,r,a){const l=await t.getBytes(n,r);if(a.etag&&a.etag!==l.etag)throw new vn(l.etag);const i=await s(l.data,a.internalCompression),c=Ag(i);if(c.length===0)throw new Error("Empty directory is invalid");return c}class cA{constructor(s=100,n=!0,r=Mg){this.cache=new Map,this.maxCacheEntries=s,this.counter=1,this.prefetch=n,this.decompress=r}async getHeader(s,n){const r=s.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,await this.cache.get(r).data;const a=new Promise((l,i)=>{lA(s,this.decompress,this.prefetch,n).then(c=>{c[1]&&this.cache.set(c[1][0],{lastUsed:this.counter++,data:Promise.resolve(c[1][2])}),l(c[0]),this.prune()}).catch(c=>{i(c)})});return this.cache.set(r,{lastUsed:this.counter++,data:a}),a}async getDirectory(s,n,r,a){const l=s.getKey()+"|"+(a.etag||"")+"|"+n+"|"+r;if(this.cache.has(l))return this.cache.get(l).lastUsed=this.counter++,await this.cache.get(l).data;const i=new Promise((c,d)=>{iA(s,this.decompress,n,r,a).then(u=>{c(u),this.prune()}).catch(u=>{d(u)})});return this.cache.set(l,{lastUsed:this.counter++,data:i}),i}async getArrayBuffer(s,n,r,a){const l=s.getKey()+"|"+(a.etag||"")+"|"+n+"|"+r;if(this.cache.has(l))return this.cache.get(l).lastUsed=this.counter++,await this.cache.get(l).data;const i=new Promise((c,d)=>{s.getBytes(n,r).then(u=>{if(a.etag&&a.etag!==u.etag)throw new vn(u.etag);c(u.data),this.cache.has(l),this.prune()}).catch(u=>{d(u)})});return this.cache.set(l,{lastUsed:this.counter++,data:i}),i}prune(){if(this.cache.size>=this.maxCacheEntries){let s=1/0,n;this.cache.forEach((r,a)=>{r.lastUsed<s&&(s=r.lastUsed,n=a)}),n&&this.cache.delete(n)}}async invalidate(s,n){this.cache.delete(s.getKey()),await this.getHeader(s,n)}}class hi{constructor(s,n,r){typeof s=="string"?this.source=new rA(s):this.source=s,r?this.decompress=r:this.decompress=Mg,n?this.cache=n:this.cache=new cA}async getHeader(){return await this.cache.getHeader(this.source)}async getZxyAttempt(s,n,r,a){const l=tA(s,n,r),i=await this.cache.getHeader(this.source);if(i.specVersion<3)return Eg.getZxy(i,this.source,this.cache,s,n,r,a);if(s<i.minZoom||s>i.maxZoom)return;let c=i.rootDirectoryOffset,d=i.rootDirectoryLength;for(let u=0;u<=3;u++){const m=await this.cache.getDirectory(this.source,c,d,i),p=nA(m,l);if(p)if(p.runLength>0){const x=await this.source.getBytes(i.tileDataOffset+p.offset,p.length,a);if(i.etag&&i.etag!==x.etag)throw new vn(x.etag);return{data:await this.decompress(x.data,i.tileCompression),cacheControl:x.cacheControl,expires:x.expires}}else c=i.leafDirectoryOffset+p.offset,d=p.length;else return}throw Error("Maximum directory depth exceeded")}async getZxy(s,n,r,a){try{return await this.getZxyAttempt(s,n,r,a)}catch(l){if(l instanceof vn)return this.cache.invalidate(this.source,l.message),await this.getZxyAttempt(s,n,r,a);throw l}}async getMetadataAttempt(){const s=await this.cache.getHeader(this.source),n=await this.source.getBytes(s.jsonMetadataOffset,s.jsonMetadataLength);if(s.etag&&s.etag!==n.etag)throw new vn(n.etag);const r=await this.decompress(n.data,s.internalCompression),a=new TextDecoder("utf-8");return JSON.parse(a.decode(r))}async getMetadata(){try{return await this.getMetadataAttempt()}catch(s){if(s instanceof vn)return this.cache.invalidate(this.source,s.message),await this.getMetadataAttempt();throw s}}}const dA={type:"pmtiles",protocolInit:t=>{const s=new YM;return t.addProtocol("pmtiles",s.tile),s},sourceInit:(t,s,n)=>{const r=new hi(s.url);t.add(r)}},im=(t,s=2,n=!1)=>isNaN(t)?"0":typeof t=="number"&&t<1?`${n?"$":""} ${t==null?void 0:t.toFixed(s)}`:t>=1e15?`${n?"$":""} ${(t/1e15).toFixed(s)} Q`:t>=1e12?`${n?"$":""} ${(t/1e12).toFixed(s)} T`:t>=1e9?`${n?"$":""} ${(t/1e9).toFixed(s)} B`:t>=1e6?`${n?"$":""} ${(t/1e6).toFixed(s)} M`:t>=1e3?`${n?"$":""} ${(t/1e3).toFixed(s)} K`:typeof t=="object"?"":`${n?"$":""} ${parseInt(t)}`,On={fill:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-4 rounded ",style:{backgroundColor:s}})}),circle:({layer:t,color:s})=>{let n=I(t,"layers[0].paint['circle-stroke-color']","#ccc");return e.jsx("div",{className:"pl-0.5 pr-2",children:e.jsx("div",{className:"w-3 h-3 rounded-full ",style:{backgroundColor:s,borderColor:n}})})},line:({layer:t,color:s})=>e.jsx("div",{className:"pr-2",children:e.jsx("div",{className:"w-4 h-1",style:{backgroundColor:s}})})},Sr={fill:t=>I(t,"layers[1].paint['fill-color']","#ccc"),circle:t=>I(t,"layers[0].paint['circle-color']","#ccc"),line:t=>I(t,"layers[1].paint['line-color']","#ccc")};function uA({layer:t}){const s=On[t.type]||On.fill;let n=(t==null?void 0:t["legend-data"])||[],r=typeof Sr[t.type](t)=="object"?Sr[t.type](t):[];const a=n||(r||[]).filter((l,i)=>i>2).map((l,i)=>i%2===0?{color:l,label:r[i+2]}:null).filter(l=>l);return e.jsx("div",{className:"w-full max-h-[250px] overflow-auto",children:a.map((l,i)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-pink-50",children:[e.jsx("div",{className:"flex items-center h-6 w-10 justify-center  ",children:e.jsx(s,{color:l.color})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-500 h-6 text-sm truncate",children:l.label})]},i))})}function mA({layer:t}){const{state:s,setState:n}=C.useContext(Cs),{choroplethdata:r,legenddata:a}=b.useMemo(()=>({choroplethdata:I(t,"['choropleth-data']",[]),legenddata:(t==null?void 0:t["legend-data"])||[]}),[s]),l=On[t.type]||On.fill;let i=typeof Sr[t.type](t)=="object"?Sr[t.type](t):[];const c=Math.max(...r),d=a||[...(i||[]).filter((u,m)=>m>2).map((u,m)=>m%2===1?{color:i[m+1],label:`${i[m+2]} - ${i[m+4]||c}`}:null).filter(u=>u)];return e.jsx("div",{className:"w-full max-h-[250px] overflow-auto",children:d.map((u,m)=>e.jsxs("div",{className:"w-full flex items-center hover:bg-pink-50",children:[e.jsx("div",{className:"flex items-center h-6 w-10 justify-center  ",children:e.jsx(l,{color:u.color})}),e.jsx("div",{className:"flex items-center text-center flex-1 px-4 text-slate-500 h-6 text-sm truncate",children:u.label})]},m))})}function pA({layer:t}){let{legenddata:s,showOther:n}=b.useMemo(()=>({legenddata:I(t,"['legend-data']",[]),showOther:I(t,"['category-show-other']","#ccc")}),[t]);const r=n==="#ccc";return e.jsx("div",{className:"w-full max-h-[350px] overflow-x-auto scrollbar-sm",children:e.jsx("div",{className:"flex-1 flex w-full p-2",children:s.map((a,l)=>e.jsxs("div",{className:"flex-1 h-6 overflow-hidden",children:[e.jsx("div",{className:"flex h-4 justify-self-end text-xs",children:r&&l===s.length-1?"N/A":s[l].label}),e.jsx("div",{className:"flex-1 h-2 w-20",style:{backgroundColor:a.color}},l)]},l))})})}function xA({layer:t}){const{minRadius:s,maxRadius:n,lowerBound:r,upperBound:a}=b.useMemo(()=>({minRadius:I(t,"['min-radius']",8),maxRadius:I(t,"['max-radius']",128),lowerBound:I(t,"['lower-bound']",null),upperBound:I(t,"['upper-bound']",null)}),[t]);return e.jsxs("div",{className:"w-[50%] max-h-[350px] overflow-x-auto scrollbar-sm text-sm",children:[e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsxs("div",{children:[s,"px"]}),e.jsxs("div",{children:[n,"px"]})]}),e.jsx("div",{className:"ml-8",children:e.jsx("i",{class:"fa-solid fa-arrow-right-long",style:{transform:"scaleX(3)"}})}),e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsx("div",{children:im(r)}),e.jsx("div",{children:im(a)})]})]})}function hA({index:t,layer:s,i:n,symbology_id:r,baseUrl:a}){const l=Le(),i=null,c=On[s.type]||On.fill;let d=Sr[s.type](s),{layerType:u,selectedInteractiveFilterIndex:m,legendOrientation:p}=b.useMemo(()=>({layerType:I(s,"['layer-type']"),selectedInteractiveFilterIndex:I(s,"['selectedInteractiveFilterIndex']"),legendOrientation:I(s,"['legend-orientation']","vertical")}),[s]);const x=`${a}/source/${s.source_id}`,h=u==="interactive"?s.label:s.name;return u=u==="interactive"?I(s,`['interactive-filters'][${m}]['layer-type']`):u,e.jsxs("div",{className:`${i==s.id?"bg-pink-100":""} hover:border-pink-500 border border-transparent`,children:[e.jsxs("div",{className:"group/title w-full  p-2 py-1 flex items-center",children:[(u==="simple"||!u)&&e.jsx("div",{className:"px-1",children:e.jsx(c,{layer:s,color:d})}),e.jsxs("div",{className:"w-full text-sm text-slate-600 font-medium truncate flex justify-between flex-wrap",children:[h,e.jsx("div",{className:"cursor-pointer text-white group-hover/title:text-black group/icon ",onClick:f=>{f.ctrlKey?window.open(x,"_blank"):l(x)},children:e.jsx("span",{className:"mx-2 text-md text-slate-300 fa fa-info group-hover/icon:text-pink-800"})})]})]}),p==="horizontal"?e.jsx(pA,{layer:s}):u==="circles"?e.jsx(xA,{layer:s}):e.jsxs(e.Fragment,{children:[u==="categories"&&e.jsx(uA,{layer:s}),u==="choropleth"&&e.jsx(mA,{layer:s})]})]})}function fA(t){const{state:s,setState:n}=C.useContext(Cs),{dataSourcesBaseUrl:r="/cenrep"}=C.useContext(me),a=b.useMemo(()=>Object.values((s==null?void 0:s.symbologies)||{}).filter(l=>l.isVisible).map(l=>({name:l.name,symbology_id:l.symbology_id,layers:{...l.symbology.layers}})),[s]);return e.jsx(e.Fragment,{children:e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"min-h-10 relative bg-white/75 max-h-[calc(100vh_-_111px)] overflow-auto pointer-events-auto scrollbar-sm",children:a.map(l=>e.jsx("div",{className:"m-1 p-1 rounded",children:Object.values(l.layers).sort((i,c)=>c.order-i.order).filter(i=>(i==null?void 0:i["legend-orientation"])!=="none").map((i,c)=>e.jsx(hA,{baseUrl:r,layer:i,i:c,symbology_id:l.symbology_id},i.id))},l.symbology_id))})})})}const gA=t=>{const s=b.useRef();return b.useEffect(()=>{s.current=t}),s.current},bA={symbology_id:"symbology_id",name:"name",collection_id:"collection_id",description:"description",symbology:"symbology",categories:"categories",_created_timestamp:"_created_timestamp",_modified_timestamp:"_modified_timestamp"},yA=t=>Object.entries(t||{}).reduce((s,n)=>{const[r,a]=n;return typeof a.value<"u"?s[r]=a.value:s[r]=a,s},{});function vA(t,s,n){return n.indexOf(t)===s}const wA=({maplibreMap:t,layer:s,layerProps:n,allLayerProps:r})=>{var v,j;const a=b.useContext(Cs),{state:l,setState:i}=a||{state:{},setState:()=>{}},[c,d]=C.useState(!1),u=b.useRef(null);b.useEffect(()=>{var S,w;const N=(w=(S=n==null?void 0:n.sources)==null?void 0:S[0])==null?void 0:w.id;if(N)if(t.getSource(N))d(!0);else{const k=()=>{t.getSource(N)&&(d(!0),t.off("sourcedata",k))};return t.on("sourcedata",k),()=>{t.off("sourcedata",k)}}},[t,(j=(v=n==null?void 0:n.sources)==null?void 0:v[0])==null?void 0:j.id]),b.useEffect(()=>()=>{s.layers.forEach(N=>{try{t&&t.getLayer(N.id)&&t.removeLayer(N.id)}catch{}})},[]);const m=t.getCenter(),p=t.getZoom();b.useEffect(()=>{l.setInitialBounds&&i(N=>{N.setInitialBounds=!1;const S={center:m,zoom:p};Ae(l.initialBounds,S)||(N.initialBounds=S)})},[t,l.setInitialBounds]);const x=gA(n),h=n.filterGroupEnabled&&!Ae(n==null?void 0:n["filter-group"],x==null?void 0:x["filter-group"]),f=!n.filterGroupEnabled&&(n==null?void 0:n["data-column"])!==(x==null?void 0:x["data-column"]),g=(n==null?void 0:n.filter)!==(x==null?void 0:x.filter),y=(n==null?void 0:n["dynamic-filters"])!==(x==null?void 0:x["dynamic-filters"]);b.useEffect(()=>{var k,$,E,M,_,L,D,A,T,O,B,F,z,P,U,R,W,V;if((h||f||g||y)&&(u.current=n),!c)return;if(console.log("debug map ue init",h,f,g,y),c&&u.current&&t.getSource(($=(k=n==null?void 0:n.sources)==null?void 0:k[0])==null?void 0:$.id)){let X=jt((E=n.sources)==null?void 0:E[0]),q=(M=X.source.tiles)==null?void 0:M[0];q&&(X.source.tiles=[cm(q,n)]),(_=n==null?void 0:n.layers)==null||_.forEach(Y=>{t.getLayer(Y==null?void 0:Y.id)&&t.getLayer(Y==null?void 0:Y.id)&&t.removeLayer(Y==null?void 0:Y.id)}),t.removeSource(X.id),t.getSource(X.id)?console.log("cant add",t.getSource(X.id)):t.addSource(X.id,X.source);let Q=Object.values(r).find(Y=>(Y==null?void 0:Y.order)===n.order+1);(L=n==null?void 0:n.layers)==null||L.forEach(Y=>{t.getLayer(Q==null?void 0:Q.id)?t.addLayer(Y,Q==null?void 0:Q.id):t.addLayer(Y)})}if((D=Object.keys(n))!=null&&D.length&&n.view_id!==(x==null?void 0:x.view_id)&&t.getSource((T=(A=x==null?void 0:x.sources)==null?void 0:A[0])==null?void 0:T.id)){const X=jt((O=x.sources)==null?void 0:O[0]);let q=jt((B=n.sources)==null?void 0:B[0]),Q=(F=q==null?void 0:q.source.tiles)==null?void 0:F[0];Q&&(q.source.tiles=[cm(Q,n)]),(z=n==null?void 0:n.layers)==null||z.forEach(H=>{t.getLayer(H==null?void 0:H.id)&&t.getLayer(H==null?void 0:H.id)&&t.removeLayer(H==null?void 0:H.id)}),t.removeSource(X.id),t.getSource(q.id)?console.log("cant add",t.getSource(q.id)):t.addSource(q.id,q.source);let Y=Object.values(r).find(H=>(H==null?void 0:H.order)===n.order+1);(P=n==null?void 0:n.layers)==null||P.forEach(H=>{t.getLayer(Y==null?void 0:Y.id)?t.addLayer(H,Y==null?void 0:Y.id):t.addLayer(H)})}if((x==null?void 0:x.order)!==void 0&&(n==null?void 0:n.order)<(x==null?void 0:x.order)){let X=Object.values(r).find(q=>(q==null?void 0:q.order)===(n==null?void 0:n.order)+1);(U=n==null?void 0:n.layers)==null||U.forEach(q=>{t.getLayer(q==null?void 0:q.id)&&t.moveLayer(q==null?void 0:q.id,X==null?void 0:X.id)})}(R=n==null?void 0:n.layers)==null||R.forEach((X,q)=>{t.getLayer(X.id)&&Object.keys(X.paint).forEach(Q=>{var Y,H,J,G;Ae((J=(H=(Y=x==null?void 0:x.layers)==null?void 0:Y[q])==null?void 0:H.paint)==null?void 0:J[Q],(G=X==null?void 0:X.paint)==null?void 0:G[Q])||t.setPaintProperty(X.id,Q,X.paint[Q])})}),(W=n==null?void 0:n.layers)==null||W.forEach((X,q)=>{t.getLayer(X.id)&&Object.keys((X==null?void 0:X.layout)||{}).forEach(Q=>{var Y,H,J,G;Ae((J=(H=(Y=x==null?void 0:x.layers)==null?void 0:Y[q])==null?void 0:H.layout)==null?void 0:J[Q],(G=X==null?void 0:X.layout)==null?void 0:G[Q])||t.setLayoutProperty(X.id,Q,X.layout[Q])})});const{filter:S,["dynamic-filters"]:w}=n;(V=n==null?void 0:n.layers)==null||V.forEach((X,q)=>{if(t.getLayer(X.id)){let Q=[];S&&(Q=Object.keys(S).map(J=>{var se;let G=[];if(J.includes("rpad(substring(prop_class, 1, 1), 3, '0')")){const le=["slice",["get","prop_class"],0,1],ce=S[J].operator,je=(se=S==null?void 0:S[J])==null?void 0:se.value.map(Ce=>Ce==null?void 0:Ce.substring(0,1));G=["in",le,["literal",je]],ce==="!="&&(G=["!",G])}else{const le=S[J].operator,ce=S[J].value,je=["get",J];le==="between"?G=["all",[">=",["to-string",je],["to-string",ce==null?void 0:ce[0]]],["<=",["to-string",je],["to-string",ce==null?void 0:ce[1]]]]:["==","!="].includes(le)?(G=["in",je,["literal",ce]],le==="!="&&(G=["!",G])):G=[le,["to-string",je],["to-string",ce]]}return G}));const Y=w&&(w==null?void 0:w.length)>0&&w.some(J=>{var G;return((G=J==null?void 0:J.values)==null?void 0:G.length)>0});let H=[];Y&&(H=w==null?void 0:w.filter(J=>{var G;return((G=J==null?void 0:J.values)==null?void 0:G.length)>0}).map(J=>{let G=[];const se=J.values;return G=["in",["get",J.column_name],["literal",se]],G})),t.setFilter(X.id,["all",...Q,...H])}}),t.once("idle",()=>{if(n!=null&&n.zoomToFitBounds){const X=((n==null?void 0:n.layers)||[]).map(Q=>Q.id),q=t.queryRenderedFeatures(void 0,{layers:X});if(q.length>0){const Q=i1(q),Y=c1(Q);t.fitBounds([[Y[0],Y[1]],[Y[2],Y[3]]],{padding:40,duration:2e3,easing:H=>1-(1-H)*(1-H)})}}})},[c,h,f,g,y,n]),b.useEffect(()=>{var N;t&&r&&((N=r==null?void 0:r.zoomToFit)==null?void 0:N.length)>0&&t.fitBounds(r.zoomToFit,{duration:400})},[t,r==null?void 0:r.zoomToFit])},cm=(t,s)=>{var c,d,u,m;let n=`${t}`;const r=(s==null?void 0:s.filter)&&((c=Object.keys(s==null?void 0:s.filter))==null?void 0:c.length)>0,a=s!=null&&s.filterGroupEnabled&&((d=s==null?void 0:s["filter-group"])==null?void 0:d.length)>0?(u=s==null?void 0:s["filter-group"])==null?void 0:u.map(p=>p.column_name):[s==null?void 0:s["data-column"]],l=(m=s==null?void 0:s["dynamic-filters"])==null?void 0:m.filter(p=>{var x;return((x=p==null?void 0:p.values)==null?void 0:x.length)>0}).map(p=>p.column_name),i=a.concat(l).filter(vA).filter(p=>!!p).join(",");if(n&&(i||r)){n!=null&&n.includes("?cols=")||(n+="?cols=");const p=n.split("?cols=");i&&p[1].length===0&&(n+=i),i&&p[1].length>0&&(n=n.replace(p[1],i)),i&&n.includes(i)&&r&&(n+=","),r&&Object.keys(s.filter).forEach((x,h)=>{x.includes("rpad(substring(prop_class, 1, 1), 3, '0')")?n+="prop_class":n+=`${x}`,h<Object.keys(s.filter).length-1&&(n+=",")})}return n};class jA extends Po{constructor(){super(...arguments);Wt(this,"onHover",{layers:this.layers.filter(n=>{var r;return((r=n==null?void 0:n.id)==null?void 0:r.indexOf("_case"))===-1}).map(n=>n.id),callback:(n,r,a)=>[r[0].id,n,(r[0]||{}).properties],Component:CA,isPinnable:this.isPinnable||!0});Wt(this,"RenderComponent",wA)}}const CA=({data:t,layer:s})=>{if(!s.props.hover)return;const{source_id:n,view_id:r}=s,{pgEnv:a,falcor:l,falcorCache:i}=C.useContext(me),c=C.useMemo(()=>I(t,"[0]",null),[t]),d=C.useMemo(()=>s.props["hover-columns"],[s]);b.useEffect(()=>{n&&l.get(["dama",a,"sources","byId",n,"attributes","metadata"])},[n,d]);const u=C.useMemo(()=>{if(d)return d;{let h=I(i,["dama",a,"sources","byId",n,"attributes","metadata","value","columns"],[]);return h.length===0&&(h=I(i,["dama",a,"sources","byId",n,"attributes","metadata","value"],[])),h}},[n,i,d]),m=C.useMemo(()=>{let h=I(i,["dama",a,"sources","byId",n,"attributes","metadata","value","columns"],[]);return h.length===0&&(h=I(i,["dama",a,"sources","byId",n,"attributes","metadata","value"],[])),Array.isArray(h)?h:[]},[n,i]);let p=(typeof(u==null?void 0:u[0])=="string"?u:u.map(h=>h.name||h.column_name)).filter(h=>!["wkb_geometry"].includes(h));C.useEffect(()=>{l.get(["dama",a,"viewsbyId",r,"databyId",c,p])},[l,a,r,c,u]);const x=C.useMemo(()=>I(i,["dama",a,"viewsbyId",r,"databyId",""+c],{}),[c,i,r,a]);return e.jsxs("div",{className:"bg-white p-4 max-h-64 max-w-lg min-w-[300px] scrollbar-xs overflow-y-scroll",children:[e.jsx("div",{className:"font-medium pb-1 w-full border-b ",children:(s==null?void 0:s.name)||""}),Object.keys(x).length===0&&u.length!==0?`Fetching Attributes ${c}`:"",Object.keys(x).filter(h=>typeof x[h]!="object").sort((h,f)=>{const g=(d==null?void 0:d.findIndex(v=>v.column_name===h))||0,y=(d==null?void 0:d.findIndex(v=>v.column_name===f))||0;return g-y}).map((h,f)=>{const g=u.find(j=>j.name===h||j.column_name===h)||{},y=m.find(j=>j.name===h||j.column_name===h)||{},v=JSON.parse((y==null?void 0:y.meta_lookup)||"{}");return g.name||g.display_name?e.jsxs("div",{className:"flex border-b pt-1",children:[e.jsx("div",{className:"flex-1 font-medium text-xs text-slate-400 pl-1",children:g.display_name||g.name}),e.jsx("div",{className:"flex-1 text-right text-sm font-thin pl-4 pr-1",children:(x==null?void 0:x[h])!=="null"?I(v,x==null?void 0:x[h],x==null?void 0:x[h]):""})]},f):e.jsx("span",{},f)})]})},NA=(t,s,n)=>{s&&n([])},Tg=(t,s,n)=>{var a;let r=(a=t[0])==null?void 0:a.key;s(t),n&&n(r)},kA=({props:t,selected:s,setSelected:n,onChange:r})=>e.jsxs("div",{className:"w-fit inline-block ml-2",children:[t.label,e.jsx("button",{className:"hover:text-red-300 animate ml-1 p-1 rounded-md rbt-token-remove-button",onClick:a=>{const l=s.filter(i=>i.key!==t.key);Tg(l,n,r)},children:e.jsx("i",{className:"fa fa-close"})})]},t.label),$A=({results:t,menuProps:s,labelKey:n,filter:r,filters:a,setFilter:l,onChange:i,...c})=>e.jsxs(ep,{className:"bg-slate-100 overflow-hidden z-[100] rounded-md",...s,children:[e.jsx("div",{className:"flex flex-row flex-wrap items-center justify-start gap-1 p-1 bg-slate-200 text-xs font-bold",children:a.map(({icon:d,label:u,value:m,filterText:p,onClick:x})=>{const h=r===p,f=g=>x?x(g):m?i(m):l(h?null:p);return e.jsxs("button",{title:`Filter by: ${p}`,className:`py-1 px-2 my-0.5 
                                    ${h?"bg-slate-300 hover:bg-blue-300":"bg-slate-100 hover:bg-blue-100"} 
                                     rounded-md`,onClick:g=>f(g),children:[e.jsx("i",{className:`${d} pr-2 pl-1`}),u]},p)})}),t.map((d,u)=>e.jsx(tp,{className:"block hover:bg-slate-200 text-xl tracking-wide pl-1",option:d,position:u,children:d.label},`${d.label}_${u}`))]}),dm=({className:t,value:s,onChange:n,options:r=[],filters:a=[],showAll:l=!1,placeholder:i="Search..."})=>{const[c,d]=b.useState([]),[u,m]=b.useState(""),[p,x]=b.useState(r);return b.useEffect(()=>{if(!s)return;const h=r.filter(f=>f.key===s);d(h)},[s,r]),b.useEffect(()=>{x(r.filter(h=>{var f;return!u||((f=h==null?void 0:h.label)==null?void 0:f.toLowerCase().includes(u.toLowerCase()))}))},[r,u]),e.jsx("div",{className:"flex justify-between",children:e.jsxs("div",{className:`flex flex row ${t} w-full shrink my-1 bg-white p-1 pl-3 rounded-l-md`,children:[e.jsx("i",{className:"fa fa-search font-light text-xl bg-white rounded-r-md"}),e.jsx(Km,{className:"w-full",onSearch:NA,minLength:0,id:"search",placeholder:i,options:p,labelKey:h=>`${h==null?void 0:h.label}`,defaultSelected:c,onChange:h=>Tg(h,d,n),selected:c,inputProps:{className:"w-full flex flex-row flex-wrap p-1"},renderMenu:(h,f,g)=>$A({results:h,menuProps:f,labelKey:g,filters:a,filter:u,setFilter:m,onChange:n}),renderToken:h=>e.jsx(kA,{props:h,selected:c,setSelected:d,onChange:n})},"search")]})})},SA=()=>{var u,m,p,x,h,f,g;const{state:t,setState:s,falcor:n,falcorCache:r,pgEnv:a}=b.useContext(Cs);b.useEffect(()=>{async function y(){const v=["dama",a,"symbologies","length"],j=await n.get(v);await n.get(["dama",a,"symbologies","byIndex",{from:0,to:ne(j.json,v,0)-1},"attributes",Object.values(bA)])}y()},[n,a]);const l=b.useMemo(()=>Object.values(ne(r,["dama",a,"symbologies","byIndex"],{})).map(y=>yA(ne(r,y.value,{attributes:{}}).attributes)),[r,a]),i=(u=Object.values(t==null?void 0:t.symbologies)[0])==null?void 0:u.symbology_id,c=l.map(y=>({label:y.name,key:y.symbology_id})),d=Object.values(((x=(p=(m=t.symbologies)==null?void 0:m[i])==null?void 0:p.symbology)==null?void 0:x.layers)||{}).map((y,v)=>{var j;return{label:(j=y.name)!=null&&j.length&&y.name!==" "?y.name:`layer - ${v+1}`,key:y.id}});return e.jsxs("div",{className:"flex w-full bg-white items-center",children:[e.jsx("label",{className:"p-1",children:"Symbology: "}),e.jsx("div",{className:"w-1/2",children:e.jsx(dm,{className:"flex-row-reverse",placeholder:"Search...",options:c,value:i,onChange:y=>{const v=l.find(j=>+j.symbology_id==+y)||{};v!=null&&v.symbology_id&&(console.log("[sym",v,y,c),s(j=>{j.symbologies={[y]:{...v,isVisible:!0}}}))}})}),e.jsx("label",{className:"p-1",children:"Layer: "}),e.jsx("div",{className:"w-1/2",children:e.jsx(dm,{className:"flex-row-reverse",placeholder:"Search...",options:d,value:(g=(f=(h=t.symbologies)==null?void 0:h[i])==null?void 0:f.symbology)==null?void 0:g.activeLayer,onChange:y=>{var j;const v=((j=t.symbologies)==null?void 0:j[i].symbology[y])||{};console.log("currView",t.symbologies,y),v&&s(N=>{N.symbologies[i].symbology.activeLayer=y})}})})]})},Og=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,color:"#000000",fill:"none",...t,children:e.jsx("path",{d:"M18 9.00005C18 9.00005 13.5811 15 12 15C10.4188 15 6 9 6 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})});function _A({enabled:t=!1,setEnabled:s,label:n,size:r="medium"}){const a={xs:"h-2 w-6",small:"h-4 w-8",medium:"h-6 w-11"},l={xs:"h-1.5 w-1.5 p-1",small:"h-3.5 w-3.5 p-1",medium:"h-4 w-4"},i={true:{xs:"translate-x-3.5",small:"translate-x-4",medium:"translate-x-6"},false:{xs:"translate-x-0.5",small:"translate-x-0.5",medium:"translate-x-1"}},c={xs:"rounded-lg",small:"rounded-lg",medium:"rounded-full"};return e.jsxs("div",{role:"switch","aria-checked":t,"aria-label":n,tabIndex:0,onClick:()=>s&&s(!t),onKeyDown:d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),s&&s(!t))},className:`relative inline-flex ${a[r]} items-center ${c[r]} cursor-pointer transition-colors duration-200 ease-in-out ${t?"bg-indigo-600":"bg-gray-200"}`,children:[e.jsx("span",{className:"sr-only",children:n}),e.jsx("span",{className:`inline-block ${l[r]} transform rounded-full bg-white transition-transform duration-200 ease-in-out ${i[t][r]}`})]})}const wn=({value:t,setValue:s,title:n,className:r})=>s?e.jsx("div",{children:e.jsxs("div",{className:r||`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular 
            text-gray-900 bg-white hover:bg-gray-50 cursor-pointer`,onClick:()=>s(!t),children:[e.jsx("span",{className:"flex-1 select-none mr-1",children:n}),e.jsx(_A,{size:"small",enabled:t,setEnabled:()=>{}})]})}):null,IA=({type:t,placeHolder:s,value:n,setValue:r,title:a,className:l,inputClassName:i,displayCdn:c=!0})=>r&&c?e.jsx("div",{children:e.jsxs("div",{className:l||`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular 
            text-gray-900 bg-white hover:bg-gray-50 cursor-pointer`,children:[e.jsx("span",{className:"flex-1 select-none mr-1",children:a}),e.jsx("input",{className:i||"p-0.5",type:t,placeholder:s,value:n,onChange:d=>r(t==="number"?+d.target.value:d.target.value),onWheel:d=>d.target.blur()})]})}):null,Dg=(t,s,n)=>{const r=b.useCallback(a=>{t.current&&!t.current.contains(a.target)&&a.target.id!==s&&n()},[t,s,n]);b.useEffect(()=>(document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}),[r])};function LA(){var x,h;const{state:t,setState:s}=b.useContext(Cs),n=b.useRef(null),[r,a]=b.useState(!1),l="menu-btn-filter-controls";Dg(n,l,()=>a(!1));const i=Object.keys(t.symbologies||{}).find(f=>t.symbologies[f].isVisible),c=(x=t.symbologies[i])==null?void 0:x.symbology,d=(h=c==null?void 0:c.layers)==null?void 0:h[c==null?void 0:c.activeLayer],u=(d==null?void 0:d["interactive-filters"])||[],m=(d==null?void 0:d["dynamic-filters"])||[],p=d==null?void 0:d.selectedInteractiveFilterIndex;return e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsx("div",{children:e.jsxs("div",{id:l,className:`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 ${r?"bg-gray-50":"bg-white hover:bg-gray-50"} cursor-pointer`,onClick:f=>a(!r),children:["Filters ",e.jsx(Og,{id:l,height:18,width:18,className:"mt-1"})]})}),e.jsx("div",{ref:n,className:`${r?"visible transition ease-in duration-200":"hidden transition ease-in duration-200"} absolute left-0 z-10 w-[20rem] origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition focus:outline-none`,children:e.jsxs("div",{className:"py-1 max-h-[500px] overflow-auto scrollbar-sm",children:[e.jsx(wn,{title:"Use Search Params",value:d==null?void 0:d.useSearchParams,setValue:f=>s(g=>{g.symbologies[i].symbology.layers[c==null?void 0:c.activeLayer].useSearchParams=f})}),e.jsx(IA,{title:"Search Param Key",type:"text",value:d==null?void 0:d.searchParamKey,setValue:f=>s(g=>{g.symbologies[i].symbology.layers[c==null?void 0:c.activeLayer].searchParamKey=f})}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 px-2 py-1 text-gray-700",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Interactive Filter"}),e.jsx("div",{className:"text-sm font-semibold",children:"Search Param Value"}),e.jsx("div",{className:"text-sm font-semibold justify-self-end",children:"Active"}),u.map((f,g)=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm",children:f.label}),e.jsx("input",{className:"text-sm",placeholder:"search param key",value:f.searchParamValue||f.label,onChange:y=>{s(v=>{v.symbologies[i].symbology.layers[c==null?void 0:c.activeLayer]["interactive-filters"][g].searchParamValue=y.target.value})}}),e.jsx(wn,{value:p===g,setValue:y=>y?s(v=>{v.symbologies[i].symbology.layers[c==null?void 0:c.activeLayer].selectedInteractiveFilterIndex=g}):null})]}))]}),e.jsxs("div",{className:"grid grid-cols-4 gap-1 px-2 py-1 text-gray-700",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Dynamic Filter"}),e.jsx("div",{className:"text-sm font-semibold",children:"Search Param Value"}),e.jsx("div",{className:"text-sm font-semibold",children:"Default Value"}),e.jsx("div",{className:"text-sm font-semibold",children:"Type"}),m.map((f,g)=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm",children:f.display_name||f.column_name}),e.jsx("input",{className:"text-sm",placeholder:"search param key",value:f.searchParamKey||f.column_name,onChange:y=>{s(v=>{v.symbologies[i].symbology.layers[c==null?void 0:c.activeLayer]["dynamic-filters"][g].searchParamKey=y.target.value})}}),e.jsx("input",{className:"text-sm",placeholder:"default value",value:f.defaultValue,onChange:y=>{s(v=>{var N;const j=(N=y.target.value)!=null&&N.length?y.target.value:void 0;v.symbologies[i].symbology.layers[c==null?void 0:c.activeLayer]["dynamic-filters"][g].defaultValue=j,v.symbologies[i].symbology.layers[c==null?void 0:c.activeLayer]["dynamic-filters"][g].values=j?[j]:[]})}}),e.jsxs("select",{className:"text-sm",value:f.dataType,onChange:y=>{s(v=>{v.symbologies[i].symbology.layers[c==null?void 0:c.activeLayer]["dynamic-filters"][g].dataType=y.target.value})},children:[e.jsx("option",{value:void 0,children:"String"},"str"),e.jsx("option",{value:"numeric",children:"Numeric"},"num")]})]}))]})]},"filters")})]})}const EA=[{name:"Default",style:"https://api.maptiler.com/maps/dataviz/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Satellite",style:"https://api.maptiler.com/maps/hybrid/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Streets",style:"https://api.maptiler.com/maps/streets-v2/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Light",style:"https://api.maptiler.com/maps/dataviz-light/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Dark",style:"https://api.maptiler.com/maps/dataviz-dark/style.json?key=mU28JQ6HchrQdneiq6k9"},{name:"Blank",style:{sources:{},version:8,layers:[{id:"background",type:"background",layout:{visibility:"visible"},paint:{"background-color":"rgba(208, 208, 206, 0)"}}]}}],MA=[{name:"Blank",style:{sources:{},version:8,layers:[{id:"background",type:"background",layout:{visibility:"visible"},paint:{"background-color":"rgba(208, 208, 206, 0)"}}]}}];function AA(){const{state:t,setState:s}=b.useContext(Cs),n=b.useRef(null),[r,a]=b.useState(!1),l="menu-btn-more-controls";return Dg(n,l,()=>a(!1)),e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsx("div",{children:e.jsxs("div",{id:l,className:`inline-flex w-full justify-center items-center rounded-md px-1.5 py-1 text-sm font-regular text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 ${r?"bg-gray-50":"bg-white hover:bg-gray-50"} cursor-pointer`,onClick:i=>a(!r),children:["More ",e.jsx(Og,{id:l,height:18,width:18,className:"mt-1"})]})}),e.jsx("div",{ref:n,className:`${r?"visible transition ease-in duration-200":"hidden transition ease-in duration-200"} absolute left-0 z-10 w-[14rem] origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 transition focus:outline-none`,children:e.jsxs("div",{className:"py-1 max-h-[500px] overflow-auto scrollbar-sm",children:[e.jsxs("div",{className:`inline-flex w-full justify-between items-center rounded-md px-1.5 py-1 text-sm font-regular 
            text-gray-900 bg-white hover:bg-gray-50 cursor-pointer`,children:[e.jsx("label",{children:"Height"}),e.jsx("select",{className:"bg-transparent p-1",value:t.height,onChange:i=>s(c=>{c.height=i.target.value}),children:["full","1","2/3","1/3","1/4"].map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsx(wn,{title:"Zoom/pan",value:t==null?void 0:t.zoomPan,setValue:i=>s(c=>{c.zoomPan=i})}),e.jsx(wn,{title:"Set initial viewport",value:t==null?void 0:t.setInitialBounds,setValue:i=>s(c=>{c.setInitialBounds=i,i||(c.initialBounds=void 0)})}),e.jsx(wn,{title:"Use blank basemap",value:t==null?void 0:t.blankBaseMap,setValue:i=>s(c=>{c.blankBaseMap=i})}),e.jsx(wn,{title:"Zoom to Fit",value:t==null?void 0:t.zoomToFitBounds,setValue:i=>s(c=>{c.zoomToFitBounds=i})})]},"more")})]})}const TA={full:"calc(95vh)",1:"900px","2/3":"600px","1/3":"300px","1/4":"150px"},OA=t=>{try{JSON.parse(t)}catch{return!1}return!0},Cs=b.createContext(void 0),DA=async()=>({}),fi=({value:t,onChange:s,size:n})=>{var $,E,M;const r=!!s,{falcor:a,falcorCache:l,pgEnv:i}=C.useContext(me),c=typeof t=="object"?t:t&&OA(t)?JSON.parse(t):{},[d,u]=st({tabs:c.tabs||[{name:"Layers",rows:[]}],symbologies:c.symbologies||{},isEdit:r,setInitialBounds:c.setInitialBounds||!1,initialBounds:c.initialBounds||null,hideControls:c.hideControls||!1,blankBaseMap:c.blankBaseMap||!1,height:c.height||"full",zoomPan:typeof c.zoomPan=="boolean"?c.zoomPan:!0,zoomToFitBounds:c.zoomToFitBounds}),[m,p]=st([]),[x]=Rt(),h=b.useMemo(()=>Object.values(d.symbologies||{}).some(_=>{var L;return Object.keys(((L=_==null?void 0:_.symbology)==null?void 0:L.layers)||{}).length>0}),[d.symbologies]);b.useEffect(()=>{var R,W;const _=Object.keys(d.symbologies||{}).find(V=>d.symbologies[V].isVisible),L=(R=d.symbologies[_])==null?void 0:R.symbology,D=(W=L==null?void 0:L.layers)==null?void 0:W[L==null?void 0:L.activeLayer],A=D==null?void 0:D.useSearchParams,T=D==null?void 0:D.searchParamKey,O=(D==null?void 0:D["interactive-filters"])||[];if(!A)return;const B=x.get(T),F=O.findIndex(V=>V.searchParamValue===B||V.label===B),z=(D==null?void 0:D["dynamic-filters"])||[],P=V=>V.searchParamKey||V.column_name,U=z.reduce((V,X)=>({...V,[P(X)]:x.get(P(X))}),{});u(V=>{F!==-1&&(V.symbologies[_].symbology.layers[L==null?void 0:L.activeLayer].selectedInteractiveFilterIndex=F),z!=null&&z.length&&V.symbologies[_].symbology.layers[L.activeLayer]["dynamic-filters"].filter(X=>U[P(X)]).forEach(X=>{var Y;const q=X.dataType==="numeric",Q=U[P(X)].split("|||");X.values=Q!=null&&Q.length?Q.map(H=>q?+H:H):(Y=X.defaultValue)!=null&&Y.length?[q?+X.defaultValue:X.defaultValue]:[]})})},[x]),b.useEffect(()=>{(async()=>{if(h){let L=Object.values(d.symbologies).reduce((D,A)=>{var B;let T=D.map(F=>F.id),O=Object.keys((B=A==null?void 0:A.symbology)==null?void 0:B.layers).reduce((F,z)=>{var P,U;return T.includes(z)||(F[z]=(U=(P=A==null?void 0:A.symbology)==null?void 0:P.layers)==null?void 0:U[z]),F},{});return[...D,...Object.values(O)]},[]);p(D=>{let A=L.filter(B=>B).sort((B,F)=>F.order-B.order).map(B=>new jA(B));const T=L.map(B=>B.id);return D.filter(B=>T.includes(B.id)),[...A].sort((B,F)=>F.order-B.order)})}})()},[d.symbologies,h]);const f=b.useMemo(()=>Object.values(d.symbologies).reduce((_,L)=>{var D;return{..._,...Object.keys(((D=L==null?void 0:L.symbology)==null?void 0:D.layers)||{}).reduce((A,T)=>{var O,B;return{...A,[T]:{...((B=(O=L==null?void 0:L.symbology)==null?void 0:O.layers)==null?void 0:B[T])||{},zoomToFitBounds:d.zoomToFitBounds}}},{})}},{}),[d==null?void 0:d.symbologies,d.zoomToFitBounds]),g=($=Object.values(d==null?void 0:d.symbologies))==null?void 0:$.filter(_=>_.isVisible).some(_=>{var L;return Object.values((L=_==null?void 0:_.symbology)==null?void 0:L.layers).some(D=>D["legend-orientation"]==="horizontal")}),y=b.useMemo(()=>{var D,A,T;const _=Object.keys(d.symbologies||{}).find(O=>d.symbologies[O].isVisible),L=(D=d.symbologies[_])==null?void 0:D.symbology;return(T=(A=d.symbologies[_])==null?void 0:A.symbology.layers[L==null?void 0:L.activeLayer])==null?void 0:T.selectedInteractiveFilterIndex},[d.symbologies]);b.useEffect(()=>{u(_=>{Object.keys(_.symbologies).forEach(L=>{const D=_.symbologies[L];Object.keys(D.symbology.layers).forEach(A=>{const T=_.symbologies[L].symbology.layers[A],O=T["interactive-filters"]||{},B=T["dynamic-filters"],F=+T.selectedInteractiveFilterIndex,z=O==null?void 0:O[F];if(z){const P={...T,...z,order:T.order,"layer-type":"interactive","interactive-filters":O,"dynamic-filters":B,selectedInteractiveFilterIndex:F};P.layers.forEach((U,R)=>{P.layers[R].layout.visibility=D.isVisible?"visible":"none"}),_.symbologies[L].symbology.layers[A]=P}})})})},[y]);const v=TA[d.height],j=Object.keys(d.symbologies||{}).find(_=>d.symbologies[_].isVisible),N=(E=d.symbologies[j])==null?void 0:E.symbology,S=(M=N==null?void 0:N.layers)==null?void 0:M[N==null?void 0:N.activeLayer];S==null||S.selectedInteractiveFilterIndex;const{center:w,zoom:k}=d.initialBounds?d.initialBounds:{center:[-75.17,42.85],zoom:6.6};return b.useEffect(()=>{s&&s(d)},[d]),e.jsxs(Cs.Provider,{value:{state:d,setState:u,falcor:a,falcorCache:l,pgEnv:i},children:[r?e.jsxs(e.Fragment,{children:[e.jsx(SA,{context:Cs}),e.jsx(LA,{}),e.jsx(AA,{})]}):null,e.jsxs("div",{id:"dama_map_edit",className:"w-full relative",style:{height:v},children:[e.jsx(Hn,{layers:m,layerProps:f,hideLoading:!0,showLayerSelect:!0,mapOptions:{center:w,zoom:k,protocols:[dA],styles:d.blankBaseMap?MA:EA,dragPan:d.zoomPan,scrollZoom:d.zoomPan,dragRotate:d.zoomPan},leftSidebar:!1,rightSidebar:!1}),e.jsxs("div",{className:"absolute inset-0 flex pointer-events-none",children:[e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:g?"max-w-[350px]":"max-w-[300px]",children:e.jsx(fA,{})})]})]})]})};fi.settings={hasControls:!1,name:"ElementEdit"};const BA={name:"Map",type:"Map",variables:[],getData:DA,EditComp:fi,ViewComp:fi},Pe=(t,s)=>{const{baseUrl:n="/datasources",defaultPgEnv:r="pan",useFalcor:a,useAuth:l}=s;return()=>{const{falcor:i,falcorCache:c}=a(),d=l();return e.jsx(ie.Provider,{value:{pgEnv:r,baseUrl:n,falcor:i,falcorCache:c,user:d},children:e.jsx(t,{})})}},FA=t=>{const{baseUrl:s="/datasources",authLevel:n=-1,components:r={},dataTypes:a={},navSettings:l={}}=t,{Head:i=T7,List:c=gk,View:d=G_,Create:u=J_,Del:m=Q_}=r,{sideNav:p={size:"none"},topNav:x={size:"none"}}=l;return Object.keys(a).forEach(h=>V_(h,a[h])),[{name:"Data Sources",path:`${s}/`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(c,t)},{name:"Data Sources",path:`${s}/cat/:cat1`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(c,t)},{name:"Data Sources",path:`${s}/cat/:cat1/:cat2`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(c,t)},{name:"Data Sources",path:`${s}/listall`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(c,t)},{name:"Data Sources",path:`${s}/listall/cat/:cat1`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(c,t)},{name:"Data Sources",path:`${s}/listall/cat/:cat1/:cat2`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(c,t)},{name:"View Source",path:`${s}/source/:sourceId`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(d,t)},{name:"View Source",path:`${s}/source/:sourceId/:page`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(d,t)},{name:"View Source",path:`${s}/source/:sourceId/:page/:viewId`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(d,t)},{name:"View Source",path:`${s}/source/:sourceId/:page/:viewId/:vPage`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(d,t)},{name:"Create Source",path:`${s}/create/source`,exact:!0,authLevel:!1,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(u,t)},{name:"Create Source",path:`${s}/create/source/:analysisContextId`,exact:!0,authLevel:!1,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(u,t)},{name:"Delete Source",path:`${s}/delete/source/:sourceId`,exact:!0,authLevel:!0,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(m,t)},{name:"Data Collections",path:`${s}/mapeditor`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(rm,t)},{name:"Data Collections",path:`${s}/mapeditor/:symbologyId`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(rm,t)},{name:"Data Collections",path:`${s}/collections`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(Sl,t)},{name:"Data Collections",path:`${s}/collections/cat/:cat1`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(Sl,t)},{name:"Data Collections",path:`${s}/collections/cat/:cat1/:cat2`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(Sl,t)},{name:"View Collection",path:`${s}/collection/:collectionId`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(pa,t)},{name:"View Collection",path:`${s}/collection/:collectionId/:page`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(pa,t)},{name:"View Symbology",path:`${s}/collection/:collectionId/:page/:symbologyId`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(pa,t)},{name:"View Symbology",path:`${s}/collection/:collectionId/:page/:symbologyId/:sPage`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(pa,t)},{name:"Create Collection",path:`${s}/create/collection`,exact:!0,authLevel:!1,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(LL,t)},{name:"Delete Collection",path:`${s}/delete/collection/:collectionId`,exact:!0,authLevel:!0,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(TL,t)},{name:"Tasks",path:`${s}/tasks`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(zL,t)},{name:"Task",path:`${s}/task/:etl_context_id`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(WL,t)},{name:"Settings",path:`${s}/settings`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(VL,t)},{name:"DMS List",path:`${s}/dmslist`,exact:!0,authLevel:n,mainNav:!1,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(JL,t)},{name:"Schedules",path:`${s}/schedules`,exact:!0,authLevel:n,mainNav:!0,Title:()=>e.jsx(ze,{baseUrl:s}),sideNav:p,topNav:x,element:Pe(BL,t)}]},um=({sideNav:t})=>{const s=De(),n=ne(t,"color","white"),a={size:ne(t,"size","full"),color:n};return e.jsx(ue,{to:"/",className:` ${s.sidenav(a).logoWrapper} flex flex-col items-center justify-center`,children:e.jsx("div",{className:"flex items-center ",children:e.jsx("img",{src:`${n==="dark"?"/nys_logo.svg":"/nys_logo_blue.svg"}`,className:"w-full h-12 justify-between",alt:"New York State Logo"})})})},zA=[{name:"Docs",path:"/docs",icon:"os-icon os-icon-home-10"},{name:"Data Sources",path:"/datasources",icon:"os-icon os-icon-grid-squares2"}],PA=({children:t,menus:s,sideNav:n={},topNav:r={},Title:a,site:l})=>{const i={size:(n==null?void 0:n.size)||"none",color:(n==null?void 0:n.color)||"dark",menuItems:(n==null?void 0:n.menuItems)||s};console.log("ppdaf layout",r);const c={position:(r==null?void 0:r.position)||"block",size:(r==null?void 0:r.size)||"compact",menu:(r==null?void 0:r.menu)||"left",subMenuStyle:(r==null?void 0:r.subMenuStyle)||"row",menuItems:((r==null?void 0:r.menuItems)||zA).filter(x=>!x.hideInNav),logo:(r==null?void 0:r.logo)||e.jsxs("div",{className:"flex items-center justify-center h-12",children:[e.jsx("div",{to:"/",className:`${["none"].includes(i.size)?"":"md:hidden"}`,children:e.jsx(um,{sideNav:{size:"mini",color:"white"}})}),typeof a=="function"?e.jsx(a,{}):a]})},d=De(),u={size:ne(n,"size","micro"),color:ne(n,"color","dark")},[m,p]=C.useState(!1);return e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"fixed h-screen",children:e.jsx(xy,{topMenu:e.jsx(um,{sideNav:n}),themeOptions:u,menuItems:s})})}),e.jsxs("div",{className:"flex-1 flex items-start flex-col items-stretch min-h-screen",children:[e.jsx("div",{className:`${d.sidenav(u).fixed} `,children:c.size==="none"?"":e.jsx(e.Fragment,{children:e.jsx("div",{className:`${(c==null?void 0:c.position)==="fixed"?"sticky top-0 z-20 w-full h-[51px]":""}`,children:e.jsx(Ei,{themeOptions:c,leftMenu:c.logo,menuItems:c.menuItems,rightMenu:e.jsx(A7,{})})})})}),e.jsx("div",{className:`h-full flex-1 bg-slate-100 ${d.sidenav(u).fixed}`,children:t})]})]})},RA=Sn.withAuth(({element:t,component:s,Layout:n=({children:a})=>e.jsx(e.Fragment,{children:a}),...r})=>{const a=t||s;Le(),Ge();const{auth:l,authLevel:i,user:c}=r;return console.log("LayoutWrapper--------------",r,n),e.jsx(n,{...r,children:e.jsx(a,{})})});function mm(t,s=PA){const n=t.filter(a=>a.mainNav);return t.map(a=>{let l=jt(a);return l.element=e.jsx(RA,{...l,Layout:s,menus:n}),l})}g9({"Map: Dama Map":WM,Map:BA});function HA(){return e.jsx(C7,{dmsConfig:y7({app:"npmrdsv5",type:"dev2"}),API_HOST:D7,authWrapper:Sn.withAuth,themes:E7,pgEnvs:["npmrds2"],damaBaseUrl:"/datasets",routes:[...mm(FA({baseUrl:"/datasets",defaultPgEnv:"npmrds2",navSettings:{topNav:{position:"fixed",size:"compact"},sideNav:{size:"none",color:"white"}},useAuth:Sn.useAuth,useFalcor:k1})),...mm(k7)]})}const{API_HOST:WA="https://graph.availabs.org",AUTH_HOST:VA="https://graph.availabs.org",PROJECT_NAME:UA="test",CLIENT_HOST:qA="https://netlify.app"}={},GA=pp(WA),JA=Sn.authProvider(HA,{AUTH_HOST:VA,PROJECT_NAME:UA,CLIENT_HOST:qA});d1.createRoot(document.getElementById("root")).render(e.jsx(b.StrictMode,{children:e.jsx($1,{falcor:GA,children:e.jsx(ho.Provider,{value:ev,children:e.jsx(JA,{})})})}));export{Ip as $,Vs as B,yo as D,hw as F,kw as L,s5 as P,Pp as S,In as T,jw as a,kd as b,Z as t,Mr as u};
